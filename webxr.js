!function(t,n){if("object"==typeof exports&&"object"==typeof module)module.exports=n(require("gloperate"));else if("function"==typeof define&&define.amd)define(["gloperate"],n);else{var r="object"==typeof exports?n(require("gloperate")):n(t.gloperate);for(var e in r)("object"==typeof exports?exports:t)[e]=r[e]}}(window,function(t){return function(t){var n={};function r(e){if(n[e])return n[e].exports;var i=n[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=t,r.c=n,r.d=function(t,n,e){r.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:e})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,n){if(1&n&&(t=r(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(r.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var i in t)r.d(e,i,function(n){return t[n]}.bind(null,i));return e},r.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(n,"a",n),n},r.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},r.p="",r(r.s=61)}({0:function(n,r){n.exports=t},1:function(t,n,r){"use strict";r.r(n);var e={};r.r(e),r.d(e,"EPSILON",function(){return h}),r.d(e,"ARRAY_TYPE",function(){return m}),r.d(e,"RANDOM",function(){return v}),r.d(e,"setMatrixArrayType",function(){return p}),r.d(e,"toRadian",function(){return b}),r.d(e,"equals",function(){return g});var i={};r.r(i),r.d(i,"create",function(){return _}),r.d(i,"clone",function(){return x}),r.d(i,"copy",function(){return y}),r.d(i,"identity",function(){return S}),r.d(i,"fromValues",function(){return A}),r.d(i,"set",function(){return T}),r.d(i,"transpose",function(){return w}),r.d(i,"invert",function(){return R}),r.d(i,"adjoint",function(){return E}),r.d(i,"determinant",function(){return C}),r.d(i,"multiply",function(){return L}),r.d(i,"rotate",function(){return O}),r.d(i,"scale",function(){return P}),r.d(i,"fromRotation",function(){return N}),r.d(i,"fromScaling",function(){return I}),r.d(i,"str",function(){return F}),r.d(i,"frob",function(){return B}),r.d(i,"LDU",function(){return U}),r.d(i,"add",function(){return V}),r.d(i,"subtract",function(){return q}),r.d(i,"exactEquals",function(){return D}),r.d(i,"equals",function(){return G}),r.d(i,"multiplyScalar",function(){return H}),r.d(i,"multiplyScalarAndAdd",function(){return z}),r.d(i,"mul",function(){return j}),r.d(i,"sub",function(){return X});var o={};r.r(o),r.d(o,"create",function(){return k}),r.d(o,"clone",function(){return Y}),r.d(o,"copy",function(){return W}),r.d(o,"identity",function(){return $}),r.d(o,"fromValues",function(){return Q}),r.d(o,"set",function(){return K}),r.d(o,"invert",function(){return Z}),r.d(o,"determinant",function(){return J}),r.d(o,"multiply",function(){return tt}),r.d(o,"rotate",function(){return nt}),r.d(o,"scale",function(){return rt}),r.d(o,"translate",function(){return et}),r.d(o,"fromRotation",function(){return it}),r.d(o,"fromScaling",function(){return ot}),r.d(o,"fromTranslation",function(){return at}),r.d(o,"str",function(){return ut}),r.d(o,"frob",function(){return st}),r.d(o,"add",function(){return ct}),r.d(o,"subtract",function(){return ft}),r.d(o,"multiplyScalar",function(){return lt}),r.d(o,"multiplyScalarAndAdd",function(){return dt}),r.d(o,"exactEquals",function(){return ht}),r.d(o,"equals",function(){return mt}),r.d(o,"mul",function(){return vt}),r.d(o,"sub",function(){return pt});var a={};r.r(a),r.d(a,"create",function(){return Mt}),r.d(a,"fromMat4",function(){return bt}),r.d(a,"clone",function(){return gt}),r.d(a,"copy",function(){return _t}),r.d(a,"fromValues",function(){return xt}),r.d(a,"set",function(){return yt}),r.d(a,"identity",function(){return St}),r.d(a,"transpose",function(){return At}),r.d(a,"invert",function(){return Tt}),r.d(a,"adjoint",function(){return wt}),r.d(a,"determinant",function(){return Rt}),r.d(a,"multiply",function(){return Et}),r.d(a,"translate",function(){return Ct}),r.d(a,"rotate",function(){return Lt}),r.d(a,"scale",function(){return Ot}),r.d(a,"fromTranslation",function(){return Pt}),r.d(a,"fromRotation",function(){return Nt}),r.d(a,"fromScaling",function(){return It}),r.d(a,"fromMat2d",function(){return Ft}),r.d(a,"fromQuat",function(){return Bt}),r.d(a,"normalFromMat4",function(){return Ut}),r.d(a,"projection",function(){return Vt}),r.d(a,"str",function(){return qt}),r.d(a,"frob",function(){return Dt}),r.d(a,"add",function(){return Gt}),r.d(a,"subtract",function(){return Ht}),r.d(a,"multiplyScalar",function(){return zt}),r.d(a,"multiplyScalarAndAdd",function(){return jt}),r.d(a,"exactEquals",function(){return Xt}),r.d(a,"equals",function(){return kt}),r.d(a,"mul",function(){return Yt}),r.d(a,"sub",function(){return Wt});var u={};r.r(u),r.d(u,"create",function(){return $t}),r.d(u,"clone",function(){return Qt}),r.d(u,"copy",function(){return Kt}),r.d(u,"fromValues",function(){return Zt}),r.d(u,"set",function(){return Jt}),r.d(u,"identity",function(){return tn}),r.d(u,"transpose",function(){return nn}),r.d(u,"invert",function(){return rn}),r.d(u,"adjoint",function(){return en}),r.d(u,"determinant",function(){return on}),r.d(u,"multiply",function(){return an}),r.d(u,"translate",function(){return un}),r.d(u,"scale",function(){return sn}),r.d(u,"rotate",function(){return cn}),r.d(u,"rotateX",function(){return fn}),r.d(u,"rotateY",function(){return ln}),r.d(u,"rotateZ",function(){return dn}),r.d(u,"fromTranslation",function(){return hn}),r.d(u,"fromScaling",function(){return mn}),r.d(u,"fromRotation",function(){return vn}),r.d(u,"fromXRotation",function(){return pn}),r.d(u,"fromYRotation",function(){return Mn}),r.d(u,"fromZRotation",function(){return bn}),r.d(u,"fromRotationTranslation",function(){return gn}),r.d(u,"fromQuat2",function(){return _n}),r.d(u,"getTranslation",function(){return xn}),r.d(u,"getScaling",function(){return yn}),r.d(u,"getRotation",function(){return Sn}),r.d(u,"fromRotationTranslationScale",function(){return An}),r.d(u,"fromRotationTranslationScaleOrigin",function(){return Tn}),r.d(u,"fromQuat",function(){return wn}),r.d(u,"frustum",function(){return Rn}),r.d(u,"perspective",function(){return En}),r.d(u,"perspectiveFromFieldOfView",function(){return Cn}),r.d(u,"ortho",function(){return Ln}),r.d(u,"lookAt",function(){return On}),r.d(u,"targetTo",function(){return Pn}),r.d(u,"str",function(){return Nn}),r.d(u,"frob",function(){return In}),r.d(u,"add",function(){return Fn}),r.d(u,"subtract",function(){return Bn}),r.d(u,"multiplyScalar",function(){return Un}),r.d(u,"multiplyScalarAndAdd",function(){return Vn}),r.d(u,"exactEquals",function(){return qn}),r.d(u,"equals",function(){return Dn}),r.d(u,"mul",function(){return Gn}),r.d(u,"sub",function(){return Hn});var s={};r.r(s),r.d(s,"create",function(){return zn}),r.d(s,"clone",function(){return jn}),r.d(s,"length",function(){return Xn}),r.d(s,"fromValues",function(){return kn}),r.d(s,"copy",function(){return Yn}),r.d(s,"set",function(){return Wn}),r.d(s,"add",function(){return $n}),r.d(s,"subtract",function(){return Qn}),r.d(s,"multiply",function(){return Kn}),r.d(s,"divide",function(){return Zn}),r.d(s,"ceil",function(){return Jn}),r.d(s,"floor",function(){return tr}),r.d(s,"min",function(){return nr}),r.d(s,"max",function(){return rr}),r.d(s,"round",function(){return er}),r.d(s,"scale",function(){return ir}),r.d(s,"scaleAndAdd",function(){return or}),r.d(s,"distance",function(){return ar}),r.d(s,"squaredDistance",function(){return ur}),r.d(s,"squaredLength",function(){return sr}),r.d(s,"negate",function(){return cr}),r.d(s,"inverse",function(){return fr}),r.d(s,"normalize",function(){return lr}),r.d(s,"dot",function(){return dr}),r.d(s,"cross",function(){return hr}),r.d(s,"lerp",function(){return mr}),r.d(s,"hermite",function(){return vr}),r.d(s,"bezier",function(){return pr}),r.d(s,"random",function(){return Mr}),r.d(s,"transformMat4",function(){return br}),r.d(s,"transformMat3",function(){return gr}),r.d(s,"transformQuat",function(){return _r}),r.d(s,"rotateX",function(){return xr}),r.d(s,"rotateY",function(){return yr}),r.d(s,"rotateZ",function(){return Sr}),r.d(s,"angle",function(){return Ar}),r.d(s,"str",function(){return Tr}),r.d(s,"exactEquals",function(){return wr}),r.d(s,"equals",function(){return Rr}),r.d(s,"sub",function(){return Er}),r.d(s,"mul",function(){return Cr}),r.d(s,"div",function(){return Lr}),r.d(s,"dist",function(){return Or}),r.d(s,"sqrDist",function(){return Pr}),r.d(s,"len",function(){return Nr}),r.d(s,"sqrLen",function(){return Ir}),r.d(s,"forEach",function(){return Fr});var c={};r.r(c),r.d(c,"create",function(){return Br}),r.d(c,"clone",function(){return Ur}),r.d(c,"fromValues",function(){return Vr}),r.d(c,"copy",function(){return qr}),r.d(c,"set",function(){return Dr}),r.d(c,"add",function(){return Gr}),r.d(c,"subtract",function(){return Hr}),r.d(c,"multiply",function(){return zr}),r.d(c,"divide",function(){return jr}),r.d(c,"ceil",function(){return Xr}),r.d(c,"floor",function(){return kr}),r.d(c,"min",function(){return Yr}),r.d(c,"max",function(){return Wr}),r.d(c,"round",function(){return $r}),r.d(c,"scale",function(){return Qr}),r.d(c,"scaleAndAdd",function(){return Kr}),r.d(c,"distance",function(){return Zr}),r.d(c,"squaredDistance",function(){return Jr}),r.d(c,"length",function(){return te}),r.d(c,"squaredLength",function(){return ne}),r.d(c,"negate",function(){return re}),r.d(c,"inverse",function(){return ee}),r.d(c,"normalize",function(){return ie}),r.d(c,"dot",function(){return oe}),r.d(c,"lerp",function(){return ae}),r.d(c,"random",function(){return ue}),r.d(c,"transformMat4",function(){return se}),r.d(c,"transformQuat",function(){return ce}),r.d(c,"str",function(){return fe}),r.d(c,"exactEquals",function(){return le}),r.d(c,"equals",function(){return de}),r.d(c,"sub",function(){return he}),r.d(c,"mul",function(){return me}),r.d(c,"div",function(){return ve}),r.d(c,"dist",function(){return pe}),r.d(c,"sqrDist",function(){return Me}),r.d(c,"len",function(){return be}),r.d(c,"sqrLen",function(){return ge}),r.d(c,"forEach",function(){return _e});var f={};r.r(f),r.d(f,"create",function(){return xe}),r.d(f,"identity",function(){return ye}),r.d(f,"setAxisAngle",function(){return Se}),r.d(f,"getAxisAngle",function(){return Ae}),r.d(f,"multiply",function(){return Te}),r.d(f,"rotateX",function(){return we}),r.d(f,"rotateY",function(){return Re}),r.d(f,"rotateZ",function(){return Ee}),r.d(f,"calculateW",function(){return Ce}),r.d(f,"slerp",function(){return Le}),r.d(f,"random",function(){return Oe}),r.d(f,"invert",function(){return Pe}),r.d(f,"conjugate",function(){return Ne}),r.d(f,"fromMat3",function(){return Ie}),r.d(f,"fromEuler",function(){return Fe}),r.d(f,"str",function(){return Be}),r.d(f,"clone",function(){return Ue}),r.d(f,"fromValues",function(){return Ve}),r.d(f,"copy",function(){return qe}),r.d(f,"set",function(){return De}),r.d(f,"add",function(){return Ge}),r.d(f,"mul",function(){return He}),r.d(f,"scale",function(){return ze}),r.d(f,"dot",function(){return je}),r.d(f,"lerp",function(){return Xe}),r.d(f,"length",function(){return ke}),r.d(f,"len",function(){return Ye}),r.d(f,"squaredLength",function(){return We}),r.d(f,"sqrLen",function(){return $e}),r.d(f,"normalize",function(){return Qe}),r.d(f,"exactEquals",function(){return Ke}),r.d(f,"equals",function(){return Ze}),r.d(f,"rotationTo",function(){return Je}),r.d(f,"sqlerp",function(){return ti}),r.d(f,"setAxes",function(){return ni});var l={};r.r(l),r.d(l,"create",function(){return ri}),r.d(l,"clone",function(){return ei}),r.d(l,"fromValues",function(){return ii}),r.d(l,"fromRotationTranslationValues",function(){return oi}),r.d(l,"fromRotationTranslation",function(){return ai}),r.d(l,"fromTranslation",function(){return ui}),r.d(l,"fromRotation",function(){return si}),r.d(l,"fromMat4",function(){return ci}),r.d(l,"copy",function(){return fi}),r.d(l,"identity",function(){return li}),r.d(l,"set",function(){return di}),r.d(l,"getReal",function(){return hi}),r.d(l,"getDual",function(){return mi}),r.d(l,"setReal",function(){return vi}),r.d(l,"setDual",function(){return pi}),r.d(l,"getTranslation",function(){return Mi}),r.d(l,"translate",function(){return bi}),r.d(l,"rotateX",function(){return gi}),r.d(l,"rotateY",function(){return _i}),r.d(l,"rotateZ",function(){return xi}),r.d(l,"rotateByQuatAppend",function(){return yi}),r.d(l,"rotateByQuatPrepend",function(){return Si}),r.d(l,"rotateAroundAxis",function(){return Ai}),r.d(l,"add",function(){return Ti}),r.d(l,"multiply",function(){return wi}),r.d(l,"mul",function(){return Ri}),r.d(l,"scale",function(){return Ei}),r.d(l,"dot",function(){return Ci}),r.d(l,"lerp",function(){return Li}),r.d(l,"invert",function(){return Oi}),r.d(l,"conjugate",function(){return Pi}),r.d(l,"length",function(){return Ni}),r.d(l,"len",function(){return Ii}),r.d(l,"squaredLength",function(){return Fi}),r.d(l,"sqrLen",function(){return Bi}),r.d(l,"normalize",function(){return Ui}),r.d(l,"str",function(){return Vi}),r.d(l,"exactEquals",function(){return qi}),r.d(l,"equals",function(){return Di});var d={};r.r(d),r.d(d,"create",function(){return Gi}),r.d(d,"clone",function(){return Hi}),r.d(d,"fromValues",function(){return zi}),r.d(d,"copy",function(){return ji}),r.d(d,"set",function(){return Xi}),r.d(d,"add",function(){return ki}),r.d(d,"subtract",function(){return Yi}),r.d(d,"multiply",function(){return Wi}),r.d(d,"divide",function(){return $i}),r.d(d,"ceil",function(){return Qi}),r.d(d,"floor",function(){return Ki}),r.d(d,"min",function(){return Zi}),r.d(d,"max",function(){return Ji}),r.d(d,"round",function(){return to}),r.d(d,"scale",function(){return no}),r.d(d,"scaleAndAdd",function(){return ro}),r.d(d,"distance",function(){return eo}),r.d(d,"squaredDistance",function(){return io}),r.d(d,"length",function(){return oo}),r.d(d,"squaredLength",function(){return ao}),r.d(d,"negate",function(){return uo}),r.d(d,"inverse",function(){return so}),r.d(d,"normalize",function(){return co}),r.d(d,"dot",function(){return fo}),r.d(d,"cross",function(){return lo}),r.d(d,"lerp",function(){return ho}),r.d(d,"random",function(){return mo}),r.d(d,"transformMat2",function(){return vo}),r.d(d,"transformMat2d",function(){return po}),r.d(d,"transformMat3",function(){return Mo}),r.d(d,"transformMat4",function(){return bo}),r.d(d,"rotate",function(){return go}),r.d(d,"angle",function(){return _o}),r.d(d,"str",function(){return xo}),r.d(d,"exactEquals",function(){return yo}),r.d(d,"equals",function(){return So}),r.d(d,"len",function(){return Ao}),r.d(d,"sub",function(){return To}),r.d(d,"mul",function(){return wo}),r.d(d,"div",function(){return Ro}),r.d(d,"dist",function(){return Eo}),r.d(d,"sqrDist",function(){return Co}),r.d(d,"sqrLen",function(){return Lo}),r.d(d,"forEach",function(){return Oo});var h=1e-6,m="undefined"!=typeof Float32Array?Float32Array:Array,v=Math.random;function p(t){m=t}var M=Math.PI/180;function b(t){return t*M}function g(t,n){return Math.abs(t-n)<=h*Math.max(1,Math.abs(t),Math.abs(n))}function _(){var t=new m(4);return m!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t}function x(t){var n=new m(4);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n}function y(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t}function S(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t}function A(t,n,r,e){var i=new m(4);return i[0]=t,i[1]=n,i[2]=r,i[3]=e,i}function T(t,n,r,e,i){return t[0]=n,t[1]=r,t[2]=e,t[3]=i,t}function w(t,n){if(t===n){var r=n[1];t[1]=n[2],t[2]=r}else t[0]=n[0],t[1]=n[2],t[2]=n[1],t[3]=n[3];return t}function R(t,n){var r=n[0],e=n[1],i=n[2],o=n[3],a=r*o-i*e;return a?(a=1/a,t[0]=o*a,t[1]=-e*a,t[2]=-i*a,t[3]=r*a,t):null}function E(t,n){var r=n[0];return t[0]=n[3],t[1]=-n[1],t[2]=-n[2],t[3]=r,t}function C(t){return t[0]*t[3]-t[2]*t[1]}function L(t,n,r){var e=n[0],i=n[1],o=n[2],a=n[3],u=r[0],s=r[1],c=r[2],f=r[3];return t[0]=e*u+o*s,t[1]=i*u+a*s,t[2]=e*c+o*f,t[3]=i*c+a*f,t}function O(t,n,r){var e=n[0],i=n[1],o=n[2],a=n[3],u=Math.sin(r),s=Math.cos(r);return t[0]=e*s+o*u,t[1]=i*s+a*u,t[2]=e*-u+o*s,t[3]=i*-u+a*s,t}function P(t,n,r){var e=n[0],i=n[1],o=n[2],a=n[3],u=r[0],s=r[1];return t[0]=e*u,t[1]=i*u,t[2]=o*s,t[3]=a*s,t}function N(t,n){var r=Math.sin(n),e=Math.cos(n);return t[0]=e,t[1]=r,t[2]=-r,t[3]=e,t}function I(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=n[1],t}function F(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function B(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))}function U(t,n,r,e){return t[2]=e[2]/e[0],r[0]=e[0],r[1]=e[1],r[3]=e[3]-t[2]*r[1],[t,n,r]}function V(t,n,r){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t[3]=n[3]+r[3],t}function q(t,n,r){return t[0]=n[0]-r[0],t[1]=n[1]-r[1],t[2]=n[2]-r[2],t[3]=n[3]-r[3],t}function D(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]}function G(t,n){var r=t[0],e=t[1],i=t[2],o=t[3],a=n[0],u=n[1],s=n[2],c=n[3];return Math.abs(r-a)<=h*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(e-u)<=h*Math.max(1,Math.abs(e),Math.abs(u))&&Math.abs(i-s)<=h*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(o-c)<=h*Math.max(1,Math.abs(o),Math.abs(c))}function H(t,n,r){return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=n[3]*r,t}function z(t,n,r,e){return t[0]=n[0]+r[0]*e,t[1]=n[1]+r[1]*e,t[2]=n[2]+r[2]*e,t[3]=n[3]+r[3]*e,t}var j=L,X=q;function k(){var t=new m(6);return m!=Float32Array&&(t[1]=0,t[2]=0,t[4]=0,t[5]=0),t[0]=1,t[3]=1,t}function Y(t){var n=new m(6);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n}function W(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t}function $(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function Q(t,n,r,e,i,o){var a=new m(6);return a[0]=t,a[1]=n,a[2]=r,a[3]=e,a[4]=i,a[5]=o,a}function K(t,n,r,e,i,o,a){return t[0]=n,t[1]=r,t[2]=e,t[3]=i,t[4]=o,t[5]=a,t}function Z(t,n){var r=n[0],e=n[1],i=n[2],o=n[3],a=n[4],u=n[5],s=r*o-e*i;return s?(s=1/s,t[0]=o*s,t[1]=-e*s,t[2]=-i*s,t[3]=r*s,t[4]=(i*u-o*a)*s,t[5]=(e*a-r*u)*s,t):null}function J(t){return t[0]*t[3]-t[1]*t[2]}function tt(t,n,r){var e=n[0],i=n[1],o=n[2],a=n[3],u=n[4],s=n[5],c=r[0],f=r[1],l=r[2],d=r[3],h=r[4],m=r[5];return t[0]=e*c+o*f,t[1]=i*c+a*f,t[2]=e*l+o*d,t[3]=i*l+a*d,t[4]=e*h+o*m+u,t[5]=i*h+a*m+s,t}function nt(t,n,r){var e=n[0],i=n[1],o=n[2],a=n[3],u=n[4],s=n[5],c=Math.sin(r),f=Math.cos(r);return t[0]=e*f+o*c,t[1]=i*f+a*c,t[2]=e*-c+o*f,t[3]=i*-c+a*f,t[4]=u,t[5]=s,t}function rt(t,n,r){var e=n[0],i=n[1],o=n[2],a=n[3],u=n[4],s=n[5],c=r[0],f=r[1];return t[0]=e*c,t[1]=i*c,t[2]=o*f,t[3]=a*f,t[4]=u,t[5]=s,t}function et(t,n,r){var e=n[0],i=n[1],o=n[2],a=n[3],u=n[4],s=n[5],c=r[0],f=r[1];return t[0]=e,t[1]=i,t[2]=o,t[3]=a,t[4]=e*c+o*f+u,t[5]=i*c+a*f+s,t}function it(t,n){var r=Math.sin(n),e=Math.cos(n);return t[0]=e,t[1]=r,t[2]=-r,t[3]=e,t[4]=0,t[5]=0,t}function ot(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=n[1],t[4]=0,t[5]=0,t}function at(t,n){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=n[0],t[5]=n[1],t}function ut(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}function st(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)}function ct(t,n,r){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t[3]=n[3]+r[3],t[4]=n[4]+r[4],t[5]=n[5]+r[5],t}function ft(t,n,r){return t[0]=n[0]-r[0],t[1]=n[1]-r[1],t[2]=n[2]-r[2],t[3]=n[3]-r[3],t[4]=n[4]-r[4],t[5]=n[5]-r[5],t}function lt(t,n,r){return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=n[3]*r,t[4]=n[4]*r,t[5]=n[5]*r,t}function dt(t,n,r,e){return t[0]=n[0]+r[0]*e,t[1]=n[1]+r[1]*e,t[2]=n[2]+r[2]*e,t[3]=n[3]+r[3]*e,t[4]=n[4]+r[4]*e,t[5]=n[5]+r[5]*e,t}function ht(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]}function mt(t,n){var r=t[0],e=t[1],i=t[2],o=t[3],a=t[4],u=t[5],s=n[0],c=n[1],f=n[2],l=n[3],d=n[4],m=n[5];return Math.abs(r-s)<=h*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(e-c)<=h*Math.max(1,Math.abs(e),Math.abs(c))&&Math.abs(i-f)<=h*Math.max(1,Math.abs(i),Math.abs(f))&&Math.abs(o-l)<=h*Math.max(1,Math.abs(o),Math.abs(l))&&Math.abs(a-d)<=h*Math.max(1,Math.abs(a),Math.abs(d))&&Math.abs(u-m)<=h*Math.max(1,Math.abs(u),Math.abs(m))}var vt=tt,pt=ft;function Mt(){var t=new m(9);return m!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function bt(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[4],t[4]=n[5],t[5]=n[6],t[6]=n[8],t[7]=n[9],t[8]=n[10],t}function gt(t){var n=new m(9);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n}function _t(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t}function xt(t,n,r,e,i,o,a,u,s){var c=new m(9);return c[0]=t,c[1]=n,c[2]=r,c[3]=e,c[4]=i,c[5]=o,c[6]=a,c[7]=u,c[8]=s,c}function yt(t,n,r,e,i,o,a,u,s,c){return t[0]=n,t[1]=r,t[2]=e,t[3]=i,t[4]=o,t[5]=a,t[6]=u,t[7]=s,t[8]=c,t}function St(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function At(t,n){if(t===n){var r=n[1],e=n[2],i=n[5];t[1]=n[3],t[2]=n[6],t[3]=r,t[5]=n[7],t[6]=e,t[7]=i}else t[0]=n[0],t[1]=n[3],t[2]=n[6],t[3]=n[1],t[4]=n[4],t[5]=n[7],t[6]=n[2],t[7]=n[5],t[8]=n[8];return t}function Tt(t,n){var r=n[0],e=n[1],i=n[2],o=n[3],a=n[4],u=n[5],s=n[6],c=n[7],f=n[8],l=f*a-u*c,d=-f*o+u*s,h=c*o-a*s,m=r*l+e*d+i*h;return m?(m=1/m,t[0]=l*m,t[1]=(-f*e+i*c)*m,t[2]=(u*e-i*a)*m,t[3]=d*m,t[4]=(f*r-i*s)*m,t[5]=(-u*r+i*o)*m,t[6]=h*m,t[7]=(-c*r+e*s)*m,t[8]=(a*r-e*o)*m,t):null}function wt(t,n){var r=n[0],e=n[1],i=n[2],o=n[3],a=n[4],u=n[5],s=n[6],c=n[7],f=n[8];return t[0]=a*f-u*c,t[1]=i*c-e*f,t[2]=e*u-i*a,t[3]=u*s-o*f,t[4]=r*f-i*s,t[5]=i*o-r*u,t[6]=o*c-a*s,t[7]=e*s-r*c,t[8]=r*a-e*o,t}function Rt(t){var n=t[0],r=t[1],e=t[2],i=t[3],o=t[4],a=t[5],u=t[6],s=t[7],c=t[8];return n*(c*o-a*s)+r*(-c*i+a*u)+e*(s*i-o*u)}function Et(t,n,r){var e=n[0],i=n[1],o=n[2],a=n[3],u=n[4],s=n[5],c=n[6],f=n[7],l=n[8],d=r[0],h=r[1],m=r[2],v=r[3],p=r[4],M=r[5],b=r[6],g=r[7],_=r[8];return t[0]=d*e+h*a+m*c,t[1]=d*i+h*u+m*f,t[2]=d*o+h*s+m*l,t[3]=v*e+p*a+M*c,t[4]=v*i+p*u+M*f,t[5]=v*o+p*s+M*l,t[6]=b*e+g*a+_*c,t[7]=b*i+g*u+_*f,t[8]=b*o+g*s+_*l,t}function Ct(t,n,r){var e=n[0],i=n[1],o=n[2],a=n[3],u=n[4],s=n[5],c=n[6],f=n[7],l=n[8],d=r[0],h=r[1];return t[0]=e,t[1]=i,t[2]=o,t[3]=a,t[4]=u,t[5]=s,t[6]=d*e+h*a+c,t[7]=d*i+h*u+f,t[8]=d*o+h*s+l,t}function Lt(t,n,r){var e=n[0],i=n[1],o=n[2],a=n[3],u=n[4],s=n[5],c=n[6],f=n[7],l=n[8],d=Math.sin(r),h=Math.cos(r);return t[0]=h*e+d*a,t[1]=h*i+d*u,t[2]=h*o+d*s,t[3]=h*a-d*e,t[4]=h*u-d*i,t[5]=h*s-d*o,t[6]=c,t[7]=f,t[8]=l,t}function Ot(t,n,r){var e=r[0],i=r[1];return t[0]=e*n[0],t[1]=e*n[1],t[2]=e*n[2],t[3]=i*n[3],t[4]=i*n[4],t[5]=i*n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t}function Pt(t,n){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=n[0],t[7]=n[1],t[8]=1,t}function Nt(t,n){var r=Math.sin(n),e=Math.cos(n);return t[0]=e,t[1]=r,t[2]=0,t[3]=-r,t[4]=e,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function It(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=0,t[4]=n[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Ft(t,n){return t[0]=n[0],t[1]=n[1],t[2]=0,t[3]=n[2],t[4]=n[3],t[5]=0,t[6]=n[4],t[7]=n[5],t[8]=1,t}function Bt(t,n){var r=n[0],e=n[1],i=n[2],o=n[3],a=r+r,u=e+e,s=i+i,c=r*a,f=e*a,l=e*u,d=i*a,h=i*u,m=i*s,v=o*a,p=o*u,M=o*s;return t[0]=1-l-m,t[3]=f-M,t[6]=d+p,t[1]=f+M,t[4]=1-c-m,t[7]=h-v,t[2]=d-p,t[5]=h+v,t[8]=1-c-l,t}function Ut(t,n){var r=n[0],e=n[1],i=n[2],o=n[3],a=n[4],u=n[5],s=n[6],c=n[7],f=n[8],l=n[9],d=n[10],h=n[11],m=n[12],v=n[13],p=n[14],M=n[15],b=r*u-e*a,g=r*s-i*a,_=r*c-o*a,x=e*s-i*u,y=e*c-o*u,S=i*c-o*s,A=f*v-l*m,T=f*p-d*m,w=f*M-h*m,R=l*p-d*v,E=l*M-h*v,C=d*M-h*p,L=b*C-g*E+_*R+x*w-y*T+S*A;return L?(L=1/L,t[0]=(u*C-s*E+c*R)*L,t[1]=(s*w-a*C-c*T)*L,t[2]=(a*E-u*w+c*A)*L,t[3]=(i*E-e*C-o*R)*L,t[4]=(r*C-i*w+o*T)*L,t[5]=(e*w-r*E-o*A)*L,t[6]=(v*S-p*y+M*x)*L,t[7]=(p*_-m*S-M*g)*L,t[8]=(m*y-v*_+M*b)*L,t):null}function Vt(t,n,r){return t[0]=2/n,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/r,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function qt(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function Dt(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))}function Gt(t,n,r){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t[3]=n[3]+r[3],t[4]=n[4]+r[4],t[5]=n[5]+r[5],t[6]=n[6]+r[6],t[7]=n[7]+r[7],t[8]=n[8]+r[8],t}function Ht(t,n,r){return t[0]=n[0]-r[0],t[1]=n[1]-r[1],t[2]=n[2]-r[2],t[3]=n[3]-r[3],t[4]=n[4]-r[4],t[5]=n[5]-r[5],t[6]=n[6]-r[6],t[7]=n[7]-r[7],t[8]=n[8]-r[8],t}function zt(t,n,r){return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=n[3]*r,t[4]=n[4]*r,t[5]=n[5]*r,t[6]=n[6]*r,t[7]=n[7]*r,t[8]=n[8]*r,t}function jt(t,n,r,e){return t[0]=n[0]+r[0]*e,t[1]=n[1]+r[1]*e,t[2]=n[2]+r[2]*e,t[3]=n[3]+r[3]*e,t[4]=n[4]+r[4]*e,t[5]=n[5]+r[5]*e,t[6]=n[6]+r[6]*e,t[7]=n[7]+r[7]*e,t[8]=n[8]+r[8]*e,t}function Xt(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]&&t[6]===n[6]&&t[7]===n[7]&&t[8]===n[8]}function kt(t,n){var r=t[0],e=t[1],i=t[2],o=t[3],a=t[4],u=t[5],s=t[6],c=t[7],f=t[8],l=n[0],d=n[1],m=n[2],v=n[3],p=n[4],M=n[5],b=n[6],g=n[7],_=n[8];return Math.abs(r-l)<=h*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(e-d)<=h*Math.max(1,Math.abs(e),Math.abs(d))&&Math.abs(i-m)<=h*Math.max(1,Math.abs(i),Math.abs(m))&&Math.abs(o-v)<=h*Math.max(1,Math.abs(o),Math.abs(v))&&Math.abs(a-p)<=h*Math.max(1,Math.abs(a),Math.abs(p))&&Math.abs(u-M)<=h*Math.max(1,Math.abs(u),Math.abs(M))&&Math.abs(s-b)<=h*Math.max(1,Math.abs(s),Math.abs(b))&&Math.abs(c-g)<=h*Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(f-_)<=h*Math.max(1,Math.abs(f),Math.abs(_))}var Yt=Et,Wt=Ht;function $t(){var t=new m(16);return m!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function Qt(t){var n=new m(16);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n}function Kt(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t}function Zt(t,n,r,e,i,o,a,u,s,c,f,l,d,h,v,p){var M=new m(16);return M[0]=t,M[1]=n,M[2]=r,M[3]=e,M[4]=i,M[5]=o,M[6]=a,M[7]=u,M[8]=s,M[9]=c,M[10]=f,M[11]=l,M[12]=d,M[13]=h,M[14]=v,M[15]=p,M}function Jt(t,n,r,e,i,o,a,u,s,c,f,l,d,h,m,v,p){return t[0]=n,t[1]=r,t[2]=e,t[3]=i,t[4]=o,t[5]=a,t[6]=u,t[7]=s,t[8]=c,t[9]=f,t[10]=l,t[11]=d,t[12]=h,t[13]=m,t[14]=v,t[15]=p,t}function tn(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function nn(t,n){if(t===n){var r=n[1],e=n[2],i=n[3],o=n[6],a=n[7],u=n[11];t[1]=n[4],t[2]=n[8],t[3]=n[12],t[4]=r,t[6]=n[9],t[7]=n[13],t[8]=e,t[9]=o,t[11]=n[14],t[12]=i,t[13]=a,t[14]=u}else t[0]=n[0],t[1]=n[4],t[2]=n[8],t[3]=n[12],t[4]=n[1],t[5]=n[5],t[6]=n[9],t[7]=n[13],t[8]=n[2],t[9]=n[6],t[10]=n[10],t[11]=n[14],t[12]=n[3],t[13]=n[7],t[14]=n[11],t[15]=n[15];return t}function rn(t,n){var r=n[0],e=n[1],i=n[2],o=n[3],a=n[4],u=n[5],s=n[6],c=n[7],f=n[8],l=n[9],d=n[10],h=n[11],m=n[12],v=n[13],p=n[14],M=n[15],b=r*u-e*a,g=r*s-i*a,_=r*c-o*a,x=e*s-i*u,y=e*c-o*u,S=i*c-o*s,A=f*v-l*m,T=f*p-d*m,w=f*M-h*m,R=l*p-d*v,E=l*M-h*v,C=d*M-h*p,L=b*C-g*E+_*R+x*w-y*T+S*A;return L?(L=1/L,t[0]=(u*C-s*E+c*R)*L,t[1]=(i*E-e*C-o*R)*L,t[2]=(v*S-p*y+M*x)*L,t[3]=(d*y-l*S-h*x)*L,t[4]=(s*w-a*C-c*T)*L,t[5]=(r*C-i*w+o*T)*L,t[6]=(p*_-m*S-M*g)*L,t[7]=(f*S-d*_+h*g)*L,t[8]=(a*E-u*w+c*A)*L,t[9]=(e*w-r*E-o*A)*L,t[10]=(m*y-v*_+M*b)*L,t[11]=(l*_-f*y-h*b)*L,t[12]=(u*T-a*R-s*A)*L,t[13]=(r*R-e*T+i*A)*L,t[14]=(v*g-m*x-p*b)*L,t[15]=(f*x-l*g+d*b)*L,t):null}function en(t,n){var r=n[0],e=n[1],i=n[2],o=n[3],a=n[4],u=n[5],s=n[6],c=n[7],f=n[8],l=n[9],d=n[10],h=n[11],m=n[12],v=n[13],p=n[14],M=n[15];return t[0]=u*(d*M-h*p)-l*(s*M-c*p)+v*(s*h-c*d),t[1]=-(e*(d*M-h*p)-l*(i*M-o*p)+v*(i*h-o*d)),t[2]=e*(s*M-c*p)-u*(i*M-o*p)+v*(i*c-o*s),t[3]=-(e*(s*h-c*d)-u*(i*h-o*d)+l*(i*c-o*s)),t[4]=-(a*(d*M-h*p)-f*(s*M-c*p)+m*(s*h-c*d)),t[5]=r*(d*M-h*p)-f*(i*M-o*p)+m*(i*h-o*d),t[6]=-(r*(s*M-c*p)-a*(i*M-o*p)+m*(i*c-o*s)),t[7]=r*(s*h-c*d)-a*(i*h-o*d)+f*(i*c-o*s),t[8]=a*(l*M-h*v)-f*(u*M-c*v)+m*(u*h-c*l),t[9]=-(r*(l*M-h*v)-f*(e*M-o*v)+m*(e*h-o*l)),t[10]=r*(u*M-c*v)-a*(e*M-o*v)+m*(e*c-o*u),t[11]=-(r*(u*h-c*l)-a*(e*h-o*l)+f*(e*c-o*u)),t[12]=-(a*(l*p-d*v)-f*(u*p-s*v)+m*(u*d-s*l)),t[13]=r*(l*p-d*v)-f*(e*p-i*v)+m*(e*d-i*l),t[14]=-(r*(u*p-s*v)-a*(e*p-i*v)+m*(e*s-i*u)),t[15]=r*(u*d-s*l)-a*(e*d-i*l)+f*(e*s-i*u),t}function on(t){var n=t[0],r=t[1],e=t[2],i=t[3],o=t[4],a=t[5],u=t[6],s=t[7],c=t[8],f=t[9],l=t[10],d=t[11],h=t[12],m=t[13],v=t[14],p=t[15];return(n*a-r*o)*(l*p-d*v)-(n*u-e*o)*(f*p-d*m)+(n*s-i*o)*(f*v-l*m)+(r*u-e*a)*(c*p-d*h)-(r*s-i*a)*(c*v-l*h)+(e*s-i*u)*(c*m-f*h)}function an(t,n,r){var e=n[0],i=n[1],o=n[2],a=n[3],u=n[4],s=n[5],c=n[6],f=n[7],l=n[8],d=n[9],h=n[10],m=n[11],v=n[12],p=n[13],M=n[14],b=n[15],g=r[0],_=r[1],x=r[2],y=r[3];return t[0]=g*e+_*u+x*l+y*v,t[1]=g*i+_*s+x*d+y*p,t[2]=g*o+_*c+x*h+y*M,t[3]=g*a+_*f+x*m+y*b,g=r[4],_=r[5],x=r[6],y=r[7],t[4]=g*e+_*u+x*l+y*v,t[5]=g*i+_*s+x*d+y*p,t[6]=g*o+_*c+x*h+y*M,t[7]=g*a+_*f+x*m+y*b,g=r[8],_=r[9],x=r[10],y=r[11],t[8]=g*e+_*u+x*l+y*v,t[9]=g*i+_*s+x*d+y*p,t[10]=g*o+_*c+x*h+y*M,t[11]=g*a+_*f+x*m+y*b,g=r[12],_=r[13],x=r[14],y=r[15],t[12]=g*e+_*u+x*l+y*v,t[13]=g*i+_*s+x*d+y*p,t[14]=g*o+_*c+x*h+y*M,t[15]=g*a+_*f+x*m+y*b,t}function un(t,n,r){var e=r[0],i=r[1],o=r[2],a=void 0,u=void 0,s=void 0,c=void 0,f=void 0,l=void 0,d=void 0,h=void 0,m=void 0,v=void 0,p=void 0,M=void 0;return n===t?(t[12]=n[0]*e+n[4]*i+n[8]*o+n[12],t[13]=n[1]*e+n[5]*i+n[9]*o+n[13],t[14]=n[2]*e+n[6]*i+n[10]*o+n[14],t[15]=n[3]*e+n[7]*i+n[11]*o+n[15]):(a=n[0],u=n[1],s=n[2],c=n[3],f=n[4],l=n[5],d=n[6],h=n[7],m=n[8],v=n[9],p=n[10],M=n[11],t[0]=a,t[1]=u,t[2]=s,t[3]=c,t[4]=f,t[5]=l,t[6]=d,t[7]=h,t[8]=m,t[9]=v,t[10]=p,t[11]=M,t[12]=a*e+f*i+m*o+n[12],t[13]=u*e+l*i+v*o+n[13],t[14]=s*e+d*i+p*o+n[14],t[15]=c*e+h*i+M*o+n[15]),t}function sn(t,n,r){var e=r[0],i=r[1],o=r[2];return t[0]=n[0]*e,t[1]=n[1]*e,t[2]=n[2]*e,t[3]=n[3]*e,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=n[7]*i,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=n[11]*o,t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t}function cn(t,n,r,e){var i,o,a,u,s,c,f,l,d,m,v,p,M,b,g,_,x,y,S,A,T,w,R,E,C=e[0],L=e[1],O=e[2],P=Math.sqrt(C*C+L*L+O*O);return P<h?null:(C*=P=1/P,L*=P,O*=P,i=Math.sin(r),a=1-(o=Math.cos(r)),u=n[0],s=n[1],c=n[2],f=n[3],l=n[4],d=n[5],m=n[6],v=n[7],p=n[8],M=n[9],b=n[10],g=n[11],_=C*C*a+o,x=L*C*a+O*i,y=O*C*a-L*i,S=C*L*a-O*i,A=L*L*a+o,T=O*L*a+C*i,w=C*O*a+L*i,R=L*O*a-C*i,E=O*O*a+o,t[0]=u*_+l*x+p*y,t[1]=s*_+d*x+M*y,t[2]=c*_+m*x+b*y,t[3]=f*_+v*x+g*y,t[4]=u*S+l*A+p*T,t[5]=s*S+d*A+M*T,t[6]=c*S+m*A+b*T,t[7]=f*S+v*A+g*T,t[8]=u*w+l*R+p*E,t[9]=s*w+d*R+M*E,t[10]=c*w+m*R+b*E,t[11]=f*w+v*R+g*E,n!==t&&(t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t)}function fn(t,n,r){var e=Math.sin(r),i=Math.cos(r),o=n[4],a=n[5],u=n[6],s=n[7],c=n[8],f=n[9],l=n[10],d=n[11];return n!==t&&(t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[4]=o*i+c*e,t[5]=a*i+f*e,t[6]=u*i+l*e,t[7]=s*i+d*e,t[8]=c*i-o*e,t[9]=f*i-a*e,t[10]=l*i-u*e,t[11]=d*i-s*e,t}function ln(t,n,r){var e=Math.sin(r),i=Math.cos(r),o=n[0],a=n[1],u=n[2],s=n[3],c=n[8],f=n[9],l=n[10],d=n[11];return n!==t&&(t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[0]=o*i-c*e,t[1]=a*i-f*e,t[2]=u*i-l*e,t[3]=s*i-d*e,t[8]=o*e+c*i,t[9]=a*e+f*i,t[10]=u*e+l*i,t[11]=s*e+d*i,t}function dn(t,n,r){var e=Math.sin(r),i=Math.cos(r),o=n[0],a=n[1],u=n[2],s=n[3],c=n[4],f=n[5],l=n[6],d=n[7];return n!==t&&(t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[0]=o*i+c*e,t[1]=a*i+f*e,t[2]=u*i+l*e,t[3]=s*i+d*e,t[4]=c*i-o*e,t[5]=f*i-a*e,t[6]=l*i-u*e,t[7]=d*i-s*e,t}function hn(t,n){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function mn(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=n[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function vn(t,n,r){var e,i,o,a=r[0],u=r[1],s=r[2],c=Math.sqrt(a*a+u*u+s*s);return c<h?null:(a*=c=1/c,u*=c,s*=c,e=Math.sin(n),o=1-(i=Math.cos(n)),t[0]=a*a*o+i,t[1]=u*a*o+s*e,t[2]=s*a*o-u*e,t[3]=0,t[4]=a*u*o-s*e,t[5]=u*u*o+i,t[6]=s*u*o+a*e,t[7]=0,t[8]=a*s*o+u*e,t[9]=u*s*o-a*e,t[10]=s*s*o+i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function pn(t,n){var r=Math.sin(n),e=Math.cos(n);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Mn(t,n){var r=Math.sin(n),e=Math.cos(n);return t[0]=e,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function bn(t,n){var r=Math.sin(n),e=Math.cos(n);return t[0]=e,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=e,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function gn(t,n,r){var e=n[0],i=n[1],o=n[2],a=n[3],u=e+e,s=i+i,c=o+o,f=e*u,l=e*s,d=e*c,h=i*s,m=i*c,v=o*c,p=a*u,M=a*s,b=a*c;return t[0]=1-(h+v),t[1]=l+b,t[2]=d-M,t[3]=0,t[4]=l-b,t[5]=1-(f+v),t[6]=m+p,t[7]=0,t[8]=d+M,t[9]=m-p,t[10]=1-(f+h),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function _n(t,n){var r=new m(3),e=-n[0],i=-n[1],o=-n[2],a=n[3],u=n[4],s=n[5],c=n[6],f=n[7],l=e*e+i*i+o*o+a*a;return l>0?(r[0]=2*(u*a+f*e+s*o-c*i)/l,r[1]=2*(s*a+f*i+c*e-u*o)/l,r[2]=2*(c*a+f*o+u*i-s*e)/l):(r[0]=2*(u*a+f*e+s*o-c*i),r[1]=2*(s*a+f*i+c*e-u*o),r[2]=2*(c*a+f*o+u*i-s*e)),gn(t,n,r),t}function xn(t,n){return t[0]=n[12],t[1]=n[13],t[2]=n[14],t}function yn(t,n){var r=n[0],e=n[1],i=n[2],o=n[4],a=n[5],u=n[6],s=n[8],c=n[9],f=n[10];return t[0]=Math.sqrt(r*r+e*e+i*i),t[1]=Math.sqrt(o*o+a*a+u*u),t[2]=Math.sqrt(s*s+c*c+f*f),t}function Sn(t,n){var r=n[0]+n[5]+n[10],e=0;return r>0?(e=2*Math.sqrt(r+1),t[3]=.25*e,t[0]=(n[6]-n[9])/e,t[1]=(n[8]-n[2])/e,t[2]=(n[1]-n[4])/e):n[0]>n[5]&&n[0]>n[10]?(e=2*Math.sqrt(1+n[0]-n[5]-n[10]),t[3]=(n[6]-n[9])/e,t[0]=.25*e,t[1]=(n[1]+n[4])/e,t[2]=(n[8]+n[2])/e):n[5]>n[10]?(e=2*Math.sqrt(1+n[5]-n[0]-n[10]),t[3]=(n[8]-n[2])/e,t[0]=(n[1]+n[4])/e,t[1]=.25*e,t[2]=(n[6]+n[9])/e):(e=2*Math.sqrt(1+n[10]-n[0]-n[5]),t[3]=(n[1]-n[4])/e,t[0]=(n[8]+n[2])/e,t[1]=(n[6]+n[9])/e,t[2]=.25*e),t}function An(t,n,r,e){var i=n[0],o=n[1],a=n[2],u=n[3],s=i+i,c=o+o,f=a+a,l=i*s,d=i*c,h=i*f,m=o*c,v=o*f,p=a*f,M=u*s,b=u*c,g=u*f,_=e[0],x=e[1],y=e[2];return t[0]=(1-(m+p))*_,t[1]=(d+g)*_,t[2]=(h-b)*_,t[3]=0,t[4]=(d-g)*x,t[5]=(1-(l+p))*x,t[6]=(v+M)*x,t[7]=0,t[8]=(h+b)*y,t[9]=(v-M)*y,t[10]=(1-(l+m))*y,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function Tn(t,n,r,e,i){var o=n[0],a=n[1],u=n[2],s=n[3],c=o+o,f=a+a,l=u+u,d=o*c,h=o*f,m=o*l,v=a*f,p=a*l,M=u*l,b=s*c,g=s*f,_=s*l,x=e[0],y=e[1],S=e[2],A=i[0],T=i[1],w=i[2],R=(1-(v+M))*x,E=(h+_)*x,C=(m-g)*x,L=(h-_)*y,O=(1-(d+M))*y,P=(p+b)*y,N=(m+g)*S,I=(p-b)*S,F=(1-(d+v))*S;return t[0]=R,t[1]=E,t[2]=C,t[3]=0,t[4]=L,t[5]=O,t[6]=P,t[7]=0,t[8]=N,t[9]=I,t[10]=F,t[11]=0,t[12]=r[0]+A-(R*A+L*T+N*w),t[13]=r[1]+T-(E*A+O*T+I*w),t[14]=r[2]+w-(C*A+P*T+F*w),t[15]=1,t}function wn(t,n){var r=n[0],e=n[1],i=n[2],o=n[3],a=r+r,u=e+e,s=i+i,c=r*a,f=e*a,l=e*u,d=i*a,h=i*u,m=i*s,v=o*a,p=o*u,M=o*s;return t[0]=1-l-m,t[1]=f+M,t[2]=d-p,t[3]=0,t[4]=f-M,t[5]=1-c-m,t[6]=h+v,t[7]=0,t[8]=d+p,t[9]=h-v,t[10]=1-c-l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Rn(t,n,r,e,i,o,a){var u=1/(r-n),s=1/(i-e),c=1/(o-a);return t[0]=2*o*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*s,t[6]=0,t[7]=0,t[8]=(r+n)*u,t[9]=(i+e)*s,t[10]=(a+o)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*o*2*c,t[15]=0,t}function En(t,n,r,e,i){var o=1/Math.tan(n/2),a=void 0;return t[0]=o/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(a=1/(e-i),t[10]=(i+e)*a,t[14]=2*i*e*a):(t[10]=-1,t[14]=-2*e),t}function Cn(t,n,r,e){var i=Math.tan(n.upDegrees*Math.PI/180),o=Math.tan(n.downDegrees*Math.PI/180),a=Math.tan(n.leftDegrees*Math.PI/180),u=Math.tan(n.rightDegrees*Math.PI/180),s=2/(a+u),c=2/(i+o);return t[0]=s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(a-u)*s*.5,t[9]=(i-o)*c*.5,t[10]=e/(r-e),t[11]=-1,t[12]=0,t[13]=0,t[14]=e*r/(r-e),t[15]=0,t}function Ln(t,n,r,e,i,o,a){var u=1/(n-r),s=1/(e-i),c=1/(o-a);return t[0]=-2*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(n+r)*u,t[13]=(i+e)*s,t[14]=(a+o)*c,t[15]=1,t}function On(t,n,r,e){var i=void 0,o=void 0,a=void 0,u=void 0,s=void 0,c=void 0,f=void 0,l=void 0,d=void 0,m=void 0,v=n[0],p=n[1],M=n[2],b=e[0],g=e[1],_=e[2],x=r[0],y=r[1],S=r[2];return Math.abs(v-x)<h&&Math.abs(p-y)<h&&Math.abs(M-S)<h?tn(t):(f=v-x,l=p-y,d=M-S,i=g*(d*=m=1/Math.sqrt(f*f+l*l+d*d))-_*(l*=m),o=_*(f*=m)-b*d,a=b*l-g*f,(m=Math.sqrt(i*i+o*o+a*a))?(i*=m=1/m,o*=m,a*=m):(i=0,o=0,a=0),u=l*a-d*o,s=d*i-f*a,c=f*o-l*i,(m=Math.sqrt(u*u+s*s+c*c))?(u*=m=1/m,s*=m,c*=m):(u=0,s=0,c=0),t[0]=i,t[1]=u,t[2]=f,t[3]=0,t[4]=o,t[5]=s,t[6]=l,t[7]=0,t[8]=a,t[9]=c,t[10]=d,t[11]=0,t[12]=-(i*v+o*p+a*M),t[13]=-(u*v+s*p+c*M),t[14]=-(f*v+l*p+d*M),t[15]=1,t)}function Pn(t,n,r,e){var i=n[0],o=n[1],a=n[2],u=e[0],s=e[1],c=e[2],f=i-r[0],l=o-r[1],d=a-r[2],h=f*f+l*l+d*d;h>0&&(f*=h=1/Math.sqrt(h),l*=h,d*=h);var m=s*d-c*l,v=c*f-u*d,p=u*l-s*f;return(h=m*m+v*v+p*p)>0&&(m*=h=1/Math.sqrt(h),v*=h,p*=h),t[0]=m,t[1]=v,t[2]=p,t[3]=0,t[4]=l*p-d*v,t[5]=d*m-f*p,t[6]=f*v-l*m,t[7]=0,t[8]=f,t[9]=l,t[10]=d,t[11]=0,t[12]=i,t[13]=o,t[14]=a,t[15]=1,t}function Nn(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function In(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))}function Fn(t,n,r){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t[3]=n[3]+r[3],t[4]=n[4]+r[4],t[5]=n[5]+r[5],t[6]=n[6]+r[6],t[7]=n[7]+r[7],t[8]=n[8]+r[8],t[9]=n[9]+r[9],t[10]=n[10]+r[10],t[11]=n[11]+r[11],t[12]=n[12]+r[12],t[13]=n[13]+r[13],t[14]=n[14]+r[14],t[15]=n[15]+r[15],t}function Bn(t,n,r){return t[0]=n[0]-r[0],t[1]=n[1]-r[1],t[2]=n[2]-r[2],t[3]=n[3]-r[3],t[4]=n[4]-r[4],t[5]=n[5]-r[5],t[6]=n[6]-r[6],t[7]=n[7]-r[7],t[8]=n[8]-r[8],t[9]=n[9]-r[9],t[10]=n[10]-r[10],t[11]=n[11]-r[11],t[12]=n[12]-r[12],t[13]=n[13]-r[13],t[14]=n[14]-r[14],t[15]=n[15]-r[15],t}function Un(t,n,r){return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=n[3]*r,t[4]=n[4]*r,t[5]=n[5]*r,t[6]=n[6]*r,t[7]=n[7]*r,t[8]=n[8]*r,t[9]=n[9]*r,t[10]=n[10]*r,t[11]=n[11]*r,t[12]=n[12]*r,t[13]=n[13]*r,t[14]=n[14]*r,t[15]=n[15]*r,t}function Vn(t,n,r,e){return t[0]=n[0]+r[0]*e,t[1]=n[1]+r[1]*e,t[2]=n[2]+r[2]*e,t[3]=n[3]+r[3]*e,t[4]=n[4]+r[4]*e,t[5]=n[5]+r[5]*e,t[6]=n[6]+r[6]*e,t[7]=n[7]+r[7]*e,t[8]=n[8]+r[8]*e,t[9]=n[9]+r[9]*e,t[10]=n[10]+r[10]*e,t[11]=n[11]+r[11]*e,t[12]=n[12]+r[12]*e,t[13]=n[13]+r[13]*e,t[14]=n[14]+r[14]*e,t[15]=n[15]+r[15]*e,t}function qn(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]&&t[6]===n[6]&&t[7]===n[7]&&t[8]===n[8]&&t[9]===n[9]&&t[10]===n[10]&&t[11]===n[11]&&t[12]===n[12]&&t[13]===n[13]&&t[14]===n[14]&&t[15]===n[15]}function Dn(t,n){var r=t[0],e=t[1],i=t[2],o=t[3],a=t[4],u=t[5],s=t[6],c=t[7],f=t[8],l=t[9],d=t[10],m=t[11],v=t[12],p=t[13],M=t[14],b=t[15],g=n[0],_=n[1],x=n[2],y=n[3],S=n[4],A=n[5],T=n[6],w=n[7],R=n[8],E=n[9],C=n[10],L=n[11],O=n[12],P=n[13],N=n[14],I=n[15];return Math.abs(r-g)<=h*Math.max(1,Math.abs(r),Math.abs(g))&&Math.abs(e-_)<=h*Math.max(1,Math.abs(e),Math.abs(_))&&Math.abs(i-x)<=h*Math.max(1,Math.abs(i),Math.abs(x))&&Math.abs(o-y)<=h*Math.max(1,Math.abs(o),Math.abs(y))&&Math.abs(a-S)<=h*Math.max(1,Math.abs(a),Math.abs(S))&&Math.abs(u-A)<=h*Math.max(1,Math.abs(u),Math.abs(A))&&Math.abs(s-T)<=h*Math.max(1,Math.abs(s),Math.abs(T))&&Math.abs(c-w)<=h*Math.max(1,Math.abs(c),Math.abs(w))&&Math.abs(f-R)<=h*Math.max(1,Math.abs(f),Math.abs(R))&&Math.abs(l-E)<=h*Math.max(1,Math.abs(l),Math.abs(E))&&Math.abs(d-C)<=h*Math.max(1,Math.abs(d),Math.abs(C))&&Math.abs(m-L)<=h*Math.max(1,Math.abs(m),Math.abs(L))&&Math.abs(v-O)<=h*Math.max(1,Math.abs(v),Math.abs(O))&&Math.abs(p-P)<=h*Math.max(1,Math.abs(p),Math.abs(P))&&Math.abs(M-N)<=h*Math.max(1,Math.abs(M),Math.abs(N))&&Math.abs(b-I)<=h*Math.max(1,Math.abs(b),Math.abs(I))}var Gn=an,Hn=Bn;function zn(){var t=new m(3);return m!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function jn(t){var n=new m(3);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n}function Xn(t){var n=t[0],r=t[1],e=t[2];return Math.sqrt(n*n+r*r+e*e)}function kn(t,n,r){var e=new m(3);return e[0]=t,e[1]=n,e[2]=r,e}function Yn(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t}function Wn(t,n,r,e){return t[0]=n,t[1]=r,t[2]=e,t}function $n(t,n,r){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t}function Qn(t,n,r){return t[0]=n[0]-r[0],t[1]=n[1]-r[1],t[2]=n[2]-r[2],t}function Kn(t,n,r){return t[0]=n[0]*r[0],t[1]=n[1]*r[1],t[2]=n[2]*r[2],t}function Zn(t,n,r){return t[0]=n[0]/r[0],t[1]=n[1]/r[1],t[2]=n[2]/r[2],t}function Jn(t,n){return t[0]=Math.ceil(n[0]),t[1]=Math.ceil(n[1]),t[2]=Math.ceil(n[2]),t}function tr(t,n){return t[0]=Math.floor(n[0]),t[1]=Math.floor(n[1]),t[2]=Math.floor(n[2]),t}function nr(t,n,r){return t[0]=Math.min(n[0],r[0]),t[1]=Math.min(n[1],r[1]),t[2]=Math.min(n[2],r[2]),t}function rr(t,n,r){return t[0]=Math.max(n[0],r[0]),t[1]=Math.max(n[1],r[1]),t[2]=Math.max(n[2],r[2]),t}function er(t,n){return t[0]=Math.round(n[0]),t[1]=Math.round(n[1]),t[2]=Math.round(n[2]),t}function ir(t,n,r){return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t}function or(t,n,r,e){return t[0]=n[0]+r[0]*e,t[1]=n[1]+r[1]*e,t[2]=n[2]+r[2]*e,t}function ar(t,n){var r=n[0]-t[0],e=n[1]-t[1],i=n[2]-t[2];return Math.sqrt(r*r+e*e+i*i)}function ur(t,n){var r=n[0]-t[0],e=n[1]-t[1],i=n[2]-t[2];return r*r+e*e+i*i}function sr(t){var n=t[0],r=t[1],e=t[2];return n*n+r*r+e*e}function cr(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t}function fr(t,n){return t[0]=1/n[0],t[1]=1/n[1],t[2]=1/n[2],t}function lr(t,n){var r=n[0],e=n[1],i=n[2],o=r*r+e*e+i*i;return o>0&&(o=1/Math.sqrt(o),t[0]=n[0]*o,t[1]=n[1]*o,t[2]=n[2]*o),t}function dr(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]}function hr(t,n,r){var e=n[0],i=n[1],o=n[2],a=r[0],u=r[1],s=r[2];return t[0]=i*s-o*u,t[1]=o*a-e*s,t[2]=e*u-i*a,t}function mr(t,n,r,e){var i=n[0],o=n[1],a=n[2];return t[0]=i+e*(r[0]-i),t[1]=o+e*(r[1]-o),t[2]=a+e*(r[2]-a),t}function vr(t,n,r,e,i,o){var a=o*o,u=a*(2*o-3)+1,s=a*(o-2)+o,c=a*(o-1),f=a*(3-2*o);return t[0]=n[0]*u+r[0]*s+e[0]*c+i[0]*f,t[1]=n[1]*u+r[1]*s+e[1]*c+i[1]*f,t[2]=n[2]*u+r[2]*s+e[2]*c+i[2]*f,t}function pr(t,n,r,e,i,o){var a=1-o,u=a*a,s=o*o,c=u*a,f=3*o*u,l=3*s*a,d=s*o;return t[0]=n[0]*c+r[0]*f+e[0]*l+i[0]*d,t[1]=n[1]*c+r[1]*f+e[1]*l+i[1]*d,t[2]=n[2]*c+r[2]*f+e[2]*l+i[2]*d,t}function Mr(t,n){n=n||1;var r=2*v()*Math.PI,e=2*v()-1,i=Math.sqrt(1-e*e)*n;return t[0]=Math.cos(r)*i,t[1]=Math.sin(r)*i,t[2]=e*n,t}function br(t,n,r){var e=n[0],i=n[1],o=n[2],a=r[3]*e+r[7]*i+r[11]*o+r[15];return a=a||1,t[0]=(r[0]*e+r[4]*i+r[8]*o+r[12])/a,t[1]=(r[1]*e+r[5]*i+r[9]*o+r[13])/a,t[2]=(r[2]*e+r[6]*i+r[10]*o+r[14])/a,t}function gr(t,n,r){var e=n[0],i=n[1],o=n[2];return t[0]=e*r[0]+i*r[3]+o*r[6],t[1]=e*r[1]+i*r[4]+o*r[7],t[2]=e*r[2]+i*r[5]+o*r[8],t}function _r(t,n,r){var e=r[0],i=r[1],o=r[2],a=r[3],u=n[0],s=n[1],c=n[2],f=i*c-o*s,l=o*u-e*c,d=e*s-i*u,h=i*d-o*l,m=o*f-e*d,v=e*l-i*f,p=2*a;return f*=p,l*=p,d*=p,h*=2,m*=2,v*=2,t[0]=u+f+h,t[1]=s+l+m,t[2]=c+d+v,t}function xr(t,n,r,e){var i=[],o=[];return i[0]=n[0]-r[0],i[1]=n[1]-r[1],i[2]=n[2]-r[2],o[0]=i[0],o[1]=i[1]*Math.cos(e)-i[2]*Math.sin(e),o[2]=i[1]*Math.sin(e)+i[2]*Math.cos(e),t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t}function yr(t,n,r,e){var i=[],o=[];return i[0]=n[0]-r[0],i[1]=n[1]-r[1],i[2]=n[2]-r[2],o[0]=i[2]*Math.sin(e)+i[0]*Math.cos(e),o[1]=i[1],o[2]=i[2]*Math.cos(e)-i[0]*Math.sin(e),t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t}function Sr(t,n,r,e){var i=[],o=[];return i[0]=n[0]-r[0],i[1]=n[1]-r[1],i[2]=n[2]-r[2],o[0]=i[0]*Math.cos(e)-i[1]*Math.sin(e),o[1]=i[0]*Math.sin(e)+i[1]*Math.cos(e),o[2]=i[2],t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t}function Ar(t,n){var r=kn(t[0],t[1],t[2]),e=kn(n[0],n[1],n[2]);lr(r,r),lr(e,e);var i=dr(r,e);return i>1?0:i<-1?Math.PI:Math.acos(i)}function Tr(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function wr(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]}function Rr(t,n){var r=t[0],e=t[1],i=t[2],o=n[0],a=n[1],u=n[2];return Math.abs(r-o)<=h*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(e-a)<=h*Math.max(1,Math.abs(e),Math.abs(a))&&Math.abs(i-u)<=h*Math.max(1,Math.abs(i),Math.abs(u))}var Er=Qn,Cr=Kn,Lr=Zn,Or=ar,Pr=ur,Nr=Xn,Ir=sr,Fr=function(){var t=zn();return function(n,r,e,i,o,a){var u=void 0,s=void 0;for(r||(r=3),e||(e=0),s=i?Math.min(i*r+e,n.length):n.length,u=e;u<s;u+=r)t[0]=n[u],t[1]=n[u+1],t[2]=n[u+2],o(t,t,a),n[u]=t[0],n[u+1]=t[1],n[u+2]=t[2];return n}}();function Br(){var t=new m(4);return m!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function Ur(t){var n=new m(4);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n}function Vr(t,n,r,e){var i=new m(4);return i[0]=t,i[1]=n,i[2]=r,i[3]=e,i}function qr(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t}function Dr(t,n,r,e,i){return t[0]=n,t[1]=r,t[2]=e,t[3]=i,t}function Gr(t,n,r){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t[3]=n[3]+r[3],t}function Hr(t,n,r){return t[0]=n[0]-r[0],t[1]=n[1]-r[1],t[2]=n[2]-r[2],t[3]=n[3]-r[3],t}function zr(t,n,r){return t[0]=n[0]*r[0],t[1]=n[1]*r[1],t[2]=n[2]*r[2],t[3]=n[3]*r[3],t}function jr(t,n,r){return t[0]=n[0]/r[0],t[1]=n[1]/r[1],t[2]=n[2]/r[2],t[3]=n[3]/r[3],t}function Xr(t,n){return t[0]=Math.ceil(n[0]),t[1]=Math.ceil(n[1]),t[2]=Math.ceil(n[2]),t[3]=Math.ceil(n[3]),t}function kr(t,n){return t[0]=Math.floor(n[0]),t[1]=Math.floor(n[1]),t[2]=Math.floor(n[2]),t[3]=Math.floor(n[3]),t}function Yr(t,n,r){return t[0]=Math.min(n[0],r[0]),t[1]=Math.min(n[1],r[1]),t[2]=Math.min(n[2],r[2]),t[3]=Math.min(n[3],r[3]),t}function Wr(t,n,r){return t[0]=Math.max(n[0],r[0]),t[1]=Math.max(n[1],r[1]),t[2]=Math.max(n[2],r[2]),t[3]=Math.max(n[3],r[3]),t}function $r(t,n){return t[0]=Math.round(n[0]),t[1]=Math.round(n[1]),t[2]=Math.round(n[2]),t[3]=Math.round(n[3]),t}function Qr(t,n,r){return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=n[3]*r,t}function Kr(t,n,r,e){return t[0]=n[0]+r[0]*e,t[1]=n[1]+r[1]*e,t[2]=n[2]+r[2]*e,t[3]=n[3]+r[3]*e,t}function Zr(t,n){var r=n[0]-t[0],e=n[1]-t[1],i=n[2]-t[2],o=n[3]-t[3];return Math.sqrt(r*r+e*e+i*i+o*o)}function Jr(t,n){var r=n[0]-t[0],e=n[1]-t[1],i=n[2]-t[2],o=n[3]-t[3];return r*r+e*e+i*i+o*o}function te(t){var n=t[0],r=t[1],e=t[2],i=t[3];return Math.sqrt(n*n+r*r+e*e+i*i)}function ne(t){var n=t[0],r=t[1],e=t[2],i=t[3];return n*n+r*r+e*e+i*i}function re(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t[3]=-n[3],t}function ee(t,n){return t[0]=1/n[0],t[1]=1/n[1],t[2]=1/n[2],t[3]=1/n[3],t}function ie(t,n){var r=n[0],e=n[1],i=n[2],o=n[3],a=r*r+e*e+i*i+o*o;return a>0&&(a=1/Math.sqrt(a),t[0]=r*a,t[1]=e*a,t[2]=i*a,t[3]=o*a),t}function oe(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]+t[3]*n[3]}function ae(t,n,r,e){var i=n[0],o=n[1],a=n[2],u=n[3];return t[0]=i+e*(r[0]-i),t[1]=o+e*(r[1]-o),t[2]=a+e*(r[2]-a),t[3]=u+e*(r[3]-u),t}function ue(t,n){var r,e,i,o,a,u;n=n||1;do{a=(r=2*v()-1)*r+(e=2*v()-1)*e}while(a>=1);do{u=(i=2*v()-1)*i+(o=2*v()-1)*o}while(u>=1);var s=Math.sqrt((1-a)/u);return t[0]=n*r,t[1]=n*e,t[2]=n*i*s,t[3]=n*o*s,t}function se(t,n,r){var e=n[0],i=n[1],o=n[2],a=n[3];return t[0]=r[0]*e+r[4]*i+r[8]*o+r[12]*a,t[1]=r[1]*e+r[5]*i+r[9]*o+r[13]*a,t[2]=r[2]*e+r[6]*i+r[10]*o+r[14]*a,t[3]=r[3]*e+r[7]*i+r[11]*o+r[15]*a,t}function ce(t,n,r){var e=n[0],i=n[1],o=n[2],a=r[0],u=r[1],s=r[2],c=r[3],f=c*e+u*o-s*i,l=c*i+s*e-a*o,d=c*o+a*i-u*e,h=-a*e-u*i-s*o;return t[0]=f*c+h*-a+l*-s-d*-u,t[1]=l*c+h*-u+d*-a-f*-s,t[2]=d*c+h*-s+f*-u-l*-a,t[3]=n[3],t}function fe(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function le(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]}function de(t,n){var r=t[0],e=t[1],i=t[2],o=t[3],a=n[0],u=n[1],s=n[2],c=n[3];return Math.abs(r-a)<=h*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(e-u)<=h*Math.max(1,Math.abs(e),Math.abs(u))&&Math.abs(i-s)<=h*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(o-c)<=h*Math.max(1,Math.abs(o),Math.abs(c))}var he=Hr,me=zr,ve=jr,pe=Zr,Me=Jr,be=te,ge=ne,_e=function(){var t=Br();return function(n,r,e,i,o,a){var u=void 0,s=void 0;for(r||(r=4),e||(e=0),s=i?Math.min(i*r+e,n.length):n.length,u=e;u<s;u+=r)t[0]=n[u],t[1]=n[u+1],t[2]=n[u+2],t[3]=n[u+3],o(t,t,a),n[u]=t[0],n[u+1]=t[1],n[u+2]=t[2],n[u+3]=t[3];return n}}();function xe(){var t=new m(4);return m!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function ye(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function Se(t,n,r){r*=.5;var e=Math.sin(r);return t[0]=e*n[0],t[1]=e*n[1],t[2]=e*n[2],t[3]=Math.cos(r),t}function Ae(t,n){var r=2*Math.acos(n[3]),e=Math.sin(r/2);return e>h?(t[0]=n[0]/e,t[1]=n[1]/e,t[2]=n[2]/e):(t[0]=1,t[1]=0,t[2]=0),r}function Te(t,n,r){var e=n[0],i=n[1],o=n[2],a=n[3],u=r[0],s=r[1],c=r[2],f=r[3];return t[0]=e*f+a*u+i*c-o*s,t[1]=i*f+a*s+o*u-e*c,t[2]=o*f+a*c+e*s-i*u,t[3]=a*f-e*u-i*s-o*c,t}function we(t,n,r){r*=.5;var e=n[0],i=n[1],o=n[2],a=n[3],u=Math.sin(r),s=Math.cos(r);return t[0]=e*s+a*u,t[1]=i*s+o*u,t[2]=o*s-i*u,t[3]=a*s-e*u,t}function Re(t,n,r){r*=.5;var e=n[0],i=n[1],o=n[2],a=n[3],u=Math.sin(r),s=Math.cos(r);return t[0]=e*s-o*u,t[1]=i*s+a*u,t[2]=o*s+e*u,t[3]=a*s-i*u,t}function Ee(t,n,r){r*=.5;var e=n[0],i=n[1],o=n[2],a=n[3],u=Math.sin(r),s=Math.cos(r);return t[0]=e*s+i*u,t[1]=i*s-e*u,t[2]=o*s+a*u,t[3]=a*s-o*u,t}function Ce(t,n){var r=n[0],e=n[1],i=n[2];return t[0]=r,t[1]=e,t[2]=i,t[3]=Math.sqrt(Math.abs(1-r*r-e*e-i*i)),t}function Le(t,n,r,e){var i=n[0],o=n[1],a=n[2],u=n[3],s=r[0],c=r[1],f=r[2],l=r[3],d=void 0,m=void 0,v=void 0,p=void 0,M=void 0;return(m=i*s+o*c+a*f+u*l)<0&&(m=-m,s=-s,c=-c,f=-f,l=-l),1-m>h?(d=Math.acos(m),v=Math.sin(d),p=Math.sin((1-e)*d)/v,M=Math.sin(e*d)/v):(p=1-e,M=e),t[0]=p*i+M*s,t[1]=p*o+M*c,t[2]=p*a+M*f,t[3]=p*u+M*l,t}function Oe(t){var n=v(),r=v(),e=v(),i=Math.sqrt(1-n),o=Math.sqrt(n);return t[0]=i*Math.sin(2*Math.PI*r),t[1]=i*Math.cos(2*Math.PI*r),t[2]=o*Math.sin(2*Math.PI*e),t[3]=o*Math.cos(2*Math.PI*e),t}function Pe(t,n){var r=n[0],e=n[1],i=n[2],o=n[3],a=r*r+e*e+i*i+o*o,u=a?1/a:0;return t[0]=-r*u,t[1]=-e*u,t[2]=-i*u,t[3]=o*u,t}function Ne(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t[3]=n[3],t}function Ie(t,n){var r=n[0]+n[4]+n[8],e=void 0;if(r>0)e=Math.sqrt(r+1),t[3]=.5*e,e=.5/e,t[0]=(n[5]-n[7])*e,t[1]=(n[6]-n[2])*e,t[2]=(n[1]-n[3])*e;else{var i=0;n[4]>n[0]&&(i=1),n[8]>n[3*i+i]&&(i=2);var o=(i+1)%3,a=(i+2)%3;e=Math.sqrt(n[3*i+i]-n[3*o+o]-n[3*a+a]+1),t[i]=.5*e,e=.5/e,t[3]=(n[3*o+a]-n[3*a+o])*e,t[o]=(n[3*o+i]+n[3*i+o])*e,t[a]=(n[3*a+i]+n[3*i+a])*e}return t}function Fe(t,n,r,e){var i=.5*Math.PI/180;n*=i,r*=i,e*=i;var o=Math.sin(n),a=Math.cos(n),u=Math.sin(r),s=Math.cos(r),c=Math.sin(e),f=Math.cos(e);return t[0]=o*s*f-a*u*c,t[1]=a*u*f+o*s*c,t[2]=a*s*c-o*u*f,t[3]=a*s*f+o*u*c,t}function Be(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var Ue=Ur,Ve=Vr,qe=qr,De=Dr,Ge=Gr,He=Te,ze=Qr,je=oe,Xe=ae,ke=te,Ye=ke,We=ne,$e=We,Qe=ie,Ke=le,Ze=de,Je=function(){var t=zn(),n=kn(1,0,0),r=kn(0,1,0);return function(e,i,o){var a=dr(i,o);return a<-.999999?(hr(t,n,i),Nr(t)<1e-6&&hr(t,r,i),lr(t,t),Se(e,t,Math.PI),e):a>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(hr(t,i,o),e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=1+a,Qe(e,e))}}(),ti=function(){var t=xe(),n=xe();return function(r,e,i,o,a,u){return Le(t,e,a,u),Le(n,i,o,u),Le(r,t,n,2*u*(1-u)),r}}(),ni=function(){var t=Mt();return function(n,r,e,i){return t[0]=e[0],t[3]=e[1],t[6]=e[2],t[1]=i[0],t[4]=i[1],t[7]=i[2],t[2]=-r[0],t[5]=-r[1],t[8]=-r[2],Qe(n,Ie(n,t))}}();function ri(){var t=new m(8);return m!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0),t[3]=1,t}function ei(t){var n=new m(8);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n}function ii(t,n,r,e,i,o,a,u){var s=new m(8);return s[0]=t,s[1]=n,s[2]=r,s[3]=e,s[4]=i,s[5]=o,s[6]=a,s[7]=u,s}function oi(t,n,r,e,i,o,a){var u=new m(8);u[0]=t,u[1]=n,u[2]=r,u[3]=e;var s=.5*i,c=.5*o,f=.5*a;return u[4]=s*e+c*r-f*n,u[5]=c*e+f*t-s*r,u[6]=f*e+s*n-c*t,u[7]=-s*t-c*n-f*r,u}function ai(t,n,r){var e=.5*r[0],i=.5*r[1],o=.5*r[2],a=n[0],u=n[1],s=n[2],c=n[3];return t[0]=a,t[1]=u,t[2]=s,t[3]=c,t[4]=e*c+i*s-o*u,t[5]=i*c+o*a-e*s,t[6]=o*c+e*u-i*a,t[7]=-e*a-i*u-o*s,t}function ui(t,n){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=.5*n[0],t[5]=.5*n[1],t[6]=.5*n[2],t[7]=0,t}function si(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function ci(t,n){var r=xe();Sn(r,n);var e=new m(3);return xn(e,n),ai(t,r,e),t}function fi(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t}function li(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function di(t,n,r,e,i,o,a,u,s){return t[0]=n,t[1]=r,t[2]=e,t[3]=i,t[4]=o,t[5]=a,t[6]=u,t[7]=s,t}var hi=qe;function mi(t,n){return t[0]=n[4],t[1]=n[5],t[2]=n[6],t[3]=n[7],t}var vi=qe;function pi(t,n){return t[4]=n[0],t[5]=n[1],t[6]=n[2],t[7]=n[3],t}function Mi(t,n){var r=n[4],e=n[5],i=n[6],o=n[7],a=-n[0],u=-n[1],s=-n[2],c=n[3];return t[0]=2*(r*c+o*a+e*s-i*u),t[1]=2*(e*c+o*u+i*a-r*s),t[2]=2*(i*c+o*s+r*u-e*a),t}function bi(t,n,r){var e=n[0],i=n[1],o=n[2],a=n[3],u=.5*r[0],s=.5*r[1],c=.5*r[2],f=n[4],l=n[5],d=n[6],h=n[7];return t[0]=e,t[1]=i,t[2]=o,t[3]=a,t[4]=a*u+i*c-o*s+f,t[5]=a*s+o*u-e*c+l,t[6]=a*c+e*s-i*u+d,t[7]=-e*u-i*s-o*c+h,t}function gi(t,n,r){var e=-n[0],i=-n[1],o=-n[2],a=n[3],u=n[4],s=n[5],c=n[6],f=n[7],l=u*a+f*e+s*o-c*i,d=s*a+f*i+c*e-u*o,h=c*a+f*o+u*i-s*e,m=f*a-u*e-s*i-c*o;return we(t,n,r),e=t[0],i=t[1],o=t[2],a=t[3],t[4]=l*a+m*e+d*o-h*i,t[5]=d*a+m*i+h*e-l*o,t[6]=h*a+m*o+l*i-d*e,t[7]=m*a-l*e-d*i-h*o,t}function _i(t,n,r){var e=-n[0],i=-n[1],o=-n[2],a=n[3],u=n[4],s=n[5],c=n[6],f=n[7],l=u*a+f*e+s*o-c*i,d=s*a+f*i+c*e-u*o,h=c*a+f*o+u*i-s*e,m=f*a-u*e-s*i-c*o;return Re(t,n,r),e=t[0],i=t[1],o=t[2],a=t[3],t[4]=l*a+m*e+d*o-h*i,t[5]=d*a+m*i+h*e-l*o,t[6]=h*a+m*o+l*i-d*e,t[7]=m*a-l*e-d*i-h*o,t}function xi(t,n,r){var e=-n[0],i=-n[1],o=-n[2],a=n[3],u=n[4],s=n[5],c=n[6],f=n[7],l=u*a+f*e+s*o-c*i,d=s*a+f*i+c*e-u*o,h=c*a+f*o+u*i-s*e,m=f*a-u*e-s*i-c*o;return Ee(t,n,r),e=t[0],i=t[1],o=t[2],a=t[3],t[4]=l*a+m*e+d*o-h*i,t[5]=d*a+m*i+h*e-l*o,t[6]=h*a+m*o+l*i-d*e,t[7]=m*a-l*e-d*i-h*o,t}function yi(t,n,r){var e=r[0],i=r[1],o=r[2],a=r[3],u=n[0],s=n[1],c=n[2],f=n[3];return t[0]=u*a+f*e+s*o-c*i,t[1]=s*a+f*i+c*e-u*o,t[2]=c*a+f*o+u*i-s*e,t[3]=f*a-u*e-s*i-c*o,u=n[4],s=n[5],c=n[6],f=n[7],t[4]=u*a+f*e+s*o-c*i,t[5]=s*a+f*i+c*e-u*o,t[6]=c*a+f*o+u*i-s*e,t[7]=f*a-u*e-s*i-c*o,t}function Si(t,n,r){var e=n[0],i=n[1],o=n[2],a=n[3],u=r[0],s=r[1],c=r[2],f=r[3];return t[0]=e*f+a*u+i*c-o*s,t[1]=i*f+a*s+o*u-e*c,t[2]=o*f+a*c+e*s-i*u,t[3]=a*f-e*u-i*s-o*c,u=r[4],s=r[5],c=r[6],f=r[7],t[4]=e*f+a*u+i*c-o*s,t[5]=i*f+a*s+o*u-e*c,t[6]=o*f+a*c+e*s-i*u,t[7]=a*f-e*u-i*s-o*c,t}function Ai(t,n,r,e){if(Math.abs(e)<h)return fi(t,n);var i=Math.sqrt(r[0]*r[0]+r[1]*r[1]+r[2]*r[2]);e*=.5;var o=Math.sin(e),a=o*r[0]/i,u=o*r[1]/i,s=o*r[2]/i,c=Math.cos(e),f=n[0],l=n[1],d=n[2],m=n[3];t[0]=f*c+m*a+l*s-d*u,t[1]=l*c+m*u+d*a-f*s,t[2]=d*c+m*s+f*u-l*a,t[3]=m*c-f*a-l*u-d*s;var v=n[4],p=n[5],M=n[6],b=n[7];return t[4]=v*c+b*a+p*s-M*u,t[5]=p*c+b*u+M*a-v*s,t[6]=M*c+b*s+v*u-p*a,t[7]=b*c-v*a-p*u-M*s,t}function Ti(t,n,r){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t[3]=n[3]+r[3],t[4]=n[4]+r[4],t[5]=n[5]+r[5],t[6]=n[6]+r[6],t[7]=n[7]+r[7],t}function wi(t,n,r){var e=n[0],i=n[1],o=n[2],a=n[3],u=r[4],s=r[5],c=r[6],f=r[7],l=n[4],d=n[5],h=n[6],m=n[7],v=r[0],p=r[1],M=r[2],b=r[3];return t[0]=e*b+a*v+i*M-o*p,t[1]=i*b+a*p+o*v-e*M,t[2]=o*b+a*M+e*p-i*v,t[3]=a*b-e*v-i*p-o*M,t[4]=e*f+a*u+i*c-o*s+l*b+m*v+d*M-h*p,t[5]=i*f+a*s+o*u-e*c+d*b+m*p+h*v-l*M,t[6]=o*f+a*c+e*s-i*u+h*b+m*M+l*p-d*v,t[7]=a*f-e*u-i*s-o*c+m*b-l*v-d*p-h*M,t}var Ri=wi;function Ei(t,n,r){return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=n[3]*r,t[4]=n[4]*r,t[5]=n[5]*r,t[6]=n[6]*r,t[7]=n[7]*r,t}var Ci=je;function Li(t,n,r,e){var i=1-e;return Ci(n,r)<0&&(e=-e),t[0]=n[0]*i+r[0]*e,t[1]=n[1]*i+r[1]*e,t[2]=n[2]*i+r[2]*e,t[3]=n[3]*i+r[3]*e,t[4]=n[4]*i+r[4]*e,t[5]=n[5]*i+r[5]*e,t[6]=n[6]*i+r[6]*e,t[7]=n[7]*i+r[7]*e,t}function Oi(t,n){var r=Fi(n);return t[0]=-n[0]/r,t[1]=-n[1]/r,t[2]=-n[2]/r,t[3]=n[3]/r,t[4]=-n[4]/r,t[5]=-n[5]/r,t[6]=-n[6]/r,t[7]=n[7]/r,t}function Pi(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t[3]=n[3],t[4]=-n[4],t[5]=-n[5],t[6]=-n[6],t[7]=n[7],t}var Ni=ke,Ii=Ni,Fi=We,Bi=Fi;function Ui(t,n){var r=Fi(n);if(r>0){r=Math.sqrt(r);var e=n[0]/r,i=n[1]/r,o=n[2]/r,a=n[3]/r,u=n[4],s=n[5],c=n[6],f=n[7],l=e*u+i*s+o*c+a*f;t[0]=e,t[1]=i,t[2]=o,t[3]=a,t[4]=(u-e*l)/r,t[5]=(s-i*l)/r,t[6]=(c-o*l)/r,t[7]=(f-a*l)/r}return t}function Vi(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"}function qi(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]&&t[6]===n[6]&&t[7]===n[7]}function Di(t,n){var r=t[0],e=t[1],i=t[2],o=t[3],a=t[4],u=t[5],s=t[6],c=t[7],f=n[0],l=n[1],d=n[2],m=n[3],v=n[4],p=n[5],M=n[6],b=n[7];return Math.abs(r-f)<=h*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(e-l)<=h*Math.max(1,Math.abs(e),Math.abs(l))&&Math.abs(i-d)<=h*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(o-m)<=h*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(a-v)<=h*Math.max(1,Math.abs(a),Math.abs(v))&&Math.abs(u-p)<=h*Math.max(1,Math.abs(u),Math.abs(p))&&Math.abs(s-M)<=h*Math.max(1,Math.abs(s),Math.abs(M))&&Math.abs(c-b)<=h*Math.max(1,Math.abs(c),Math.abs(b))}function Gi(){var t=new m(2);return m!=Float32Array&&(t[0]=0,t[1]=0),t}function Hi(t){var n=new m(2);return n[0]=t[0],n[1]=t[1],n}function zi(t,n){var r=new m(2);return r[0]=t,r[1]=n,r}function ji(t,n){return t[0]=n[0],t[1]=n[1],t}function Xi(t,n,r){return t[0]=n,t[1]=r,t}function ki(t,n,r){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t}function Yi(t,n,r){return t[0]=n[0]-r[0],t[1]=n[1]-r[1],t}function Wi(t,n,r){return t[0]=n[0]*r[0],t[1]=n[1]*r[1],t}function $i(t,n,r){return t[0]=n[0]/r[0],t[1]=n[1]/r[1],t}function Qi(t,n){return t[0]=Math.ceil(n[0]),t[1]=Math.ceil(n[1]),t}function Ki(t,n){return t[0]=Math.floor(n[0]),t[1]=Math.floor(n[1]),t}function Zi(t,n,r){return t[0]=Math.min(n[0],r[0]),t[1]=Math.min(n[1],r[1]),t}function Ji(t,n,r){return t[0]=Math.max(n[0],r[0]),t[1]=Math.max(n[1],r[1]),t}function to(t,n){return t[0]=Math.round(n[0]),t[1]=Math.round(n[1]),t}function no(t,n,r){return t[0]=n[0]*r,t[1]=n[1]*r,t}function ro(t,n,r,e){return t[0]=n[0]+r[0]*e,t[1]=n[1]+r[1]*e,t}function eo(t,n){var r=n[0]-t[0],e=n[1]-t[1];return Math.sqrt(r*r+e*e)}function io(t,n){var r=n[0]-t[0],e=n[1]-t[1];return r*r+e*e}function oo(t){var n=t[0],r=t[1];return Math.sqrt(n*n+r*r)}function ao(t){var n=t[0],r=t[1];return n*n+r*r}function uo(t,n){return t[0]=-n[0],t[1]=-n[1],t}function so(t,n){return t[0]=1/n[0],t[1]=1/n[1],t}function co(t,n){var r=n[0],e=n[1],i=r*r+e*e;return i>0&&(i=1/Math.sqrt(i),t[0]=n[0]*i,t[1]=n[1]*i),t}function fo(t,n){return t[0]*n[0]+t[1]*n[1]}function lo(t,n,r){var e=n[0]*r[1]-n[1]*r[0];return t[0]=t[1]=0,t[2]=e,t}function ho(t,n,r,e){var i=n[0],o=n[1];return t[0]=i+e*(r[0]-i),t[1]=o+e*(r[1]-o),t}function mo(t,n){n=n||1;var r=2*v()*Math.PI;return t[0]=Math.cos(r)*n,t[1]=Math.sin(r)*n,t}function vo(t,n,r){var e=n[0],i=n[1];return t[0]=r[0]*e+r[2]*i,t[1]=r[1]*e+r[3]*i,t}function po(t,n,r){var e=n[0],i=n[1];return t[0]=r[0]*e+r[2]*i+r[4],t[1]=r[1]*e+r[3]*i+r[5],t}function Mo(t,n,r){var e=n[0],i=n[1];return t[0]=r[0]*e+r[3]*i+r[6],t[1]=r[1]*e+r[4]*i+r[7],t}function bo(t,n,r){var e=n[0],i=n[1];return t[0]=r[0]*e+r[4]*i+r[12],t[1]=r[1]*e+r[5]*i+r[13],t}function go(t,n,r,e){var i=n[0]-r[0],o=n[1]-r[1],a=Math.sin(e),u=Math.cos(e);return t[0]=i*u-o*a+r[0],t[1]=i*a+o*u+r[1],t}function _o(t,n){var r=t[0],e=t[1],i=n[0],o=n[1],a=r*r+e*e;a>0&&(a=1/Math.sqrt(a));var u=i*i+o*o;u>0&&(u=1/Math.sqrt(u));var s=(r*i+e*o)*a*u;return s>1?0:s<-1?Math.PI:Math.acos(s)}function xo(t){return"vec2("+t[0]+", "+t[1]+")"}function yo(t,n){return t[0]===n[0]&&t[1]===n[1]}function So(t,n){var r=t[0],e=t[1],i=n[0],o=n[1];return Math.abs(r-i)<=h*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(e-o)<=h*Math.max(1,Math.abs(e),Math.abs(o))}var Ao=oo,To=Yi,wo=Wi,Ro=$i,Eo=eo,Co=io,Lo=ao,Oo=function(){var t=Gi();return function(n,r,e,i,o,a){var u=void 0,s=void 0;for(r||(r=2),e||(e=0),s=i?Math.min(i*r+e,n.length):n.length,u=e;u<s;u+=r)t[0]=n[u],t[1]=n[u+1],o(t,t,a),n[u]=t[0],n[u+1]=t[1];return n}}();r.d(n,"glMatrix",function(){return e}),r.d(n,"mat2",function(){return i}),r.d(n,"mat2d",function(){return o}),r.d(n,"mat3",function(){return a}),r.d(n,"mat4",function(){return u}),r.d(n,"quat",function(){return f}),r.d(n,"quat2",function(){return l}),r.d(n,"vec2",function(){return d}),r.d(n,"vec3",function(){return s}),r.d(n,"vec4",function(){return c})},10:function(t,n,r){"use strict";var e=this&&this.__awaiter||function(t,n,r,e){return new(r||(r=Promise))(function(i,o){function a(t){try{s(e.next(t))}catch(t){o(t)}}function u(t){try{s(e.throw(t))}catch(t){o(t)}}function s(t){t.done?i(t.value):new r(function(n){n(t.value)}).then(a,u)}s((e=e.apply(t,n||[])).next())})};Object.defineProperty(n,"__esModule",{value:!0});const i=r(3),o=r(11);class a{constructor(){this.bounds=new i.Aabb3}static fromGltf(t,n){return e(this,void 0,void 0,function*(){const r=n.gAsset.gltf.meshes[t],e=new a;e.context=n.context,e.name=r.name,e.primitives=yield Promise.all(r.primitives.map((e,i)=>{const a=`mesh_${r.name||t}_prim_${i}`;return o.Primitive.fromGltf(e,n,a)}));for(const t of e.primitives)e.bounds.union(t.bounds);return e})}uninitialize(){for(const t of this.primitives)t.uninitialize()}}n.Mesh=a},11:function(t,n,r){"use strict";var e=this&&this.__awaiter||function(t,n,r,e){return new(r||(r=Promise))(function(i,o){function a(t){try{s(e.next(t))}catch(t){o(t)}}function u(t){try{s(e.throw(t))}catch(t){o(t)}}function s(t){t.done?i(t.value):new r(function(n){n(t.value)}).then(a,u)}s((e=e.apply(t,n||[])).next())})};Object.defineProperty(n,"__esModule",{value:!0});const i=r(0),o=i.auxiliaries.assert,a=r(1),u=r(6),s=r(3),c=r(4),f=r(5);class l{constructor(t,n,r,e,i,o){this.buffer=t,this.size=n,this.type=r,this.normalized=e,this.stride=i,this.offset=o}static fromGltf(t,n,r){return new l(r,u.GLTF_ELEMENTS_PER_TYPE[t.type],t.componentType,t.normalized||!1,n||0,t.byteOffset||0)}enable(t){this.buffer.attribEnable(t,this.size,this.type,this.normalized,this.stride,this.offset,!0,!1)}disable(t){this.buffer.attribDisable(t,!1,!0)}}class d extends i.Initializable{constructor(t,n="Primitive"){super(),this.attributes={},this.identifier=n,this.vertexArray=new i.VertexArray(t,n+"_VAO")}static fromGltf(t,n,r){return e(this,void 0,void 0,function*(){const e=new d(n.context,r);e.mode=t.mode||4;const u=n.context,h=e.context.gl,m=n.gAsset,v=m.gltf;if(o(void 0!==t.attributes.POSITION,"primitives must have the POSITION attribute"),void 0===v.bufferViews)throw new Error("invalid gltf");const p={};for(const n in t.attributes){const r=t.attributes[n],o=v.accessors[r];e.numVertices=o.count;const u=o.bufferView;let c,f;if(void 0!==u&&u in p)c=p[u],f=v.bufferViews[u].byteStride;else{const t=yield m.accessorData(r);(c=new i.Buffer(e.context,`${e.identifier}_VBO_${Object.keys(p).length}`)).initialize(h.ARRAY_BUFFER),c.data(t,h.STATIC_DRAW),void 0!==u&&(p[u]=c,f=v.bufferViews[u].byteStride)}e.attributes[n]=l.fromGltf(o,f,c),"POSITION"===n&&(e.bounds=new s.Aabb3(a.vec3.fromValues.apply(void 0,o.min),a.vec3.fromValues.apply(void 0,o.max)))}let M=0;if(void 0!==t.attributes.NORMAL&&(M|=f.ShaderFlags.HAS_NORMALS),void 0!==t.attributes.TANGENT&&(M|=f.ShaderFlags.HAS_TANGENTS),void 0!==t.attributes.TEXCOORD_0&&(M|=f.ShaderFlags.HAS_UV),void 0!==t.attributes.COLOR_0&&(M|=f.ShaderFlags.HAS_COLORS),void 0!==t.indices){const n=v.accessors[t.indices],r=yield m.accessorData(t.indices);if(e.indexBuffer=new i.Buffer(e.context,`${e.identifier}_EBO`),e.numIndices=n.count,e.indexByteOffset=n.byteOffset||0,e.indexType=n.componentType,e.indexType===h.UNSIGNED_INT&&u.isWebGL1){if(!u.supportsElementIndexUint)throw new Error(`Primitive ${e.identifier} needs unsupported extension OES_element_index_uint`);u.elementIndexUint}e.indexBuffer.initialize(h.ELEMENT_ARRAY_BUFFER),e.indexBuffer.data(r,h.STATIC_DRAW),i.auxiliaries.assert(void 0!==e.indexBuffer&&e.indexBuffer.object instanceof WebGLBuffer,"expected valid WebGLBuffer")}return void 0===t.material?(e.material=new c.Material(u),e.material.name="DefaultMaterial"):e.material=yield n.getMaterial(t.material),e.shaderFlags=M|e.material.shaderFlags,e.initialize(),e})}bindBuffers(){for(const t in this.attributes){const n=this.shader.attribLocations[t];void 0!==n&&-1!==n&&this.attributes[t].enable(n)}this.numIndices&&this.indexBuffer.bind()}unbindBuffers(){for(const t in this.attributes){const n=this.shader.attribLocations[t];void 0!==n&&-1!==n&&this.attributes[t].disable(n)}this.numIndices&&this.indexBuffer.unbind()}initialize(...t){const n=this.context.gl;return this.numIndices?this.drawCall=(()=>{n.drawElements(this.mode,this.numIndices,this.indexType,this.indexByteOffset)}):this.drawCall=(()=>{n.drawArrays(this.mode,0,this.numVertices)}),this.vertexArray.initialize(()=>this.bindBuffers(),()=>this.unbindBuffers()),this.vertexArray.valid}uninitialize(){this.vertexArray.uninitialize();for(const t in this.attributes){const n=this.attributes[t].buffer;n.initialized&&n.uninitialize()}this.indexBuffer&&this.indexBuffer.uninitialize()}draw(t,n){if(this.shader=t,this.context.gl.uniform1i(t.uniforms.u_PbrFlags,this.shaderFlags),this.vertexArray.bind(),n){const r=this.context.gl;for(const e of n){const n=e.viewport;r.viewport(n.x,n.y,n.width,n.height),r.uniformMatrix4fv(t.uniforms.u_ViewProjection,!1,e.viewProjectionMatrix),r.uniform3fv(t.uniforms.u_Camera,e.cameraPosition),this.drawCall()}}else this.drawCall();this.vertexArray.unbind(),this.shader=void 0}get context(){return this.vertexArray.context}}n.Primitive=d},12:function(t,n,r){"use strict";var e=this&&this.__awaiter||function(t,n,r,e){return new(r||(r=Promise))(function(i,o){function a(t){try{s(e.next(t))}catch(t){o(t)}}function u(t){try{s(e.throw(t))}catch(t){o(t)}}function s(t){t.done?i(t.value):new r(function(n){n(t.value)}).then(a,u)}s((e=e.apply(t,n||[])).next())})};Object.defineProperty(n,"__esModule",{value:!0});const i=r(1),o=r(3),a=r(4),u=r(13);class s{constructor(){this.nodes=[],this.batchesByMaterial=new Map,this.bounds=new o.Aabb3}static fromGltf(t,n){return e(this,void 0,void 0,function*(){const r=new s;r.context=n.context,r.name=t.name,r.rootNodes=yield Promise.all(t.nodes.map(t=>{const r=n.gAsset.gltf.nodes[t];return u.Node.fromGltf(r,n)}));const e=i.mat4.create();for(const t of r.rootNodes)t.updateTransform(e),t.updateBounds(),r.bounds.union(t.bounds);for(const t of r.rootNodes){r.nodes.push(t);const n=[t];for(;n.length>0;){const t=n.pop();r.nodes.push(t),n.push.apply(n,t.children)}}for(const t of r.nodes)if(void 0!==t.mesh)for(const n of t.mesh.primitives){const e=n.material,i=r.batchesByMaterial.get(e)||[];0===i.length&&r.batchesByMaterial.set(e,i),i.push({node:t,primitive:n})}const o=Array.from(r.batchesByMaterial.keys()),c=o.filter(t=>t.alphaMode===a.AlphaMode.OPAQUE),f=o.filter(t=>t.alphaMode!==a.AlphaMode.OPAQUE);return r.sortedMaterials=c.concat(f),r})}draw(t,n){const r=this.context.gl;for(const e of this.sortedMaterials){const i=this.batchesByMaterial.get(e);e.bind(t);for(const{primitive:e,node:o}of i)r.uniformMatrix4fv(t.uniforms.u_ModelMatrix,r.FALSE,o.finalTransform),r.uniformMatrix3fv(t.uniforms.u_NormalMatrix,r.FALSE,o.normalMatrix),e.draw(t,n);e.unbind(t)}}uninitialize(){for(const t of this.rootNodes)t.uninitialize()}}n.Scene=s},13:function(t,n,r){"use strict";var e=this&&this.__awaiter||function(t,n,r,e){return new(r||(r=Promise))(function(i,o){function a(t){try{s(e.next(t))}catch(t){o(t)}}function u(t){try{s(e.throw(t))}catch(t){o(t)}}function s(t){t.done?i(t.value):new r(function(n){n(t.value)}).then(a,u)}s((e=e.apply(t,n||[])).next())})};Object.defineProperty(n,"__esModule",{value:!0});const i=r(1),o=r(3);class a{constructor(){this.children=[],this.finalTransform=i.mat4.create(),this.normalMatrix=i.mat3.create()}static fromGltf(t,n){return e(this,void 0,void 0,function*(){const r=new a;return r.name=t.name,r.context=n.context,void 0!==t.matrix?r.matrix=i.mat4.fromValues.apply(void 0,t.matrix):t.translation||t.rotation||t.scale?(r.translation=t.translation?i.vec3.fromValues.apply(void 0,t.translation):i.vec3.create(),r.rotation=t.rotation?i.quat.fromValues.apply(void 0,t.rotation):i.quat.create(),r.scale=t.scale?i.vec3.fromValues.apply(void 0,t.scale):i.vec3.fromValues(1,1,1)):r.matrix=i.mat4.create(),void 0!==t.mesh&&(r.mesh=yield n.getMesh(t.mesh)),t.children&&(r.children=yield Promise.all(t.children.map(t=>a.fromGltf(n.gAsset.gltf.nodes[t],n)))),r})}updateTransform(t){if(this.finalTransform=i.mat4.clone(t),this.matrix)i.mat4.mul(this.finalTransform,this.finalTransform,this.matrix);else{const t=i.mat4.fromRotationTranslationScale(i.mat4.create(),this.rotation,this.translation,this.scale);i.mat4.mul(this.finalTransform,this.finalTransform,t)}i.mat3.normalFromMat4(this.normalMatrix,this.finalTransform);for(const t of this.children)t.updateTransform(this.finalTransform)}updateBounds(){if(this.mesh)this.bounds=this.mesh.bounds.clone(),this.bounds.transform(this.finalTransform);else if(0===this.children.length)this.bounds=new o.Aabb3(i.vec3.fromValues(0,0,0),i.vec3.fromValues(0,0,0)),this.bounds.transform(this.finalTransform);else{this.bounds=new o.Aabb3;for(const t of this.children)t.updateBounds(),this.bounds.union(t.bounds)}}uninitialize(){this.mesh&&this.mesh.uninitialize();for(const t of this.children)t.uninitialize()}}n.Node=a},2:function(t,n,r){"use strict"},3:function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const e=r(1);class i{constructor(t=e.vec3.fromValues(1/0,1/0,1/0),n=e.vec3.fromValues(-1/0,-1/0,-1/0)){this.min=t,this.max=n}transform(t){const n=e.vec3.fromValues(1/0,1/0,1/0),r=e.vec3.fromValues(-1/0,-1/0,-1/0),i=e.vec3.create(),o=t=>{e.vec3.transformMat4(i,i,t),e.vec3.min(n,n,i),e.vec3.max(r,r,i)};e.vec3.set(i,this.min[0],this.min[1],this.min[2]),o(t),e.vec3.set(i,this.min[0],this.min[1],this.max[2]),o(t),e.vec3.set(i,this.min[0],this.max[1],this.min[2]),o(t),e.vec3.set(i,this.min[0],this.max[1],this.max[2]),o(t),e.vec3.set(i,this.max[0],this.min[1],this.min[2]),o(t),e.vec3.set(i,this.max[0],this.min[1],this.max[2]),o(t),e.vec3.set(i,this.max[0],this.max[1],this.min[2]),o(t),e.vec3.set(i,this.max[0],this.max[1],this.max[2]),o(t),this.min=n,this.max=r}get size(){return e.vec3.sub(e.vec3.create(),this.max,this.min)}get center(){const t=e.vec3.create();return e.vec3.add(t,this.min,this.max),e.vec3.scale(t,t,.5)}union(t){return e.vec3.min(this.min,this.min,t.min),e.vec3.max(this.max,this.max,t.max),this}clone(){return new i(e.vec3.clone(this.min),e.vec3.clone(this.max))}}n.Aabb3=i},4:function(t,n,r){"use strict";var e=this&&this.__awaiter||function(t,n,r,e){return new(r||(r=Promise))(function(i,o){function a(t){try{s(e.next(t))}catch(t){o(t)}}function u(t){try{s(e.throw(t))}catch(t){o(t)}}function s(t){t.done?i(t.value):new r(function(n){n(t.value)}).then(a,u)}s((e=e.apply(t,n||[])).next())})};Object.defineProperty(n,"__esModule",{value:!0});const i=r(1),o=r(0),a=r(5);var u;!function(t){t[t.OPAQUE=0]="OPAQUE",t[t.MASK=1]="MASK",t[t.BLEND=2]="BLEND"}(u=n.AlphaMode||(n.AlphaMode={}));class s{constructor(t){this.baseColorFactor=i.vec4.fromValues(1,1,1,1),this.metallicFactor=1,this.roughnessFactor=1,this.emissiveFactor=i.vec3.fromValues(0,0,0),this.alphaCutoff=.5,this.alphaMode=u.OPAQUE,this.doubleSided=!1,this.context=t;const n=this.context.gl;this.emptyTexture=new o.Texture2(this.context,"emptyTexture"),this.emptyTexture.initialize(1,1,n.RGBA,n.RGBA,n.UNSIGNED_BYTE)}static fromGltf(t,n){return e(this,void 0,void 0,function*(){const r=n.gAsset.gltf.materials[t],e=new s(n.context);e.name=r.name||t.toString();const o=r.pbrMetallicRoughness,a={baseColorTexture:void 0,metallicRoghnessTexture:void 0,normalTexture:void 0,occlusionTexture:void 0,emissiveTexture:void 0};o&&(o.baseColorFactor&&(e.baseColorFactor=i.vec4.fromValues.apply(void 0,o.baseColorFactor)),o.baseColorTexture&&(a.baseColorTexture=this.loadTexture(o.baseColorTexture,n,`mat_${e.name}_baseColorTexture`),e.baseColorTexCoord=o.baseColorTexture.texCoord||0),void 0!==o.metallicFactor&&(e.metallicFactor=o.metallicFactor),void 0!==o.roughnessFactor&&(e.roughnessFactor=o.roughnessFactor),o.metallicRoughnessTexture&&(a.metallicRoughnessTexture=this.loadTexture(o.metallicRoughnessTexture,n,`mat_${e.name}_metallicRoughnessTexture`),e.metallicRoughnessTexCoord=o.metallicRoughnessTexture.texCoord||0));const c=r.normalTexture;c&&(a.normalTexture=this.loadTexture(c,n,`mat_${e.name}_normalTexture`),e.normalTexCoord=c.texCoord||0,e.normalScale=c.scale||1);const f=r.occlusionTexture;f&&(a.occlusionTexture=this.loadTexture(f,n,`mat_${e.name}_occlusionTexture`),e.occlusionTexCoord=f.texCoord||0,e.occlusionStrength=f.strength||1),r.emissiveTexture&&(a.emissiveTexture=this.loadTexture(r.emissiveTexture,n,`mat_${e.name}_emissiveTexture`),e.emissiveTexCoord=r.emissiveTexture.texCoord||0),r.emissiveFactor&&(e.emissiveFactor=i.vec3.fromValues.apply(void 0,r.emissiveFactor)),void 0!==r.alphaCutoff&&(e.alphaCutoff=r.alphaCutoff),r.alphaMode&&(e.alphaMode=u[r.alphaMode]),void 0!==r.doubleSided&&(e.doubleSided=r.doubleSided),yield Promise.all(Object.values(a));for(const t in a)e[t]=yield a[t];return e})}static loadTexture(t,n,r){return e(this,void 0,void 0,function*(){const e=n.context.gl,i=n.gAsset.gltf;if(n.textures[t.index])return n.textures[t.index];const a=i.textures[t.index],u=yield n.gAsset.imageData.get(a.source),s=void 0!==a.sampler?i.samplers[a.sampler]:{},c=new o.Texture2(n.context,r);c.initialize(u.width,u.height,e.RGBA,e.RGBA,e.UNSIGNED_BYTE),c.wrap(s.wrapS||e.REPEAT,s.wrapT||e.REPEAT,!0,!1);const f=s.magFilter||e.LINEAR,l=s.minFilter||e.LINEAR_MIPMAP_LINEAR;return c.filter(f,l,!1,!1),c.data(u,!1,!1),(l===e.LINEAR_MIPMAP_LINEAR||l===e.LINEAR_MIPMAP_NEAREST||l===e.NEAREST_MIPMAP_LINEAR||l===e.NEAREST_MIPMAP_NEAREST)&&e.generateMipmap(e.TEXTURE_2D),c.unbind(),n.textures[t.index]=c,c})}get shaderFlags(){let t=0;return this.baseColorTexture&&(t|=a.ShaderFlags.HAS_BASECOLORMAP),this.normalTexture&&(t|=a.ShaderFlags.HAS_NORMALMAP),this.emissiveTexture&&(t|=a.ShaderFlags.HAS_EMISSIVEMAP),this.metallicRoughnessTexture&&(t|=a.ShaderFlags.HAS_METALROUGHNESSMAP),this.occlusionTexture&&(t|=a.ShaderFlags.HAS_OCCLUSIONMAP),t}bind(t){const n=this.context.gl,r=t.uniforms;this.doubleSided?n.disable(n.CULL_FACE):n.enable(n.CULL_FACE),this.alphaMode!==u.OPAQUE&&(n.enable(n.BLEND),n.blendFunc(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA),n.uniform1f(r.u_AlphaBlend,1),this.alphaMode===u.MASK&&n.uniform1f(r.u_AlphaCutoff,this.alphaCutoff)),n.uniform4fv(r.u_BaseColorFactor,this.baseColorFactor),this.baseColorTexture?(this.baseColorTexture.bind(n.TEXTURE0),n.uniform1i(r.u_BaseColorTexCoord,this.baseColorTexCoord)):this.emptyTexture.bind(n.TEXTURE0),this.normalTexture?(this.normalTexture.bind(n.TEXTURE1),n.uniform1i(r.u_NormalTexCoord,this.normalTexCoord),n.uniform1f(r.u_NormalScale,this.normalScale)):this.emptyTexture.bind(n.TEXTURE1),this.emissiveTexture?(this.emissiveTexture.bind(n.TEXTURE2),n.uniform1i(r.u_EmissiveTexCoord,this.emissiveTexCoord),n.uniform3fv(r.u_EmissiveFactor,this.emissiveFactor)):this.emptyTexture.bind(n.TEXTURE2),this.metallicRoughnessTexture?(this.metallicRoughnessTexture.bind(n.TEXTURE3),n.uniform1i(r.u_MetallicRoughnessTexCoord,this.metallicRoughnessTexCoord)):this.emptyTexture.bind(n.TEXTURE3),n.uniform2f(r.u_MetallicRoughnessValues,this.metallicFactor,this.roughnessFactor),this.occlusionTexture?(this.occlusionTexture.bind(n.TEXTURE4),n.uniform1i(r.u_OcclusionTexCoord,this.occlusionTexCoord),n.uniform1f(r.u_OcclusionStrength,this.occlusionStrength)):this.emptyTexture.bind(n.TEXTURE4)}unbind(t){const n=this.context.gl;this.alphaMode!==u.OPAQUE&&(n.disable(n.BLEND),n.uniform1f(t.uniforms.u_AlphaBlend,0),this.alphaMode===u.MASK&&n.uniform1f(t.uniforms.u_AlphaCutoff,0))}}n.Material=s},5:function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const e=r(0);function i(t){return`a_${t.toLowerCase()}`}n.ATTRIB_LOCATIONS={POSITION:0,NORMAL:1,TANGENT:2,TEXCOORD_0:3,TEXCOORD_1:4,COLOR_0:5,JOINTS_0:6,WEIGHTS_0:7},n.attribName=i,function(t){t[t.HAS_NORMALS=1]="HAS_NORMALS",t[t.HAS_TANGENTS=2]="HAS_TANGENTS",t[t.HAS_UV=4]="HAS_UV",t[t.HAS_COLORS=8]="HAS_COLORS",t[t.USE_IBL=16]="USE_IBL",t[t.HAS_BASECOLORMAP=32]="HAS_BASECOLORMAP",t[t.HAS_NORMALMAP=64]="HAS_NORMALMAP",t[t.HAS_EMISSIVEMAP=128]="HAS_EMISSIVEMAP",t[t.HAS_METALROUGHNESSMAP=256]="HAS_METALROUGHNESSMAP",t[t.HAS_OCCLUSIONMAP=512]="HAS_OCCLUSIONMAP",t[t.USE_TEX_LOD=1024]="USE_TEX_LOD"}(n.ShaderFlags||(n.ShaderFlags={}));class o{constructor(t){this.u_ViewProjection=null,this.u_ModelMatrix=null,this.u_NormalMatrix=null,this.u_Camera=null,this.u_LightDirection=null,this.u_LightColor=null,this.u_BaseColorSampler=null,this.u_BaseColorTexCoord=null,this.u_BaseColorFactor=null,this.u_NormalSampler=null,this.u_NormalTexCoord=null,this.u_NormalScale=null,this.u_EmissiveSampler=null,this.u_EmissiveTexCoord=null,this.u_EmissiveFactor=null,this.u_MetallicRoughnessSampler=null,this.u_MetallicRoughnessTexCoord=null,this.u_MetallicRoughnessValues=null,this.u_OcclusionSampler=null,this.u_OcclusionTexCoord=null,this.u_OcclusionStrength=null,this.u_AlphaBlend=null,this.u_AlphaCutoff=null,this.u_PbrFlags=null;for(const n in this)this[n]=t.uniform(n),null!==this[n]||n.endsWith("Sampler")||console.warn("Failed to get uniform location for "+n);t.bind();const n=t.context.gl;n.uniform1i(this.u_BaseColorSampler,0),n.uniform1i(this.u_NormalSampler,1),n.uniform1i(this.u_EmissiveSampler,2),n.uniform1i(this.u_MetallicRoughnessSampler,3),n.uniform1i(this.u_OcclusionSampler,4),n.uniform3f(this.u_LightColor,4,4,4),n.uniform3f(this.u_LightDirection,0,.5,.5)}}n.PbrShader=class{constructor(t){this.attribLocations={};const a=t.gl;if(t.isWebGL1){if(!t.supportsShaderTextureLOD)throw new Error("PBR shader needs unsupported extension GL_EXT_shader_texture_lod");if(t.shaderTextureLOD,!t.supportsStandardDerivatives)throw new Error("PBR shader needs unsupported extension GL_OES_standard_derivatives");t.standardDerivatives}const u=new e.Shader(t,a.VERTEX_SHADER,"pbr-vert.glsl");u.initialize(r(8));const s=new e.Shader(t,a.FRAGMENT_SHADER,"pbr-frag.glsl");if(s.initialize(r(9)),this.program=new e.Program(t),this.program.initialize([u,s]),t.isWebGL2)Object.assign(this.attribLocations,n.ATTRIB_LOCATIONS);else for(const t of Object.keys(n.ATTRIB_LOCATIONS)){const n=i(t);this.attribLocations[t]=this.program.attribute(n)}this.uniforms=new o(this.program)}bind(){this.program.bind()}unbind(){this.program.unbind()}uninitialize(){this.program.uninitialize()}}},6:function(t,n){t.exports=function(t){var n={};function r(e){if(n[e])return n[e].exports;var i=n[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=t,r.c=n,r.d=function(t,n,e){r.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:e})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,n){if(1&n&&(t=r(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(r.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var i in t)r.d(e,i,function(n){return t[n]}.bind(null,i));return e},r.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(n,"a",n),n},r.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},r.p="",r(r.s=7)}([function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.LoadingManager=class{constructor(){this.urlModifier=void 0,this.onStart=void 0,this.onProgress=void 0,this.onLoad=void 0,this.onError=void 0,this.isLoading=!1,this.itemsLoaded=0,this.itemsTotal=0}itemStart(t){this.itemsTotal++,!this.isLoading&&this.onStart&&this.onStart(t,this.itemsLoaded,this.itemsTotal),this.isLoading=!0}itemEnd(t){this.itemsLoaded++,this.onProgress&&this.onProgress(t,this.itemsLoaded,this.itemsTotal),this.itemsLoaded===this.itemsTotal&&(this.isLoading=!1,this.onLoad&&this.onLoad())}itemError(t){this.onError&&this.onError(t)}resolveURL(t){return this.urlModifier?this.urlModifier(t):t}}},function(t,n,r){"use strict";var e=this&&this.__awaiter||function(t,n,r,e){return new(r||(r=Promise))(function(i,o){function a(t){try{s(e.next(t))}catch(t){o(t)}}function u(t){try{s(e.throw(t))}catch(t){o(t)}}function s(t){t.done?i(t.value):new r(function(n){n(t.value)}).then(a,u)}s((e=e.apply(t,n||[])).next())})};Object.defineProperty(n,"__esModule",{value:!0});const i=r(3),o=r(0);n.GLTF_COMPONENT_TYPE_ARRAYS={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},n.GLTF_ELEMENTS_PER_TYPE={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},n.GltfAsset=class{constructor(t,n,r,e=new o.LoadingManager){this.gltf=t,this.glbData=r,this.bufferData=new a(this,n,e),this.imageData=new u(this,n,e)}bufferViewData(t){return e(this,void 0,void 0,function*(){if(!this.gltf.bufferViews)throw new Error("No buffer views found.");const n=this.gltf.bufferViews[t],r=yield this.bufferData.get(n.buffer),e=n.byteLength||0,i=n.byteOffset||0,o=r.buffer,a=r.byteOffset;return new Uint8Array(o,a+i,e)})}accessorData(t){return e(this,void 0,void 0,function*(){if(!this.gltf.accessors)throw new Error("No accessors views found.");const r=this.gltf.accessors[t],e=n.GLTF_ELEMENTS_PER_TYPE[r.type];let i;if(void 0!==r.bufferView)i=yield this.bufferViewData(r.bufferView);else{const t=n.GLTF_COMPONENT_TYPE_ARRAYS[r.componentType].BYTES_PER_ELEMENT*e*r.count;i=new Uint8Array(t)}if(r.sparse){const{count:t,indices:o,values:a}=r.sparse;let u=n.GLTF_COMPONENT_TYPE_ARRAYS[o.componentType],s=yield this.bufferViewData(o.bufferView);const c=new u(s.buffer,s.byteOffset+(o.byteOffset||0),t);u=n.GLTF_COMPONENT_TYPE_ARRAYS[r.componentType],s=yield this.bufferViewData(a.bufferView);const f=new u((yield this.bufferViewData(a.bufferView)).buffer,s.byteOffset+(a.byteOffset||0),t*e);r.bufferView&&(i=new Uint8Array(i));const l=new n.GLTF_COMPONENT_TYPE_ARRAYS[r.componentType](i.buffer);for(let n=0;n<t;n++)for(let t=0;t<e;t++)l[e*c[n]+t]=f[e*n+t]}return i})}preFetchAll(){return e(this,void 0,void 0,function*(){return Promise.all([this.bufferData.preFetchAll(),this.imageData.preFetchAll()])})}};class a{constructor(t,n,r){this.bufferCache=[],this.asset=t,this.baseUri=n,this.manager=r,this.loader=new i.FileLoader(r),this.loader.responseType="arraybuffer"}get(t){return e(this,void 0,void 0,function*(){if(void 0!==this.bufferCache[t])return this.bufferCache[t];const n=this.asset.gltf;if(!n.buffers)throw new Error("No buffers found.");const r=n.buffers[t];if(void 0===r.uri){if(0!==t)throw new Error("GLB container is required to be the first buffer");if(void 0===this.asset.glbData)throw new Error("invalid gltf: buffer has no uri nor is there a GLB buffer");return this.asset.glbData.binaryChunk}const e=s(r.uri,this.baseUri),i=yield this.loader.load(e),o=new Uint8Array(i);return this.bufferCache[t]=o,o})}preFetchAll(){return e(this,void 0,void 0,function*(){const t=this.asset.gltf.buffers;return t?Promise.all(t.map((t,n)=>this.get(n))):[]})}}n.BufferData=a;class u{constructor(t,n,r){this.crossOrigin="anonymous",this.imageCache=[],this.asset=t,this.baseUri=n,this.manager=r}get(t){return e(this,void 0,void 0,function*(){if(void 0!==this.imageCache[t])return this.imageCache[t];const n=this.asset.gltf;if(!n.images)throw new Error("No images found.");const r=n.images[t];let e,i=!1;if(void 0!==r.bufferView){const t=yield this.asset.bufferViewData(r.bufferView);i=!0;const n=new Blob([t],{type:r.mimeType});e=URL.createObjectURL(n)}else{if(void 0===r.uri)throw new Error("Invalid glTF: image must either have a `uri` or a `bufferView`");e=this.manager.resolveURL(s(r.uri,this.baseUri))}const o=new Image;return o.crossOrigin=this.crossOrigin,new Promise((n,r)=>{o.onerror=(()=>{r(`Failed to load ${e}`),this.manager.itemEnd(e),this.manager.itemError(e)}),o.onload=(()=>{i&&URL.revokeObjectURL(e),this.imageCache[t]=o,n(o),this.manager.itemEnd(e)}),o.src=e,this.manager.itemStart(e)})})}preFetchAll(){return e(this,void 0,void 0,function*(){const t=this.asset.gltf.images;return t?Promise.all(t.map((t,n)=>this.get(n))):[]})}}function s(t,n){return"string"!=typeof t||""===t?"":/^(https?:)?\/\//i.test(t)?t:/^data:.*,.*$/i.test(t)?t:/^blob:.*$/i.test(t)?t:n+t}n.ImageData=u,n.resolveURL=s},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.LoaderUtils=class{static decodeText(t){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(t);let n="";for(const r of t)n+=String.fromCharCode(r);return decodeURIComponent(escape(n))}static extractUrlBase(t){const n=t.split("/");return 1===n.length?"./":(n.pop(),n.join("/")+"/")}}},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.FileLoader=class{constructor(t){this.runningRequests={},this.manager=t}load(t,n){if(void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t),this.runningRequests[t])return this.runningRequests[t];const r=new Promise((r,e)=>{const i=new XMLHttpRequest;i.open("GET",t,!0);const o=this;i.onload=function(n){const a=this.response;0===this.status?(console.warn("FileLoader: HTTP Status 0 received."),r(a),o.manager.itemEnd(t)):200===this.status?(r(a),o.manager.itemEnd(t)):(e({url:t,status:this.status,statusText:i.statusText}),o.manager.itemEnd(t),o.manager.itemError(t)),delete o.runningRequests[t]},i.onprogress=(t=>{n&&n(t)}),i.onerror=function(n){e({url:t,status:this.status,statusText:i.statusText}),o.manager.itemEnd(t),o.manager.itemError(t),delete o.runningRequests[t]},this.responseType&&(i.responseType=this.responseType),this.withCredentials&&(i.withCredentials=this.withCredentials),this.mimeType&&i.overrideMimeType&&i.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain");for(const t in this.requestHeaders)i.setRequestHeader(t,this.requestHeaders[t]);i.send(null),this.manager.itemStart(t)});return this.runningRequests[t]=r,r}setRequestHeader(t,n){return this.requestHeaders[t]=n,this}}},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0})},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const e=r(2);n.BINARY_HEADER_MAGIC="glTF";const i=1313821514,o=5130562;n.GLTFBinaryData=class{constructor(t){const r=new DataView(t,0,12),a=e.LoaderUtils.decodeText(new Uint8Array(t,0,4)),u=r.getUint32(4,!0);if(r.getUint32(8,!0),a!==n.BINARY_HEADER_MAGIC)throw new Error("Unsupported glTF-Binary header.");if(u<2)throw new Error("Unsupported legacy binary file detected.");const s=new DataView(t,12);let c=0;for(;c<s.byteLength;){const n=s.getUint32(c,!0);c+=4;const r=s.getUint32(c,!0);if(c+=4,r===i){const r=new Uint8Array(t,12+c,n);this.json=e.LoaderUtils.decodeText(r)}else if(r===o){const r=12+c;this.binaryChunk=new Uint8Array(t,r,n)}c+=n}if(null===this.json)throw new Error("glTF-Binary: JSON content not found.")}}},function(t,n,r){"use strict";var e=this&&this.__awaiter||function(t,n,r,e){return new(r||(r=Promise))(function(i,o){function a(t){try{s(e.next(t))}catch(t){o(t)}}function u(t){try{s(e.throw(t))}catch(t){o(t)}}function s(t){t.done?i(t.value):new r(function(n){n(t.value)}).then(a,u)}s((e=e.apply(t,n||[])).next())})};function i(t){for(var r in t)n.hasOwnProperty(r)||(n[r]=t[r])}Object.defineProperty(n,"__esModule",{value:!0});const o=r(3),a=r(5),u=r(1),s=r(2),c=r(0),f=r(4);n.gltf=f,i(r(1)),i(r(0)),n.GltfLoader=class{constructor(t){this.manager=t||new c.LoadingManager}load(t,n){return e(this,void 0,void 0,function*(){const r=s.LoaderUtils.extractUrlBase(t),e=new o.FileLoader(this.manager);e.responseType="arraybuffer";const i=yield e.load(t,n);return yield this.parse(i,r)})}loadFromFiles(t){return e(this,void 0,void 0,function*(){let n,r;for(const[e,i]of t)i.name.match(/\.(gltf|glb)$/)&&(n=i,r=e.replace(i.name,""));if(!n)throw new Error("No .gltf or .glb asset found.");const e="string"==typeof n?n:URL.createObjectURL(n),i=s.LoaderUtils.extractUrlBase(e),o=[];this.manager.urlModifier=(n=>{const e=r+n.replace(i,"").replace(/^(\.?\/)/,"");if(t.has(e)){const n=t.get(e),r=URL.createObjectURL(n);return o.push(r),r}return n});const a=yield this.load(e);return yield a.preFetchAll(),URL.revokeObjectURL(e),o.forEach(URL.revokeObjectURL),a})}parse(t,n){return e(this,void 0,void 0,function*(){let r,e=void 0;r="string"==typeof t?t:s.LoaderUtils.decodeText(new Uint8Array(t,0,4))===a.BINARY_HEADER_MAGIC?(e=new a.GLTFBinaryData(t)).json:s.LoaderUtils.decodeText(new Uint8Array(t));const i=JSON.parse(r);if(void 0===i.asset||i.asset.version[0]<2)throw new Error("Unsupported asset. glTF versions >=2.0 are supported.");return new u.GltfAsset(i,n,e,this.manager)})}}},function(t,n,r){t.exports=r(6)}])},61:function(t,n,r){r(2),t.exports=r(62)},62:function(t,n,r){"use strict";var e=this&&this.__awaiter||function(t,n,r,e){return new(r||(r=Promise))(function(i,o){function a(t){try{s(e.next(t))}catch(t){o(t)}}function u(t){try{s(e.throw(t))}catch(t){o(t)}}function s(t){t.done?i(t.value):new r(function(n){n(t.value)}).then(a,u)}s((e=e.apply(t,n||[])).next())})};Object.defineProperty(n,"__esModule",{value:!0});const i=r(6),o=r(0),a=r(0),u=r(7),s=r(63);function c(t,n){return e(this,void 0,void 0,function*(){console.time("asset.getScene");const r=yield new u.Asset(t,n.context).getScene();console.timeEnd("asset.getScene"),n.scene=r})}let f;function l(t){const n=new RegExp(`${t}=([^&]+)`),r=document.location.search.match(n);if(r)return r[1]}const d="https://raw.githubusercontent.com/immersive-web/webxr-samples/master/media/",h=d+"gltf/space/space.gltf";let m;function v(t){if(m=new s.WebXRRenderer,t.renderer=m,f)c(f,m);else{!function(t,n,r){e(this,void 0,void 0,function*(){try{console.time("GltfLoader.load"),f=yield t.load(n),console.timeEnd("GltfLoader.load"),console.time("asset.preFetchAll"),yield f.preFetchAll(),console.timeEnd("asset.preFetchAll"),c(f,r)}catch(t){if(console.error(t),"string"==typeof t)alert(t);else{const n=t.status?` (${t.status} ${t.statusText} ${t.url})`:"";alert("Error loading glTF"+n)}}})}(new i.GltfLoader,h,m)}}function p(){v(new o.Canvas("example-canvas",{depth:!0}))}function M(){return e(this,void 0,void 0,function*(){if("1"===(l("allowPolyfill")||"1")){new WebXRPolyfill}new WebXRVersionShim;const t=document.getElementById("message");function n(n,r="red"){t.innerHTML=n,t.style.color=r}const r=document.getElementById("xr-button");let i;function u(){return e(this,void 0,void 0,function*(){try{return yield i.requestDevice(),!0}catch(t){return console.error(t),n(t.message),p(),!1}})}if(!a.XRController.supportsXR())return n("Your browser does not support WebXR."),void p();const s=l("mode")||"magic-window";if("present"===s){if(i=new o.XRController({immersive:!0}),!(yield u()))return}else if("mirror"===s){if(i=new o.XRController({immersive:!0}),!(yield u()))return;const t=document.getElementById("example-canvas").getContext("xrpresent");i.sessionCreationOptions.outputContext=t}else{if("magic-window"!==s)throw new Error("invalid mode");{if(i=new o.XRController({immersive:!1}),!(yield u()))return;const t=document.getElementById("example-canvas").getContext("xrpresent");i.sessionCreationOptions.outputContext=t,yield i.requestSession(),v(i.canvas),i.sessionCreationOptions.immersive=!0}}(yield i.supportsSession())||n("immersive session not supported."),n("Ready.","green"),r.disabled=!1,r.onclick=(()=>e(this,void 0,void 0,function*(){i.session&&i.session.immersive?(yield i.endSession(),n("Ready.","green"),r.innerHTML="Enter XR"):(n("Requesting session...","black"),yield i.requestSession(),n("Session active.","green"),r.innerHTML="Exit XR",v(i.canvas),i.session.addEventListener("end",()=>{n("Ready.","green"),r.innerHTML="Enter XR"}))})),window.xrcontroller=i})}"complete"===window.document.readyState?M():window.onload=M},63:function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const e=r(1),i=r(0),o=r(5);n.WebXRRenderer=class extends i.XRRenderer{constructor(){super(...arguments),this.frameCount=0}set scene(t){this._scene&&this._scene.uninitialize(),this._scene=t,this.setCameraFromBounds(),this.invalidate(!0)}get context(){return this._context}onInitialize(t,n,r){const a=this._context.gl;return this.pbrShader=new o.PbrShader(t),this._camera=new i.Camera,this._camera.center=e.vec3.fromValues(0,0,0),this._camera.up=e.vec3.fromValues(0,1,0),this._camera.eye=e.vec3.fromValues(0,0,3),this._camera.near=.1,this._camera.far=20,this._navigation=new i.Navigation(n,r),this._navigation.camera=this._camera,a.enable(a.DEPTH_TEST),a.clearColor(0,0,0,1),!0}onUninitialize(){this._scene.uninitialize(),this.pbrShader.uninitialize()}onUpdate(){const t=this.context.gl;this._altered.frameSize&&(this._camera.viewport=[this._frameSize[0],this._frameSize[1]],t.viewport(0,0,this._frameSize[0],this._frameSize[1])),this._altered.canvasSize&&(this._camera.aspect=this._canvasSize[0]/this._canvasSize[1]),this._navigation.update();const n=this._altered.any||this._camera.altered;return this._altered.reset(),this._camera.altered=!1,n}onFrame(t){const n=this._context.gl;n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT),this.pbrShader.bind(),n.uniformMatrix4fv(this.pbrShader.uniforms.u_ViewProjection,!1,this._camera.viewProjection),n.uniform3fv(this.pbrShader.uniforms.u_Camera,this._camera.eye),this._scene&&this._scene.draw(this.pbrShader),this.pbrShader.unbind(),++this.frameCount}onXRFrame(t){const n=this._context.gl;if(n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT),!this._scene)return;this.pbrShader.bind();const r=t.renderViews;if(1===r.length){const t=r[0],e=t.viewport;n.viewport(e.x,e.y,e.width,e.height),n.uniformMatrix4fv(this.pbrShader.uniforms.u_ViewProjection,!1,t.viewProjectionMatrix),n.uniform3fv(this.pbrShader.uniforms.u_Camera,t.cameraPosition),this._scene.draw(this.pbrShader)}else this._scene.draw(this.pbrShader,r);this.pbrShader.unbind(),++this.frameCount}setCameraFromBounds(){const t=this._scene.bounds,n=e.vec3.len(t.size),r=t.center;this._camera.eye=e.vec3.fromValues(r[0]+n/1.5,r[1]+n/5,r[2]+n/1.5),this._camera.center=r,this._camera.far=20*n,this._camera.near=n/100}}},7:function(t,n,r){"use strict";var e=this&&this.__awaiter||function(t,n,r,e){return new(r||(r=Promise))(function(i,o){function a(t){try{s(e.next(t))}catch(t){o(t)}}function u(t){try{s(e.throw(t))}catch(t){o(t)}}function s(t){t.done?i(t.value):new r(function(n){n(t.value)}).then(a,u)}s((e=e.apply(t,n||[])).next())})};Object.defineProperty(n,"__esModule",{value:!0});const i=r(4),o=r(10),a=r(12);n.Asset=class{constructor(t,n){this.scenes=[],this.meshes=[],this.materials=[],this.textures=[],this.gAsset=t,this.context=n}getScene(t){return e(this,void 0,void 0,function*(){if(t=void 0!==t?t:this.gAsset.gltf.scene||0,this.scenes[t])return this.scenes[t];const n=this.gAsset.gltf.scenes[t];return this.scenes[t]=yield a.Scene.fromGltf(n,this),this.scenes[t]})}getMesh(t){return e(this,void 0,void 0,function*(){return this.meshes[t]?this.meshes[t]:(this.meshes[t]=yield o.Mesh.fromGltf(t,this),this.meshes[t])})}getMaterial(t){return e(this,void 0,void 0,function*(){return this.materials[t]?this.materials[t]:(this.materials[t]=yield i.Material.fromGltf(t,this),this.materials[t])})}}},8:function(t,n){t.exports="// Originally taken from https://github.com/KhronosGroup/glTF-WebGL-PBR\r\n// Commit c28b5b8f5a83380857ad8395ac5302594ecc13ae\r\n\r\n\r\n#if __VERSION__ == 100\r\n#else \r\n    #define varying out\r\n#endif\r\n\r\n\r\n#if __VERSION__ == 100\r\n  attribute vec4 a_position;\r\n  attribute vec4 a_normal;\r\n  attribute vec4 a_tangent;\r\n  attribute vec2 a_texcoord_0;\r\n  attribute vec2 a_texcoord_1;\r\n  attribute vec4 a_color;\r\n#else\r\n    layout (location = 0) in vec4 a_position;\r\n    layout (location = 1) in vec3 a_normal;\r\n    layout (location = 2) in vec4 a_tangent;\r\n    layout (location = 3) in vec2 a_texcoord_0;\r\n    layout (location = 4) in vec2 a_texcoord_1;\r\n    layout (location = 5) in vec4 a_color;\r\n#endif\r\n\r\n// TODO!!!: WebGL1 support (int/bit operators...)\r\n// vertex shader + fragment shader\r\nconst int HAS_NORMALS           = 1;\r\nconst int HAS_TANGENTS          = 1 << 1;\r\nconst int HAS_UV                = 1 << 2;\r\nconst int HAS_COLORS            = 1 << 3;\r\n\r\nuniform mediump int u_PbrFlags;\r\nuniform mat4 u_ModelMatrix;\r\nuniform mat4 u_ViewProjection;\r\nuniform mat3 u_NormalMatrix;\r\n\r\nvarying vec3 v_Position;\r\nvarying vec2 v_UV[2];\r\nvarying vec4 v_Color;\r\n\r\nvarying mat3 v_TBN;\r\nvarying vec3 v_Normal;\r\n\r\nbool checkFlag(int flag) {\r\n    return (u_PbrFlags & flag) == flag;\r\n}\r\n\r\nvoid main()\r\n{\r\n  vec4 pos = u_ModelMatrix * a_position;\r\n  v_Position = vec3(pos.xyz) / pos.w;\r\n\r\n  if (checkFlag(HAS_NORMALS)) {\r\n  if (checkFlag(HAS_TANGENTS)) {\r\n  vec3 normalW = normalize(vec3(u_NormalMatrix * a_normal));\r\n  vec3 tangentW = normalize(vec3(u_ModelMatrix * vec4(a_tangent.xyz, 0.0)));\r\n  vec3 bitangentW = cross(normalW, tangentW) * a_tangent.w;\r\n  v_TBN = mat3(tangentW, bitangentW, normalW);\r\n  } else { // HAS_TANGENTS != 1\r\n  v_Normal = normalize(vec3(u_ModelMatrix * vec4(a_normal.xyz, 0.0)));\r\n  }\r\n  }\r\n\r\n  if (checkFlag(HAS_UV)) {\r\n    v_UV[0] = a_texcoord_0;\r\n    v_UV[1] = a_texcoord_1;\r\n  }\r\n  else {\r\n    v_UV[0] = vec2(0., 0.);\r\n    v_UV[1] = vec2(0., 0.);\r\n  }\r\n\r\n  if (checkFlag(HAS_COLORS))\r\n  v_Color = a_color;\r\n  else\r\n  v_Color = vec4(1.0);\r\n\r\n  gl_Position = u_ViewProjection * u_ModelMatrix * a_position; // needs w for proper perspective correction\r\n}\r\n\r\n\r\n"},9:function(t,n){t.exports="// Originally taken from https://github.com/KhronosGroup/glTF-WebGL-PBR\r\n// Commit c28b5b8f5a83380857ad8395ac5302594ecc13ae\r\n//\r\n// This fragment shader defines a reference implementation for Physically Based Shading of\r\n// a microfacet surface material defined by a glTF model.\r\n//\r\n// References:\r\n// [1] Real Shading in Unreal Engine 4\r\n//     http://blog.selfshadow.com/publications/s2013-shading-course/karis/s2013_pbs_epic_notes_v2.pdf\r\n// [2] Physically Based Shading at Disney\r\n//     http://blog.selfshadow.com/publications/s2012-shading-course/burley/s2012_pbs_disney_brdf_notes_v3.pdf\r\n// [3] README.md - Environment Maps\r\n//     https://github.com/KhronosGroup/glTF-WebGL-PBR/#environment-maps\r\n// [4] \"An Inexpensive BRDF Model for Physically based Rendering\" by Christophe Schlick\r\n//     https://www.cs.virginia.edu/~jdl/bib/appearance/analytic%20models/schlick94b.pdf\r\n\r\nprecision highp float;\r\n\r\n#if __VERSION__ == 100\r\n    #extension GL_EXT_shader_texture_lod: enable\r\n    #extension GL_OES_standard_derivatives : enable\r\n    #define fragColor gl_FragColor\r\n    #define texture( texture2D(\r\n#else\r\n    #define varying in\r\n    layout(location = 0) out vec4 fragColor;\r\n#endif\r\n\r\n// vertex shader + fragment shader\r\nconst int HAS_NORMALS           = 1;\r\nconst int HAS_TANGENTS          = 1 << 1;\r\nconst int HAS_UV                = 1 << 2;\r\nconst int HAS_COLORS            = 1 << 3;\r\n\r\n// fragment shader only\r\nconst int USE_IBL               = 1 << 4;\r\nconst int HAS_BASECOLORMAP      = 1 << 5;\r\nconst int HAS_NORMALMAP         = 1 << 6;\r\nconst int HAS_EMISSIVEMAP       = 1 << 7;\r\nconst int HAS_METALROUGHNESSMAP = 1 << 8;\r\nconst int HAS_OCCLUSIONMAP      = 1 << 9;\r\nconst int USE_TEX_LOD           = 1 << 10;\r\n\r\nuniform vec3 u_LightDirection;\r\nuniform vec3 u_LightColor;\r\n\r\n// TODO!: ambient light or only IBL? (see gltf-viewer)\r\n\r\n#ifdef USE_IBL\r\nuniform samplerCube u_DiffuseEnvSampler;\r\nuniform samplerCube u_SpecularEnvSampler;\r\nuniform sampler2D u_brdfLUT;\r\n#endif\r\n\r\nuniform mediump int u_PbrFlags;\r\n\r\nuniform sampler2D u_BaseColorSampler;\r\nuniform lowp int u_BaseColorTexCoord;\r\n\r\nuniform sampler2D u_NormalSampler;\r\nuniform lowp int u_NormalTexCoord;\r\nuniform float u_NormalScale;\r\n\r\nuniform sampler2D u_EmissiveSampler;\r\nuniform lowp int u_EmissiveTexCoord;\r\nuniform vec3 u_EmissiveFactor;\r\n\r\nuniform sampler2D u_MetallicRoughnessSampler;\r\nuniform lowp int u_MetallicRoughnessTexCoord;\r\nuniform sampler2D u_OcclusionSampler;\r\nuniform lowp int u_OcclusionTexCoord;\r\nuniform float u_OcclusionStrength;\r\n\r\nuniform vec2 u_MetallicRoughnessValues;\r\nuniform vec4 u_BaseColorFactor;\r\n\r\nuniform vec3 u_Camera;\r\n\r\nuniform float u_AlphaBlend;\r\nuniform float u_AlphaCutoff;\r\n\r\n// // debugging flags used for shader output of intermediate PBR variables\r\n// uniform vec4 u_ScaleDiffBaseMR;\r\n// uniform vec4 u_ScaleFGDSpec;\r\n// uniform vec4 u_ScaleIBLAmbient;\r\n\r\nvarying vec3 v_Position;\r\nvarying vec2 v_UV[2];\r\nvarying vec4 v_Color;\r\nvarying mat3 v_TBN;\r\nvarying vec3 v_Normal;\r\n\r\n// Encapsulate the various inputs used by the various functions in the shading equation\r\n// We store values in this struct to simplify the integration of alternative implementations\r\n// of the shading terms, outlined in the Readme.MD Appendix.\r\nstruct PBRInfo\r\n{\r\n    float NdotL;                  // cos angle between normal and light direction\r\n    float NdotV;                  // cos angle between normal and view direction\r\n    float NdotH;                  // cos angle between normal and half vector\r\n    float LdotH;                  // cos angle between light direction and half vector\r\n    float VdotH;                  // cos angle between view direction and half vector\r\n    float perceptualRoughness;    // roughness value, as authored by the model creator (input to shader)\r\n    float metalness;              // metallic value at the surface\r\n    vec3 reflectance0;            // full reflectance color (normal incidence angle)\r\n    vec3 reflectance90;           // reflectance color at grazing angle\r\n    float alphaRoughness;         // roughness mapped to a more linear change in the roughness (proposed by [2])\r\n    vec3 diffuseColor;            // color contribution from diffuse lighting\r\n    vec3 specularColor;           // color contribution from specular lighting\r\n};\r\n\r\nconst float M_PI = 3.141592653589793;\r\nconst float c_MinRoughness = 0.04;\r\n\r\nvec4 SRGBtoLINEAR(vec4 srgbIn)\r\n{\r\n    #ifdef MANUAL_SRGB\r\n    #ifdef SRGB_FAST_APPROXIMATION\r\n    vec3 linOut = pow(srgbIn.xyz,vec3(2.2));\r\n    #else //SRGB_FAST_APPROXIMATION\r\n    vec3 bLess = step(vec3(0.04045),srgbIn.xyz);\r\n    vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );\r\n    #endif //SRGB_FAST_APPROXIMATION\r\n    return vec4(linOut,srgbIn.w);;\r\n    #else //MANUAL_SRGB\r\n    return srgbIn;\r\n    #endif //MANUAL_SRGB\r\n}\r\n\r\nbool checkFlag(int flag) {\r\n    return (u_PbrFlags & flag) == flag;\r\n}\r\n\r\n// Find the normal for this fragment, pulling either from a predefined normal map\r\n// or from the interpolated mesh normal and tangent attributes.\r\nvec3 getNormal()\r\n{\r\n    // Retrieve the tangent space matrix\r\n    mat3 tbn;\r\nif (!checkFlag(HAS_TANGENTS)) {\r\n    vec3 pos_dx = dFdx(v_Position);\r\n    vec3 pos_dy = dFdy(v_Position);\r\n    vec3 tex_dx = dFdx(vec3(v_UV[0], 0.0));\r\n    vec3 tex_dy = dFdy(vec3(v_UV[0], 0.0));\r\n    vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\r\n\r\n    vec3 ng;\r\nif (checkFlag(HAS_NORMALS))\r\n    ng = normalize(v_Normal);\r\nelse\r\n    ng = cross(pos_dx, pos_dy);\r\n\r\n    t = normalize(t - ng * dot(ng, t));\r\n    vec3 b = normalize(cross(ng, t));\r\n    tbn = mat3(t, b, ng);\r\n} else { // HAS_TANGENTS\r\n    tbn = v_TBN;\r\n}\r\n\r\n    vec3 n;\r\nif (checkFlag(HAS_NORMALMAP)) {\r\n    n = texture(u_NormalSampler, v_UV[u_NormalTexCoord]).rgb;\r\n    n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_NormalScale, u_NormalScale, 1.0)));\r\n} else {\r\n    // The tbn matrix is linearly interpolated, so we need to re-normalize\r\n    n = normalize(tbn[2].xyz);\r\n}\r\n\r\n    // reverse backface normals\r\n    n *= (2.0 * float(gl_FrontFacing) - 1.0);\r\n\r\n    return n;\r\n}\r\n\r\n#ifdef USE_IBL\r\n// Calculation of the lighting contribution from an optional Image Based Light source.\r\n// Precomputed Environment Maps are required uniform inputs and are computed as outlined in [1].\r\n// See our README.md on Environment Maps [3] for additional discussion.\r\nvec3 getIBLContribution(PBRInfo pbrInputs, vec3 n, vec3 reflection)\r\n{\r\n    float mipCount = 9.0; // resolution of 512x512\r\n    float lod = (pbrInputs.perceptualRoughness * mipCount);\r\n    // retrieve a scale and bias to F0. See [1], Figure 3\r\n    vec3 brdf = SRGBtoLINEAR(texture(u_brdfLUT, vec2(pbrInputs.NdotV, 1.0 - pbrInputs.perceptualRoughness))).rgb;\r\n    vec3 diffuseLight = SRGBtoLINEAR(textureCube(u_DiffuseEnvSampler, n)).rgb;\r\n\r\n#ifdef USE_TEX_LOD\r\n    vec3 specularLight = SRGBtoLINEAR(textureCubeLodEXT(u_SpecularEnvSampler, reflection, lod)).rgb;\r\n#else\r\n    vec3 specularLight = SRGBtoLINEAR(textureCube(u_SpecularEnvSampler, reflection)).rgb;\r\n#endif\r\n\r\n    vec3 diffuse = diffuseLight * pbrInputs.diffuseColor;\r\n    vec3 specular = specularLight * (pbrInputs.specularColor * brdf.x + brdf.y);\r\n\r\n    // For presentation, this allows us to disable IBL terms\r\n    diffuse *= u_ScaleIBLAmbient.x;\r\n    specular *= u_ScaleIBLAmbient.y;\r\n\r\n    return diffuse + specular;\r\n}\r\n#endif\r\n\r\n// Basic Lambertian diffuse\r\n// Implementation from Lambert's Photometria https://archive.org/details/lambertsphotome00lambgoog\r\n// See also [1], Equation 1\r\nvec3 diffuse(PBRInfo pbrInputs)\r\n{\r\n    return pbrInputs.diffuseColor / M_PI;\r\n}\r\n\r\n// The following equation models the Fresnel reflectance term of the spec equation (aka F())\r\n// Implementation of fresnel from [4], Equation 15\r\nvec3 specularReflection(PBRInfo pbrInputs)\r\n{\r\n    return pbrInputs.reflectance0 + (pbrInputs.reflectance90 - pbrInputs.reflectance0) * pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);\r\n}\r\n\r\n// This calculates the specular geometric attenuation (aka G()),\r\n// where rougher material will reflect less light back to the viewer.\r\n// This implementation is based on [1] Equation 4, and we adopt their modifications to\r\n// alphaRoughness as input as originally proposed in [2].\r\nfloat geometricOcclusion(PBRInfo pbrInputs)\r\n{\r\n    float NdotL = pbrInputs.NdotL;\r\n    float NdotV = pbrInputs.NdotV;\r\n    float r = pbrInputs.alphaRoughness;\r\n\r\n    float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));\r\n    float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));\r\n    return attenuationL * attenuationV;\r\n}\r\n\r\n// The following equation(s) model the distribution of microfacet normals across the area being drawn (aka D())\r\n// Implementation from \"Average Irregularity Representation of a Roughened Surface for Ray Reflection\" by T. S. Trowbridge, and K. P. Reitz\r\n// Follows the distribution function recommended in the SIGGRAPH 2013 course notes from EPIC Games [1], Equation 3.\r\nfloat microfacetDistribution(PBRInfo pbrInputs)\r\n{\r\n    float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;\r\n    float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;\r\n    return roughnessSq / (M_PI * f * f);\r\n}\r\n\r\nvoid main()\r\n{\r\n    // Metallic and Roughness material properties are packed together\r\n    // In glTF, these factors can be specified by fixed scalar values\r\n    // or from a metallic-roughness map\r\n    float perceptualRoughness = u_MetallicRoughnessValues.y;\r\n    float metallic = u_MetallicRoughnessValues.x;\r\nif (checkFlag(HAS_METALROUGHNESSMAP)) {\r\n    // Roughness is stored in the 'g' channel, metallic is stored in the 'b' channel.\r\n    // This layout intentionally reserves the 'r' channel for (optional) occlusion map data\r\n    vec4 mrSample = texture(u_MetallicRoughnessSampler, v_UV[u_MetallicRoughnessTexCoord]);\r\n    perceptualRoughness = mrSample.g * perceptualRoughness;\r\n    metallic = mrSample.b * metallic;\r\n}\r\n    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);\r\n    metallic = clamp(metallic, 0.0, 1.0);\r\n    // Roughness is authored as perceptual roughness; as is convention,\r\n    // convert to material roughness by squaring the perceptual roughness [2].\r\n    float alphaRoughness = perceptualRoughness * perceptualRoughness;\r\n\r\n    // The albedo may be defined from a base texture or a flat color\r\n    vec4 baseColor;\r\nif (checkFlag(HAS_BASECOLORMAP))\r\n    baseColor = SRGBtoLINEAR(texture(u_BaseColorSampler, v_UV[u_BaseColorTexCoord])) * u_BaseColorFactor;\r\nelse\r\n    baseColor = u_BaseColorFactor;\r\n\r\n    // spec: COLOR_0 ... acts as an additional linear multiplier to baseColor\r\n    // TODO!: distinguish vec3/vec4 colors...\r\n    baseColor *= vec4(v_Color.rgb, 1.0);\r\n\r\n    vec3 f0 = vec3(0.04);\r\n    vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);\r\n    diffuseColor *= 1.0 - metallic;\r\n    vec3 specularColor = mix(f0, baseColor.rgb, metallic);\r\n\r\n    // Compute reflectance.\r\n    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\r\n\r\n    // For typical incident reflectance range (between 4% to 100%) set the grazing reflectance to 100% for typical fresnel effect.\r\n    // For very low reflectance range on highly diffuse objects (below 4%), incrementally reduce grazing reflecance to 0%.\r\n    float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);\r\n    vec3 specularEnvironmentR0 = specularColor.rgb;\r\n    vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;\r\n\r\n    vec3 n = getNormal();                             // normal at surface point\r\n    vec3 v = normalize(u_Camera - v_Position);        // Vector from surface point to camera\r\n    vec3 l = normalize(u_LightDirection);             // Vector from surface point to light\r\n    vec3 h = normalize(l+v);                          // Half vector between both l and v\r\n    vec3 reflection = -normalize(reflect(v, n));\r\n\r\n    float NdotL = clamp(dot(n, l), 0.001, 1.0);\r\n    float NdotV = abs(dot(n, v)) + 0.001;\r\n    float NdotH = clamp(dot(n, h), 0.0, 1.0);\r\n    float LdotH = clamp(dot(l, h), 0.0, 1.0);\r\n    float VdotH = clamp(dot(v, h), 0.0, 1.0);\r\n\r\n    PBRInfo pbrInputs = PBRInfo(\r\n        NdotL,\r\n        NdotV,\r\n        NdotH,\r\n        LdotH,\r\n        VdotH,\r\n        perceptualRoughness,\r\n        metallic,\r\n        specularEnvironmentR0,\r\n        specularEnvironmentR90,\r\n        alphaRoughness,\r\n        diffuseColor,\r\n        specularColor\r\n    );\r\n\r\n    // Calculate the shading terms for the microfacet specular shading model\r\n    vec3 F = specularReflection(pbrInputs);\r\n    float G = geometricOcclusion(pbrInputs);\r\n    float D = microfacetDistribution(pbrInputs);\r\n\r\n    // Calculation of analytical lighting contribution\r\n    vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);\r\n    vec3 specContrib = F * G * D / (4.0 * NdotL * NdotV);\r\n    // Obtain final intensity as reflectance (BRDF) scaled by the energy of the light (cosine law)\r\n    vec3 color = NdotL * u_LightColor * (diffuseContrib + specContrib);\r\n\r\n    // Calculate lighting contribution from image based lighting source (IBL)\r\n#ifdef USE_IBL\r\n    color += getIBLContribution(pbrInputs, n, reflection);\r\n#endif\r\n\r\n    // Apply optional PBR terms for additional (optional) shading\r\nif (checkFlag(HAS_OCCLUSIONMAP)) {\r\n    float ao = texture(u_OcclusionSampler, v_UV[u_OcclusionTexCoord]).r;\r\n    color = mix(color, color * ao, u_OcclusionStrength);\r\n}\r\n\r\nif (checkFlag(HAS_EMISSIVEMAP)) {\r\n    vec3 emissive = SRGBtoLINEAR(texture(u_EmissiveSampler, v_UV[u_EmissiveTexCoord])).rgb * u_EmissiveFactor;\r\n    color += emissive;\r\n}\r\n\r\n    // // This section uses mix to override final color for reference app visualization\r\n    // // of various parameters in the lighting equation.\r\n    // color = mix(color, F, u_ScaleFGDSpec.x);\r\n    // color = mix(color, vec3(G), u_ScaleFGDSpec.y);\r\n    // color = mix(color, vec3(D), u_ScaleFGDSpec.z);\r\n    // color = mix(color, specContrib, u_ScaleFGDSpec.w);\r\n\r\n    // color = mix(color, diffuseContrib, u_ScaleDiffBaseMR.x);\r\n    // color = mix(color, baseColor.rgb, u_ScaleDiffBaseMR.y);\r\n    // color = mix(color, vec3(metallic), u_ScaleDiffBaseMR.z);\r\n    // color = mix(color, vec3(perceptualRoughness), u_ScaleDiffBaseMR.w);\r\n\r\n    // NOTE: the spec mandates to ignore any alpha value in 'OPAQUE' mode\r\n    float alpha = mix(1.0, baseColor.a, u_AlphaBlend);\r\n    if (u_AlphaCutoff > 0.0) {\r\n        alpha = step(u_AlphaCutoff, baseColor.a);\r\n    }\r\n    fragColor = vec4(pow(color,vec3(1.0/2.2)), alpha);\r\n}\r\n"}})});
//# sourceMappingURL=webxr.js.map