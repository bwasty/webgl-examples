!function(t,n){if("object"==typeof exports&&"object"==typeof module)module.exports=n(require("gloperate"));else if("function"==typeof define&&define.amd)define(["gloperate"],n);else{var e="object"==typeof exports?n(require("gloperate")):n(t.gloperate);for(var r in e)("object"==typeof exports?exports:t)[r]=e[r]}}(window,function(t){return function(t){var n={};function e(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=19)}([function(n,e){n.exports=t},function(t,n,e){"use strict";e.r(n);var r={};e.d(r,"EPSILON",function(){return d}),e.d(r,"ARRAY_TYPE",function(){return m}),e.d(r,"RANDOM",function(){return p}),e.d(r,"setMatrixArrayType",function(){return M}),e.d(r,"toRadian",function(){return v}),e.d(r,"equals",function(){return g});var i={};e.d(i,"create",function(){return _}),e.d(i,"clone",function(){return x}),e.d(i,"copy",function(){return S}),e.d(i,"identity",function(){return y}),e.d(i,"fromValues",function(){return A}),e.d(i,"set",function(){return T}),e.d(i,"transpose",function(){return w}),e.d(i,"invert",function(){return R}),e.d(i,"adjoint",function(){return E}),e.d(i,"determinant",function(){return L}),e.d(i,"multiply",function(){return C}),e.d(i,"rotate",function(){return O}),e.d(i,"scale",function(){return P}),e.d(i,"fromRotation",function(){return N}),e.d(i,"fromScaling",function(){return I}),e.d(i,"str",function(){return F}),e.d(i,"frob",function(){return B}),e.d(i,"LDU",function(){return U}),e.d(i,"add",function(){return V}),e.d(i,"subtract",function(){return D}),e.d(i,"exactEquals",function(){return q}),e.d(i,"equals",function(){return H}),e.d(i,"multiplyScalar",function(){return G}),e.d(i,"multiplyScalarAndAdd",function(){return z}),e.d(i,"mul",function(){return j}),e.d(i,"sub",function(){return k});var o={};e.d(o,"create",function(){return X}),e.d(o,"clone",function(){return Y}),e.d(o,"copy",function(){return W}),e.d(o,"identity",function(){return $}),e.d(o,"fromValues",function(){return Q}),e.d(o,"set",function(){return K}),e.d(o,"invert",function(){return Z}),e.d(o,"determinant",function(){return J}),e.d(o,"multiply",function(){return tt}),e.d(o,"rotate",function(){return nt}),e.d(o,"scale",function(){return et}),e.d(o,"translate",function(){return rt}),e.d(o,"fromRotation",function(){return it}),e.d(o,"fromScaling",function(){return ot}),e.d(o,"fromTranslation",function(){return at}),e.d(o,"str",function(){return ut}),e.d(o,"frob",function(){return st}),e.d(o,"add",function(){return ct}),e.d(o,"subtract",function(){return lt}),e.d(o,"multiplyScalar",function(){return ft}),e.d(o,"multiplyScalarAndAdd",function(){return ht}),e.d(o,"exactEquals",function(){return dt}),e.d(o,"equals",function(){return mt}),e.d(o,"mul",function(){return pt}),e.d(o,"sub",function(){return Mt});var a={};e.d(a,"create",function(){return bt}),e.d(a,"fromMat4",function(){return vt}),e.d(a,"clone",function(){return gt}),e.d(a,"copy",function(){return _t}),e.d(a,"fromValues",function(){return xt}),e.d(a,"set",function(){return St}),e.d(a,"identity",function(){return yt}),e.d(a,"transpose",function(){return At}),e.d(a,"invert",function(){return Tt}),e.d(a,"adjoint",function(){return wt}),e.d(a,"determinant",function(){return Rt}),e.d(a,"multiply",function(){return Et}),e.d(a,"translate",function(){return Lt}),e.d(a,"rotate",function(){return Ct}),e.d(a,"scale",function(){return Ot}),e.d(a,"fromTranslation",function(){return Pt}),e.d(a,"fromRotation",function(){return Nt}),e.d(a,"fromScaling",function(){return It}),e.d(a,"fromMat2d",function(){return Ft}),e.d(a,"fromQuat",function(){return Bt}),e.d(a,"normalFromMat4",function(){return Ut}),e.d(a,"projection",function(){return Vt}),e.d(a,"str",function(){return Dt}),e.d(a,"frob",function(){return qt}),e.d(a,"add",function(){return Ht}),e.d(a,"subtract",function(){return Gt}),e.d(a,"multiplyScalar",function(){return zt}),e.d(a,"multiplyScalarAndAdd",function(){return jt}),e.d(a,"exactEquals",function(){return kt}),e.d(a,"equals",function(){return Xt}),e.d(a,"mul",function(){return Yt}),e.d(a,"sub",function(){return Wt});var u={};e.d(u,"create",function(){return $t}),e.d(u,"clone",function(){return Qt}),e.d(u,"copy",function(){return Kt}),e.d(u,"fromValues",function(){return Zt}),e.d(u,"set",function(){return Jt}),e.d(u,"identity",function(){return tn}),e.d(u,"transpose",function(){return nn}),e.d(u,"invert",function(){return en}),e.d(u,"adjoint",function(){return rn}),e.d(u,"determinant",function(){return on}),e.d(u,"multiply",function(){return an}),e.d(u,"translate",function(){return un}),e.d(u,"scale",function(){return sn}),e.d(u,"rotate",function(){return cn}),e.d(u,"rotateX",function(){return ln}),e.d(u,"rotateY",function(){return fn}),e.d(u,"rotateZ",function(){return hn}),e.d(u,"fromTranslation",function(){return dn}),e.d(u,"fromScaling",function(){return mn}),e.d(u,"fromRotation",function(){return pn}),e.d(u,"fromXRotation",function(){return Mn}),e.d(u,"fromYRotation",function(){return bn}),e.d(u,"fromZRotation",function(){return vn}),e.d(u,"fromRotationTranslation",function(){return gn}),e.d(u,"fromQuat2",function(){return _n}),e.d(u,"getTranslation",function(){return xn}),e.d(u,"getScaling",function(){return Sn}),e.d(u,"getRotation",function(){return yn}),e.d(u,"fromRotationTranslationScale",function(){return An}),e.d(u,"fromRotationTranslationScaleOrigin",function(){return Tn}),e.d(u,"fromQuat",function(){return wn}),e.d(u,"frustum",function(){return Rn}),e.d(u,"perspective",function(){return En}),e.d(u,"perspectiveFromFieldOfView",function(){return Ln}),e.d(u,"ortho",function(){return Cn}),e.d(u,"lookAt",function(){return On}),e.d(u,"targetTo",function(){return Pn}),e.d(u,"str",function(){return Nn}),e.d(u,"frob",function(){return In}),e.d(u,"add",function(){return Fn}),e.d(u,"subtract",function(){return Bn}),e.d(u,"multiplyScalar",function(){return Un}),e.d(u,"multiplyScalarAndAdd",function(){return Vn}),e.d(u,"exactEquals",function(){return Dn}),e.d(u,"equals",function(){return qn}),e.d(u,"mul",function(){return Hn}),e.d(u,"sub",function(){return Gn});var s={};e.d(s,"create",function(){return zn}),e.d(s,"clone",function(){return jn}),e.d(s,"length",function(){return kn}),e.d(s,"fromValues",function(){return Xn}),e.d(s,"copy",function(){return Yn}),e.d(s,"set",function(){return Wn}),e.d(s,"add",function(){return $n}),e.d(s,"subtract",function(){return Qn}),e.d(s,"multiply",function(){return Kn}),e.d(s,"divide",function(){return Zn}),e.d(s,"ceil",function(){return Jn}),e.d(s,"floor",function(){return te}),e.d(s,"min",function(){return ne}),e.d(s,"max",function(){return ee}),e.d(s,"round",function(){return re}),e.d(s,"scale",function(){return ie}),e.d(s,"scaleAndAdd",function(){return oe}),e.d(s,"distance",function(){return ae}),e.d(s,"squaredDistance",function(){return ue}),e.d(s,"squaredLength",function(){return se}),e.d(s,"negate",function(){return ce}),e.d(s,"inverse",function(){return le}),e.d(s,"normalize",function(){return fe}),e.d(s,"dot",function(){return he}),e.d(s,"cross",function(){return de}),e.d(s,"lerp",function(){return me}),e.d(s,"hermite",function(){return pe}),e.d(s,"bezier",function(){return Me}),e.d(s,"random",function(){return be}),e.d(s,"transformMat4",function(){return ve}),e.d(s,"transformMat3",function(){return ge}),e.d(s,"transformQuat",function(){return _e}),e.d(s,"rotateX",function(){return xe}),e.d(s,"rotateY",function(){return Se}),e.d(s,"rotateZ",function(){return ye}),e.d(s,"angle",function(){return Ae}),e.d(s,"str",function(){return Te}),e.d(s,"exactEquals",function(){return we}),e.d(s,"equals",function(){return Re}),e.d(s,"sub",function(){return Ee}),e.d(s,"mul",function(){return Le}),e.d(s,"div",function(){return Ce}),e.d(s,"dist",function(){return Oe}),e.d(s,"sqrDist",function(){return Pe}),e.d(s,"len",function(){return Ne}),e.d(s,"sqrLen",function(){return Ie}),e.d(s,"forEach",function(){return Fe});var c={};e.d(c,"create",function(){return Be}),e.d(c,"clone",function(){return Ue}),e.d(c,"fromValues",function(){return Ve}),e.d(c,"copy",function(){return De}),e.d(c,"set",function(){return qe}),e.d(c,"add",function(){return He}),e.d(c,"subtract",function(){return Ge}),e.d(c,"multiply",function(){return ze}),e.d(c,"divide",function(){return je}),e.d(c,"ceil",function(){return ke}),e.d(c,"floor",function(){return Xe}),e.d(c,"min",function(){return Ye}),e.d(c,"max",function(){return We}),e.d(c,"round",function(){return $e}),e.d(c,"scale",function(){return Qe}),e.d(c,"scaleAndAdd",function(){return Ke}),e.d(c,"distance",function(){return Ze}),e.d(c,"squaredDistance",function(){return Je}),e.d(c,"length",function(){return tr}),e.d(c,"squaredLength",function(){return nr}),e.d(c,"negate",function(){return er}),e.d(c,"inverse",function(){return rr}),e.d(c,"normalize",function(){return ir}),e.d(c,"dot",function(){return or}),e.d(c,"lerp",function(){return ar}),e.d(c,"random",function(){return ur}),e.d(c,"transformMat4",function(){return sr}),e.d(c,"transformQuat",function(){return cr}),e.d(c,"str",function(){return lr}),e.d(c,"exactEquals",function(){return fr}),e.d(c,"equals",function(){return hr}),e.d(c,"sub",function(){return dr}),e.d(c,"mul",function(){return mr}),e.d(c,"div",function(){return pr}),e.d(c,"dist",function(){return Mr}),e.d(c,"sqrDist",function(){return br}),e.d(c,"len",function(){return vr}),e.d(c,"sqrLen",function(){return gr}),e.d(c,"forEach",function(){return _r});var l={};e.d(l,"create",function(){return xr}),e.d(l,"identity",function(){return Sr}),e.d(l,"setAxisAngle",function(){return yr}),e.d(l,"getAxisAngle",function(){return Ar}),e.d(l,"multiply",function(){return Tr}),e.d(l,"rotateX",function(){return wr}),e.d(l,"rotateY",function(){return Rr}),e.d(l,"rotateZ",function(){return Er}),e.d(l,"calculateW",function(){return Lr}),e.d(l,"slerp",function(){return Cr}),e.d(l,"invert",function(){return Or}),e.d(l,"conjugate",function(){return Pr}),e.d(l,"fromMat3",function(){return Nr}),e.d(l,"fromEuler",function(){return Ir}),e.d(l,"str",function(){return Fr}),e.d(l,"clone",function(){return Br}),e.d(l,"fromValues",function(){return Ur}),e.d(l,"copy",function(){return Vr}),e.d(l,"set",function(){return Dr}),e.d(l,"add",function(){return qr}),e.d(l,"mul",function(){return Hr}),e.d(l,"scale",function(){return Gr}),e.d(l,"dot",function(){return zr}),e.d(l,"lerp",function(){return jr}),e.d(l,"length",function(){return kr}),e.d(l,"len",function(){return Xr}),e.d(l,"squaredLength",function(){return Yr}),e.d(l,"sqrLen",function(){return Wr}),e.d(l,"normalize",function(){return $r}),e.d(l,"exactEquals",function(){return Qr}),e.d(l,"equals",function(){return Kr}),e.d(l,"rotationTo",function(){return Zr}),e.d(l,"sqlerp",function(){return Jr}),e.d(l,"setAxes",function(){return ti});var f={};e.d(f,"create",function(){return ni}),e.d(f,"clone",function(){return ei}),e.d(f,"fromValues",function(){return ri}),e.d(f,"fromRotationTranslationValues",function(){return ii}),e.d(f,"fromRotationTranslation",function(){return oi}),e.d(f,"fromTranslation",function(){return ai}),e.d(f,"fromRotation",function(){return ui}),e.d(f,"fromMat4",function(){return si}),e.d(f,"copy",function(){return ci}),e.d(f,"identity",function(){return li}),e.d(f,"set",function(){return fi}),e.d(f,"getReal",function(){return hi}),e.d(f,"getDual",function(){return di}),e.d(f,"setReal",function(){return mi}),e.d(f,"setDual",function(){return pi}),e.d(f,"getTranslation",function(){return Mi}),e.d(f,"translate",function(){return bi}),e.d(f,"rotateX",function(){return vi}),e.d(f,"rotateY",function(){return gi}),e.d(f,"rotateZ",function(){return _i}),e.d(f,"rotateByQuatAppend",function(){return xi}),e.d(f,"rotateByQuatPrepend",function(){return Si}),e.d(f,"rotateAroundAxis",function(){return yi}),e.d(f,"add",function(){return Ai}),e.d(f,"multiply",function(){return Ti}),e.d(f,"mul",function(){return wi}),e.d(f,"scale",function(){return Ri}),e.d(f,"dot",function(){return Ei}),e.d(f,"lerp",function(){return Li}),e.d(f,"invert",function(){return Ci}),e.d(f,"conjugate",function(){return Oi}),e.d(f,"length",function(){return Pi}),e.d(f,"len",function(){return Ni}),e.d(f,"squaredLength",function(){return Ii}),e.d(f,"sqrLen",function(){return Fi}),e.d(f,"normalize",function(){return Bi}),e.d(f,"str",function(){return Ui}),e.d(f,"exactEquals",function(){return Vi}),e.d(f,"equals",function(){return Di});var h={};e.d(h,"create",function(){return qi}),e.d(h,"clone",function(){return Hi}),e.d(h,"fromValues",function(){return Gi}),e.d(h,"copy",function(){return zi}),e.d(h,"set",function(){return ji}),e.d(h,"add",function(){return ki}),e.d(h,"subtract",function(){return Xi}),e.d(h,"multiply",function(){return Yi}),e.d(h,"divide",function(){return Wi}),e.d(h,"ceil",function(){return $i}),e.d(h,"floor",function(){return Qi}),e.d(h,"min",function(){return Ki}),e.d(h,"max",function(){return Zi}),e.d(h,"round",function(){return Ji}),e.d(h,"scale",function(){return to}),e.d(h,"scaleAndAdd",function(){return no}),e.d(h,"distance",function(){return eo}),e.d(h,"squaredDistance",function(){return ro}),e.d(h,"length",function(){return io}),e.d(h,"squaredLength",function(){return oo}),e.d(h,"negate",function(){return ao}),e.d(h,"inverse",function(){return uo}),e.d(h,"normalize",function(){return so}),e.d(h,"dot",function(){return co}),e.d(h,"cross",function(){return lo}),e.d(h,"lerp",function(){return fo}),e.d(h,"random",function(){return ho}),e.d(h,"transformMat2",function(){return mo}),e.d(h,"transformMat2d",function(){return po}),e.d(h,"transformMat3",function(){return Mo}),e.d(h,"transformMat4",function(){return bo}),e.d(h,"rotate",function(){return vo}),e.d(h,"angle",function(){return go}),e.d(h,"str",function(){return _o}),e.d(h,"exactEquals",function(){return xo}),e.d(h,"equals",function(){return So}),e.d(h,"len",function(){return yo}),e.d(h,"sub",function(){return Ao}),e.d(h,"mul",function(){return To}),e.d(h,"div",function(){return wo}),e.d(h,"dist",function(){return Ro}),e.d(h,"sqrDist",function(){return Eo}),e.d(h,"sqrLen",function(){return Lo}),e.d(h,"forEach",function(){return Co});const d=1e-6;let m="undefined"!=typeof Float32Array?Float32Array:Array;const p=Math.random;function M(t){m=t}const b=Math.PI/180;function v(t){return t*b}function g(t,n){return Math.abs(t-n)<=d*Math.max(1,Math.abs(t),Math.abs(n))}function _(){let t=new m(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t}function x(t){let n=new m(4);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n}function S(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t}function y(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t}function A(t,n,e,r){let i=new m(4);return i[0]=t,i[1]=n,i[2]=e,i[3]=r,i}function T(t,n,e,r,i){return t[0]=n,t[1]=e,t[2]=r,t[3]=i,t}function w(t,n){if(t===n){let e=n[1];t[1]=n[2],t[2]=e}else t[0]=n[0],t[1]=n[2],t[2]=n[1],t[3]=n[3];return t}function R(t,n){let e=n[0],r=n[1],i=n[2],o=n[3],a=e*o-i*r;return a?(a=1/a,t[0]=o*a,t[1]=-r*a,t[2]=-i*a,t[3]=e*a,t):null}function E(t,n){let e=n[0];return t[0]=n[3],t[1]=-n[1],t[2]=-n[2],t[3]=e,t}function L(t){return t[0]*t[3]-t[2]*t[1]}function C(t,n,e){let r=n[0],i=n[1],o=n[2],a=n[3],u=e[0],s=e[1],c=e[2],l=e[3];return t[0]=r*u+o*s,t[1]=i*u+a*s,t[2]=r*c+o*l,t[3]=i*c+a*l,t}function O(t,n,e){let r=n[0],i=n[1],o=n[2],a=n[3],u=Math.sin(e),s=Math.cos(e);return t[0]=r*s+o*u,t[1]=i*s+a*u,t[2]=r*-u+o*s,t[3]=i*-u+a*s,t}function P(t,n,e){let r=n[0],i=n[1],o=n[2],a=n[3],u=e[0],s=e[1];return t[0]=r*u,t[1]=i*u,t[2]=o*s,t[3]=a*s,t}function N(t,n){let e=Math.sin(n),r=Math.cos(n);return t[0]=r,t[1]=e,t[2]=-e,t[3]=r,t}function I(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=n[1],t}function F(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function B(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))}function U(t,n,e,r){return t[2]=r[2]/r[0],e[0]=r[0],e[1]=r[1],e[3]=r[3]-t[2]*e[1],[t,n,e]}function V(t,n,e){return t[0]=n[0]+e[0],t[1]=n[1]+e[1],t[2]=n[2]+e[2],t[3]=n[3]+e[3],t}function D(t,n,e){return t[0]=n[0]-e[0],t[1]=n[1]-e[1],t[2]=n[2]-e[2],t[3]=n[3]-e[3],t}function q(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]}function H(t,n){let e=t[0],r=t[1],i=t[2],o=t[3],a=n[0],u=n[1],s=n[2],c=n[3];return Math.abs(e-a)<=d*Math.max(1,Math.abs(e),Math.abs(a))&&Math.abs(r-u)<=d*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(i-s)<=d*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(o-c)<=d*Math.max(1,Math.abs(o),Math.abs(c))}function G(t,n,e){return t[0]=n[0]*e,t[1]=n[1]*e,t[2]=n[2]*e,t[3]=n[3]*e,t}function z(t,n,e,r){return t[0]=n[0]+e[0]*r,t[1]=n[1]+e[1]*r,t[2]=n[2]+e[2]*r,t[3]=n[3]+e[3]*r,t}const j=C,k=D;function X(){let t=new m(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function Y(t){let n=new m(6);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n}function W(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t}function $(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function Q(t,n,e,r,i,o){let a=new m(6);return a[0]=t,a[1]=n,a[2]=e,a[3]=r,a[4]=i,a[5]=o,a}function K(t,n,e,r,i,o,a){return t[0]=n,t[1]=e,t[2]=r,t[3]=i,t[4]=o,t[5]=a,t}function Z(t,n){let e=n[0],r=n[1],i=n[2],o=n[3],a=n[4],u=n[5],s=e*o-r*i;return s?(s=1/s,t[0]=o*s,t[1]=-r*s,t[2]=-i*s,t[3]=e*s,t[4]=(i*u-o*a)*s,t[5]=(r*a-e*u)*s,t):null}function J(t){return t[0]*t[3]-t[1]*t[2]}function tt(t,n,e){let r=n[0],i=n[1],o=n[2],a=n[3],u=n[4],s=n[5],c=e[0],l=e[1],f=e[2],h=e[3],d=e[4],m=e[5];return t[0]=r*c+o*l,t[1]=i*c+a*l,t[2]=r*f+o*h,t[3]=i*f+a*h,t[4]=r*d+o*m+u,t[5]=i*d+a*m+s,t}function nt(t,n,e){let r=n[0],i=n[1],o=n[2],a=n[3],u=n[4],s=n[5],c=Math.sin(e),l=Math.cos(e);return t[0]=r*l+o*c,t[1]=i*l+a*c,t[2]=r*-c+o*l,t[3]=i*-c+a*l,t[4]=u,t[5]=s,t}function et(t,n,e){let r=n[0],i=n[1],o=n[2],a=n[3],u=n[4],s=n[5],c=e[0],l=e[1];return t[0]=r*c,t[1]=i*c,t[2]=o*l,t[3]=a*l,t[4]=u,t[5]=s,t}function rt(t,n,e){let r=n[0],i=n[1],o=n[2],a=n[3],u=n[4],s=n[5],c=e[0],l=e[1];return t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=r*c+o*l+u,t[5]=i*c+a*l+s,t}function it(t,n){let e=Math.sin(n),r=Math.cos(n);return t[0]=r,t[1]=e,t[2]=-e,t[3]=r,t[4]=0,t[5]=0,t}function ot(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=n[1],t[4]=0,t[5]=0,t}function at(t,n){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=n[0],t[5]=n[1],t}function ut(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}function st(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)}function ct(t,n,e){return t[0]=n[0]+e[0],t[1]=n[1]+e[1],t[2]=n[2]+e[2],t[3]=n[3]+e[3],t[4]=n[4]+e[4],t[5]=n[5]+e[5],t}function lt(t,n,e){return t[0]=n[0]-e[0],t[1]=n[1]-e[1],t[2]=n[2]-e[2],t[3]=n[3]-e[3],t[4]=n[4]-e[4],t[5]=n[5]-e[5],t}function ft(t,n,e){return t[0]=n[0]*e,t[1]=n[1]*e,t[2]=n[2]*e,t[3]=n[3]*e,t[4]=n[4]*e,t[5]=n[5]*e,t}function ht(t,n,e,r){return t[0]=n[0]+e[0]*r,t[1]=n[1]+e[1]*r,t[2]=n[2]+e[2]*r,t[3]=n[3]+e[3]*r,t[4]=n[4]+e[4]*r,t[5]=n[5]+e[5]*r,t}function dt(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]}function mt(t,n){let e=t[0],r=t[1],i=t[2],o=t[3],a=t[4],u=t[5],s=n[0],c=n[1],l=n[2],f=n[3],h=n[4],m=n[5];return Math.abs(e-s)<=d*Math.max(1,Math.abs(e),Math.abs(s))&&Math.abs(r-c)<=d*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(i-l)<=d*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(o-f)<=d*Math.max(1,Math.abs(o),Math.abs(f))&&Math.abs(a-h)<=d*Math.max(1,Math.abs(a),Math.abs(h))&&Math.abs(u-m)<=d*Math.max(1,Math.abs(u),Math.abs(m))}const pt=tt,Mt=lt;function bt(){let t=new m(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function vt(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[4],t[4]=n[5],t[5]=n[6],t[6]=n[8],t[7]=n[9],t[8]=n[10],t}function gt(t){let n=new m(9);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n}function _t(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t}function xt(t,n,e,r,i,o,a,u,s){let c=new m(9);return c[0]=t,c[1]=n,c[2]=e,c[3]=r,c[4]=i,c[5]=o,c[6]=a,c[7]=u,c[8]=s,c}function St(t,n,e,r,i,o,a,u,s,c){return t[0]=n,t[1]=e,t[2]=r,t[3]=i,t[4]=o,t[5]=a,t[6]=u,t[7]=s,t[8]=c,t}function yt(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function At(t,n){if(t===n){let e=n[1],r=n[2],i=n[5];t[1]=n[3],t[2]=n[6],t[3]=e,t[5]=n[7],t[6]=r,t[7]=i}else t[0]=n[0],t[1]=n[3],t[2]=n[6],t[3]=n[1],t[4]=n[4],t[5]=n[7],t[6]=n[2],t[7]=n[5],t[8]=n[8];return t}function Tt(t,n){let e=n[0],r=n[1],i=n[2],o=n[3],a=n[4],u=n[5],s=n[6],c=n[7],l=n[8],f=l*a-u*c,h=-l*o+u*s,d=c*o-a*s,m=e*f+r*h+i*d;return m?(m=1/m,t[0]=f*m,t[1]=(-l*r+i*c)*m,t[2]=(u*r-i*a)*m,t[3]=h*m,t[4]=(l*e-i*s)*m,t[5]=(-u*e+i*o)*m,t[6]=d*m,t[7]=(-c*e+r*s)*m,t[8]=(a*e-r*o)*m,t):null}function wt(t,n){let e=n[0],r=n[1],i=n[2],o=n[3],a=n[4],u=n[5],s=n[6],c=n[7],l=n[8];return t[0]=a*l-u*c,t[1]=i*c-r*l,t[2]=r*u-i*a,t[3]=u*s-o*l,t[4]=e*l-i*s,t[5]=i*o-e*u,t[6]=o*c-a*s,t[7]=r*s-e*c,t[8]=e*a-r*o,t}function Rt(t){let n=t[0],e=t[1],r=t[2],i=t[3],o=t[4],a=t[5],u=t[6],s=t[7],c=t[8];return n*(c*o-a*s)+e*(-c*i+a*u)+r*(s*i-o*u)}function Et(t,n,e){let r=n[0],i=n[1],o=n[2],a=n[3],u=n[4],s=n[5],c=n[6],l=n[7],f=n[8],h=e[0],d=e[1],m=e[2],p=e[3],M=e[4],b=e[5],v=e[6],g=e[7],_=e[8];return t[0]=h*r+d*a+m*c,t[1]=h*i+d*u+m*l,t[2]=h*o+d*s+m*f,t[3]=p*r+M*a+b*c,t[4]=p*i+M*u+b*l,t[5]=p*o+M*s+b*f,t[6]=v*r+g*a+_*c,t[7]=v*i+g*u+_*l,t[8]=v*o+g*s+_*f,t}function Lt(t,n,e){let r=n[0],i=n[1],o=n[2],a=n[3],u=n[4],s=n[5],c=n[6],l=n[7],f=n[8],h=e[0],d=e[1];return t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=u,t[5]=s,t[6]=h*r+d*a+c,t[7]=h*i+d*u+l,t[8]=h*o+d*s+f,t}function Ct(t,n,e){let r=n[0],i=n[1],o=n[2],a=n[3],u=n[4],s=n[5],c=n[6],l=n[7],f=n[8],h=Math.sin(e),d=Math.cos(e);return t[0]=d*r+h*a,t[1]=d*i+h*u,t[2]=d*o+h*s,t[3]=d*a-h*r,t[4]=d*u-h*i,t[5]=d*s-h*o,t[6]=c,t[7]=l,t[8]=f,t}function Ot(t,n,e){let r=e[0],i=e[1];return t[0]=r*n[0],t[1]=r*n[1],t[2]=r*n[2],t[3]=i*n[3],t[4]=i*n[4],t[5]=i*n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t}function Pt(t,n){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=n[0],t[7]=n[1],t[8]=1,t}function Nt(t,n){let e=Math.sin(n),r=Math.cos(n);return t[0]=r,t[1]=e,t[2]=0,t[3]=-e,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function It(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=0,t[4]=n[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Ft(t,n){return t[0]=n[0],t[1]=n[1],t[2]=0,t[3]=n[2],t[4]=n[3],t[5]=0,t[6]=n[4],t[7]=n[5],t[8]=1,t}function Bt(t,n){let e=n[0],r=n[1],i=n[2],o=n[3],a=e+e,u=r+r,s=i+i,c=e*a,l=r*a,f=r*u,h=i*a,d=i*u,m=i*s,p=o*a,M=o*u,b=o*s;return t[0]=1-f-m,t[3]=l-b,t[6]=h+M,t[1]=l+b,t[4]=1-c-m,t[7]=d-p,t[2]=h-M,t[5]=d+p,t[8]=1-c-f,t}function Ut(t,n){let e=n[0],r=n[1],i=n[2],o=n[3],a=n[4],u=n[5],s=n[6],c=n[7],l=n[8],f=n[9],h=n[10],d=n[11],m=n[12],p=n[13],M=n[14],b=n[15],v=e*u-r*a,g=e*s-i*a,_=e*c-o*a,x=r*s-i*u,S=r*c-o*u,y=i*c-o*s,A=l*p-f*m,T=l*M-h*m,w=l*b-d*m,R=f*M-h*p,E=f*b-d*p,L=h*b-d*M,C=v*L-g*E+_*R+x*w-S*T+y*A;return C?(C=1/C,t[0]=(u*L-s*E+c*R)*C,t[1]=(s*w-a*L-c*T)*C,t[2]=(a*E-u*w+c*A)*C,t[3]=(i*E-r*L-o*R)*C,t[4]=(e*L-i*w+o*T)*C,t[5]=(r*w-e*E-o*A)*C,t[6]=(p*y-M*S+b*x)*C,t[7]=(M*_-m*y-b*g)*C,t[8]=(m*S-p*_+b*v)*C,t):null}function Vt(t,n,e){return t[0]=2/n,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/e,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function Dt(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function qt(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))}function Ht(t,n,e){return t[0]=n[0]+e[0],t[1]=n[1]+e[1],t[2]=n[2]+e[2],t[3]=n[3]+e[3],t[4]=n[4]+e[4],t[5]=n[5]+e[5],t[6]=n[6]+e[6],t[7]=n[7]+e[7],t[8]=n[8]+e[8],t}function Gt(t,n,e){return t[0]=n[0]-e[0],t[1]=n[1]-e[1],t[2]=n[2]-e[2],t[3]=n[3]-e[3],t[4]=n[4]-e[4],t[5]=n[5]-e[5],t[6]=n[6]-e[6],t[7]=n[7]-e[7],t[8]=n[8]-e[8],t}function zt(t,n,e){return t[0]=n[0]*e,t[1]=n[1]*e,t[2]=n[2]*e,t[3]=n[3]*e,t[4]=n[4]*e,t[5]=n[5]*e,t[6]=n[6]*e,t[7]=n[7]*e,t[8]=n[8]*e,t}function jt(t,n,e,r){return t[0]=n[0]+e[0]*r,t[1]=n[1]+e[1]*r,t[2]=n[2]+e[2]*r,t[3]=n[3]+e[3]*r,t[4]=n[4]+e[4]*r,t[5]=n[5]+e[5]*r,t[6]=n[6]+e[6]*r,t[7]=n[7]+e[7]*r,t[8]=n[8]+e[8]*r,t}function kt(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]&&t[6]===n[6]&&t[7]===n[7]&&t[8]===n[8]}function Xt(t,n){let e=t[0],r=t[1],i=t[2],o=t[3],a=t[4],u=t[5],s=t[6],c=t[7],l=t[8],f=n[0],h=n[1],m=n[2],p=n[3],M=n[4],b=n[5],v=n[6],g=n[7],_=n[8];return Math.abs(e-f)<=d*Math.max(1,Math.abs(e),Math.abs(f))&&Math.abs(r-h)<=d*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(i-m)<=d*Math.max(1,Math.abs(i),Math.abs(m))&&Math.abs(o-p)<=d*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(a-M)<=d*Math.max(1,Math.abs(a),Math.abs(M))&&Math.abs(u-b)<=d*Math.max(1,Math.abs(u),Math.abs(b))&&Math.abs(s-v)<=d*Math.max(1,Math.abs(s),Math.abs(v))&&Math.abs(c-g)<=d*Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(l-_)<=d*Math.max(1,Math.abs(l),Math.abs(_))}const Yt=Et,Wt=Gt;function $t(){let t=new m(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Qt(t){let n=new m(16);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n}function Kt(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t}function Zt(t,n,e,r,i,o,a,u,s,c,l,f,h,d,p,M){let b=new m(16);return b[0]=t,b[1]=n,b[2]=e,b[3]=r,b[4]=i,b[5]=o,b[6]=a,b[7]=u,b[8]=s,b[9]=c,b[10]=l,b[11]=f,b[12]=h,b[13]=d,b[14]=p,b[15]=M,b}function Jt(t,n,e,r,i,o,a,u,s,c,l,f,h,d,m,p,M){return t[0]=n,t[1]=e,t[2]=r,t[3]=i,t[4]=o,t[5]=a,t[6]=u,t[7]=s,t[8]=c,t[9]=l,t[10]=f,t[11]=h,t[12]=d,t[13]=m,t[14]=p,t[15]=M,t}function tn(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function nn(t,n){if(t===n){let e=n[1],r=n[2],i=n[3],o=n[6],a=n[7],u=n[11];t[1]=n[4],t[2]=n[8],t[3]=n[12],t[4]=e,t[6]=n[9],t[7]=n[13],t[8]=r,t[9]=o,t[11]=n[14],t[12]=i,t[13]=a,t[14]=u}else t[0]=n[0],t[1]=n[4],t[2]=n[8],t[3]=n[12],t[4]=n[1],t[5]=n[5],t[6]=n[9],t[7]=n[13],t[8]=n[2],t[9]=n[6],t[10]=n[10],t[11]=n[14],t[12]=n[3],t[13]=n[7],t[14]=n[11],t[15]=n[15];return t}function en(t,n){let e=n[0],r=n[1],i=n[2],o=n[3],a=n[4],u=n[5],s=n[6],c=n[7],l=n[8],f=n[9],h=n[10],d=n[11],m=n[12],p=n[13],M=n[14],b=n[15],v=e*u-r*a,g=e*s-i*a,_=e*c-o*a,x=r*s-i*u,S=r*c-o*u,y=i*c-o*s,A=l*p-f*m,T=l*M-h*m,w=l*b-d*m,R=f*M-h*p,E=f*b-d*p,L=h*b-d*M,C=v*L-g*E+_*R+x*w-S*T+y*A;return C?(C=1/C,t[0]=(u*L-s*E+c*R)*C,t[1]=(i*E-r*L-o*R)*C,t[2]=(p*y-M*S+b*x)*C,t[3]=(h*S-f*y-d*x)*C,t[4]=(s*w-a*L-c*T)*C,t[5]=(e*L-i*w+o*T)*C,t[6]=(M*_-m*y-b*g)*C,t[7]=(l*y-h*_+d*g)*C,t[8]=(a*E-u*w+c*A)*C,t[9]=(r*w-e*E-o*A)*C,t[10]=(m*S-p*_+b*v)*C,t[11]=(f*_-l*S-d*v)*C,t[12]=(u*T-a*R-s*A)*C,t[13]=(e*R-r*T+i*A)*C,t[14]=(p*g-m*x-M*v)*C,t[15]=(l*x-f*g+h*v)*C,t):null}function rn(t,n){let e=n[0],r=n[1],i=n[2],o=n[3],a=n[4],u=n[5],s=n[6],c=n[7],l=n[8],f=n[9],h=n[10],d=n[11],m=n[12],p=n[13],M=n[14],b=n[15];return t[0]=u*(h*b-d*M)-f*(s*b-c*M)+p*(s*d-c*h),t[1]=-(r*(h*b-d*M)-f*(i*b-o*M)+p*(i*d-o*h)),t[2]=r*(s*b-c*M)-u*(i*b-o*M)+p*(i*c-o*s),t[3]=-(r*(s*d-c*h)-u*(i*d-o*h)+f*(i*c-o*s)),t[4]=-(a*(h*b-d*M)-l*(s*b-c*M)+m*(s*d-c*h)),t[5]=e*(h*b-d*M)-l*(i*b-o*M)+m*(i*d-o*h),t[6]=-(e*(s*b-c*M)-a*(i*b-o*M)+m*(i*c-o*s)),t[7]=e*(s*d-c*h)-a*(i*d-o*h)+l*(i*c-o*s),t[8]=a*(f*b-d*p)-l*(u*b-c*p)+m*(u*d-c*f),t[9]=-(e*(f*b-d*p)-l*(r*b-o*p)+m*(r*d-o*f)),t[10]=e*(u*b-c*p)-a*(r*b-o*p)+m*(r*c-o*u),t[11]=-(e*(u*d-c*f)-a*(r*d-o*f)+l*(r*c-o*u)),t[12]=-(a*(f*M-h*p)-l*(u*M-s*p)+m*(u*h-s*f)),t[13]=e*(f*M-h*p)-l*(r*M-i*p)+m*(r*h-i*f),t[14]=-(e*(u*M-s*p)-a*(r*M-i*p)+m*(r*s-i*u)),t[15]=e*(u*h-s*f)-a*(r*h-i*f)+l*(r*s-i*u),t}function on(t){let n=t[0],e=t[1],r=t[2],i=t[3],o=t[4],a=t[5],u=t[6],s=t[7],c=t[8],l=t[9],f=t[10],h=t[11],d=t[12],m=t[13],p=t[14],M=t[15];return(n*a-e*o)*(f*M-h*p)-(n*u-r*o)*(l*M-h*m)+(n*s-i*o)*(l*p-f*m)+(e*u-r*a)*(c*M-h*d)-(e*s-i*a)*(c*p-f*d)+(r*s-i*u)*(c*m-l*d)}function an(t,n,e){let r=n[0],i=n[1],o=n[2],a=n[3],u=n[4],s=n[5],c=n[6],l=n[7],f=n[8],h=n[9],d=n[10],m=n[11],p=n[12],M=n[13],b=n[14],v=n[15],g=e[0],_=e[1],x=e[2],S=e[3];return t[0]=g*r+_*u+x*f+S*p,t[1]=g*i+_*s+x*h+S*M,t[2]=g*o+_*c+x*d+S*b,t[3]=g*a+_*l+x*m+S*v,g=e[4],_=e[5],x=e[6],S=e[7],t[4]=g*r+_*u+x*f+S*p,t[5]=g*i+_*s+x*h+S*M,t[6]=g*o+_*c+x*d+S*b,t[7]=g*a+_*l+x*m+S*v,g=e[8],_=e[9],x=e[10],S=e[11],t[8]=g*r+_*u+x*f+S*p,t[9]=g*i+_*s+x*h+S*M,t[10]=g*o+_*c+x*d+S*b,t[11]=g*a+_*l+x*m+S*v,g=e[12],_=e[13],x=e[14],S=e[15],t[12]=g*r+_*u+x*f+S*p,t[13]=g*i+_*s+x*h+S*M,t[14]=g*o+_*c+x*d+S*b,t[15]=g*a+_*l+x*m+S*v,t}function un(t,n,e){let r,i,o,a,u,s,c,l,f,h,d,m,p=e[0],M=e[1],b=e[2];return n===t?(t[12]=n[0]*p+n[4]*M+n[8]*b+n[12],t[13]=n[1]*p+n[5]*M+n[9]*b+n[13],t[14]=n[2]*p+n[6]*M+n[10]*b+n[14],t[15]=n[3]*p+n[7]*M+n[11]*b+n[15]):(r=n[0],i=n[1],o=n[2],a=n[3],u=n[4],s=n[5],c=n[6],l=n[7],f=n[8],h=n[9],d=n[10],m=n[11],t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=u,t[5]=s,t[6]=c,t[7]=l,t[8]=f,t[9]=h,t[10]=d,t[11]=m,t[12]=r*p+u*M+f*b+n[12],t[13]=i*p+s*M+h*b+n[13],t[14]=o*p+c*M+d*b+n[14],t[15]=a*p+l*M+m*b+n[15]),t}function sn(t,n,e){let r=e[0],i=e[1],o=e[2];return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=n[3]*r,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=n[7]*i,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=n[11]*o,t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t}function cn(t,n,e,r){let i,o,a,u,s,c,l,f,h,m,p,M,b,v,g,_,x,S,y,A,T,w,R,E,L=r[0],C=r[1],O=r[2],P=Math.sqrt(L*L+C*C+O*O);return P<d?null:(L*=P=1/P,C*=P,O*=P,i=Math.sin(e),a=1-(o=Math.cos(e)),u=n[0],s=n[1],c=n[2],l=n[3],f=n[4],h=n[5],m=n[6],p=n[7],M=n[8],b=n[9],v=n[10],g=n[11],_=L*L*a+o,x=C*L*a+O*i,S=O*L*a-C*i,y=L*C*a-O*i,A=C*C*a+o,T=O*C*a+L*i,w=L*O*a+C*i,R=C*O*a-L*i,E=O*O*a+o,t[0]=u*_+f*x+M*S,t[1]=s*_+h*x+b*S,t[2]=c*_+m*x+v*S,t[3]=l*_+p*x+g*S,t[4]=u*y+f*A+M*T,t[5]=s*y+h*A+b*T,t[6]=c*y+m*A+v*T,t[7]=l*y+p*A+g*T,t[8]=u*w+f*R+M*E,t[9]=s*w+h*R+b*E,t[10]=c*w+m*R+v*E,t[11]=l*w+p*R+g*E,n!==t&&(t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t)}function ln(t,n,e){let r=Math.sin(e),i=Math.cos(e),o=n[4],a=n[5],u=n[6],s=n[7],c=n[8],l=n[9],f=n[10],h=n[11];return n!==t&&(t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[4]=o*i+c*r,t[5]=a*i+l*r,t[6]=u*i+f*r,t[7]=s*i+h*r,t[8]=c*i-o*r,t[9]=l*i-a*r,t[10]=f*i-u*r,t[11]=h*i-s*r,t}function fn(t,n,e){let r=Math.sin(e),i=Math.cos(e),o=n[0],a=n[1],u=n[2],s=n[3],c=n[8],l=n[9],f=n[10],h=n[11];return n!==t&&(t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[0]=o*i-c*r,t[1]=a*i-l*r,t[2]=u*i-f*r,t[3]=s*i-h*r,t[8]=o*r+c*i,t[9]=a*r+l*i,t[10]=u*r+f*i,t[11]=s*r+h*i,t}function hn(t,n,e){let r=Math.sin(e),i=Math.cos(e),o=n[0],a=n[1],u=n[2],s=n[3],c=n[4],l=n[5],f=n[6],h=n[7];return n!==t&&(t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[0]=o*i+c*r,t[1]=a*i+l*r,t[2]=u*i+f*r,t[3]=s*i+h*r,t[4]=c*i-o*r,t[5]=l*i-a*r,t[6]=f*i-u*r,t[7]=h*i-s*r,t}function dn(t,n){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function mn(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=n[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function pn(t,n,e){let r,i,o,a=e[0],u=e[1],s=e[2],c=Math.sqrt(a*a+u*u+s*s);return c<d?null:(a*=c=1/c,u*=c,s*=c,r=Math.sin(n),o=1-(i=Math.cos(n)),t[0]=a*a*o+i,t[1]=u*a*o+s*r,t[2]=s*a*o-u*r,t[3]=0,t[4]=a*u*o-s*r,t[5]=u*u*o+i,t[6]=s*u*o+a*r,t[7]=0,t[8]=a*s*o+u*r,t[9]=u*s*o-a*r,t[10]=s*s*o+i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function Mn(t,n){let e=Math.sin(n),r=Math.cos(n);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=e,t[7]=0,t[8]=0,t[9]=-e,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function bn(t,n){let e=Math.sin(n),r=Math.cos(n);return t[0]=r,t[1]=0,t[2]=-e,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=e,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function vn(t,n){let e=Math.sin(n),r=Math.cos(n);return t[0]=r,t[1]=e,t[2]=0,t[3]=0,t[4]=-e,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function gn(t,n,e){let r=n[0],i=n[1],o=n[2],a=n[3],u=r+r,s=i+i,c=o+o,l=r*u,f=r*s,h=r*c,d=i*s,m=i*c,p=o*c,M=a*u,b=a*s,v=a*c;return t[0]=1-(d+p),t[1]=f+v,t[2]=h-b,t[3]=0,t[4]=f-v,t[5]=1-(l+p),t[6]=m+M,t[7]=0,t[8]=h+b,t[9]=m-M,t[10]=1-(l+d),t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function _n(t,n){let e=new m(3),r=-n[0],i=-n[1],o=-n[2],a=n[3],u=n[4],s=n[5],c=n[6],l=n[7],f=r*r+i*i+o*o+a*a;return f>0?(e[0]=2*(u*a+l*r+s*o-c*i)/f,e[1]=2*(s*a+l*i+c*r-u*o)/f,e[2]=2*(c*a+l*o+u*i-s*r)/f):(e[0]=2*(u*a+l*r+s*o-c*i),e[1]=2*(s*a+l*i+c*r-u*o),e[2]=2*(c*a+l*o+u*i-s*r)),gn(t,n,e),t}function xn(t,n){return t[0]=n[12],t[1]=n[13],t[2]=n[14],t}function Sn(t,n){let e=n[0],r=n[1],i=n[2],o=n[4],a=n[5],u=n[6],s=n[8],c=n[9],l=n[10];return t[0]=Math.sqrt(e*e+r*r+i*i),t[1]=Math.sqrt(o*o+a*a+u*u),t[2]=Math.sqrt(s*s+c*c+l*l),t}function yn(t,n){let e=n[0]+n[5]+n[10],r=0;return e>0?(r=2*Math.sqrt(e+1),t[3]=.25*r,t[0]=(n[6]-n[9])/r,t[1]=(n[8]-n[2])/r,t[2]=(n[1]-n[4])/r):n[0]>n[5]&&n[0]>n[10]?(r=2*Math.sqrt(1+n[0]-n[5]-n[10]),t[3]=(n[6]-n[9])/r,t[0]=.25*r,t[1]=(n[1]+n[4])/r,t[2]=(n[8]+n[2])/r):n[5]>n[10]?(r=2*Math.sqrt(1+n[5]-n[0]-n[10]),t[3]=(n[8]-n[2])/r,t[0]=(n[1]+n[4])/r,t[1]=.25*r,t[2]=(n[6]+n[9])/r):(r=2*Math.sqrt(1+n[10]-n[0]-n[5]),t[3]=(n[1]-n[4])/r,t[0]=(n[8]+n[2])/r,t[1]=(n[6]+n[9])/r,t[2]=.25*r),t}function An(t,n,e,r){let i=n[0],o=n[1],a=n[2],u=n[3],s=i+i,c=o+o,l=a+a,f=i*s,h=i*c,d=i*l,m=o*c,p=o*l,M=a*l,b=u*s,v=u*c,g=u*l,_=r[0],x=r[1],S=r[2];return t[0]=(1-(m+M))*_,t[1]=(h+g)*_,t[2]=(d-v)*_,t[3]=0,t[4]=(h-g)*x,t[5]=(1-(f+M))*x,t[6]=(p+b)*x,t[7]=0,t[8]=(d+v)*S,t[9]=(p-b)*S,t[10]=(1-(f+m))*S,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function Tn(t,n,e,r,i){let o=n[0],a=n[1],u=n[2],s=n[3],c=o+o,l=a+a,f=u+u,h=o*c,d=o*l,m=o*f,p=a*l,M=a*f,b=u*f,v=s*c,g=s*l,_=s*f,x=r[0],S=r[1],y=r[2],A=i[0],T=i[1],w=i[2],R=(1-(p+b))*x,E=(d+_)*x,L=(m-g)*x,C=(d-_)*S,O=(1-(h+b))*S,P=(M+v)*S,N=(m+g)*y,I=(M-v)*y,F=(1-(h+p))*y;return t[0]=R,t[1]=E,t[2]=L,t[3]=0,t[4]=C,t[5]=O,t[6]=P,t[7]=0,t[8]=N,t[9]=I,t[10]=F,t[11]=0,t[12]=e[0]+A-(R*A+C*T+N*w),t[13]=e[1]+T-(E*A+O*T+I*w),t[14]=e[2]+w-(L*A+P*T+F*w),t[15]=1,t}function wn(t,n){let e=n[0],r=n[1],i=n[2],o=n[3],a=e+e,u=r+r,s=i+i,c=e*a,l=r*a,f=r*u,h=i*a,d=i*u,m=i*s,p=o*a,M=o*u,b=o*s;return t[0]=1-f-m,t[1]=l+b,t[2]=h-M,t[3]=0,t[4]=l-b,t[5]=1-c-m,t[6]=d+p,t[7]=0,t[8]=h+M,t[9]=d-p,t[10]=1-c-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Rn(t,n,e,r,i,o,a){let u=1/(e-n),s=1/(i-r),c=1/(o-a);return t[0]=2*o*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*s,t[6]=0,t[7]=0,t[8]=(e+n)*u,t[9]=(i+r)*s,t[10]=(a+o)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*o*2*c,t[15]=0,t}function En(t,n,e,r,i){let o=1/Math.tan(n/2),a=1/(r-i);return t[0]=o/e,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(i+r)*a,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*i*r*a,t[15]=0,t}function Ln(t,n,e,r){let i=Math.tan(n.upDegrees*Math.PI/180),o=Math.tan(n.downDegrees*Math.PI/180),a=Math.tan(n.leftDegrees*Math.PI/180),u=Math.tan(n.rightDegrees*Math.PI/180),s=2/(a+u),c=2/(i+o);return t[0]=s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(a-u)*s*.5,t[9]=(i-o)*c*.5,t[10]=r/(e-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*e/(e-r),t[15]=0,t}function Cn(t,n,e,r,i,o,a){let u=1/(n-e),s=1/(r-i),c=1/(o-a);return t[0]=-2*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(n+e)*u,t[13]=(i+r)*s,t[14]=(a+o)*c,t[15]=1,t}function On(t,n,e,r){let i,o,a,u,s,c,l,f,h,m,p=n[0],M=n[1],b=n[2],v=r[0],g=r[1],_=r[2],x=e[0],S=e[1],y=e[2];return Math.abs(p-x)<d&&Math.abs(M-S)<d&&Math.abs(b-y)<d?tn(t):(l=p-x,f=M-S,h=b-y,i=g*(h*=m=1/Math.sqrt(l*l+f*f+h*h))-_*(f*=m),o=_*(l*=m)-v*h,a=v*f-g*l,(m=Math.sqrt(i*i+o*o+a*a))?(i*=m=1/m,o*=m,a*=m):(i=0,o=0,a=0),u=f*a-h*o,s=h*i-l*a,c=l*o-f*i,(m=Math.sqrt(u*u+s*s+c*c))?(u*=m=1/m,s*=m,c*=m):(u=0,s=0,c=0),t[0]=i,t[1]=u,t[2]=l,t[3]=0,t[4]=o,t[5]=s,t[6]=f,t[7]=0,t[8]=a,t[9]=c,t[10]=h,t[11]=0,t[12]=-(i*p+o*M+a*b),t[13]=-(u*p+s*M+c*b),t[14]=-(l*p+f*M+h*b),t[15]=1,t)}function Pn(t,n,e,r){let i=n[0],o=n[1],a=n[2],u=r[0],s=r[1],c=r[2],l=i-e[0],f=o-e[1],h=a-e[2],d=l*l+f*f+h*h;d>0&&(l*=d=1/Math.sqrt(d),f*=d,h*=d);let m=s*h-c*f,p=c*l-u*h,M=u*f-s*l;return(d=m*m+p*p+M*M)>0&&(m*=d=1/Math.sqrt(d),p*=d,M*=d),t[0]=m,t[1]=p,t[2]=M,t[3]=0,t[4]=f*M-h*p,t[5]=h*m-l*M,t[6]=l*p-f*m,t[7]=0,t[8]=l,t[9]=f,t[10]=h,t[11]=0,t[12]=i,t[13]=o,t[14]=a,t[15]=1,t}function Nn(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function In(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))}function Fn(t,n,e){return t[0]=n[0]+e[0],t[1]=n[1]+e[1],t[2]=n[2]+e[2],t[3]=n[3]+e[3],t[4]=n[4]+e[4],t[5]=n[5]+e[5],t[6]=n[6]+e[6],t[7]=n[7]+e[7],t[8]=n[8]+e[8],t[9]=n[9]+e[9],t[10]=n[10]+e[10],t[11]=n[11]+e[11],t[12]=n[12]+e[12],t[13]=n[13]+e[13],t[14]=n[14]+e[14],t[15]=n[15]+e[15],t}function Bn(t,n,e){return t[0]=n[0]-e[0],t[1]=n[1]-e[1],t[2]=n[2]-e[2],t[3]=n[3]-e[3],t[4]=n[4]-e[4],t[5]=n[5]-e[5],t[6]=n[6]-e[6],t[7]=n[7]-e[7],t[8]=n[8]-e[8],t[9]=n[9]-e[9],t[10]=n[10]-e[10],t[11]=n[11]-e[11],t[12]=n[12]-e[12],t[13]=n[13]-e[13],t[14]=n[14]-e[14],t[15]=n[15]-e[15],t}function Un(t,n,e){return t[0]=n[0]*e,t[1]=n[1]*e,t[2]=n[2]*e,t[3]=n[3]*e,t[4]=n[4]*e,t[5]=n[5]*e,t[6]=n[6]*e,t[7]=n[7]*e,t[8]=n[8]*e,t[9]=n[9]*e,t[10]=n[10]*e,t[11]=n[11]*e,t[12]=n[12]*e,t[13]=n[13]*e,t[14]=n[14]*e,t[15]=n[15]*e,t}function Vn(t,n,e,r){return t[0]=n[0]+e[0]*r,t[1]=n[1]+e[1]*r,t[2]=n[2]+e[2]*r,t[3]=n[3]+e[3]*r,t[4]=n[4]+e[4]*r,t[5]=n[5]+e[5]*r,t[6]=n[6]+e[6]*r,t[7]=n[7]+e[7]*r,t[8]=n[8]+e[8]*r,t[9]=n[9]+e[9]*r,t[10]=n[10]+e[10]*r,t[11]=n[11]+e[11]*r,t[12]=n[12]+e[12]*r,t[13]=n[13]+e[13]*r,t[14]=n[14]+e[14]*r,t[15]=n[15]+e[15]*r,t}function Dn(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]&&t[6]===n[6]&&t[7]===n[7]&&t[8]===n[8]&&t[9]===n[9]&&t[10]===n[10]&&t[11]===n[11]&&t[12]===n[12]&&t[13]===n[13]&&t[14]===n[14]&&t[15]===n[15]}function qn(t,n){let e=t[0],r=t[1],i=t[2],o=t[3],a=t[4],u=t[5],s=t[6],c=t[7],l=t[8],f=t[9],h=t[10],m=t[11],p=t[12],M=t[13],b=t[14],v=t[15],g=n[0],_=n[1],x=n[2],S=n[3],y=n[4],A=n[5],T=n[6],w=n[7],R=n[8],E=n[9],L=n[10],C=n[11],O=n[12],P=n[13],N=n[14],I=n[15];return Math.abs(e-g)<=d*Math.max(1,Math.abs(e),Math.abs(g))&&Math.abs(r-_)<=d*Math.max(1,Math.abs(r),Math.abs(_))&&Math.abs(i-x)<=d*Math.max(1,Math.abs(i),Math.abs(x))&&Math.abs(o-S)<=d*Math.max(1,Math.abs(o),Math.abs(S))&&Math.abs(a-y)<=d*Math.max(1,Math.abs(a),Math.abs(y))&&Math.abs(u-A)<=d*Math.max(1,Math.abs(u),Math.abs(A))&&Math.abs(s-T)<=d*Math.max(1,Math.abs(s),Math.abs(T))&&Math.abs(c-w)<=d*Math.max(1,Math.abs(c),Math.abs(w))&&Math.abs(l-R)<=d*Math.max(1,Math.abs(l),Math.abs(R))&&Math.abs(f-E)<=d*Math.max(1,Math.abs(f),Math.abs(E))&&Math.abs(h-L)<=d*Math.max(1,Math.abs(h),Math.abs(L))&&Math.abs(m-C)<=d*Math.max(1,Math.abs(m),Math.abs(C))&&Math.abs(p-O)<=d*Math.max(1,Math.abs(p),Math.abs(O))&&Math.abs(M-P)<=d*Math.max(1,Math.abs(M),Math.abs(P))&&Math.abs(b-N)<=d*Math.max(1,Math.abs(b),Math.abs(N))&&Math.abs(v-I)<=d*Math.max(1,Math.abs(v),Math.abs(I))}const Hn=an,Gn=Bn;function zn(){let t=new m(3);return t[0]=0,t[1]=0,t[2]=0,t}function jn(t){var n=new m(3);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n}function kn(t){let n=t[0],e=t[1],r=t[2];return Math.sqrt(n*n+e*e+r*r)}function Xn(t,n,e){let r=new m(3);return r[0]=t,r[1]=n,r[2]=e,r}function Yn(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t}function Wn(t,n,e,r){return t[0]=n,t[1]=e,t[2]=r,t}function $n(t,n,e){return t[0]=n[0]+e[0],t[1]=n[1]+e[1],t[2]=n[2]+e[2],t}function Qn(t,n,e){return t[0]=n[0]-e[0],t[1]=n[1]-e[1],t[2]=n[2]-e[2],t}function Kn(t,n,e){return t[0]=n[0]*e[0],t[1]=n[1]*e[1],t[2]=n[2]*e[2],t}function Zn(t,n,e){return t[0]=n[0]/e[0],t[1]=n[1]/e[1],t[2]=n[2]/e[2],t}function Jn(t,n){return t[0]=Math.ceil(n[0]),t[1]=Math.ceil(n[1]),t[2]=Math.ceil(n[2]),t}function te(t,n){return t[0]=Math.floor(n[0]),t[1]=Math.floor(n[1]),t[2]=Math.floor(n[2]),t}function ne(t,n,e){return t[0]=Math.min(n[0],e[0]),t[1]=Math.min(n[1],e[1]),t[2]=Math.min(n[2],e[2]),t}function ee(t,n,e){return t[0]=Math.max(n[0],e[0]),t[1]=Math.max(n[1],e[1]),t[2]=Math.max(n[2],e[2]),t}function re(t,n){return t[0]=Math.round(n[0]),t[1]=Math.round(n[1]),t[2]=Math.round(n[2]),t}function ie(t,n,e){return t[0]=n[0]*e,t[1]=n[1]*e,t[2]=n[2]*e,t}function oe(t,n,e,r){return t[0]=n[0]+e[0]*r,t[1]=n[1]+e[1]*r,t[2]=n[2]+e[2]*r,t}function ae(t,n){let e=n[0]-t[0],r=n[1]-t[1],i=n[2]-t[2];return Math.sqrt(e*e+r*r+i*i)}function ue(t,n){let e=n[0]-t[0],r=n[1]-t[1],i=n[2]-t[2];return e*e+r*r+i*i}function se(t){let n=t[0],e=t[1],r=t[2];return n*n+e*e+r*r}function ce(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t}function le(t,n){return t[0]=1/n[0],t[1]=1/n[1],t[2]=1/n[2],t}function fe(t,n){let e=n[0],r=n[1],i=n[2],o=e*e+r*r+i*i;return o>0&&(o=1/Math.sqrt(o),t[0]=n[0]*o,t[1]=n[1]*o,t[2]=n[2]*o),t}function he(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]}function de(t,n,e){let r=n[0],i=n[1],o=n[2],a=e[0],u=e[1],s=e[2];return t[0]=i*s-o*u,t[1]=o*a-r*s,t[2]=r*u-i*a,t}function me(t,n,e,r){let i=n[0],o=n[1],a=n[2];return t[0]=i+r*(e[0]-i),t[1]=o+r*(e[1]-o),t[2]=a+r*(e[2]-a),t}function pe(t,n,e,r,i,o){let a=o*o,u=a*(2*o-3)+1,s=a*(o-2)+o,c=a*(o-1),l=a*(3-2*o);return t[0]=n[0]*u+e[0]*s+r[0]*c+i[0]*l,t[1]=n[1]*u+e[1]*s+r[1]*c+i[1]*l,t[2]=n[2]*u+e[2]*s+r[2]*c+i[2]*l,t}function Me(t,n,e,r,i,o){let a=1-o,u=a*a,s=o*o,c=u*a,l=3*o*u,f=3*s*a,h=s*o;return t[0]=n[0]*c+e[0]*l+r[0]*f+i[0]*h,t[1]=n[1]*c+e[1]*l+r[1]*f+i[1]*h,t[2]=n[2]*c+e[2]*l+r[2]*f+i[2]*h,t}function be(t,n){n=n||1;let e=2*p()*Math.PI,r=2*p()-1,i=Math.sqrt(1-r*r)*n;return t[0]=Math.cos(e)*i,t[1]=Math.sin(e)*i,t[2]=r*n,t}function ve(t,n,e){let r=n[0],i=n[1],o=n[2],a=e[3]*r+e[7]*i+e[11]*o+e[15];return a=a||1,t[0]=(e[0]*r+e[4]*i+e[8]*o+e[12])/a,t[1]=(e[1]*r+e[5]*i+e[9]*o+e[13])/a,t[2]=(e[2]*r+e[6]*i+e[10]*o+e[14])/a,t}function ge(t,n,e){let r=n[0],i=n[1],o=n[2];return t[0]=r*e[0]+i*e[3]+o*e[6],t[1]=r*e[1]+i*e[4]+o*e[7],t[2]=r*e[2]+i*e[5]+o*e[8],t}function _e(t,n,e){let r=e[0],i=e[1],o=e[2],a=e[3],u=n[0],s=n[1],c=n[2],l=i*c-o*s,f=o*u-r*c,h=r*s-i*u,d=i*h-o*f,m=o*l-r*h,p=r*f-i*l,M=2*a;return l*=M,f*=M,h*=M,d*=2,m*=2,p*=2,t[0]=u+l+d,t[1]=s+f+m,t[2]=c+h+p,t}function xe(t,n,e,r){let i=[],o=[];return i[0]=n[0]-e[0],i[1]=n[1]-e[1],i[2]=n[2]-e[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=o[0]+e[0],t[1]=o[1]+e[1],t[2]=o[2]+e[2],t}function Se(t,n,e,r){let i=[],o=[];return i[0]=n[0]-e[0],i[1]=n[1]-e[1],i[2]=n[2]-e[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=o[0]+e[0],t[1]=o[1]+e[1],t[2]=o[2]+e[2],t}function ye(t,n,e,r){let i=[],o=[];return i[0]=n[0]-e[0],i[1]=n[1]-e[1],i[2]=n[2]-e[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],t[0]=o[0]+e[0],t[1]=o[1]+e[1],t[2]=o[2]+e[2],t}function Ae(t,n){let e=Xn(t[0],t[1],t[2]),r=Xn(n[0],n[1],n[2]);fe(e,e),fe(r,r);let i=he(e,r);return i>1?0:i<-1?Math.PI:Math.acos(i)}function Te(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function we(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]}function Re(t,n){let e=t[0],r=t[1],i=t[2],o=n[0],a=n[1],u=n[2];return Math.abs(e-o)<=d*Math.max(1,Math.abs(e),Math.abs(o))&&Math.abs(r-a)<=d*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(i-u)<=d*Math.max(1,Math.abs(i),Math.abs(u))}const Ee=Qn,Le=Kn,Ce=Zn,Oe=ae,Pe=ue,Ne=kn,Ie=se,Fe=function(){let t=zn();return function(n,e,r,i,o,a){let u,s;for(e||(e=3),r||(r=0),s=i?Math.min(i*e+r,n.length):n.length,u=r;u<s;u+=e)t[0]=n[u],t[1]=n[u+1],t[2]=n[u+2],o(t,t,a),n[u]=t[0],n[u+1]=t[1],n[u+2]=t[2];return n}}();function Be(){let t=new m(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function Ue(t){let n=new m(4);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n}function Ve(t,n,e,r){let i=new m(4);return i[0]=t,i[1]=n,i[2]=e,i[3]=r,i}function De(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t}function qe(t,n,e,r,i){return t[0]=n,t[1]=e,t[2]=r,t[3]=i,t}function He(t,n,e){return t[0]=n[0]+e[0],t[1]=n[1]+e[1],t[2]=n[2]+e[2],t[3]=n[3]+e[3],t}function Ge(t,n,e){return t[0]=n[0]-e[0],t[1]=n[1]-e[1],t[2]=n[2]-e[2],t[3]=n[3]-e[3],t}function ze(t,n,e){return t[0]=n[0]*e[0],t[1]=n[1]*e[1],t[2]=n[2]*e[2],t[3]=n[3]*e[3],t}function je(t,n,e){return t[0]=n[0]/e[0],t[1]=n[1]/e[1],t[2]=n[2]/e[2],t[3]=n[3]/e[3],t}function ke(t,n){return t[0]=Math.ceil(n[0]),t[1]=Math.ceil(n[1]),t[2]=Math.ceil(n[2]),t[3]=Math.ceil(n[3]),t}function Xe(t,n){return t[0]=Math.floor(n[0]),t[1]=Math.floor(n[1]),t[2]=Math.floor(n[2]),t[3]=Math.floor(n[3]),t}function Ye(t,n,e){return t[0]=Math.min(n[0],e[0]),t[1]=Math.min(n[1],e[1]),t[2]=Math.min(n[2],e[2]),t[3]=Math.min(n[3],e[3]),t}function We(t,n,e){return t[0]=Math.max(n[0],e[0]),t[1]=Math.max(n[1],e[1]),t[2]=Math.max(n[2],e[2]),t[3]=Math.max(n[3],e[3]),t}function $e(t,n){return t[0]=Math.round(n[0]),t[1]=Math.round(n[1]),t[2]=Math.round(n[2]),t[3]=Math.round(n[3]),t}function Qe(t,n,e){return t[0]=n[0]*e,t[1]=n[1]*e,t[2]=n[2]*e,t[3]=n[3]*e,t}function Ke(t,n,e,r){return t[0]=n[0]+e[0]*r,t[1]=n[1]+e[1]*r,t[2]=n[2]+e[2]*r,t[3]=n[3]+e[3]*r,t}function Ze(t,n){let e=n[0]-t[0],r=n[1]-t[1],i=n[2]-t[2],o=n[3]-t[3];return Math.sqrt(e*e+r*r+i*i+o*o)}function Je(t,n){let e=n[0]-t[0],r=n[1]-t[1],i=n[2]-t[2],o=n[3]-t[3];return e*e+r*r+i*i+o*o}function tr(t){let n=t[0],e=t[1],r=t[2],i=t[3];return Math.sqrt(n*n+e*e+r*r+i*i)}function nr(t){let n=t[0],e=t[1],r=t[2],i=t[3];return n*n+e*e+r*r+i*i}function er(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t[3]=-n[3],t}function rr(t,n){return t[0]=1/n[0],t[1]=1/n[1],t[2]=1/n[2],t[3]=1/n[3],t}function ir(t,n){let e=n[0],r=n[1],i=n[2],o=n[3],a=e*e+r*r+i*i+o*o;return a>0&&(a=1/Math.sqrt(a),t[0]=e*a,t[1]=r*a,t[2]=i*a,t[3]=o*a),t}function or(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]+t[3]*n[3]}function ar(t,n,e,r){let i=n[0],o=n[1],a=n[2],u=n[3];return t[0]=i+r*(e[0]-i),t[1]=o+r*(e[1]-o),t[2]=a+r*(e[2]-a),t[3]=u+r*(e[3]-u),t}function ur(t,n){var e,r,i,o,a,u;n=n||1;do{a=(e=2*p()-1)*e+(r=2*p()-1)*r}while(a>=1);do{u=(i=2*p()-1)*i+(o=2*p()-1)*o}while(u>=1);var s=Math.sqrt((1-a)/u);return t[0]=Qe*e,t[1]=Qe*r,t[2]=Qe*i*s,t[3]=Qe*o*s,t}function sr(t,n,e){let r=n[0],i=n[1],o=n[2],a=n[3];return t[0]=e[0]*r+e[4]*i+e[8]*o+e[12]*a,t[1]=e[1]*r+e[5]*i+e[9]*o+e[13]*a,t[2]=e[2]*r+e[6]*i+e[10]*o+e[14]*a,t[3]=e[3]*r+e[7]*i+e[11]*o+e[15]*a,t}function cr(t,n,e){let r=n[0],i=n[1],o=n[2],a=e[0],u=e[1],s=e[2],c=e[3],l=c*r+u*o-s*i,f=c*i+s*r-a*o,h=c*o+a*i-u*r,d=-a*r-u*i-s*o;return t[0]=l*c+d*-a+f*-s-h*-u,t[1]=f*c+d*-u+h*-a-l*-s,t[2]=h*c+d*-s+l*-u-f*-a,t[3]=n[3],t}function lr(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function fr(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]}function hr(t,n){let e=t[0],r=t[1],i=t[2],o=t[3],a=n[0],u=n[1],s=n[2],c=n[3];return Math.abs(e-a)<=d*Math.max(1,Math.abs(e),Math.abs(a))&&Math.abs(r-u)<=d*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(i-s)<=d*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(o-c)<=d*Math.max(1,Math.abs(o),Math.abs(c))}const dr=Ge,mr=ze,pr=je,Mr=Ze,br=Je,vr=tr,gr=nr,_r=function(){let t=Be();return function(n,e,r,i,o,a){let u,s;for(e||(e=4),r||(r=0),s=i?Math.min(i*e+r,n.length):n.length,u=r;u<s;u+=e)t[0]=n[u],t[1]=n[u+1],t[2]=n[u+2],t[3]=n[u+3],o(t,t,a),n[u]=t[0],n[u+1]=t[1],n[u+2]=t[2],n[u+3]=t[3];return n}}();function xr(){let t=new m(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function Sr(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function yr(t,n,e){e*=.5;let r=Math.sin(e);return t[0]=r*n[0],t[1]=r*n[1],t[2]=r*n[2],t[3]=Math.cos(e),t}function Ar(t,n){let e=2*Math.acos(n[3]),r=Math.sin(e/2);return 0!=r?(t[0]=n[0]/r,t[1]=n[1]/r,t[2]=n[2]/r):(t[0]=1,t[1]=0,t[2]=0),e}function Tr(t,n,e){let r=n[0],i=n[1],o=n[2],a=n[3],u=e[0],s=e[1],c=e[2],l=e[3];return t[0]=r*l+a*u+i*c-o*s,t[1]=i*l+a*s+o*u-r*c,t[2]=o*l+a*c+r*s-i*u,t[3]=a*l-r*u-i*s-o*c,t}function wr(t,n,e){e*=.5;let r=n[0],i=n[1],o=n[2],a=n[3],u=Math.sin(e),s=Math.cos(e);return t[0]=r*s+a*u,t[1]=i*s+o*u,t[2]=o*s-i*u,t[3]=a*s-r*u,t}function Rr(t,n,e){e*=.5;let r=n[0],i=n[1],o=n[2],a=n[3],u=Math.sin(e),s=Math.cos(e);return t[0]=r*s-o*u,t[1]=i*s+a*u,t[2]=o*s+r*u,t[3]=a*s-i*u,t}function Er(t,n,e){e*=.5;let r=n[0],i=n[1],o=n[2],a=n[3],u=Math.sin(e),s=Math.cos(e);return t[0]=r*s+i*u,t[1]=i*s-r*u,t[2]=o*s+a*u,t[3]=a*s-o*u,t}function Lr(t,n){let e=n[0],r=n[1],i=n[2];return t[0]=e,t[1]=r,t[2]=i,t[3]=Math.sqrt(Math.abs(1-e*e-r*r-i*i)),t}function Cr(t,n,e,r){let i,o,a,u,s,c=n[0],l=n[1],f=n[2],h=n[3],d=e[0],m=e[1],p=e[2],M=e[3];return(o=c*d+l*m+f*p+h*M)<0&&(o=-o,d=-d,m=-m,p=-p,M=-M),1-o>1e-6?(i=Math.acos(o),a=Math.sin(i),u=Math.sin((1-r)*i)/a,s=Math.sin(r*i)/a):(u=1-r,s=r),t[0]=u*c+s*d,t[1]=u*l+s*m,t[2]=u*f+s*p,t[3]=u*h+s*M,t}function Or(t,n){let e=n[0],r=n[1],i=n[2],o=n[3],a=e*e+r*r+i*i+o*o,u=a?1/a:0;return t[0]=-e*u,t[1]=-r*u,t[2]=-i*u,t[3]=o*u,t}function Pr(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t[3]=n[3],t}function Nr(t,n){let e,r=n[0]+n[4]+n[8];if(r>0)e=Math.sqrt(r+1),t[3]=.5*e,e=.5/e,t[0]=(n[5]-n[7])*e,t[1]=(n[6]-n[2])*e,t[2]=(n[1]-n[3])*e;else{let r=0;n[4]>n[0]&&(r=1),n[8]>n[3*r+r]&&(r=2);let i=(r+1)%3,o=(r+2)%3;e=Math.sqrt(n[3*r+r]-n[3*i+i]-n[3*o+o]+1),t[r]=.5*e,e=.5/e,t[3]=(n[3*i+o]-n[3*o+i])*e,t[i]=(n[3*i+r]+n[3*r+i])*e,t[o]=(n[3*o+r]+n[3*r+o])*e}return t}function Ir(t,n,e,r){let i=.5*Math.PI/180;n*=i,e*=i,r*=i;let o=Math.sin(n),a=Math.cos(n),u=Math.sin(e),s=Math.cos(e),c=Math.sin(r),l=Math.cos(r);return t[0]=o*s*l-a*u*c,t[1]=a*u*l+o*s*c,t[2]=a*s*c-o*u*l,t[3]=a*s*l+o*u*c,t}function Fr(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}const Br=Ue,Ur=Ve,Vr=De,Dr=qe,qr=He,Hr=Tr,Gr=Qe,zr=or,jr=ar,kr=tr,Xr=kr,Yr=nr,Wr=Yr,$r=ir,Qr=fr,Kr=hr,Zr=function(){let t=zn(),n=Xn(1,0,0),e=Xn(0,1,0);return function(r,i,o){let a=he(i,o);return a<-.999999?(de(t,n,i),Ne(t)<1e-6&&de(t,e,i),fe(t,t),yr(r,t,Math.PI),r):a>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(de(t,i,o),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+a,$r(r,r))}}(),Jr=function(){let t=xr(),n=xr();return function(e,r,i,o,a,u){return Cr(t,r,a,u),Cr(n,i,o,u),Cr(e,t,n,2*u*(1-u)),e}}(),ti=function(){let t=bt();return function(n,e,r,i){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=i[0],t[4]=i[1],t[7]=i[2],t[2]=-e[0],t[5]=-e[1],t[8]=-e[2],$r(n,Nr(n,t))}}();function ni(){let t=new m(8);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function ei(t){let n=new m(8);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n}function ri(t,n,e,r,i,o,a,u){let s=new m(8);return s[0]=t,s[1]=n,s[2]=e,s[3]=r,s[4]=i,s[5]=o,s[6]=a,s[7]=u,s}function ii(t,n,e,r,i,o,a){let u=new m(8);u[0]=t,u[1]=n,u[2]=e,u[3]=r;let s=.5*i,c=.5*o,l=.5*a;return u[4]=s*r+c*e-l*n,u[5]=c*r+l*t-s*e,u[6]=l*r+s*n-c*t,u[7]=-s*t-c*n-l*e,u}function oi(t,n,e){let r=.5*e[0],i=.5*e[1],o=.5*e[2],a=n[0],u=n[1],s=n[2],c=n[3];return t[0]=a,t[1]=u,t[2]=s,t[3]=c,t[4]=r*c+i*s-o*u,t[5]=i*c+o*a-r*s,t[6]=o*c+r*u-i*a,t[7]=-r*a-i*u-o*s,t}function ai(t,n){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=.5*n[0],t[5]=.5*n[1],t[6]=.5*n[2],t[7]=0,t}function ui(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function si(t,n){let e=xr();yn(e,n);let r=new m(3);return xn(r,n),oi(t,e,r),t}function ci(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t}function li(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function fi(t,n,e,r,i,o,a,u,s){return t[0]=n,t[1]=e,t[2]=r,t[3]=i,t[4]=o,t[5]=a,t[6]=u,t[7]=s,t}const hi=Vr;function di(t,n){return t[0]=n[4],t[1]=n[5],t[2]=n[6],t[3]=n[7],t}const mi=Vr;function pi(t,n){return t[4]=n[0],t[5]=n[1],t[6]=n[2],t[7]=n[3],t}function Mi(t,n){let e=n[4],r=n[5],i=n[6],o=n[7],a=-n[0],u=-n[1],s=-n[2],c=n[3];return t[0]=2*(e*c+o*a+r*s-i*u),t[1]=2*(r*c+o*u+i*a-e*s),t[2]=2*(i*c+o*s+e*u-r*a),t}function bi(t,n,e){let r=n[0],i=n[1],o=n[2],a=n[3],u=.5*e[0],s=.5*e[1],c=.5*e[2],l=n[4],f=n[5],h=n[6],d=n[7];return t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=a*u+i*c-o*s+l,t[5]=a*s+o*u-r*c+f,t[6]=a*c+r*s-i*u+h,t[7]=-r*u-i*s-o*c+d,t}function vi(t,n,e){let r=-n[0],i=-n[1],o=-n[2],a=n[3],u=n[4],s=n[5],c=n[6],l=n[7],f=u*a+l*r+s*o-c*i,h=s*a+l*i+c*r-u*o,d=c*a+l*o+u*i-s*r,m=l*a-u*r-s*i-c*o;return wr(t,n,e),r=t[0],i=t[1],o=t[2],a=t[3],t[4]=f*a+m*r+h*o-d*i,t[5]=h*a+m*i+d*r-f*o,t[6]=d*a+m*o+f*i-h*r,t[7]=m*a-f*r-h*i-d*o,t}function gi(t,n,e){let r=-n[0],i=-n[1],o=-n[2],a=n[3],u=n[4],s=n[5],c=n[6],l=n[7],f=u*a+l*r+s*o-c*i,h=s*a+l*i+c*r-u*o,d=c*a+l*o+u*i-s*r,m=l*a-u*r-s*i-c*o;return Rr(t,n,e),r=t[0],i=t[1],o=t[2],a=t[3],t[4]=f*a+m*r+h*o-d*i,t[5]=h*a+m*i+d*r-f*o,t[6]=d*a+m*o+f*i-h*r,t[7]=m*a-f*r-h*i-d*o,t}function _i(t,n,e){let r=-n[0],i=-n[1],o=-n[2],a=n[3],u=n[4],s=n[5],c=n[6],l=n[7],f=u*a+l*r+s*o-c*i,h=s*a+l*i+c*r-u*o,d=c*a+l*o+u*i-s*r,m=l*a-u*r-s*i-c*o;return Er(t,n,e),r=t[0],i=t[1],o=t[2],a=t[3],t[4]=f*a+m*r+h*o-d*i,t[5]=h*a+m*i+d*r-f*o,t[6]=d*a+m*o+f*i-h*r,t[7]=m*a-f*r-h*i-d*o,t}function xi(t,n,e){let r=e[0],i=e[1],o=e[2],a=e[3],u=n[0],s=n[1],c=n[2],l=n[3];return t[0]=u*a+l*r+s*o-c*i,t[1]=s*a+l*i+c*r-u*o,t[2]=c*a+l*o+u*i-s*r,t[3]=l*a-u*r-s*i-c*o,u=n[4],s=n[5],c=n[6],l=n[7],t[4]=u*a+l*r+s*o-c*i,t[5]=s*a+l*i+c*r-u*o,t[6]=c*a+l*o+u*i-s*r,t[7]=l*a-u*r-s*i-c*o,t}function Si(t,n,e){let r=n[0],i=n[1],o=n[2],a=n[3],u=e[0],s=e[1],c=e[2],l=e[3];return t[0]=r*l+a*u+i*c-o*s,t[1]=i*l+a*s+o*u-r*c,t[2]=o*l+a*c+r*s-i*u,t[3]=a*l-r*u-i*s-o*c,u=e[4],s=e[5],c=e[6],l=e[7],t[4]=r*l+a*u+i*c-o*s,t[5]=i*l+a*s+o*u-r*c,t[6]=o*l+a*c+r*s-i*u,t[7]=a*l-r*u-i*s-o*c,t}function yi(t,n,e,r){if(Math.abs(r)<d)return ci(t,n);let i=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);r*=.5;let o=Math.sin(r),a=o*e[0]/i,u=o*e[1]/i,s=o*e[2]/i,c=Math.cos(r),l=n[0],f=n[1],h=n[2],m=n[3];t[0]=l*c+m*a+f*s-h*u,t[1]=f*c+m*u+h*a-l*s,t[2]=h*c+m*s+l*u-f*a,t[3]=m*c-l*a-f*u-h*s;let p=n[4],M=n[5],b=n[6],v=n[7];return t[4]=p*c+v*a+M*s-b*u,t[5]=M*c+v*u+b*a-p*s,t[6]=b*c+v*s+p*u-M*a,t[7]=v*c-p*a-M*u-b*s,t}function Ai(t,n,e){return t[0]=n[0]+e[0],t[1]=n[1]+e[1],t[2]=n[2]+e[2],t[3]=n[3]+e[3],t[4]=n[4]+e[4],t[5]=n[5]+e[5],t[6]=n[6]+e[6],t[7]=n[7]+e[7],t}function Ti(t,n,e){let r=n[0],i=n[1],o=n[2],a=n[3],u=e[4],s=e[5],c=e[6],l=e[7],f=n[4],h=n[5],d=n[6],m=n[7],p=e[0],M=e[1],b=e[2],v=e[3];return t[0]=r*v+a*p+i*b-o*M,t[1]=i*v+a*M+o*p-r*b,t[2]=o*v+a*b+r*M-i*p,t[3]=a*v-r*p-i*M-o*b,t[4]=r*l+a*u+i*c-o*s+f*v+m*p+h*b-d*M,t[5]=i*l+a*s+o*u-r*c+h*v+m*M+d*p-f*b,t[6]=o*l+a*c+r*s-i*u+d*v+m*b+f*M-h*p,t[7]=a*l-r*u-i*s-o*c+m*v-f*p-h*M-d*b,t}const wi=Ti;function Ri(t,n,e){return t[0]=n[0]*e,t[1]=n[1]*e,t[2]=n[2]*e,t[3]=n[3]*e,t[4]=n[4]*e,t[5]=n[5]*e,t[6]=n[6]*e,t[7]=n[7]*e,t}const Ei=zr;function Li(t,n,e,r){let i=1-r;return Ei(n,e)<0&&(r=-r),t[0]=n[0]*i+e[0]*r,t[1]=n[1]*i+e[1]*r,t[2]=n[2]*i+e[2]*r,t[3]=n[3]*i+e[3]*r,t[4]=n[4]*i+e[4]*r,t[5]=n[5]*i+e[5]*r,t[6]=n[6]*i+e[6]*r,t[7]=n[7]*i+e[7]*r,t}function Ci(t,n){let e=Ii(n);return t[0]=-n[0]/e,t[1]=-n[1]/e,t[2]=-n[2]/e,t[3]=n[3]/e,t[4]=-n[4]/e,t[5]=-n[5]/e,t[6]=-n[6]/e,t[7]=n[7]/e,t}function Oi(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t[3]=n[3],t[4]=-n[4],t[5]=-n[5],t[6]=-n[6],t[7]=n[7],t}const Pi=kr,Ni=Pi,Ii=Yr,Fi=Ii;function Bi(t,n){let e=Ii(n);return e>0&&(e=Math.sqrt(e),t[0]=n[0]/e,t[1]=n[1]/e,t[2]=n[2]/e,t[3]=n[3]/e,t[4]=n[4]/e,t[5]=n[5]/e,t[6]=n[6]/e,t[7]=n[7]/e),t}function Ui(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"}function Vi(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]&&t[6]===n[6]&&t[7]===n[7]}function Di(t,n){let e=t[0],r=t[1],i=t[2],o=t[3],a=t[4],u=t[5],s=t[6],c=t[7],l=n[0],f=n[1],h=n[2],m=n[3],p=n[4],M=n[5],b=n[6],v=n[7];return Math.abs(e-l)<=d*Math.max(1,Math.abs(e),Math.abs(l))&&Math.abs(r-f)<=d*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(i-h)<=d*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(o-m)<=d*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(a-p)<=d*Math.max(1,Math.abs(a),Math.abs(p))&&Math.abs(u-M)<=d*Math.max(1,Math.abs(u),Math.abs(M))&&Math.abs(s-b)<=d*Math.max(1,Math.abs(s),Math.abs(b))&&Math.abs(c-v)<=d*Math.max(1,Math.abs(c),Math.abs(v))}function qi(){let t=new m(2);return t[0]=0,t[1]=0,t}function Hi(t){let n=new m(2);return n[0]=t[0],n[1]=t[1],n}function Gi(t,n){let e=new m(2);return e[0]=t,e[1]=n,e}function zi(t,n){return t[0]=n[0],t[1]=n[1],t}function ji(t,n,e){return t[0]=n,t[1]=e,t}function ki(t,n,e){return t[0]=n[0]+e[0],t[1]=n[1]+e[1],t}function Xi(t,n,e){return t[0]=n[0]-e[0],t[1]=n[1]-e[1],t}function Yi(t,n,e){return t[0]=n[0]*e[0],t[1]=n[1]*e[1],t}function Wi(t,n,e){return t[0]=n[0]/e[0],t[1]=n[1]/e[1],t}function $i(t,n){return t[0]=Math.ceil(n[0]),t[1]=Math.ceil(n[1]),t}function Qi(t,n){return t[0]=Math.floor(n[0]),t[1]=Math.floor(n[1]),t}function Ki(t,n,e){return t[0]=Math.min(n[0],e[0]),t[1]=Math.min(n[1],e[1]),t}function Zi(t,n,e){return t[0]=Math.max(n[0],e[0]),t[1]=Math.max(n[1],e[1]),t}function Ji(t,n){return t[0]=Math.round(n[0]),t[1]=Math.round(n[1]),t}function to(t,n,e){return t[0]=n[0]*e,t[1]=n[1]*e,t}function no(t,n,e,r){return t[0]=n[0]+e[0]*r,t[1]=n[1]+e[1]*r,t}function eo(t,n){var e=n[0]-t[0],r=n[1]-t[1];return Math.sqrt(e*e+r*r)}function ro(t,n){var e=n[0]-t[0],r=n[1]-t[1];return e*e+r*r}function io(t){var n=t[0],e=t[1];return Math.sqrt(n*n+e*e)}function oo(t){var n=t[0],e=t[1];return n*n+e*e}function ao(t,n){return t[0]=-n[0],t[1]=-n[1],t}function uo(t,n){return t[0]=1/n[0],t[1]=1/n[1],t}function so(t,n){var e=n[0],r=n[1],i=e*e+r*r;return i>0&&(i=1/Math.sqrt(i),t[0]=n[0]*i,t[1]=n[1]*i),t}function co(t,n){return t[0]*n[0]+t[1]*n[1]}function lo(t,n,e){var r=n[0]*e[1]-n[1]*e[0];return t[0]=t[1]=0,t[2]=r,t}function fo(t,n,e,r){var i=n[0],o=n[1];return t[0]=i+r*(e[0]-i),t[1]=o+r*(e[1]-o),t}function ho(t,n){n=n||1;var e=2*p()*Math.PI;return t[0]=Math.cos(e)*n,t[1]=Math.sin(e)*n,t}function mo(t,n,e){var r=n[0],i=n[1];return t[0]=e[0]*r+e[2]*i,t[1]=e[1]*r+e[3]*i,t}function po(t,n,e){var r=n[0],i=n[1];return t[0]=e[0]*r+e[2]*i+e[4],t[1]=e[1]*r+e[3]*i+e[5],t}function Mo(t,n,e){var r=n[0],i=n[1];return t[0]=e[0]*r+e[3]*i+e[6],t[1]=e[1]*r+e[4]*i+e[7],t}function bo(t,n,e){let r=n[0],i=n[1];return t[0]=e[0]*r+e[4]*i+e[12],t[1]=e[1]*r+e[5]*i+e[13],t}function vo(t,n,e,r){let i=n[0]-e[0],o=n[1]-e[1],a=Math.sin(r),u=Math.cos(r);return t[0]=i*u-o*a+e[0],t[1]=i*a+o*u+e[1],t}function go(t,n){let e=t[0],r=t[1],i=n[0],o=n[1],a=e*e+r*r;a>0&&(a=1/Math.sqrt(a));let u=i*i+o*o;u>0&&(u=1/Math.sqrt(u));let s=(e*i+r*o)*a*u;return s>1?0:s<-1?Math.PI:Math.acos(s)}function _o(t){return"vec2("+t[0]+", "+t[1]+")"}function xo(t,n){return t[0]===n[0]&&t[1]===n[1]}function So(t,n){let e=t[0],r=t[1],i=n[0],o=n[1];return Math.abs(e-i)<=d*Math.max(1,Math.abs(e),Math.abs(i))&&Math.abs(r-o)<=d*Math.max(1,Math.abs(r),Math.abs(o))}const yo=io,Ao=Xi,To=Yi,wo=Wi,Ro=eo,Eo=ro,Lo=oo,Co=function(){let t=qi();return function(n,e,r,i,o,a){let u,s;for(e||(e=2),r||(r=0),s=i?Math.min(i*e+r,n.length):n.length,u=r;u<s;u+=e)t[0]=n[u],t[1]=n[u+1],o(t,t,a),n[u]=t[0],n[u+1]=t[1];return n}}();e.d(n,"glMatrix",function(){return r}),e.d(n,"mat2",function(){return i}),e.d(n,"mat2d",function(){return o}),e.d(n,"mat3",function(){return a}),e.d(n,"mat4",function(){return u}),e.d(n,"quat",function(){return l}),e.d(n,"quat2",function(){return f}),e.d(n,"vec2",function(){return h}),e.d(n,"vec3",function(){return s}),e.d(n,"vec4",function(){return c})},function(t,n,e){"use strict"},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const r=e(1);class i{constructor(t=r.vec3.fromValues(1/0,1/0,1/0),n=r.vec3.fromValues(-1/0,-1/0,-1/0)){this.min=t,this.max=n}transform(t){const n=r.vec3.fromValues(1/0,1/0,1/0),e=r.vec3.fromValues(-1/0,-1/0,-1/0),i=r.vec3.create(),o=t=>{r.vec3.transformMat4(i,i,t),r.vec3.min(n,n,i),r.vec3.max(e,e,i)};r.vec3.set(i,this.min[0],this.min[1],this.min[2]),o(t),r.vec3.set(i,this.min[0],this.min[1],this.max[2]),o(t),r.vec3.set(i,this.min[0],this.max[1],this.min[2]),o(t),r.vec3.set(i,this.min[0],this.max[1],this.max[2]),o(t),r.vec3.set(i,this.max[0],this.min[1],this.min[2]),o(t),r.vec3.set(i,this.max[0],this.min[1],this.max[2]),o(t),r.vec3.set(i,this.max[0],this.max[1],this.min[2]),o(t),r.vec3.set(i,this.max[0],this.max[1],this.max[2]),o(t),this.min=n,this.max=e}get size(){return r.vec3.sub(r.vec3.create(),this.max,this.min)}get center(){const t=r.vec3.create();return r.vec3.add(t,this.min,this.max),r.vec3.scale(t,t,.5)}union(t){return r.vec3.min(this.min,this.min,t.min),r.vec3.max(this.max,this.max,t.max),this}clone(){return new i(r.vec3.clone(this.min),r.vec3.clone(this.max))}}n.Aabb3=i},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const r=e(0);function i(t){return`a_${t.toLowerCase()}`}n.ATTRIB_LOCATIONS={POSITION:0,NORMAL:1,TANGENT:2,TEXCOORD_0:3,TEXCOORD_1:4,COLOR_0:5,JOINTS_0:6,WEIGHTS_0:7},n.attribName=i,function(t){t[t.HAS_NORMALS=1]="HAS_NORMALS",t[t.HAS_TANGENTS=2]="HAS_TANGENTS",t[t.HAS_UV=4]="HAS_UV",t[t.HAS_COLORS=8]="HAS_COLORS",t[t.USE_IBL=16]="USE_IBL",t[t.HAS_BASECOLORMAP=32]="HAS_BASECOLORMAP",t[t.HAS_NORMALMAP=64]="HAS_NORMALMAP",t[t.HAS_EMISSIVEMAP=128]="HAS_EMISSIVEMAP",t[t.HAS_METALROUGHNESSMAP=256]="HAS_METALROUGHNESSMAP",t[t.HAS_OCCLUSIONMAP=512]="HAS_OCCLUSIONMAP",t[t.USE_TEX_LOD=1024]="USE_TEX_LOD"}(n.ShaderFlags||(n.ShaderFlags={}));class o{constructor(t){this.u_ViewProjection=null,this.u_ModelMatrix=null,this.u_NormalMatrix=null,this.u_Camera=null,this.u_LightDirection=null,this.u_LightColor=null,this.u_BaseColorSampler=null,this.u_BaseColorTexCoord=null,this.u_BaseColorFactor=null,this.u_NormalSampler=null,this.u_NormalTexCoord=null,this.u_NormalScale=null,this.u_EmissiveSampler=null,this.u_EmissiveTexCoord=null,this.u_EmissiveFactor=null,this.u_MetallicRoughnessSampler=null,this.u_MetallicRoughnessTexCoord=null,this.u_MetallicRoughnessValues=null,this.u_OcclusionSampler=null,this.u_OcclusionTexCoord=null,this.u_OcclusionStrength=null,this.u_AlphaBlend=null,this.u_AlphaCutoff=null,this.u_PbrFlags=null;for(const n in this)this[n]=t.uniform(n),null!==this[n]||n.endsWith("Sampler")||console.warn("Failed to get uniform location for "+n);t.bind();const n=t.context.gl;n.uniform1i(this.u_BaseColorSampler,0),n.uniform1i(this.u_NormalSampler,1),n.uniform1i(this.u_EmissiveSampler,2),n.uniform1i(this.u_MetallicRoughnessSampler,3),n.uniform1i(this.u_OcclusionSampler,4),n.uniform3f(this.u_LightColor,4,4,4),n.uniform3f(this.u_LightDirection,0,.5,.5)}}n.PbrShader=class{constructor(t){this.attribLocations={};const a=t.gl;if(t.isWebGL1){if(!t.supportsShaderTextureLOD)throw new Error("PBR shader needs unsupported extension GL_EXT_shader_texture_lod");if(t.shaderTextureLOD,!t.supportsStandardDerivatives)throw new Error("PBR shader needs unsupported extension GL_OES_standard_derivatives");t.standardDerivatives}const u=new r.Shader(t,a.VERTEX_SHADER,"pbr-vert.glsl");u.initialize(e(13));const s=new r.Shader(t,a.FRAGMENT_SHADER,"pbr-frag.glsl");if(s.initialize(e(12)),this.program=new r.Program(t),this.program.initialize([u,s]),t.isWebGL2)Object.assign(this.attribLocations,n.ATTRIB_LOCATIONS);else for(const t of Object.keys(n.ATTRIB_LOCATIONS)){const n=i(t);this.attribLocations[t]=this.program.attribute(n)}this.uniforms=new o(this.program)}bind(){this.program.bind()}unbind(){this.program.unbind()}uninitialize(){this.program.uninitialize()}}},function(t,n,e){"use strict";var r=this&&this.__awaiter||function(t,n,e,r){return new(e||(e=Promise))(function(i,o){function a(t){try{s(r.next(t))}catch(t){o(t)}}function u(t){try{s(r.throw(t))}catch(t){o(t)}}function s(t){t.done?i(t.value):new e(function(n){n(t.value)}).then(a,u)}s((r=r.apply(t,n||[])).next())})};Object.defineProperty(n,"__esModule",{value:!0});const i=e(1),o=e(0),a=e(4);var u;!function(t){t[t.OPAQUE=0]="OPAQUE",t[t.MASK=1]="MASK",t[t.BLEND=2]="BLEND"}(u=n.AlphaMode||(n.AlphaMode={}));class s{constructor(t){this.baseColorFactor=i.vec4.fromValues(1,1,1,1),this.metallicFactor=1,this.roughnessFactor=1,this.emissiveFactor=i.vec3.fromValues(0,0,0),this.alphaCutoff=.5,this.alphaMode=u.OPAQUE,this.doubleSided=!1,this.context=t}static fromGltf(t,n){return r(this,void 0,void 0,function*(){const e=n.gAsset.gltf.materials[t],r=new s(n.context);r.name=e.name||t.toString();const o=e.pbrMetallicRoughness,a={baseColorTexture:void 0,metallicRoghnessTexture:void 0,normalTexture:void 0,occlusionTexture:void 0,emissiveTexture:void 0};o&&(o.baseColorFactor&&(r.baseColorFactor=i.vec4.fromValues.apply(void 0,o.baseColorFactor)),o.baseColorTexture&&(a.baseColorTexture=this.loadTexture(o.baseColorTexture,n,`mat_${r.name}_baseColorTexture`),r.baseColorTexCoord=o.baseColorTexture.texCoord||0),void 0!==o.metallicFactor&&(r.metallicFactor=o.metallicFactor),void 0!==o.roughnessFactor&&(r.roughnessFactor=o.roughnessFactor),o.metallicRoughnessTexture&&(a.metallicRoughnessTexture=this.loadTexture(o.metallicRoughnessTexture,n,`mat_${r.name}_metallicRoughnessTexture`),r.metallicRoughnessTexCoord=o.metallicRoughnessTexture.texCoord||0));const c=e.normalTexture;c&&(a.normalTexture=this.loadTexture(c,n,`mat_${r.name}_normalTexture`),r.normalTexCoord=c.texCoord||0,r.normalScale=c.scale||1);const l=e.occlusionTexture;l&&(a.occlusionTexture=this.loadTexture(l,n,`mat_${r.name}_occlusionTexture`),r.occlusionTexCoord=l.texCoord||0,r.occlusionStrength=l.strength||1),e.emissiveTexture&&(a.emissiveTexture=this.loadTexture(e.emissiveTexture,n,`mat_${r.name}_emissiveTexture`),r.emissiveTexCoord=e.emissiveTexture.texCoord||0),e.emissiveFactor&&(r.emissiveFactor=i.vec3.fromValues.apply(void 0,e.emissiveFactor)),void 0!==e.alphaCutoff&&(r.alphaCutoff=e.alphaCutoff),e.alphaMode&&(r.alphaMode=u[e.alphaMode]),void 0!==e.doubleSided&&(r.doubleSided=e.doubleSided),yield Promise.all(Object.values(a));for(const t in a)r[t]=yield a[t];return r})}static loadTexture(t,n,e){return r(this,void 0,void 0,function*(){const r=n.context.gl,i=n.gAsset.gltf;if(n.textures[t.index])return n.textures[t.index];const a=i.textures[t.index],u=yield n.gAsset.imageData.get(a.source),s=void 0!==a.sampler?i.samplers[a.sampler]:{},c=new o.Texture2(n.context,e);c.initialize(u.width,u.height,r.RGBA,r.RGBA,r.UNSIGNED_BYTE),c.wrap(s.wrapS||r.REPEAT,s.wrapT||r.REPEAT,!0,!1);const l=s.magFilter||r.LINEAR,f=s.minFilter||r.LINEAR_MIPMAP_LINEAR;return c.filter(l,f,!1,!1),c.data(u,!1,!1),(f===r.LINEAR_MIPMAP_LINEAR||f===r.LINEAR_MIPMAP_NEAREST||f===r.NEAREST_MIPMAP_LINEAR||f===r.NEAREST_MIPMAP_NEAREST)&&r.generateMipmap(r.TEXTURE_2D),c.unbind(),n.textures[t.index]=c,c})}get shaderFlags(){let t=0;return this.baseColorTexture&&(t|=a.ShaderFlags.HAS_BASECOLORMAP),this.normalTexture&&(t|=a.ShaderFlags.HAS_NORMALMAP),this.emissiveTexture&&(t|=a.ShaderFlags.HAS_EMISSIVEMAP),this.metallicRoughnessTexture&&(t|=a.ShaderFlags.HAS_METALROUGHNESSMAP),this.occlusionTexture&&(t|=a.ShaderFlags.HAS_OCCLUSIONMAP),t}bind(t){const n=this.context.gl,e=t.uniforms;this.doubleSided?n.disable(n.CULL_FACE):n.enable(n.CULL_FACE),this.alphaMode!==u.OPAQUE&&(n.enable(n.BLEND),n.blendFunc(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA),n.uniform1f(e.u_AlphaBlend,1),this.alphaMode===u.MASK&&n.uniform1f(e.u_AlphaCutoff,this.alphaCutoff)),n.uniform4fv(e.u_BaseColorFactor,this.baseColorFactor),this.baseColorTexture&&(this.baseColorTexture.bind(n.TEXTURE0),n.uniform1i(e.u_BaseColorTexCoord,this.baseColorTexCoord)),this.normalTexture&&(this.normalTexture.bind(n.TEXTURE1),n.uniform1i(e.u_NormalTexCoord,this.normalTexCoord),n.uniform1f(e.u_NormalScale,this.normalScale)),this.emissiveTexture&&(this.emissiveTexture.bind(n.TEXTURE2),n.uniform1i(e.u_EmissiveTexCoord,this.emissiveTexCoord),n.uniform3fv(e.u_EmissiveFactor,this.emissiveFactor)),this.metallicRoughnessTexture&&(this.metallicRoughnessTexture.bind(n.TEXTURE3),n.uniform1i(e.u_MetallicRoughnessTexCoord,this.metallicRoughnessTexCoord)),n.uniform2f(e.u_MetallicRoughnessValues,this.metallicFactor,this.roughnessFactor),this.occlusionTexture&&(this.occlusionTexture.bind(n.TEXTURE4),n.uniform1i(e.u_OcclusionTexCoord,this.occlusionTexCoord),n.uniform1f(e.u_OcclusionStrength,this.occlusionStrength))}unbind(t){const n=this.context.gl;this.alphaMode!==u.OPAQUE&&(n.disable(n.BLEND),n.uniform1f(t.uniforms.u_AlphaBlend,0),this.alphaMode===u.MASK&&n.uniform1f(t.uniforms.u_AlphaCutoff,0))}}n.Material=s},function(t,n){t.exports=function(t){var n={};function e(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:r})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var i in t)e.d(r,i,function(n){return t[n]}.bind(null,i));return r},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=7)}([function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.LoadingManager=class{constructor(){this.urlModifier=void 0,this.onStart=void 0,this.onProgress=void 0,this.onLoad=void 0,this.onError=void 0,this.isLoading=!1,this.itemsLoaded=0,this.itemsTotal=0}itemStart(t){this.itemsTotal++,!this.isLoading&&this.onStart&&this.onStart(t,this.itemsLoaded,this.itemsTotal),this.isLoading=!0}itemEnd(t){this.itemsLoaded++,this.onProgress&&this.onProgress(t,this.itemsLoaded,this.itemsTotal),this.itemsLoaded===this.itemsTotal&&(this.isLoading=!1,this.onLoad&&this.onLoad())}itemError(t){this.onError&&this.onError(t)}resolveURL(t){return this.urlModifier?this.urlModifier(t):t}}},function(t,n,e){"use strict";var r=this&&this.__awaiter||function(t,n,e,r){return new(e||(e=Promise))(function(i,o){function a(t){try{s(r.next(t))}catch(t){o(t)}}function u(t){try{s(r.throw(t))}catch(t){o(t)}}function s(t){t.done?i(t.value):new e(function(n){n(t.value)}).then(a,u)}s((r=r.apply(t,n||[])).next())})};Object.defineProperty(n,"__esModule",{value:!0});const i=e(3),o=e(0);n.GLTF_COMPONENT_TYPE_ARRAYS={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},n.GLTF_ELEMENTS_PER_TYPE={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},n.GltfAsset=class{constructor(t,n,e,r=new o.LoadingManager){this.gltf=t,this.glbData=e,this.bufferData=new a(this,n,r),this.imageData=new u(this,n,r)}bufferViewData(t){return r(this,void 0,void 0,function*(){if(!this.gltf.bufferViews)throw new Error("No buffer views found.");const n=this.gltf.bufferViews[t],e=yield this.bufferData.get(n.buffer),r=n.byteLength||0,i=n.byteOffset||0,o=e.buffer,a=e.byteOffset;return new Uint8Array(o,a+i,r)})}accessorData(t){return r(this,void 0,void 0,function*(){if(!this.gltf.accessors)throw new Error("No accessors views found.");const e=this.gltf.accessors[t],r=n.GLTF_ELEMENTS_PER_TYPE[e.type];let i;if(void 0!==e.bufferView)i=yield this.bufferViewData(e.bufferView);else{const t=n.GLTF_COMPONENT_TYPE_ARRAYS[e.componentType].BYTES_PER_ELEMENT*r*e.count;i=new Uint8Array(t)}if(e.sparse){const{count:t,indices:o,values:a}=e.sparse;let u=n.GLTF_COMPONENT_TYPE_ARRAYS[o.componentType],s=yield this.bufferViewData(o.bufferView);const c=new u(s.buffer,s.byteOffset+(o.byteOffset||0),t);u=n.GLTF_COMPONENT_TYPE_ARRAYS[e.componentType],s=yield this.bufferViewData(a.bufferView);const l=new u((yield this.bufferViewData(a.bufferView)).buffer,s.byteOffset+(a.byteOffset||0),t*r);e.bufferView&&(i=new Uint8Array(i));const f=new n.GLTF_COMPONENT_TYPE_ARRAYS[e.componentType](i.buffer);for(let n=0;n<t;n++)for(let t=0;t<r;t++)f[r*c[n]+t]=l[r*n+t]}return i})}preFetchAll(){return r(this,void 0,void 0,function*(){return Promise.all([this.bufferData.preFetchAll(),this.imageData.preFetchAll()])})}};class a{constructor(t,n,e){this.bufferCache=[],this.asset=t,this.baseUri=n,this.manager=e,this.loader=new i.FileLoader(e),this.loader.responseType="arraybuffer"}get(t){return r(this,void 0,void 0,function*(){if(void 0!==this.bufferCache[t])return this.bufferCache[t];const n=this.asset.gltf;if(!n.buffers)throw new Error("No buffers found.");const e=n.buffers[t];if(void 0===e.uri){if(0!==t)throw new Error("GLB container is required to be the first buffer");if(void 0===this.asset.glbData)throw new Error("invalid gltf: buffer has no uri nor is there a GLB buffer");return this.asset.glbData.binaryChunk}const r=s(e.uri,this.baseUri),i=yield this.loader.load(r),o=new Uint8Array(i);return this.bufferCache[t]=o,o})}preFetchAll(){return r(this,void 0,void 0,function*(){const t=this.asset.gltf.buffers;return t?Promise.all(t.map((t,n)=>this.get(n))):[]})}}n.BufferData=a;class u{constructor(t,n,e){this.crossOrigin="anonymous",this.imageCache=[],this.asset=t,this.baseUri=n,this.manager=e}get(t){return r(this,void 0,void 0,function*(){if(void 0!==this.imageCache[t])return this.imageCache[t];const n=this.asset.gltf;if(!n.images)throw new Error("No images found.");const e=n.images[t];let r,i=!1;if(void 0!==e.bufferView){const t=yield this.asset.bufferViewData(e.bufferView);i=!0;const n=new Blob([t],{type:e.mimeType});r=URL.createObjectURL(n)}else{if(void 0===e.uri)throw new Error("Invalid glTF: image must either have a `uri` or a `bufferView`");r=this.manager.resolveURL(s(e.uri,this.baseUri))}const o=new Image;return o.crossOrigin=this.crossOrigin,new Promise((n,e)=>{o.onerror=(()=>{e(`Failed to load ${r}`),this.manager.itemEnd(r),this.manager.itemError(r)}),o.onload=(()=>{i&&URL.revokeObjectURL(r),this.imageCache[t]=o,n(o),this.manager.itemEnd(r)}),o.src=r,this.manager.itemStart(r)})})}preFetchAll(){return r(this,void 0,void 0,function*(){const t=this.asset.gltf.images;return t?Promise.all(t.map((t,n)=>this.get(n))):[]})}}function s(t,n){return"string"!=typeof t||""===t?"":/^(https?:)?\/\//i.test(t)?t:/^data:.*,.*$/i.test(t)?t:/^blob:.*$/i.test(t)?t:n+t}n.ImageData=u,n.resolveURL=s},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.LoaderUtils=class{static decodeText(t){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(t);let n="";for(const e of t)n+=String.fromCharCode(e);return decodeURIComponent(escape(n))}static extractUrlBase(t){const n=t.split("/");return 1===n.length?"./":(n.pop(),n.join("/")+"/")}}},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.FileLoader=class{constructor(t){this.runningRequests={},this.manager=t}load(t,n){if(void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t),this.runningRequests[t])return this.runningRequests[t];const e=new Promise((e,r)=>{const i=new XMLHttpRequest;i.open("GET",t,!0);const o=this;i.onload=function(n){const a=this.response;0===this.status?(console.warn("FileLoader: HTTP Status 0 received."),e(a),o.manager.itemEnd(t)):200===this.status?(e(a),o.manager.itemEnd(t)):(r({url:t,status:this.status,statusText:i.statusText}),o.manager.itemEnd(t),o.manager.itemError(t)),delete o.runningRequests[t]},i.onprogress=(t=>{n&&n(t)}),i.onerror=function(n){r({url:t,status:this.status,statusText:i.statusText}),o.manager.itemEnd(t),o.manager.itemError(t),delete o.runningRequests[t]},this.responseType&&(i.responseType=this.responseType),this.withCredentials&&(i.withCredentials=this.withCredentials),this.mimeType&&i.overrideMimeType&&i.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain");for(const t in this.requestHeaders)i.setRequestHeader(t,this.requestHeaders[t]);i.send(null),this.manager.itemStart(t)});return this.runningRequests[t]=e,e}setRequestHeader(t,n){return this.requestHeaders[t]=n,this}}},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0})},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const r=e(2);n.BINARY_HEADER_MAGIC="glTF";const i=1313821514,o=5130562;n.GLTFBinaryData=class{constructor(t){const e=new DataView(t,0,12),a=r.LoaderUtils.decodeText(new Uint8Array(t,0,4)),u=e.getUint32(4,!0);if(e.getUint32(8,!0),a!==n.BINARY_HEADER_MAGIC)throw new Error("Unsupported glTF-Binary header.");if(u<2)throw new Error("Unsupported legacy binary file detected.");const s=new DataView(t,12);let c=0;for(;c<s.byteLength;){const n=s.getUint32(c,!0);c+=4;const e=s.getUint32(c,!0);if(c+=4,e===i){const e=new Uint8Array(t,12+c,n);this.json=r.LoaderUtils.decodeText(e)}else if(e===o){const e=12+c;this.binaryChunk=new Uint8Array(t,e,n)}c+=n}if(null===this.json)throw new Error("glTF-Binary: JSON content not found.")}}},function(t,n,e){"use strict";var r=this&&this.__awaiter||function(t,n,e,r){return new(e||(e=Promise))(function(i,o){function a(t){try{s(r.next(t))}catch(t){o(t)}}function u(t){try{s(r.throw(t))}catch(t){o(t)}}function s(t){t.done?i(t.value):new e(function(n){n(t.value)}).then(a,u)}s((r=r.apply(t,n||[])).next())})};function i(t){for(var e in t)n.hasOwnProperty(e)||(n[e]=t[e])}Object.defineProperty(n,"__esModule",{value:!0});const o=e(3),a=e(5),u=e(1),s=e(2),c=e(0),l=e(4);n.gltf=l,i(e(1)),i(e(0)),n.GltfLoader=class{constructor(t){this.manager=t||new c.LoadingManager}load(t,n){return r(this,void 0,void 0,function*(){const e=s.LoaderUtils.extractUrlBase(t),r=new o.FileLoader(this.manager);r.responseType="arraybuffer";const i=yield r.load(t,n);return yield this.parse(i,e)})}loadFromFiles(t){return r(this,void 0,void 0,function*(){let n,e;for(const[r,i]of t)i.name.match(/\.(gltf|glb)$/)&&(n=i,e=r.replace(i.name,""));if(!n)throw new Error("No .gltf or .glb asset found.");const r="string"==typeof n?n:URL.createObjectURL(n),i=s.LoaderUtils.extractUrlBase(r),o=[];this.manager.urlModifier=(n=>{const r=e+n.replace(i,"").replace(/^(\.?\/)/,"");if(t.has(r)){const n=t.get(r),e=URL.createObjectURL(n);return o.push(e),e}return n});const a=yield this.load(r);return yield a.preFetchAll(),URL.revokeObjectURL(r),o.forEach(URL.revokeObjectURL),a})}parse(t,n){return r(this,void 0,void 0,function*(){let e,r=void 0;e="string"==typeof t?t:s.LoaderUtils.decodeText(new Uint8Array(t,0,4))===a.BINARY_HEADER_MAGIC?(r=new a.GLTFBinaryData(t)).json:s.LoaderUtils.decodeText(new Uint8Array(t));const i=JSON.parse(e);if(void 0===i.asset||i.asset.version[0]<2)throw new Error("Unsupported asset. glTF versions >=2.0 are supported.");return new u.GltfAsset(i,n,r,this.manager)})}}},function(t,n,e){t.exports=e(6)}])},function(t,n,e){var r;t.exports=((r=function(){function t(t){return i.appendChild(t.dom),t}function n(t){for(var n=0;n<i.children.length;n++)i.children[n].style.display=n===t?"block":"none";e=t}var e=0,i=document.createElement("div");i.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",i.addEventListener("click",function(t){t.preventDefault(),n(++e%i.children.length)},!1);var o=(performance||Date).now(),a=o,u=0,s=t(new r.Panel("FPS","#0ff","#002")),c=t(new r.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var l=t(new r.Panel("MB","#f08","#201"));return n(0),{REVISION:16,dom:i,addPanel:t,showPanel:n,begin:function(){o=(performance||Date).now()},end:function(){u++;var t=(performance||Date).now();if(c.update(t-o,200),t>a+1e3&&(s.update(1e3*u/(t-a),100),a=t,u=0,l)){var n=performance.memory;l.update(n.usedJSHeapSize/1048576,n.jsHeapSizeLimit/1048576)}return t},update:function(){o=this.end()},domElement:i,setMode:n}}).Panel=function(t,n,e){var r=1/0,i=0,o=Math.round,a=o(window.devicePixelRatio||1),u=80*a,s=48*a,c=3*a,l=2*a,f=3*a,h=15*a,d=74*a,m=30*a,p=document.createElement("canvas");p.width=u,p.height=s,p.style.cssText="width:80px;height:48px";var M=p.getContext("2d");return M.font="bold "+9*a+"px Helvetica,Arial,sans-serif",M.textBaseline="top",M.fillStyle=e,M.fillRect(0,0,u,s),M.fillStyle=n,M.fillText(t,c,l),M.fillRect(f,h,d,m),M.fillStyle=e,M.globalAlpha=.9,M.fillRect(f,h,d,m),{dom:p,update:function(s,b){r=Math.min(r,s),i=Math.max(i,s),M.fillStyle=e,M.globalAlpha=1,M.fillRect(0,0,u,h),M.fillStyle=n,M.fillText(o(s)+" "+t+" ("+o(r)+"-"+o(i)+")",c,l),M.drawImage(p,f+a,h,d-a,m,f,h,d-a,m),M.fillRect(f+d-a,h,a,m),M.fillStyle=e,M.globalAlpha=.9,M.fillRect(f+d-a,h,a,o((1-s/b)*m))}}},r)},function(t,n,e){"use strict";var r=this&&this.__awaiter||function(t,n,e,r){return new(e||(e=Promise))(function(i,o){function a(t){try{s(r.next(t))}catch(t){o(t)}}function u(t){try{s(r.throw(t))}catch(t){o(t)}}function s(t){t.done?i(t.value):new e(function(n){n(t.value)}).then(a,u)}s((r=r.apply(t,n||[])).next())})};Object.defineProperty(n,"__esModule",{value:!0});const i=e(1),o=e(3);class a{constructor(){this.children=[],this.finalTransform=i.mat4.create(),this.normalMatrix=i.mat3.create()}static fromGltf(t,n){return r(this,void 0,void 0,function*(){const e=new a;return e.name=t.name,e.context=n.context,void 0!==t.matrix?e.matrix=i.mat4.fromValues.apply(void 0,t.matrix):t.translation||t.rotation||t.scale?(e.translation=t.translation?i.vec3.fromValues.apply(void 0,t.translation):i.vec3.create(),e.rotation=t.rotation?i.quat.fromValues.apply(void 0,t.rotation):i.quat.create(),e.scale=t.scale?i.vec3.fromValues.apply(void 0,t.scale):i.vec3.fromValues(1,1,1)):e.matrix=i.mat4.create(),void 0!==t.mesh&&(e.mesh=yield n.getMesh(t.mesh)),t.children&&(e.children=yield Promise.all(t.children.map(t=>a.fromGltf(n.gAsset.gltf.nodes[t],n)))),e})}updateTransform(t){if(this.finalTransform=i.mat4.clone(t),this.matrix)i.mat4.mul(this.finalTransform,this.finalTransform,this.matrix);else{const t=i.mat4.fromRotationTranslationScale(i.mat4.create(),this.rotation,this.translation,this.scale);i.mat4.mul(this.finalTransform,this.finalTransform,t)}i.mat3.normalFromMat4(this.normalMatrix,this.finalTransform);for(const t of this.children)t.updateTransform(this.finalTransform)}updateBounds(){if(this.mesh)this.bounds=this.mesh.bounds.clone(),this.bounds.transform(this.finalTransform);else if(0===this.children.length)this.bounds=new o.Aabb3(i.vec3.fromValues(0,0,0),i.vec3.fromValues(0,0,0)),this.bounds.transform(this.finalTransform);else{this.bounds=new o.Aabb3;for(const t of this.children)t.updateBounds(),this.bounds.union(t.bounds)}}uninitialize(){this.mesh&&this.mesh.uninitialize();for(const t of this.children)t.uninitialize()}}n.Node=a},function(t,n,e){"use strict";var r=this&&this.__awaiter||function(t,n,e,r){return new(e||(e=Promise))(function(i,o){function a(t){try{s(r.next(t))}catch(t){o(t)}}function u(t){try{s(r.throw(t))}catch(t){o(t)}}function s(t){t.done?i(t.value):new e(function(n){n(t.value)}).then(a,u)}s((r=r.apply(t,n||[])).next())})};Object.defineProperty(n,"__esModule",{value:!0});const i=e(1),o=e(3),a=e(5),u=e(8);class s{constructor(){this.nodes=[],this.batchesByMaterial=new Map,this.bounds=new o.Aabb3}static fromGltf(t,n){return r(this,void 0,void 0,function*(){const e=new s;e.context=n.context,e.name=t.name,e.rootNodes=yield Promise.all(t.nodes.map(t=>{const e=n.gAsset.gltf.nodes[t];return u.Node.fromGltf(e,n)}));const r=i.mat4.create();for(const t of e.rootNodes)t.updateTransform(r),t.updateBounds(),e.bounds.union(t.bounds);for(const t of e.rootNodes){e.nodes.push(t);const n=[t];for(;n.length>0;){const t=n.pop();e.nodes.push(t),n.push.apply(n,t.children)}}for(const t of e.nodes)if(void 0!==t.mesh)for(const n of t.mesh.primitives){const r=n.material,i=e.batchesByMaterial.get(r)||[];0===i.length&&e.batchesByMaterial.set(r,i),i.push({node:t,primitive:n})}const o=Array.from(e.batchesByMaterial.keys()),c=o.filter(t=>t.alphaMode===a.AlphaMode.OPAQUE),l=o.filter(t=>t.alphaMode!==a.AlphaMode.OPAQUE);return e.sortedMaterials=c.concat(l),e})}draw(t,n){const e=this.context.gl;for(const t of this.sortedMaterials){const r=this.batchesByMaterial.get(t);t.bind(n);for(const{primitive:t,node:i}of r)e.uniformMatrix4fv(n.uniforms.u_ModelMatrix,e.FALSE,i.finalTransform),e.uniformMatrix3fv(n.uniforms.u_NormalMatrix,e.FALSE,i.normalMatrix),t.draw(n);t.unbind(n)}}uninitialize(){for(const t of this.rootNodes)t.uninitialize()}}n.Scene=s},function(t,n,e){"use strict";var r=this&&this.__awaiter||function(t,n,e,r){return new(e||(e=Promise))(function(i,o){function a(t){try{s(r.next(t))}catch(t){o(t)}}function u(t){try{s(r.throw(t))}catch(t){o(t)}}function s(t){t.done?i(t.value):new e(function(n){n(t.value)}).then(a,u)}s((r=r.apply(t,n||[])).next())})};Object.defineProperty(n,"__esModule",{value:!0});const i=e(0),o=i.auxiliaries.assert,a=e(1),u=e(6),s=e(3),c=e(5),l=e(4);class f{constructor(t,n,e,r,i,o){this.buffer=t,this.size=n,this.type=e,this.normalized=r,this.stride=i,this.offset=o}static fromGltf(t,n,e){return new f(e,u.GLTF_ELEMENTS_PER_TYPE[t.type],t.componentType,t.normalized||!1,n||0,t.byteOffset||0)}enable(t){this.buffer.attribEnable(t,this.size,this.type,this.normalized,this.stride,this.offset,!0,!1)}disable(t){this.buffer.attribDisable(t,!1,!0)}}class h{constructor(t,n="Primitive"){this.attributes={},this.identifier=n,this.vertexArray=new i.VertexArray(t,n+"_VAO")}static fromGltf(t,n,e){return r(this,void 0,void 0,function*(){const r=new h(n.context,e);r.mode=t.mode||4;const u=n.context,d=r.context.gl,m=n.gAsset,p=m.gltf;if(o(void 0!==t.attributes.POSITION,"primitives must have the POSITION attribute"),void 0===p.bufferViews)throw new Error("invalid gltf");const M={};for(const n in t.attributes){const e=t.attributes[n],o=p.accessors[e];r.numVertices=o.count;const u=o.bufferView;let c,l;if(void 0!==u&&u in M)c=M[u],l=p.bufferViews[u].byteStride;else{const t=yield m.accessorData(e);(c=new i.Buffer(r.context,`${r.identifier}_VBO_${Object.keys(M).length}`)).initialize(d.ARRAY_BUFFER),c.data(t,d.STATIC_DRAW),void 0!==u&&(M[u]=c,l=p.bufferViews[u].byteStride)}r.attributes[n]=f.fromGltf(o,l,c),"POSITION"===n&&(r.bounds=new s.Aabb3(a.vec3.fromValues.apply(void 0,o.min),a.vec3.fromValues.apply(void 0,o.max)))}let b=0;if(void 0!==t.attributes.NORMAL&&(b|=l.ShaderFlags.HAS_NORMALS),void 0!==t.attributes.TANGENT&&(b|=l.ShaderFlags.HAS_TANGENTS),void 0!==t.attributes.TEXCOORD_0&&(b|=l.ShaderFlags.HAS_UV),void 0!==t.attributes.COLOR_0&&(b|=l.ShaderFlags.HAS_COLORS),void 0!==t.indices){const n=p.accessors[t.indices],e=yield m.accessorData(t.indices);if(r.indexBuffer=new i.Buffer(r.context,`${r.identifier}_EBO`),r.numIndices=n.count,r.indexByteOffset=n.byteOffset||0,r.indexType=n.componentType,r.indexType===d.UNSIGNED_INT&&u.isWebGL1){if(!u.supportsElementIndexUint)throw new Error(`Primitive ${r.identifier} needs unsupported extension OES_element_index_uint`);u.elementIndexUint}r.indexBuffer.initialize(d.ELEMENT_ARRAY_BUFFER),r.indexBuffer.data(e,d.STATIC_DRAW),i.auxiliaries.assert(void 0!==r.indexBuffer&&r.indexBuffer.object instanceof WebGLBuffer,"expected valid WebGLBuffer")}return void 0===t.material?(r.material=new c.Material(u),r.material.name="DefaultMaterial"):r.material=yield n.getMaterial(t.material),r.shaderFlags=b|r.material.shaderFlags,r.initialize(),r})}bindBuffers(){for(const t in this.attributes){const n=this.shader.attribLocations[t];void 0!==n&&-1!==n&&this.attributes[t].enable(n)}this.numIndices&&this.indexBuffer.bind()}unbindBuffers(){for(const t in this.attributes){const n=this.shader.attribLocations[t];void 0!==n&&-1!==n&&this.attributes[t].disable(n)}this.numIndices&&this.indexBuffer.unbind()}initialize(...t){const n=this.context.gl;return this.numIndices?this.drawCall=(()=>{n.drawElements(this.mode,this.numIndices,this.indexType,this.indexByteOffset)}):this.drawCall=(()=>{n.drawArrays(this.mode,0,this.numVertices)}),this.vertexArray.initialize(()=>this.bindBuffers(),()=>this.unbindBuffers()),this.vertexArray.valid}uninitialize(){this.vertexArray.uninitialize();for(const t in this.attributes){const n=this.attributes[t].buffer;n.initialized&&n.uninitialize()}this.indexBuffer&&this.indexBuffer.uninitialize()}draw(t){this.shader=t,this.context.gl.uniform1i(t.uniforms.u_PbrFlags,this.shaderFlags),this.vertexArray.bind(),this.drawCall(),this.vertexArray.unbind(),this.shader=void 0}get context(){return this.vertexArray.context}}n.Primitive=h},function(t,n,e){"use strict";var r=this&&this.__awaiter||function(t,n,e,r){return new(e||(e=Promise))(function(i,o){function a(t){try{s(r.next(t))}catch(t){o(t)}}function u(t){try{s(r.throw(t))}catch(t){o(t)}}function s(t){t.done?i(t.value):new e(function(n){n(t.value)}).then(a,u)}s((r=r.apply(t,n||[])).next())})};Object.defineProperty(n,"__esModule",{value:!0});const i=e(3),o=e(10);class a{constructor(){this.bounds=new i.Aabb3}static fromGltf(t,n){return r(this,void 0,void 0,function*(){const e=n.gAsset.gltf.meshes[t],r=new a;r.context=n.context,r.name=e.name,r.primitives=yield Promise.all(e.primitives.map((r,i)=>{const a=`mesh_${e.name||t}_prim_${i}`;return o.Primitive.fromGltf(r,n,a)}));for(const t of r.primitives)r.bounds.union(t.bounds);return r})}uninitialize(){for(const t of this.primitives)t.uninitialize()}}n.Mesh=a},function(t,n){t.exports="// Originally taken from https://github.com/KhronosGroup/glTF-WebGL-PBR\n// Commit c28b5b8f5a83380857ad8395ac5302594ecc13ae\n//\n// This fragment shader defines a reference implementation for Physically Based Shading of\n// a microfacet surface material defined by a glTF model.\n//\n// References:\n// [1] Real Shading in Unreal Engine 4\n//     http://blog.selfshadow.com/publications/s2013-shading-course/karis/s2013_pbs_epic_notes_v2.pdf\n// [2] Physically Based Shading at Disney\n//     http://blog.selfshadow.com/publications/s2012-shading-course/burley/s2012_pbs_disney_brdf_notes_v3.pdf\n// [3] README.md - Environment Maps\n//     https://github.com/KhronosGroup/glTF-WebGL-PBR/#environment-maps\n// [4] \"An Inexpensive BRDF Model for Physically based Rendering\" by Christophe Schlick\n//     https://www.cs.virginia.edu/~jdl/bib/appearance/analytic%20models/schlick94b.pdf\n\nprecision highp float;\n\n#if __VERSION__ == 100\n    #extension GL_EXT_shader_texture_lod: enable\n    #extension GL_OES_standard_derivatives : enable\n    #define fragColor gl_FragColor\n    #define texture( texture2D(\n#else\n    #define varying in\n    layout(location = 0) out vec4 fragColor;\n#endif\n\n// vertex shader + fragment shader\nconst int HAS_NORMALS           = 1;\nconst int HAS_TANGENTS          = 1 << 1;\nconst int HAS_UV                = 1 << 2;\nconst int HAS_COLORS            = 1 << 3;\n\n// fragment shader only\nconst int USE_IBL               = 1 << 4;\nconst int HAS_BASECOLORMAP      = 1 << 5;\nconst int HAS_NORMALMAP         = 1 << 6;\nconst int HAS_EMISSIVEMAP       = 1 << 7;\nconst int HAS_METALROUGHNESSMAP = 1 << 8;\nconst int HAS_OCCLUSIONMAP      = 1 << 9;\nconst int USE_TEX_LOD           = 1 << 10;\n\nuniform vec3 u_LightDirection;\nuniform vec3 u_LightColor;\n\n// TODO!: ambient light or only IBL? (see gltf-viewer)\n\n#ifdef USE_IBL\nuniform samplerCube u_DiffuseEnvSampler;\nuniform samplerCube u_SpecularEnvSampler;\nuniform sampler2D u_brdfLUT;\n#endif\n\nuniform mediump int u_PbrFlags;\n\nuniform sampler2D u_BaseColorSampler;\nuniform lowp int u_BaseColorTexCoord;\n\nuniform sampler2D u_NormalSampler;\nuniform lowp int u_NormalTexCoord;\nuniform float u_NormalScale;\n\nuniform sampler2D u_EmissiveSampler;\nuniform lowp int u_EmissiveTexCoord;\nuniform vec3 u_EmissiveFactor;\n\nuniform sampler2D u_MetallicRoughnessSampler;\nuniform lowp int u_MetallicRoughnessTexCoord;\nuniform sampler2D u_OcclusionSampler;\nuniform lowp int u_OcclusionTexCoord;\nuniform float u_OcclusionStrength;\n\nuniform vec2 u_MetallicRoughnessValues;\nuniform vec4 u_BaseColorFactor;\n\nuniform vec3 u_Camera;\n\nuniform float u_AlphaBlend;\nuniform float u_AlphaCutoff;\n\n// // debugging flags used for shader output of intermediate PBR variables\n// uniform vec4 u_ScaleDiffBaseMR;\n// uniform vec4 u_ScaleFGDSpec;\n// uniform vec4 u_ScaleIBLAmbient;\n\nvarying vec3 v_Position;\nvarying vec2 v_UV[2];\nvarying vec4 v_Color;\nvarying mat3 v_TBN;\nvarying vec3 v_Normal;\n\n// Encapsulate the various inputs used by the various functions in the shading equation\n// We store values in this struct to simplify the integration of alternative implementations\n// of the shading terms, outlined in the Readme.MD Appendix.\nstruct PBRInfo\n{\n    float NdotL;                  // cos angle between normal and light direction\n    float NdotV;                  // cos angle between normal and view direction\n    float NdotH;                  // cos angle between normal and half vector\n    float LdotH;                  // cos angle between light direction and half vector\n    float VdotH;                  // cos angle between view direction and half vector\n    float perceptualRoughness;    // roughness value, as authored by the model creator (input to shader)\n    float metalness;              // metallic value at the surface\n    vec3 reflectance0;            // full reflectance color (normal incidence angle)\n    vec3 reflectance90;           // reflectance color at grazing angle\n    float alphaRoughness;         // roughness mapped to a more linear change in the roughness (proposed by [2])\n    vec3 diffuseColor;            // color contribution from diffuse lighting\n    vec3 specularColor;           // color contribution from specular lighting\n};\n\nconst float M_PI = 3.141592653589793;\nconst float c_MinRoughness = 0.04;\n\nvec4 SRGBtoLINEAR(vec4 srgbIn)\n{\n    #ifdef MANUAL_SRGB\n    #ifdef SRGB_FAST_APPROXIMATION\n    vec3 linOut = pow(srgbIn.xyz,vec3(2.2));\n    #else //SRGB_FAST_APPROXIMATION\n    vec3 bLess = step(vec3(0.04045),srgbIn.xyz);\n    vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );\n    #endif //SRGB_FAST_APPROXIMATION\n    return vec4(linOut,srgbIn.w);;\n    #else //MANUAL_SRGB\n    return srgbIn;\n    #endif //MANUAL_SRGB\n}\n\nbool checkFlag(int flag) {\n    return (u_PbrFlags & flag) == flag;\n}\n\n// Find the normal for this fragment, pulling either from a predefined normal map\n// or from the interpolated mesh normal and tangent attributes.\nvec3 getNormal()\n{\n    // Retrieve the tangent space matrix\n    mat3 tbn;\nif (!checkFlag(HAS_TANGENTS)) {\n    vec3 pos_dx = dFdx(v_Position);\n    vec3 pos_dy = dFdy(v_Position);\n    vec3 tex_dx = dFdx(vec3(v_UV[0], 0.0));\n    vec3 tex_dy = dFdy(vec3(v_UV[0], 0.0));\n    vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\n\n    vec3 ng;\nif (checkFlag(HAS_NORMALS))\n    ng = normalize(v_Normal);\nelse\n    ng = cross(pos_dx, pos_dy);\n\n    t = normalize(t - ng * dot(ng, t));\n    vec3 b = normalize(cross(ng, t));\n    tbn = mat3(t, b, ng);\n} else { // HAS_TANGENTS\n    tbn = v_TBN;\n}\n\n    vec3 n;\nif (checkFlag(HAS_NORMALMAP)) {\n    n = texture(u_NormalSampler, v_UV[u_NormalTexCoord]).rgb;\n    n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_NormalScale, u_NormalScale, 1.0)));\n} else {\n    // The tbn matrix is linearly interpolated, so we need to re-normalize\n    n = normalize(tbn[2].xyz);\n}\n\n    // reverse backface normals\n    n *= (2.0 * float(gl_FrontFacing) - 1.0);\n\n    return n;\n}\n\n#ifdef USE_IBL\n// Calculation of the lighting contribution from an optional Image Based Light source.\n// Precomputed Environment Maps are required uniform inputs and are computed as outlined in [1].\n// See our README.md on Environment Maps [3] for additional discussion.\nvec3 getIBLContribution(PBRInfo pbrInputs, vec3 n, vec3 reflection)\n{\n    float mipCount = 9.0; // resolution of 512x512\n    float lod = (pbrInputs.perceptualRoughness * mipCount);\n    // retrieve a scale and bias to F0. See [1], Figure 3\n    vec3 brdf = SRGBtoLINEAR(texture(u_brdfLUT, vec2(pbrInputs.NdotV, 1.0 - pbrInputs.perceptualRoughness))).rgb;\n    vec3 diffuseLight = SRGBtoLINEAR(textureCube(u_DiffuseEnvSampler, n)).rgb;\n\n#ifdef USE_TEX_LOD\n    vec3 specularLight = SRGBtoLINEAR(textureCubeLodEXT(u_SpecularEnvSampler, reflection, lod)).rgb;\n#else\n    vec3 specularLight = SRGBtoLINEAR(textureCube(u_SpecularEnvSampler, reflection)).rgb;\n#endif\n\n    vec3 diffuse = diffuseLight * pbrInputs.diffuseColor;\n    vec3 specular = specularLight * (pbrInputs.specularColor * brdf.x + brdf.y);\n\n    // For presentation, this allows us to disable IBL terms\n    diffuse *= u_ScaleIBLAmbient.x;\n    specular *= u_ScaleIBLAmbient.y;\n\n    return diffuse + specular;\n}\n#endif\n\n// Basic Lambertian diffuse\n// Implementation from Lambert's Photometria https://archive.org/details/lambertsphotome00lambgoog\n// See also [1], Equation 1\nvec3 diffuse(PBRInfo pbrInputs)\n{\n    return pbrInputs.diffuseColor / M_PI;\n}\n\n// The following equation models the Fresnel reflectance term of the spec equation (aka F())\n// Implementation of fresnel from [4], Equation 15\nvec3 specularReflection(PBRInfo pbrInputs)\n{\n    return pbrInputs.reflectance0 + (pbrInputs.reflectance90 - pbrInputs.reflectance0) * pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);\n}\n\n// This calculates the specular geometric attenuation (aka G()),\n// where rougher material will reflect less light back to the viewer.\n// This implementation is based on [1] Equation 4, and we adopt their modifications to\n// alphaRoughness as input as originally proposed in [2].\nfloat geometricOcclusion(PBRInfo pbrInputs)\n{\n    float NdotL = pbrInputs.NdotL;\n    float NdotV = pbrInputs.NdotV;\n    float r = pbrInputs.alphaRoughness;\n\n    float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));\n    float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));\n    return attenuationL * attenuationV;\n}\n\n// The following equation(s) model the distribution of microfacet normals across the area being drawn (aka D())\n// Implementation from \"Average Irregularity Representation of a Roughened Surface for Ray Reflection\" by T. S. Trowbridge, and K. P. Reitz\n// Follows the distribution function recommended in the SIGGRAPH 2013 course notes from EPIC Games [1], Equation 3.\nfloat microfacetDistribution(PBRInfo pbrInputs)\n{\n    float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;\n    float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;\n    return roughnessSq / (M_PI * f * f);\n}\n\nvoid main()\n{\n    // Metallic and Roughness material properties are packed together\n    // In glTF, these factors can be specified by fixed scalar values\n    // or from a metallic-roughness map\n    float perceptualRoughness = u_MetallicRoughnessValues.y;\n    float metallic = u_MetallicRoughnessValues.x;\nif (checkFlag(HAS_METALROUGHNESSMAP)) {\n    // Roughness is stored in the 'g' channel, metallic is stored in the 'b' channel.\n    // This layout intentionally reserves the 'r' channel for (optional) occlusion map data\n    vec4 mrSample = texture(u_MetallicRoughnessSampler, v_UV[u_MetallicRoughnessTexCoord]);\n    perceptualRoughness = mrSample.g * perceptualRoughness;\n    metallic = mrSample.b * metallic;\n}\n    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);\n    metallic = clamp(metallic, 0.0, 1.0);\n    // Roughness is authored as perceptual roughness; as is convention,\n    // convert to material roughness by squaring the perceptual roughness [2].\n    float alphaRoughness = perceptualRoughness * perceptualRoughness;\n\n    // The albedo may be defined from a base texture or a flat color\n    vec4 baseColor;\nif (checkFlag(HAS_BASECOLORMAP))\n    baseColor = SRGBtoLINEAR(texture(u_BaseColorSampler, v_UV[u_BaseColorTexCoord])) * u_BaseColorFactor;\nelse\n    baseColor = u_BaseColorFactor;\n\n    // spec: COLOR_0 ... acts as an additional linear multiplier to baseColor\n    // TODO!: distinguish vec3/vec4 colors...\n    baseColor *= vec4(v_Color.rgb, 1.0);\n\n    vec3 f0 = vec3(0.04);\n    vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);\n    diffuseColor *= 1.0 - metallic;\n    vec3 specularColor = mix(f0, baseColor.rgb, metallic);\n\n    // Compute reflectance.\n    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\n\n    // For typical incident reflectance range (between 4% to 100%) set the grazing reflectance to 100% for typical fresnel effect.\n    // For very low reflectance range on highly diffuse objects (below 4%), incrementally reduce grazing reflecance to 0%.\n    float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);\n    vec3 specularEnvironmentR0 = specularColor.rgb;\n    vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;\n\n    vec3 n = getNormal();                             // normal at surface point\n    vec3 v = normalize(u_Camera - v_Position);        // Vector from surface point to camera\n    vec3 l = normalize(u_LightDirection);             // Vector from surface point to light\n    vec3 h = normalize(l+v);                          // Half vector between both l and v\n    vec3 reflection = -normalize(reflect(v, n));\n\n    float NdotL = clamp(dot(n, l), 0.001, 1.0);\n    float NdotV = abs(dot(n, v)) + 0.001;\n    float NdotH = clamp(dot(n, h), 0.0, 1.0);\n    float LdotH = clamp(dot(l, h), 0.0, 1.0);\n    float VdotH = clamp(dot(v, h), 0.0, 1.0);\n\n    PBRInfo pbrInputs = PBRInfo(\n        NdotL,\n        NdotV,\n        NdotH,\n        LdotH,\n        VdotH,\n        perceptualRoughness,\n        metallic,\n        specularEnvironmentR0,\n        specularEnvironmentR90,\n        alphaRoughness,\n        diffuseColor,\n        specularColor\n    );\n\n    // Calculate the shading terms for the microfacet specular shading model\n    vec3 F = specularReflection(pbrInputs);\n    float G = geometricOcclusion(pbrInputs);\n    float D = microfacetDistribution(pbrInputs);\n\n    // Calculation of analytical lighting contribution\n    vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);\n    vec3 specContrib = F * G * D / (4.0 * NdotL * NdotV);\n    // Obtain final intensity as reflectance (BRDF) scaled by the energy of the light (cosine law)\n    vec3 color = NdotL * u_LightColor * (diffuseContrib + specContrib);\n\n    // Calculate lighting contribution from image based lighting source (IBL)\n#ifdef USE_IBL\n    color += getIBLContribution(pbrInputs, n, reflection);\n#endif\n\n    // Apply optional PBR terms for additional (optional) shading\nif (checkFlag(HAS_OCCLUSIONMAP)) {\n    float ao = texture(u_OcclusionSampler, v_UV[u_OcclusionTexCoord]).r;\n    color = mix(color, color * ao, u_OcclusionStrength);\n}\n\nif (checkFlag(HAS_EMISSIVEMAP)) {\n    vec3 emissive = SRGBtoLINEAR(texture(u_EmissiveSampler, v_UV[u_EmissiveTexCoord])).rgb * u_EmissiveFactor;\n    color += emissive;\n}\n\n    // // This section uses mix to override final color for reference app visualization\n    // // of various parameters in the lighting equation.\n    // color = mix(color, F, u_ScaleFGDSpec.x);\n    // color = mix(color, vec3(G), u_ScaleFGDSpec.y);\n    // color = mix(color, vec3(D), u_ScaleFGDSpec.z);\n    // color = mix(color, specContrib, u_ScaleFGDSpec.w);\n\n    // color = mix(color, diffuseContrib, u_ScaleDiffBaseMR.x);\n    // color = mix(color, baseColor.rgb, u_ScaleDiffBaseMR.y);\n    // color = mix(color, vec3(metallic), u_ScaleDiffBaseMR.z);\n    // color = mix(color, vec3(perceptualRoughness), u_ScaleDiffBaseMR.w);\n\n    // NOTE: the spec mandates to ignore any alpha value in 'OPAQUE' mode\n    float alpha = mix(1.0, baseColor.a, u_AlphaBlend);\n    if (u_AlphaCutoff > 0.0) {\n        alpha = step(u_AlphaCutoff, baseColor.a);\n    }\n    fragColor = vec4(pow(color,vec3(1.0/2.2)), alpha);\n}\n"},function(t,n){t.exports="// Originally taken from https://github.com/KhronosGroup/glTF-WebGL-PBR\n// Commit c28b5b8f5a83380857ad8395ac5302594ecc13ae\n\n\n#if __VERSION__ == 100\n#else \n    #define varying out\n#endif\n\n\n#if __VERSION__ == 100\n  attribute vec4 a_position;\n  attribute vec4 a_normal;\n  attribute vec4 a_tangent;\n  attribute vec2 a_texcoord_0;\n  attribute vec2 a_texcoord_1;\n  attribute vec4 a_color;\n#else\n    layout (location = 0) in vec4 a_position;\n    layout (location = 1) in vec3 a_normal;\n    layout (location = 2) in vec4 a_tangent;\n    layout (location = 3) in vec2 a_texcoord_0;\n    layout (location = 4) in vec2 a_texcoord_1;\n    layout (location = 5) in vec4 a_color;\n#endif\n\n// TODO!!!: WebGL1 support (int/bit operators...)\n// vertex shader + fragment shader\nconst int HAS_NORMALS           = 1;\nconst int HAS_TANGENTS          = 1 << 1;\nconst int HAS_UV                = 1 << 2;\nconst int HAS_COLORS            = 1 << 3;\n\nuniform mediump int u_PbrFlags;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_ViewProjection;\nuniform mat3 u_NormalMatrix;\n\nvarying vec3 v_Position;\nvarying vec2 v_UV[2];\nvarying vec4 v_Color;\n\nvarying mat3 v_TBN;\nvarying vec3 v_Normal;\n\nbool checkFlag(int flag) {\n    return (u_PbrFlags & flag) == flag;\n}\n\nvoid main()\n{\n  vec4 pos = u_ModelMatrix * a_position;\n  v_Position = vec3(pos.xyz) / pos.w;\n\n  if (checkFlag(HAS_NORMALS)) {\n  if (checkFlag(HAS_TANGENTS)) {\n  vec3 normalW = normalize(vec3(u_NormalMatrix * a_normal));\n  vec3 tangentW = normalize(vec3(u_ModelMatrix * vec4(a_tangent.xyz, 0.0)));\n  vec3 bitangentW = cross(normalW, tangentW) * a_tangent.w;\n  v_TBN = mat3(tangentW, bitangentW, normalW);\n  } else { // HAS_TANGENTS != 1\n  v_Normal = normalize(vec3(u_ModelMatrix * vec4(a_normal.xyz, 0.0)));\n  }\n  }\n\n  if (checkFlag(HAS_UV)) {\n    v_UV[0] = a_texcoord_0;\n    v_UV[1] = a_texcoord_1;\n  }\n  else {\n    v_UV[0] = vec2(0., 0.);\n    v_UV[1] = vec2(0., 0.);\n  }\n\n  if (checkFlag(HAS_COLORS))\n  v_Color = a_color;\n  else\n  v_Color = vec4(1.0);\n\n  gl_Position = u_ViewProjection * u_ModelMatrix * a_position; // needs w for proper perspective correction\n}\n\n\n"},function(t,n,e){"use strict";var r=this&&this.__awaiter||function(t,n,e,r){return new(e||(e=Promise))(function(i,o){function a(t){try{s(r.next(t))}catch(t){o(t)}}function u(t){try{s(r.throw(t))}catch(t){o(t)}}function s(t){t.done?i(t.value):new e(function(n){n(t.value)}).then(a,u)}s((r=r.apply(t,n||[])).next())})};Object.defineProperty(n,"__esModule",{value:!0});const i=e(5),o=e(11),a=e(9);n.Asset=class{constructor(t,n){this.scenes=[],this.meshes=[],this.materials=[],this.textures=[],this.gAsset=t,this.context=n}getScene(t){return r(this,void 0,void 0,function*(){if(t=void 0!==t?t:this.gAsset.gltf.scene||0,this.scenes[t])return this.scenes[t];const n=this.gAsset.gltf.scenes[t];return this.scenes[t]=yield a.Scene.fromGltf(n,this),this.scenes[t]})}getMesh(t){return r(this,void 0,void 0,function*(){return this.meshes[t]?this.meshes[t]:(this.meshes[t]=yield o.Mesh.fromGltf(t,this),this.meshes[t])})}getMaterial(t){return r(this,void 0,void 0,function*(){return this.materials[t]?this.materials[t]:(this.materials[t]=yield i.Material.fromGltf(t,this),this.materials[t])})}}},,,function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const r=e(1),i=e(7),o=e(0),a=e(4);n.WebXRRenderer=class extends o.Renderer{set scene(t){this._scene&&this._scene.uninitialize(),this._scene=t,this._sceneChanged=!0,this.setCameraFromBounds(),this.invalidate()}get context(){return this._context}onInitialize(t,n,e){const u=this._context.gl;return this.pbrShader=new a.PbrShader(t),this._camera=new o.Camera,this._camera.center=r.vec3.fromValues(0,0,0),this._camera.up=r.vec3.fromValues(0,1,0),this._camera.eye=r.vec3.fromValues(0,0,3),this._camera.near=.1,this._camera.far=20,this._navigation=new o.Navigation(n,e),this._navigation.camera=this._camera,u.enable(u.DEPTH_TEST),setTimeout(()=>{this.clearColor=[.1,.2,.3,1]},0),this.stats=new i,this.stats.dom.height="48px",this.stats.dom.top="12px",[].forEach.call(this.stats.dom.children,t=>t.style.display=""),this.stats.dom.children[2].style.display="none",!0}onUninitialize(){this._scene.uninitialize(),this.pbrShader.uninitialize()}onUpdate(){const t=this.context.gl;if(this._altered.frameSize&&(this._camera.viewport=[this._frameSize[0],this._frameSize[1]],t.viewport(0,0,this._frameSize[0],this._frameSize[1])),this._altered.canvasSize&&(this._camera.aspect=this._canvasSize[0]/this._canvasSize[1]),this._altered.clearColor){const n=this._clearColor;t.clearColor(n[0],n[1],n[2],n[3])}this._navigation.update();const n=this._altered.any||this._camera.altered||this._sceneChanged;return this._altered.reset(),this._camera.altered=!1,this._sceneChanged=!1,n}onPrepare(){}onFrame(t){this.stats.begin();const n=this._context.gl;let e=Date.now();n.clearColor(Math.cos(e/2e3),Math.cos(e/4e3),Math.cos(e/6e3),1),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT),this.pbrShader.bind(),n.uniformMatrix4fv(this.pbrShader.uniforms.u_ViewProjection,!1,this._camera.viewProjection),n.uniform3fv(this.pbrShader.uniforms.u_Camera,this._camera.eye),this._scene&&this._scene.draw(this._camera,this.pbrShader),this.pbrShader.unbind(),this.stats.end()}onSwap(){this.invalidate()}setCameraFromBounds(){const t=this._scene.bounds,n=r.vec3.len(t.size),e=t.center;this._camera.eye=r.vec3.fromValues(e[0]+n/1.5,e[1]+n/5,e[2]+n/1.5),this._camera.center=e,this._camera.far=20*n,this._camera.near=n/100}}},function(t,n,e){"use strict";var r=this&&this.__awaiter||function(t,n,e,r){return new(e||(e=Promise))(function(i,o){function a(t){try{s(r.next(t))}catch(t){o(t)}}function u(t){try{s(r.throw(t))}catch(t){o(t)}}function s(t){t.done?i(t.value):new e(function(n){n(t.value)}).then(a,u)}s((r=r.apply(t,n||[])).next())})};Object.defineProperty(n,"__esModule",{value:!0});const i=e(6),o=e(0),a=e(0),u=(e(14),e(17));function s(){return r(this,void 0,void 0,function*(){const t=document.getElementById("message");function n(n,e="red"){t.innerHTML=n,t.style.color=e}const e=document.getElementById("xr-button");if(!a.supportsXR())return void n("Your browser does not support WebXR.");const s=new o.XRController({immersive:!0});try{yield s.initialize()}catch(t){return console.error(t),void n(t.message)}(yield s.supportsSession())||n("immersive session not supported."),n("Ready.","green"),e.disabled=!1,e.onclick=(()=>r(this,void 0,void 0,function*(){if(s.session)yield s.endSession(),n("Ready.","green"),e.innerHTML="Enter XR";else{n("Requesting session...","black"),yield s.requestSession(),n("Session active.","green"),e.innerHTML="Exit XR",s.gl.clearColor(0,1,0,1);const t=new u.WebXRRenderer;s.canvas.renderer=t,s.session.addEventListener("end",()=>{n("Ready.","green"),e.innerHTML="Enter XR"})}}));new i.GltfLoader;window.xrcontroller=s})}"complete"===window.document.readyState?s():window.onload=s},function(t,n,e){e(2),t.exports=e(18)}])});
//# sourceMappingURL=webxr.js.map