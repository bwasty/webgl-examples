!function(t,n){if("object"==typeof exports&&"object"==typeof module)module.exports=n(require("gloperate"));else if("function"==typeof define&&define.amd)define(["gloperate"],n);else{var e="object"==typeof exports?n(require("gloperate")):n(t.gloperate);for(var r in e)("object"==typeof exports?exports:t)[r]=e[r]}}(window,function(t){return function(t){var n={};function e(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=18)}([function(n,e){n.exports=t},function(t,n,e){"use strict";e.r(n);var r={};e.d(r,"EPSILON",function(){return h}),e.d(r,"ARRAY_TYPE",function(){return d}),e.d(r,"RANDOM",function(){return m}),e.d(r,"setMatrixArrayType",function(){return b}),e.d(r,"toRadian",function(){return M}),e.d(r,"equals",function(){return v});var i={};e.d(i,"create",function(){return _}),e.d(i,"clone",function(){return y}),e.d(i,"copy",function(){return g}),e.d(i,"identity",function(){return x}),e.d(i,"fromValues",function(){return w}),e.d(i,"set",function(){return T}),e.d(i,"transpose",function(){return A}),e.d(i,"invert",function(){return S}),e.d(i,"adjoint",function(){return E}),e.d(i,"determinant",function(){return O}),e.d(i,"multiply",function(){return R}),e.d(i,"rotate",function(){return C}),e.d(i,"scale",function(){return L}),e.d(i,"fromRotation",function(){return P}),e.d(i,"fromScaling",function(){return F}),e.d(i,"str",function(){return B}),e.d(i,"frob",function(){return I}),e.d(i,"LDU",function(){return N}),e.d(i,"add",function(){return z}),e.d(i,"subtract",function(){return q}),e.d(i,"exactEquals",function(){return U}),e.d(i,"equals",function(){return D}),e.d(i,"multiplyScalar",function(){return V}),e.d(i,"multiplyScalarAndAdd",function(){return j}),e.d(i,"mul",function(){return G}),e.d(i,"sub",function(){return k});var o={};e.d(o,"create",function(){return H}),e.d(o,"clone",function(){return Y}),e.d(o,"copy",function(){return W}),e.d(o,"identity",function(){return X}),e.d(o,"fromValues",function(){return Q}),e.d(o,"set",function(){return Z}),e.d(o,"invert",function(){return $}),e.d(o,"determinant",function(){return J}),e.d(o,"multiply",function(){return K}),e.d(o,"rotate",function(){return tt}),e.d(o,"scale",function(){return nt}),e.d(o,"translate",function(){return et}),e.d(o,"fromRotation",function(){return rt}),e.d(o,"fromScaling",function(){return it}),e.d(o,"fromTranslation",function(){return ot}),e.d(o,"str",function(){return at}),e.d(o,"frob",function(){return ut}),e.d(o,"add",function(){return st}),e.d(o,"subtract",function(){return ct}),e.d(o,"multiplyScalar",function(){return ft}),e.d(o,"multiplyScalarAndAdd",function(){return lt}),e.d(o,"exactEquals",function(){return ht}),e.d(o,"equals",function(){return dt}),e.d(o,"mul",function(){return mt}),e.d(o,"sub",function(){return bt});var a={};e.d(a,"create",function(){return pt}),e.d(a,"fromMat4",function(){return Mt}),e.d(a,"clone",function(){return vt}),e.d(a,"copy",function(){return _t}),e.d(a,"fromValues",function(){return yt}),e.d(a,"set",function(){return gt}),e.d(a,"identity",function(){return xt}),e.d(a,"transpose",function(){return wt}),e.d(a,"invert",function(){return Tt}),e.d(a,"adjoint",function(){return At}),e.d(a,"determinant",function(){return St}),e.d(a,"multiply",function(){return Et}),e.d(a,"translate",function(){return Ot}),e.d(a,"rotate",function(){return Rt}),e.d(a,"scale",function(){return Ct}),e.d(a,"fromTranslation",function(){return Lt}),e.d(a,"fromRotation",function(){return Pt}),e.d(a,"fromScaling",function(){return Ft}),e.d(a,"fromMat2d",function(){return Bt}),e.d(a,"fromQuat",function(){return It}),e.d(a,"normalFromMat4",function(){return Nt}),e.d(a,"projection",function(){return zt}),e.d(a,"str",function(){return qt}),e.d(a,"frob",function(){return Ut}),e.d(a,"add",function(){return Dt}),e.d(a,"subtract",function(){return Vt}),e.d(a,"multiplyScalar",function(){return jt}),e.d(a,"multiplyScalarAndAdd",function(){return Gt}),e.d(a,"exactEquals",function(){return kt}),e.d(a,"equals",function(){return Ht}),e.d(a,"mul",function(){return Yt}),e.d(a,"sub",function(){return Wt});var u={};e.d(u,"create",function(){return Xt}),e.d(u,"clone",function(){return Qt}),e.d(u,"copy",function(){return Zt}),e.d(u,"fromValues",function(){return $t}),e.d(u,"set",function(){return Jt}),e.d(u,"identity",function(){return Kt}),e.d(u,"transpose",function(){return tn}),e.d(u,"invert",function(){return nn}),e.d(u,"adjoint",function(){return en}),e.d(u,"determinant",function(){return rn}),e.d(u,"multiply",function(){return on}),e.d(u,"translate",function(){return an}),e.d(u,"scale",function(){return un}),e.d(u,"rotate",function(){return sn}),e.d(u,"rotateX",function(){return cn}),e.d(u,"rotateY",function(){return fn}),e.d(u,"rotateZ",function(){return ln}),e.d(u,"fromTranslation",function(){return hn}),e.d(u,"fromScaling",function(){return dn}),e.d(u,"fromRotation",function(){return mn}),e.d(u,"fromXRotation",function(){return bn}),e.d(u,"fromYRotation",function(){return pn}),e.d(u,"fromZRotation",function(){return Mn}),e.d(u,"fromRotationTranslation",function(){return vn}),e.d(u,"getTranslation",function(){return _n}),e.d(u,"getScaling",function(){return yn}),e.d(u,"getRotation",function(){return gn}),e.d(u,"fromRotationTranslationScale",function(){return xn}),e.d(u,"fromRotationTranslationScaleOrigin",function(){return wn}),e.d(u,"fromQuat",function(){return Tn}),e.d(u,"frustum",function(){return An}),e.d(u,"perspective",function(){return Sn}),e.d(u,"perspectiveFromFieldOfView",function(){return En}),e.d(u,"ortho",function(){return On}),e.d(u,"lookAt",function(){return Rn}),e.d(u,"targetTo",function(){return Cn}),e.d(u,"str",function(){return Ln}),e.d(u,"frob",function(){return Pn}),e.d(u,"add",function(){return Fn}),e.d(u,"subtract",function(){return Bn}),e.d(u,"multiplyScalar",function(){return In}),e.d(u,"multiplyScalarAndAdd",function(){return Nn}),e.d(u,"exactEquals",function(){return zn}),e.d(u,"equals",function(){return qn}),e.d(u,"mul",function(){return Un}),e.d(u,"sub",function(){return Dn});var s={};e.d(s,"create",function(){return Vn}),e.d(s,"clone",function(){return jn}),e.d(s,"length",function(){return Gn}),e.d(s,"fromValues",function(){return kn}),e.d(s,"copy",function(){return Hn}),e.d(s,"set",function(){return Yn}),e.d(s,"add",function(){return Wn}),e.d(s,"subtract",function(){return Xn}),e.d(s,"multiply",function(){return Qn}),e.d(s,"divide",function(){return Zn}),e.d(s,"ceil",function(){return $n}),e.d(s,"floor",function(){return Jn}),e.d(s,"min",function(){return Kn}),e.d(s,"max",function(){return te}),e.d(s,"round",function(){return ne}),e.d(s,"scale",function(){return ee}),e.d(s,"scaleAndAdd",function(){return re}),e.d(s,"distance",function(){return ie}),e.d(s,"squaredDistance",function(){return oe}),e.d(s,"squaredLength",function(){return ae}),e.d(s,"negate",function(){return ue}),e.d(s,"inverse",function(){return se}),e.d(s,"normalize",function(){return ce}),e.d(s,"dot",function(){return fe}),e.d(s,"cross",function(){return le}),e.d(s,"lerp",function(){return he}),e.d(s,"hermite",function(){return de}),e.d(s,"bezier",function(){return me}),e.d(s,"random",function(){return be}),e.d(s,"transformMat4",function(){return pe}),e.d(s,"transformMat3",function(){return Me}),e.d(s,"transformQuat",function(){return ve}),e.d(s,"rotateX",function(){return _e}),e.d(s,"rotateY",function(){return ye}),e.d(s,"rotateZ",function(){return ge}),e.d(s,"angle",function(){return xe}),e.d(s,"str",function(){return we}),e.d(s,"exactEquals",function(){return Te}),e.d(s,"equals",function(){return Ae}),e.d(s,"sub",function(){return Se}),e.d(s,"mul",function(){return Ee}),e.d(s,"div",function(){return Oe}),e.d(s,"dist",function(){return Re}),e.d(s,"sqrDist",function(){return Ce}),e.d(s,"len",function(){return Le}),e.d(s,"sqrLen",function(){return Pe}),e.d(s,"forEach",function(){return Fe});var c={};e.d(c,"create",function(){return Be}),e.d(c,"clone",function(){return Ie}),e.d(c,"fromValues",function(){return Ne}),e.d(c,"copy",function(){return ze}),e.d(c,"set",function(){return qe}),e.d(c,"add",function(){return Ue}),e.d(c,"subtract",function(){return De}),e.d(c,"multiply",function(){return Ve}),e.d(c,"divide",function(){return je}),e.d(c,"ceil",function(){return Ge}),e.d(c,"floor",function(){return ke}),e.d(c,"min",function(){return He}),e.d(c,"max",function(){return Ye}),e.d(c,"round",function(){return We}),e.d(c,"scale",function(){return Xe}),e.d(c,"scaleAndAdd",function(){return Qe}),e.d(c,"distance",function(){return Ze}),e.d(c,"squaredDistance",function(){return $e}),e.d(c,"length",function(){return Je}),e.d(c,"squaredLength",function(){return Ke}),e.d(c,"negate",function(){return tr}),e.d(c,"inverse",function(){return nr}),e.d(c,"normalize",function(){return er}),e.d(c,"dot",function(){return rr}),e.d(c,"lerp",function(){return ir}),e.d(c,"random",function(){return or}),e.d(c,"transformMat4",function(){return ar}),e.d(c,"transformQuat",function(){return ur}),e.d(c,"str",function(){return sr}),e.d(c,"exactEquals",function(){return cr}),e.d(c,"equals",function(){return fr}),e.d(c,"sub",function(){return lr}),e.d(c,"mul",function(){return hr}),e.d(c,"div",function(){return dr}),e.d(c,"dist",function(){return mr}),e.d(c,"sqrDist",function(){return br}),e.d(c,"len",function(){return pr}),e.d(c,"sqrLen",function(){return Mr}),e.d(c,"forEach",function(){return vr});var f={};e.d(f,"create",function(){return _r}),e.d(f,"identity",function(){return yr}),e.d(f,"setAxisAngle",function(){return gr}),e.d(f,"getAxisAngle",function(){return xr}),e.d(f,"multiply",function(){return wr}),e.d(f,"rotateX",function(){return Tr}),e.d(f,"rotateY",function(){return Ar}),e.d(f,"rotateZ",function(){return Sr}),e.d(f,"calculateW",function(){return Er}),e.d(f,"slerp",function(){return Or}),e.d(f,"invert",function(){return Rr}),e.d(f,"conjugate",function(){return Cr}),e.d(f,"fromMat3",function(){return Lr}),e.d(f,"fromEuler",function(){return Pr}),e.d(f,"str",function(){return Fr}),e.d(f,"clone",function(){return Br}),e.d(f,"fromValues",function(){return Ir}),e.d(f,"copy",function(){return Nr}),e.d(f,"set",function(){return zr}),e.d(f,"add",function(){return qr}),e.d(f,"mul",function(){return Ur}),e.d(f,"scale",function(){return Dr}),e.d(f,"dot",function(){return Vr}),e.d(f,"lerp",function(){return jr}),e.d(f,"length",function(){return Gr}),e.d(f,"len",function(){return kr}),e.d(f,"squaredLength",function(){return Hr}),e.d(f,"sqrLen",function(){return Yr}),e.d(f,"normalize",function(){return Wr}),e.d(f,"exactEquals",function(){return Xr}),e.d(f,"equals",function(){return Qr}),e.d(f,"rotationTo",function(){return Zr}),e.d(f,"sqlerp",function(){return $r}),e.d(f,"setAxes",function(){return Jr});var l={};e.d(l,"create",function(){return Kr}),e.d(l,"clone",function(){return ti}),e.d(l,"fromValues",function(){return ni}),e.d(l,"copy",function(){return ei}),e.d(l,"set",function(){return ri}),e.d(l,"add",function(){return ii}),e.d(l,"subtract",function(){return oi}),e.d(l,"multiply",function(){return ai}),e.d(l,"divide",function(){return ui}),e.d(l,"ceil",function(){return si}),e.d(l,"floor",function(){return ci}),e.d(l,"min",function(){return fi}),e.d(l,"max",function(){return li}),e.d(l,"round",function(){return hi}),e.d(l,"scale",function(){return di}),e.d(l,"scaleAndAdd",function(){return mi}),e.d(l,"distance",function(){return bi}),e.d(l,"squaredDistance",function(){return pi}),e.d(l,"length",function(){return Mi}),e.d(l,"squaredLength",function(){return vi}),e.d(l,"negate",function(){return _i}),e.d(l,"inverse",function(){return yi}),e.d(l,"normalize",function(){return gi}),e.d(l,"dot",function(){return xi}),e.d(l,"cross",function(){return wi}),e.d(l,"lerp",function(){return Ti}),e.d(l,"random",function(){return Ai}),e.d(l,"transformMat2",function(){return Si}),e.d(l,"transformMat2d",function(){return Ei}),e.d(l,"transformMat3",function(){return Oi}),e.d(l,"transformMat4",function(){return Ri}),e.d(l,"str",function(){return Ci}),e.d(l,"exactEquals",function(){return Li}),e.d(l,"equals",function(){return Pi}),e.d(l,"len",function(){return Fi}),e.d(l,"sub",function(){return Bi}),e.d(l,"mul",function(){return Ii}),e.d(l,"div",function(){return Ni}),e.d(l,"dist",function(){return zi}),e.d(l,"sqrDist",function(){return qi}),e.d(l,"sqrLen",function(){return Ui}),e.d(l,"forEach",function(){return Di});const h=1e-6;let d="undefined"!=typeof Float32Array?Float32Array:Array;const m=Math.random;function b(t){d=t}const p=Math.PI/180;function M(t){return t*p}function v(t,n){return Math.abs(t-n)<=h*Math.max(1,Math.abs(t),Math.abs(n))}function _(){let t=new d(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t}function y(t){let n=new d(4);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n}function g(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t}function x(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t}function w(t,n,e,r){let i=new d(4);return i[0]=t,i[1]=n,i[2]=e,i[3]=r,i}function T(t,n,e,r,i){return t[0]=n,t[1]=e,t[2]=r,t[3]=i,t}function A(t,n){if(t===n){let e=n[1];t[1]=n[2],t[2]=e}else t[0]=n[0],t[1]=n[2],t[2]=n[1],t[3]=n[3];return t}function S(t,n){let e=n[0],r=n[1],i=n[2],o=n[3],a=e*o-i*r;return a?(a=1/a,t[0]=o*a,t[1]=-r*a,t[2]=-i*a,t[3]=e*a,t):null}function E(t,n){let e=n[0];return t[0]=n[3],t[1]=-n[1],t[2]=-n[2],t[3]=e,t}function O(t){return t[0]*t[3]-t[2]*t[1]}function R(t,n,e){let r=n[0],i=n[1],o=n[2],a=n[3],u=e[0],s=e[1],c=e[2],f=e[3];return t[0]=r*u+o*s,t[1]=i*u+a*s,t[2]=r*c+o*f,t[3]=i*c+a*f,t}function C(t,n,e){let r=n[0],i=n[1],o=n[2],a=n[3],u=Math.sin(e),s=Math.cos(e);return t[0]=r*s+o*u,t[1]=i*s+a*u,t[2]=r*-u+o*s,t[3]=i*-u+a*s,t}function L(t,n,e){let r=n[0],i=n[1],o=n[2],a=n[3],u=e[0],s=e[1];return t[0]=r*u,t[1]=i*u,t[2]=o*s,t[3]=a*s,t}function P(t,n){let e=Math.sin(n),r=Math.cos(n);return t[0]=r,t[1]=e,t[2]=-e,t[3]=r,t}function F(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=n[1],t}function B(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function I(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))}function N(t,n,e,r){return t[2]=r[2]/r[0],e[0]=r[0],e[1]=r[1],e[3]=r[3]-t[2]*e[1],[t,n,e]}function z(t,n,e){return t[0]=n[0]+e[0],t[1]=n[1]+e[1],t[2]=n[2]+e[2],t[3]=n[3]+e[3],t}function q(t,n,e){return t[0]=n[0]-e[0],t[1]=n[1]-e[1],t[2]=n[2]-e[2],t[3]=n[3]-e[3],t}function U(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]}function D(t,n){let e=t[0],r=t[1],i=t[2],o=t[3],a=n[0],u=n[1],s=n[2],c=n[3];return Math.abs(e-a)<=h*Math.max(1,Math.abs(e),Math.abs(a))&&Math.abs(r-u)<=h*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(i-s)<=h*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(o-c)<=h*Math.max(1,Math.abs(o),Math.abs(c))}function V(t,n,e){return t[0]=n[0]*e,t[1]=n[1]*e,t[2]=n[2]*e,t[3]=n[3]*e,t}function j(t,n,e,r){return t[0]=n[0]+e[0]*r,t[1]=n[1]+e[1]*r,t[2]=n[2]+e[2]*r,t[3]=n[3]+e[3]*r,t}const G=R,k=q;function H(){let t=new d(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function Y(t){let n=new d(6);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n}function W(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t}function X(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function Q(t,n,e,r,i,o){let a=new d(6);return a[0]=t,a[1]=n,a[2]=e,a[3]=r,a[4]=i,a[5]=o,a}function Z(t,n,e,r,i,o,a){return t[0]=n,t[1]=e,t[2]=r,t[3]=i,t[4]=o,t[5]=a,t}function $(t,n){let e=n[0],r=n[1],i=n[2],o=n[3],a=n[4],u=n[5],s=e*o-r*i;return s?(s=1/s,t[0]=o*s,t[1]=-r*s,t[2]=-i*s,t[3]=e*s,t[4]=(i*u-o*a)*s,t[5]=(r*a-e*u)*s,t):null}function J(t){return t[0]*t[3]-t[1]*t[2]}function K(t,n,e){let r=n[0],i=n[1],o=n[2],a=n[3],u=n[4],s=n[5],c=e[0],f=e[1],l=e[2],h=e[3],d=e[4],m=e[5];return t[0]=r*c+o*f,t[1]=i*c+a*f,t[2]=r*l+o*h,t[3]=i*l+a*h,t[4]=r*d+o*m+u,t[5]=i*d+a*m+s,t}function tt(t,n,e){let r=n[0],i=n[1],o=n[2],a=n[3],u=n[4],s=n[5],c=Math.sin(e),f=Math.cos(e);return t[0]=r*f+o*c,t[1]=i*f+a*c,t[2]=r*-c+o*f,t[3]=i*-c+a*f,t[4]=u,t[5]=s,t}function nt(t,n,e){let r=n[0],i=n[1],o=n[2],a=n[3],u=n[4],s=n[5],c=e[0],f=e[1];return t[0]=r*c,t[1]=i*c,t[2]=o*f,t[3]=a*f,t[4]=u,t[5]=s,t}function et(t,n,e){let r=n[0],i=n[1],o=n[2],a=n[3],u=n[4],s=n[5],c=e[0],f=e[1];return t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=r*c+o*f+u,t[5]=i*c+a*f+s,t}function rt(t,n){let e=Math.sin(n),r=Math.cos(n);return t[0]=r,t[1]=e,t[2]=-e,t[3]=r,t[4]=0,t[5]=0,t}function it(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=n[1],t[4]=0,t[5]=0,t}function ot(t,n){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=n[0],t[5]=n[1],t}function at(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}function ut(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)}function st(t,n,e){return t[0]=n[0]+e[0],t[1]=n[1]+e[1],t[2]=n[2]+e[2],t[3]=n[3]+e[3],t[4]=n[4]+e[4],t[5]=n[5]+e[5],t}function ct(t,n,e){return t[0]=n[0]-e[0],t[1]=n[1]-e[1],t[2]=n[2]-e[2],t[3]=n[3]-e[3],t[4]=n[4]-e[4],t[5]=n[5]-e[5],t}function ft(t,n,e){return t[0]=n[0]*e,t[1]=n[1]*e,t[2]=n[2]*e,t[3]=n[3]*e,t[4]=n[4]*e,t[5]=n[5]*e,t}function lt(t,n,e,r){return t[0]=n[0]+e[0]*r,t[1]=n[1]+e[1]*r,t[2]=n[2]+e[2]*r,t[3]=n[3]+e[3]*r,t[4]=n[4]+e[4]*r,t[5]=n[5]+e[5]*r,t}function ht(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]}function dt(t,n){let e=t[0],r=t[1],i=t[2],o=t[3],a=t[4],u=t[5],s=n[0],c=n[1],f=n[2],l=n[3],d=n[4],m=n[5];return Math.abs(e-s)<=h*Math.max(1,Math.abs(e),Math.abs(s))&&Math.abs(r-c)<=h*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(i-f)<=h*Math.max(1,Math.abs(i),Math.abs(f))&&Math.abs(o-l)<=h*Math.max(1,Math.abs(o),Math.abs(l))&&Math.abs(a-d)<=h*Math.max(1,Math.abs(a),Math.abs(d))&&Math.abs(u-m)<=h*Math.max(1,Math.abs(u),Math.abs(m))}const mt=K,bt=ct;function pt(){let t=new d(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Mt(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[4],t[4]=n[5],t[5]=n[6],t[6]=n[8],t[7]=n[9],t[8]=n[10],t}function vt(t){let n=new d(9);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n}function _t(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t}function yt(t,n,e,r,i,o,a,u,s){let c=new d(9);return c[0]=t,c[1]=n,c[2]=e,c[3]=r,c[4]=i,c[5]=o,c[6]=a,c[7]=u,c[8]=s,c}function gt(t,n,e,r,i,o,a,u,s,c){return t[0]=n,t[1]=e,t[2]=r,t[3]=i,t[4]=o,t[5]=a,t[6]=u,t[7]=s,t[8]=c,t}function xt(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function wt(t,n){if(t===n){let e=n[1],r=n[2],i=n[5];t[1]=n[3],t[2]=n[6],t[3]=e,t[5]=n[7],t[6]=r,t[7]=i}else t[0]=n[0],t[1]=n[3],t[2]=n[6],t[3]=n[1],t[4]=n[4],t[5]=n[7],t[6]=n[2],t[7]=n[5],t[8]=n[8];return t}function Tt(t,n){let e=n[0],r=n[1],i=n[2],o=n[3],a=n[4],u=n[5],s=n[6],c=n[7],f=n[8],l=f*a-u*c,h=-f*o+u*s,d=c*o-a*s,m=e*l+r*h+i*d;return m?(m=1/m,t[0]=l*m,t[1]=(-f*r+i*c)*m,t[2]=(u*r-i*a)*m,t[3]=h*m,t[4]=(f*e-i*s)*m,t[5]=(-u*e+i*o)*m,t[6]=d*m,t[7]=(-c*e+r*s)*m,t[8]=(a*e-r*o)*m,t):null}function At(t,n){let e=n[0],r=n[1],i=n[2],o=n[3],a=n[4],u=n[5],s=n[6],c=n[7],f=n[8];return t[0]=a*f-u*c,t[1]=i*c-r*f,t[2]=r*u-i*a,t[3]=u*s-o*f,t[4]=e*f-i*s,t[5]=i*o-e*u,t[6]=o*c-a*s,t[7]=r*s-e*c,t[8]=e*a-r*o,t}function St(t){let n=t[0],e=t[1],r=t[2],i=t[3],o=t[4],a=t[5],u=t[6],s=t[7],c=t[8];return n*(c*o-a*s)+e*(-c*i+a*u)+r*(s*i-o*u)}function Et(t,n,e){let r=n[0],i=n[1],o=n[2],a=n[3],u=n[4],s=n[5],c=n[6],f=n[7],l=n[8],h=e[0],d=e[1],m=e[2],b=e[3],p=e[4],M=e[5],v=e[6],_=e[7],y=e[8];return t[0]=h*r+d*a+m*c,t[1]=h*i+d*u+m*f,t[2]=h*o+d*s+m*l,t[3]=b*r+p*a+M*c,t[4]=b*i+p*u+M*f,t[5]=b*o+p*s+M*l,t[6]=v*r+_*a+y*c,t[7]=v*i+_*u+y*f,t[8]=v*o+_*s+y*l,t}function Ot(t,n,e){let r=n[0],i=n[1],o=n[2],a=n[3],u=n[4],s=n[5],c=n[6],f=n[7],l=n[8],h=e[0],d=e[1];return t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=u,t[5]=s,t[6]=h*r+d*a+c,t[7]=h*i+d*u+f,t[8]=h*o+d*s+l,t}function Rt(t,n,e){let r=n[0],i=n[1],o=n[2],a=n[3],u=n[4],s=n[5],c=n[6],f=n[7],l=n[8],h=Math.sin(e),d=Math.cos(e);return t[0]=d*r+h*a,t[1]=d*i+h*u,t[2]=d*o+h*s,t[3]=d*a-h*r,t[4]=d*u-h*i,t[5]=d*s-h*o,t[6]=c,t[7]=f,t[8]=l,t}function Ct(t,n,e){let r=e[0],i=e[1];return t[0]=r*n[0],t[1]=r*n[1],t[2]=r*n[2],t[3]=i*n[3],t[4]=i*n[4],t[5]=i*n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t}function Lt(t,n){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=n[0],t[7]=n[1],t[8]=1,t}function Pt(t,n){let e=Math.sin(n),r=Math.cos(n);return t[0]=r,t[1]=e,t[2]=0,t[3]=-e,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Ft(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=0,t[4]=n[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Bt(t,n){return t[0]=n[0],t[1]=n[1],t[2]=0,t[3]=n[2],t[4]=n[3],t[5]=0,t[6]=n[4],t[7]=n[5],t[8]=1,t}function It(t,n){let e=n[0],r=n[1],i=n[2],o=n[3],a=e+e,u=r+r,s=i+i,c=e*a,f=r*a,l=r*u,h=i*a,d=i*u,m=i*s,b=o*a,p=o*u,M=o*s;return t[0]=1-l-m,t[3]=f-M,t[6]=h+p,t[1]=f+M,t[4]=1-c-m,t[7]=d-b,t[2]=h-p,t[5]=d+b,t[8]=1-c-l,t}function Nt(t,n){let e=n[0],r=n[1],i=n[2],o=n[3],a=n[4],u=n[5],s=n[6],c=n[7],f=n[8],l=n[9],h=n[10],d=n[11],m=n[12],b=n[13],p=n[14],M=n[15],v=e*u-r*a,_=e*s-i*a,y=e*c-o*a,g=r*s-i*u,x=r*c-o*u,w=i*c-o*s,T=f*b-l*m,A=f*p-h*m,S=f*M-d*m,E=l*p-h*b,O=l*M-d*b,R=h*M-d*p,C=v*R-_*O+y*E+g*S-x*A+w*T;return C?(C=1/C,t[0]=(u*R-s*O+c*E)*C,t[1]=(s*S-a*R-c*A)*C,t[2]=(a*O-u*S+c*T)*C,t[3]=(i*O-r*R-o*E)*C,t[4]=(e*R-i*S+o*A)*C,t[5]=(r*S-e*O-o*T)*C,t[6]=(b*w-p*x+M*g)*C,t[7]=(p*y-m*w-M*_)*C,t[8]=(m*x-b*y+M*v)*C,t):null}function zt(t,n,e){return t[0]=2/n,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/e,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function qt(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function Ut(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))}function Dt(t,n,e){return t[0]=n[0]+e[0],t[1]=n[1]+e[1],t[2]=n[2]+e[2],t[3]=n[3]+e[3],t[4]=n[4]+e[4],t[5]=n[5]+e[5],t[6]=n[6]+e[6],t[7]=n[7]+e[7],t[8]=n[8]+e[8],t}function Vt(t,n,e){return t[0]=n[0]-e[0],t[1]=n[1]-e[1],t[2]=n[2]-e[2],t[3]=n[3]-e[3],t[4]=n[4]-e[4],t[5]=n[5]-e[5],t[6]=n[6]-e[6],t[7]=n[7]-e[7],t[8]=n[8]-e[8],t}function jt(t,n,e){return t[0]=n[0]*e,t[1]=n[1]*e,t[2]=n[2]*e,t[3]=n[3]*e,t[4]=n[4]*e,t[5]=n[5]*e,t[6]=n[6]*e,t[7]=n[7]*e,t[8]=n[8]*e,t}function Gt(t,n,e,r){return t[0]=n[0]+e[0]*r,t[1]=n[1]+e[1]*r,t[2]=n[2]+e[2]*r,t[3]=n[3]+e[3]*r,t[4]=n[4]+e[4]*r,t[5]=n[5]+e[5]*r,t[6]=n[6]+e[6]*r,t[7]=n[7]+e[7]*r,t[8]=n[8]+e[8]*r,t}function kt(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]&&t[6]===n[6]&&t[7]===n[7]&&t[8]===n[8]}function Ht(t,n){let e=t[0],r=t[1],i=t[2],o=t[3],a=t[4],u=t[5],s=t[6],c=t[7],f=t[8],l=n[0],d=n[1],m=n[2],b=n[3],p=n[4],M=n[5],v=n[6],_=n[7],y=n[8];return Math.abs(e-l)<=h*Math.max(1,Math.abs(e),Math.abs(l))&&Math.abs(r-d)<=h*Math.max(1,Math.abs(r),Math.abs(d))&&Math.abs(i-m)<=h*Math.max(1,Math.abs(i),Math.abs(m))&&Math.abs(o-b)<=h*Math.max(1,Math.abs(o),Math.abs(b))&&Math.abs(a-p)<=h*Math.max(1,Math.abs(a),Math.abs(p))&&Math.abs(u-M)<=h*Math.max(1,Math.abs(u),Math.abs(M))&&Math.abs(s-v)<=h*Math.max(1,Math.abs(s),Math.abs(v))&&Math.abs(c-_)<=h*Math.max(1,Math.abs(c),Math.abs(_))&&Math.abs(f-y)<=h*Math.max(1,Math.abs(f),Math.abs(y))}const Yt=Et,Wt=Vt;function Xt(){let t=new d(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Qt(t){let n=new d(16);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n}function Zt(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t}function $t(t,n,e,r,i,o,a,u,s,c,f,l,h,m,b,p){let M=new d(16);return M[0]=t,M[1]=n,M[2]=e,M[3]=r,M[4]=i,M[5]=o,M[6]=a,M[7]=u,M[8]=s,M[9]=c,M[10]=f,M[11]=l,M[12]=h,M[13]=m,M[14]=b,M[15]=p,M}function Jt(t,n,e,r,i,o,a,u,s,c,f,l,h,d,m,b,p){return t[0]=n,t[1]=e,t[2]=r,t[3]=i,t[4]=o,t[5]=a,t[6]=u,t[7]=s,t[8]=c,t[9]=f,t[10]=l,t[11]=h,t[12]=d,t[13]=m,t[14]=b,t[15]=p,t}function Kt(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function tn(t,n){if(t===n){let e=n[1],r=n[2],i=n[3],o=n[6],a=n[7],u=n[11];t[1]=n[4],t[2]=n[8],t[3]=n[12],t[4]=e,t[6]=n[9],t[7]=n[13],t[8]=r,t[9]=o,t[11]=n[14],t[12]=i,t[13]=a,t[14]=u}else t[0]=n[0],t[1]=n[4],t[2]=n[8],t[3]=n[12],t[4]=n[1],t[5]=n[5],t[6]=n[9],t[7]=n[13],t[8]=n[2],t[9]=n[6],t[10]=n[10],t[11]=n[14],t[12]=n[3],t[13]=n[7],t[14]=n[11],t[15]=n[15];return t}function nn(t,n){let e=n[0],r=n[1],i=n[2],o=n[3],a=n[4],u=n[5],s=n[6],c=n[7],f=n[8],l=n[9],h=n[10],d=n[11],m=n[12],b=n[13],p=n[14],M=n[15],v=e*u-r*a,_=e*s-i*a,y=e*c-o*a,g=r*s-i*u,x=r*c-o*u,w=i*c-o*s,T=f*b-l*m,A=f*p-h*m,S=f*M-d*m,E=l*p-h*b,O=l*M-d*b,R=h*M-d*p,C=v*R-_*O+y*E+g*S-x*A+w*T;return C?(C=1/C,t[0]=(u*R-s*O+c*E)*C,t[1]=(i*O-r*R-o*E)*C,t[2]=(b*w-p*x+M*g)*C,t[3]=(h*x-l*w-d*g)*C,t[4]=(s*S-a*R-c*A)*C,t[5]=(e*R-i*S+o*A)*C,t[6]=(p*y-m*w-M*_)*C,t[7]=(f*w-h*y+d*_)*C,t[8]=(a*O-u*S+c*T)*C,t[9]=(r*S-e*O-o*T)*C,t[10]=(m*x-b*y+M*v)*C,t[11]=(l*y-f*x-d*v)*C,t[12]=(u*A-a*E-s*T)*C,t[13]=(e*E-r*A+i*T)*C,t[14]=(b*_-m*g-p*v)*C,t[15]=(f*g-l*_+h*v)*C,t):null}function en(t,n){let e=n[0],r=n[1],i=n[2],o=n[3],a=n[4],u=n[5],s=n[6],c=n[7],f=n[8],l=n[9],h=n[10],d=n[11],m=n[12],b=n[13],p=n[14],M=n[15];return t[0]=u*(h*M-d*p)-l*(s*M-c*p)+b*(s*d-c*h),t[1]=-(r*(h*M-d*p)-l*(i*M-o*p)+b*(i*d-o*h)),t[2]=r*(s*M-c*p)-u*(i*M-o*p)+b*(i*c-o*s),t[3]=-(r*(s*d-c*h)-u*(i*d-o*h)+l*(i*c-o*s)),t[4]=-(a*(h*M-d*p)-f*(s*M-c*p)+m*(s*d-c*h)),t[5]=e*(h*M-d*p)-f*(i*M-o*p)+m*(i*d-o*h),t[6]=-(e*(s*M-c*p)-a*(i*M-o*p)+m*(i*c-o*s)),t[7]=e*(s*d-c*h)-a*(i*d-o*h)+f*(i*c-o*s),t[8]=a*(l*M-d*b)-f*(u*M-c*b)+m*(u*d-c*l),t[9]=-(e*(l*M-d*b)-f*(r*M-o*b)+m*(r*d-o*l)),t[10]=e*(u*M-c*b)-a*(r*M-o*b)+m*(r*c-o*u),t[11]=-(e*(u*d-c*l)-a*(r*d-o*l)+f*(r*c-o*u)),t[12]=-(a*(l*p-h*b)-f*(u*p-s*b)+m*(u*h-s*l)),t[13]=e*(l*p-h*b)-f*(r*p-i*b)+m*(r*h-i*l),t[14]=-(e*(u*p-s*b)-a*(r*p-i*b)+m*(r*s-i*u)),t[15]=e*(u*h-s*l)-a*(r*h-i*l)+f*(r*s-i*u),t}function rn(t){let n=t[0],e=t[1],r=t[2],i=t[3],o=t[4],a=t[5],u=t[6],s=t[7],c=t[8],f=t[9],l=t[10],h=t[11],d=t[12],m=t[13],b=t[14],p=t[15];return(n*a-e*o)*(l*p-h*b)-(n*u-r*o)*(f*p-h*m)+(n*s-i*o)*(f*b-l*m)+(e*u-r*a)*(c*p-h*d)-(e*s-i*a)*(c*b-l*d)+(r*s-i*u)*(c*m-f*d)}function on(t,n,e){let r=n[0],i=n[1],o=n[2],a=n[3],u=n[4],s=n[5],c=n[6],f=n[7],l=n[8],h=n[9],d=n[10],m=n[11],b=n[12],p=n[13],M=n[14],v=n[15],_=e[0],y=e[1],g=e[2],x=e[3];return t[0]=_*r+y*u+g*l+x*b,t[1]=_*i+y*s+g*h+x*p,t[2]=_*o+y*c+g*d+x*M,t[3]=_*a+y*f+g*m+x*v,_=e[4],y=e[5],g=e[6],x=e[7],t[4]=_*r+y*u+g*l+x*b,t[5]=_*i+y*s+g*h+x*p,t[6]=_*o+y*c+g*d+x*M,t[7]=_*a+y*f+g*m+x*v,_=e[8],y=e[9],g=e[10],x=e[11],t[8]=_*r+y*u+g*l+x*b,t[9]=_*i+y*s+g*h+x*p,t[10]=_*o+y*c+g*d+x*M,t[11]=_*a+y*f+g*m+x*v,_=e[12],y=e[13],g=e[14],x=e[15],t[12]=_*r+y*u+g*l+x*b,t[13]=_*i+y*s+g*h+x*p,t[14]=_*o+y*c+g*d+x*M,t[15]=_*a+y*f+g*m+x*v,t}function an(t,n,e){let r,i,o,a,u,s,c,f,l,h,d,m,b=e[0],p=e[1],M=e[2];return n===t?(t[12]=n[0]*b+n[4]*p+n[8]*M+n[12],t[13]=n[1]*b+n[5]*p+n[9]*M+n[13],t[14]=n[2]*b+n[6]*p+n[10]*M+n[14],t[15]=n[3]*b+n[7]*p+n[11]*M+n[15]):(r=n[0],i=n[1],o=n[2],a=n[3],u=n[4],s=n[5],c=n[6],f=n[7],l=n[8],h=n[9],d=n[10],m=n[11],t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=u,t[5]=s,t[6]=c,t[7]=f,t[8]=l,t[9]=h,t[10]=d,t[11]=m,t[12]=r*b+u*p+l*M+n[12],t[13]=i*b+s*p+h*M+n[13],t[14]=o*b+c*p+d*M+n[14],t[15]=a*b+f*p+m*M+n[15]),t}function un(t,n,e){let r=e[0],i=e[1],o=e[2];return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=n[3]*r,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=n[7]*i,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=n[11]*o,t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t}function sn(t,n,e,r){let i,o,a,u,s,c,f,l,d,m,b,p,M,v,_,y,g,x,w,T,A,S,E,O,R=r[0],C=r[1],L=r[2],P=Math.sqrt(R*R+C*C+L*L);return Math.abs(P)<h?null:(R*=P=1/P,C*=P,L*=P,i=Math.sin(e),a=1-(o=Math.cos(e)),u=n[0],s=n[1],c=n[2],f=n[3],l=n[4],d=n[5],m=n[6],b=n[7],p=n[8],M=n[9],v=n[10],_=n[11],y=R*R*a+o,g=C*R*a+L*i,x=L*R*a-C*i,w=R*C*a-L*i,T=C*C*a+o,A=L*C*a+R*i,S=R*L*a+C*i,E=C*L*a-R*i,O=L*L*a+o,t[0]=u*y+l*g+p*x,t[1]=s*y+d*g+M*x,t[2]=c*y+m*g+v*x,t[3]=f*y+b*g+_*x,t[4]=u*w+l*T+p*A,t[5]=s*w+d*T+M*A,t[6]=c*w+m*T+v*A,t[7]=f*w+b*T+_*A,t[8]=u*S+l*E+p*O,t[9]=s*S+d*E+M*O,t[10]=c*S+m*E+v*O,t[11]=f*S+b*E+_*O,n!==t&&(t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t)}function cn(t,n,e){let r=Math.sin(e),i=Math.cos(e),o=n[4],a=n[5],u=n[6],s=n[7],c=n[8],f=n[9],l=n[10],h=n[11];return n!==t&&(t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[4]=o*i+c*r,t[5]=a*i+f*r,t[6]=u*i+l*r,t[7]=s*i+h*r,t[8]=c*i-o*r,t[9]=f*i-a*r,t[10]=l*i-u*r,t[11]=h*i-s*r,t}function fn(t,n,e){let r=Math.sin(e),i=Math.cos(e),o=n[0],a=n[1],u=n[2],s=n[3],c=n[8],f=n[9],l=n[10],h=n[11];return n!==t&&(t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[0]=o*i-c*r,t[1]=a*i-f*r,t[2]=u*i-l*r,t[3]=s*i-h*r,t[8]=o*r+c*i,t[9]=a*r+f*i,t[10]=u*r+l*i,t[11]=s*r+h*i,t}function ln(t,n,e){let r=Math.sin(e),i=Math.cos(e),o=n[0],a=n[1],u=n[2],s=n[3],c=n[4],f=n[5],l=n[6],h=n[7];return n!==t&&(t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[0]=o*i+c*r,t[1]=a*i+f*r,t[2]=u*i+l*r,t[3]=s*i+h*r,t[4]=c*i-o*r,t[5]=f*i-a*r,t[6]=l*i-u*r,t[7]=h*i-s*r,t}function hn(t,n){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function dn(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=n[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function mn(t,n,e){let r,i,o,a=e[0],u=e[1],s=e[2],c=Math.sqrt(a*a+u*u+s*s);return Math.abs(c)<h?null:(a*=c=1/c,u*=c,s*=c,r=Math.sin(n),o=1-(i=Math.cos(n)),t[0]=a*a*o+i,t[1]=u*a*o+s*r,t[2]=s*a*o-u*r,t[3]=0,t[4]=a*u*o-s*r,t[5]=u*u*o+i,t[6]=s*u*o+a*r,t[7]=0,t[8]=a*s*o+u*r,t[9]=u*s*o-a*r,t[10]=s*s*o+i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function bn(t,n){let e=Math.sin(n),r=Math.cos(n);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=e,t[7]=0,t[8]=0,t[9]=-e,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function pn(t,n){let e=Math.sin(n),r=Math.cos(n);return t[0]=r,t[1]=0,t[2]=-e,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=e,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Mn(t,n){let e=Math.sin(n),r=Math.cos(n);return t[0]=r,t[1]=e,t[2]=0,t[3]=0,t[4]=-e,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function vn(t,n,e){let r=n[0],i=n[1],o=n[2],a=n[3],u=r+r,s=i+i,c=o+o,f=r*u,l=r*s,h=r*c,d=i*s,m=i*c,b=o*c,p=a*u,M=a*s,v=a*c;return t[0]=1-(d+b),t[1]=l+v,t[2]=h-M,t[3]=0,t[4]=l-v,t[5]=1-(f+b),t[6]=m+p,t[7]=0,t[8]=h+M,t[9]=m-p,t[10]=1-(f+d),t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function _n(t,n){return t[0]=n[12],t[1]=n[13],t[2]=n[14],t}function yn(t,n){let e=n[0],r=n[1],i=n[2],o=n[4],a=n[5],u=n[6],s=n[8],c=n[9],f=n[10];return t[0]=Math.sqrt(e*e+r*r+i*i),t[1]=Math.sqrt(o*o+a*a+u*u),t[2]=Math.sqrt(s*s+c*c+f*f),t}function gn(t,n){let e=n[0]+n[5]+n[10],r=0;return e>0?(r=2*Math.sqrt(e+1),t[3]=.25*r,t[0]=(n[6]-n[9])/r,t[1]=(n[8]-n[2])/r,t[2]=(n[1]-n[4])/r):n[0]>n[5]&&n[0]>n[10]?(r=2*Math.sqrt(1+n[0]-n[5]-n[10]),t[3]=(n[6]-n[9])/r,t[0]=.25*r,t[1]=(n[1]+n[4])/r,t[2]=(n[8]+n[2])/r):n[5]>n[10]?(r=2*Math.sqrt(1+n[5]-n[0]-n[10]),t[3]=(n[8]-n[2])/r,t[0]=(n[1]+n[4])/r,t[1]=.25*r,t[2]=(n[6]+n[9])/r):(r=2*Math.sqrt(1+n[10]-n[0]-n[5]),t[3]=(n[1]-n[4])/r,t[0]=(n[8]+n[2])/r,t[1]=(n[6]+n[9])/r,t[2]=.25*r),t}function xn(t,n,e,r){let i=n[0],o=n[1],a=n[2],u=n[3],s=i+i,c=o+o,f=a+a,l=i*s,h=i*c,d=i*f,m=o*c,b=o*f,p=a*f,M=u*s,v=u*c,_=u*f,y=r[0],g=r[1],x=r[2];return t[0]=(1-(m+p))*y,t[1]=(h+_)*y,t[2]=(d-v)*y,t[3]=0,t[4]=(h-_)*g,t[5]=(1-(l+p))*g,t[6]=(b+M)*g,t[7]=0,t[8]=(d+v)*x,t[9]=(b-M)*x,t[10]=(1-(l+m))*x,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function wn(t,n,e,r,i){let o=n[0],a=n[1],u=n[2],s=n[3],c=o+o,f=a+a,l=u+u,h=o*c,d=o*f,m=o*l,b=a*f,p=a*l,M=u*l,v=s*c,_=s*f,y=s*l,g=r[0],x=r[1],w=r[2],T=i[0],A=i[1],S=i[2],E=(1-(b+M))*g,O=(d+y)*g,R=(m-_)*g,C=(d-y)*x,L=(1-(h+M))*x,P=(p+v)*x,F=(m+_)*w,B=(p-v)*w,I=(1-(h+b))*w;return t[0]=E,t[1]=O,t[2]=R,t[3]=0,t[4]=C,t[5]=L,t[6]=P,t[7]=0,t[8]=F,t[9]=B,t[10]=I,t[11]=0,t[12]=e[0]+T-(E*T+C*A+F*S),t[13]=e[1]+A-(O*T+L*A+B*S),t[14]=e[2]+S-(R*T+P*A+I*S),t[15]=1,t}function Tn(t,n){let e=n[0],r=n[1],i=n[2],o=n[3],a=e+e,u=r+r,s=i+i,c=e*a,f=r*a,l=r*u,h=i*a,d=i*u,m=i*s,b=o*a,p=o*u,M=o*s;return t[0]=1-l-m,t[1]=f+M,t[2]=h-p,t[3]=0,t[4]=f-M,t[5]=1-c-m,t[6]=d+b,t[7]=0,t[8]=h+p,t[9]=d-b,t[10]=1-c-l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function An(t,n,e,r,i,o,a){let u=1/(e-n),s=1/(i-r),c=1/(o-a);return t[0]=2*o*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*s,t[6]=0,t[7]=0,t[8]=(e+n)*u,t[9]=(i+r)*s,t[10]=(a+o)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*o*2*c,t[15]=0,t}function Sn(t,n,e,r,i){let o=1/Math.tan(n/2),a=1/(r-i);return t[0]=o/e,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(i+r)*a,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*i*r*a,t[15]=0,t}function En(t,n,e,r){let i=Math.tan(n.upDegrees*Math.PI/180),o=Math.tan(n.downDegrees*Math.PI/180),a=Math.tan(n.leftDegrees*Math.PI/180),u=Math.tan(n.rightDegrees*Math.PI/180),s=2/(a+u),c=2/(i+o);return t[0]=s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(a-u)*s*.5,t[9]=(i-o)*c*.5,t[10]=r/(e-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*e/(e-r),t[15]=0,t}function On(t,n,e,r,i,o,a){let u=1/(n-e),s=1/(r-i),c=1/(o-a);return t[0]=-2*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(n+e)*u,t[13]=(i+r)*s,t[14]=(a+o)*c,t[15]=1,t}function Rn(t,n,e,r){let i,o,a,u,s,c,f,l,d,m,b=n[0],p=n[1],M=n[2],v=r[0],_=r[1],y=r[2],g=e[0],x=e[1],w=e[2];return Math.abs(b-g)<h&&Math.abs(p-x)<h&&Math.abs(M-w)<h?Kt(t):(f=b-g,l=p-x,d=M-w,i=_*(d*=m=1/Math.sqrt(f*f+l*l+d*d))-y*(l*=m),o=y*(f*=m)-v*d,a=v*l-_*f,(m=Math.sqrt(i*i+o*o+a*a))?(i*=m=1/m,o*=m,a*=m):(i=0,o=0,a=0),u=l*a-d*o,s=d*i-f*a,c=f*o-l*i,(m=Math.sqrt(u*u+s*s+c*c))?(u*=m=1/m,s*=m,c*=m):(u=0,s=0,c=0),t[0]=i,t[1]=u,t[2]=f,t[3]=0,t[4]=o,t[5]=s,t[6]=l,t[7]=0,t[8]=a,t[9]=c,t[10]=d,t[11]=0,t[12]=-(i*b+o*p+a*M),t[13]=-(u*b+s*p+c*M),t[14]=-(f*b+l*p+d*M),t[15]=1,t)}function Cn(t,n,e,r){let i=n[0],o=n[1],a=n[2],u=r[0],s=r[1],c=r[2],f=i-e[0],l=o-e[1],h=a-e[2],d=f*f+l*l+h*h;d>0&&(f*=d=1/Math.sqrt(d),l*=d,h*=d);let m=s*h-c*l,b=c*f-u*h,p=u*l-s*f;return(d=m*m+b*b+p*p)>0&&(m*=d=1/Math.sqrt(d),b*=d,p*=d),t[0]=m,t[1]=b,t[2]=p,t[3]=0,t[4]=l*p-h*b,t[5]=h*m-f*p,t[6]=f*b-l*m,t[7]=0,t[8]=f,t[9]=l,t[10]=h,t[11]=0,t[12]=i,t[13]=o,t[14]=a,t[15]=1,t}function Ln(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function Pn(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))}function Fn(t,n,e){return t[0]=n[0]+e[0],t[1]=n[1]+e[1],t[2]=n[2]+e[2],t[3]=n[3]+e[3],t[4]=n[4]+e[4],t[5]=n[5]+e[5],t[6]=n[6]+e[6],t[7]=n[7]+e[7],t[8]=n[8]+e[8],t[9]=n[9]+e[9],t[10]=n[10]+e[10],t[11]=n[11]+e[11],t[12]=n[12]+e[12],t[13]=n[13]+e[13],t[14]=n[14]+e[14],t[15]=n[15]+e[15],t}function Bn(t,n,e){return t[0]=n[0]-e[0],t[1]=n[1]-e[1],t[2]=n[2]-e[2],t[3]=n[3]-e[3],t[4]=n[4]-e[4],t[5]=n[5]-e[5],t[6]=n[6]-e[6],t[7]=n[7]-e[7],t[8]=n[8]-e[8],t[9]=n[9]-e[9],t[10]=n[10]-e[10],t[11]=n[11]-e[11],t[12]=n[12]-e[12],t[13]=n[13]-e[13],t[14]=n[14]-e[14],t[15]=n[15]-e[15],t}function In(t,n,e){return t[0]=n[0]*e,t[1]=n[1]*e,t[2]=n[2]*e,t[3]=n[3]*e,t[4]=n[4]*e,t[5]=n[5]*e,t[6]=n[6]*e,t[7]=n[7]*e,t[8]=n[8]*e,t[9]=n[9]*e,t[10]=n[10]*e,t[11]=n[11]*e,t[12]=n[12]*e,t[13]=n[13]*e,t[14]=n[14]*e,t[15]=n[15]*e,t}function Nn(t,n,e,r){return t[0]=n[0]+e[0]*r,t[1]=n[1]+e[1]*r,t[2]=n[2]+e[2]*r,t[3]=n[3]+e[3]*r,t[4]=n[4]+e[4]*r,t[5]=n[5]+e[5]*r,t[6]=n[6]+e[6]*r,t[7]=n[7]+e[7]*r,t[8]=n[8]+e[8]*r,t[9]=n[9]+e[9]*r,t[10]=n[10]+e[10]*r,t[11]=n[11]+e[11]*r,t[12]=n[12]+e[12]*r,t[13]=n[13]+e[13]*r,t[14]=n[14]+e[14]*r,t[15]=n[15]+e[15]*r,t}function zn(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]&&t[6]===n[6]&&t[7]===n[7]&&t[8]===n[8]&&t[9]===n[9]&&t[10]===n[10]&&t[11]===n[11]&&t[12]===n[12]&&t[13]===n[13]&&t[14]===n[14]&&t[15]===n[15]}function qn(t,n){let e=t[0],r=t[1],i=t[2],o=t[3],a=t[4],u=t[5],s=t[6],c=t[7],f=t[8],l=t[9],d=t[10],m=t[11],b=t[12],p=t[13],M=t[14],v=t[15],_=n[0],y=n[1],g=n[2],x=n[3],w=n[4],T=n[5],A=n[6],S=n[7],E=n[8],O=n[9],R=n[10],C=n[11],L=n[12],P=n[13],F=n[14],B=n[15];return Math.abs(e-_)<=h*Math.max(1,Math.abs(e),Math.abs(_))&&Math.abs(r-y)<=h*Math.max(1,Math.abs(r),Math.abs(y))&&Math.abs(i-g)<=h*Math.max(1,Math.abs(i),Math.abs(g))&&Math.abs(o-x)<=h*Math.max(1,Math.abs(o),Math.abs(x))&&Math.abs(a-w)<=h*Math.max(1,Math.abs(a),Math.abs(w))&&Math.abs(u-T)<=h*Math.max(1,Math.abs(u),Math.abs(T))&&Math.abs(s-A)<=h*Math.max(1,Math.abs(s),Math.abs(A))&&Math.abs(c-S)<=h*Math.max(1,Math.abs(c),Math.abs(S))&&Math.abs(f-E)<=h*Math.max(1,Math.abs(f),Math.abs(E))&&Math.abs(l-O)<=h*Math.max(1,Math.abs(l),Math.abs(O))&&Math.abs(d-R)<=h*Math.max(1,Math.abs(d),Math.abs(R))&&Math.abs(m-C)<=h*Math.max(1,Math.abs(m),Math.abs(C))&&Math.abs(b-L)<=h*Math.max(1,Math.abs(b),Math.abs(L))&&Math.abs(p-P)<=h*Math.max(1,Math.abs(p),Math.abs(P))&&Math.abs(M-F)<=h*Math.max(1,Math.abs(M),Math.abs(F))&&Math.abs(v-B)<=h*Math.max(1,Math.abs(v),Math.abs(B))}const Un=on,Dn=Bn;function Vn(){let t=new d(3);return t[0]=0,t[1]=0,t[2]=0,t}function jn(t){var n=new d(3);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n}function Gn(t){let n=t[0],e=t[1],r=t[2];return Math.sqrt(n*n+e*e+r*r)}function kn(t,n,e){let r=new d(3);return r[0]=t,r[1]=n,r[2]=e,r}function Hn(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t}function Yn(t,n,e,r){return t[0]=n,t[1]=e,t[2]=r,t}function Wn(t,n,e){return t[0]=n[0]+e[0],t[1]=n[1]+e[1],t[2]=n[2]+e[2],t}function Xn(t,n,e){return t[0]=n[0]-e[0],t[1]=n[1]-e[1],t[2]=n[2]-e[2],t}function Qn(t,n,e){return t[0]=n[0]*e[0],t[1]=n[1]*e[1],t[2]=n[2]*e[2],t}function Zn(t,n,e){return t[0]=n[0]/e[0],t[1]=n[1]/e[1],t[2]=n[2]/e[2],t}function $n(t,n){return t[0]=Math.ceil(n[0]),t[1]=Math.ceil(n[1]),t[2]=Math.ceil(n[2]),t}function Jn(t,n){return t[0]=Math.floor(n[0]),t[1]=Math.floor(n[1]),t[2]=Math.floor(n[2]),t}function Kn(t,n,e){return t[0]=Math.min(n[0],e[0]),t[1]=Math.min(n[1],e[1]),t[2]=Math.min(n[2],e[2]),t}function te(t,n,e){return t[0]=Math.max(n[0],e[0]),t[1]=Math.max(n[1],e[1]),t[2]=Math.max(n[2],e[2]),t}function ne(t,n){return t[0]=Math.round(n[0]),t[1]=Math.round(n[1]),t[2]=Math.round(n[2]),t}function ee(t,n,e){return t[0]=n[0]*e,t[1]=n[1]*e,t[2]=n[2]*e,t}function re(t,n,e,r){return t[0]=n[0]+e[0]*r,t[1]=n[1]+e[1]*r,t[2]=n[2]+e[2]*r,t}function ie(t,n){let e=n[0]-t[0],r=n[1]-t[1],i=n[2]-t[2];return Math.sqrt(e*e+r*r+i*i)}function oe(t,n){let e=n[0]-t[0],r=n[1]-t[1],i=n[2]-t[2];return e*e+r*r+i*i}function ae(t){let n=t[0],e=t[1],r=t[2];return n*n+e*e+r*r}function ue(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t}function se(t,n){return t[0]=1/n[0],t[1]=1/n[1],t[2]=1/n[2],t}function ce(t,n){let e=n[0],r=n[1],i=n[2],o=e*e+r*r+i*i;return o>0&&(o=1/Math.sqrt(o),t[0]=n[0]*o,t[1]=n[1]*o,t[2]=n[2]*o),t}function fe(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]}function le(t,n,e){let r=n[0],i=n[1],o=n[2],a=e[0],u=e[1],s=e[2];return t[0]=i*s-o*u,t[1]=o*a-r*s,t[2]=r*u-i*a,t}function he(t,n,e,r){let i=n[0],o=n[1],a=n[2];return t[0]=i+r*(e[0]-i),t[1]=o+r*(e[1]-o),t[2]=a+r*(e[2]-a),t}function de(t,n,e,r,i,o){let a=o*o,u=a*(2*o-3)+1,s=a*(o-2)+o,c=a*(o-1),f=a*(3-2*o);return t[0]=n[0]*u+e[0]*s+r[0]*c+i[0]*f,t[1]=n[1]*u+e[1]*s+r[1]*c+i[1]*f,t[2]=n[2]*u+e[2]*s+r[2]*c+i[2]*f,t}function me(t,n,e,r,i,o){let a=1-o,u=a*a,s=o*o,c=u*a,f=3*o*u,l=3*s*a,h=s*o;return t[0]=n[0]*c+e[0]*f+r[0]*l+i[0]*h,t[1]=n[1]*c+e[1]*f+r[1]*l+i[1]*h,t[2]=n[2]*c+e[2]*f+r[2]*l+i[2]*h,t}function be(t,n){n=n||1;let e=2*m()*Math.PI,r=2*m()-1,i=Math.sqrt(1-r*r)*n;return t[0]=Math.cos(e)*i,t[1]=Math.sin(e)*i,t[2]=r*n,t}function pe(t,n,e){let r=n[0],i=n[1],o=n[2],a=e[3]*r+e[7]*i+e[11]*o+e[15];return a=a||1,t[0]=(e[0]*r+e[4]*i+e[8]*o+e[12])/a,t[1]=(e[1]*r+e[5]*i+e[9]*o+e[13])/a,t[2]=(e[2]*r+e[6]*i+e[10]*o+e[14])/a,t}function Me(t,n,e){let r=n[0],i=n[1],o=n[2];return t[0]=r*e[0]+i*e[3]+o*e[6],t[1]=r*e[1]+i*e[4]+o*e[7],t[2]=r*e[2]+i*e[5]+o*e[8],t}function ve(t,n,e){let r=n[0],i=n[1],o=n[2],a=e[0],u=e[1],s=e[2],c=e[3],f=c*r+u*o-s*i,l=c*i+s*r-a*o,h=c*o+a*i-u*r,d=-a*r-u*i-s*o;return t[0]=f*c+d*-a+l*-s-h*-u,t[1]=l*c+d*-u+h*-a-f*-s,t[2]=h*c+d*-s+f*-u-l*-a,t}function _e(t,n,e,r){let i=[],o=[];return i[0]=n[0]-e[0],i[1]=n[1]-e[1],i[2]=n[2]-e[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=o[0]+e[0],t[1]=o[1]+e[1],t[2]=o[2]+e[2],t}function ye(t,n,e,r){let i=[],o=[];return i[0]=n[0]-e[0],i[1]=n[1]-e[1],i[2]=n[2]-e[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=o[0]+e[0],t[1]=o[1]+e[1],t[2]=o[2]+e[2],t}function ge(t,n,e,r){let i=[],o=[];return i[0]=n[0]-e[0],i[1]=n[1]-e[1],i[2]=n[2]-e[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],t[0]=o[0]+e[0],t[1]=o[1]+e[1],t[2]=o[2]+e[2],t}function xe(t,n){let e=kn(t[0],t[1],t[2]),r=kn(n[0],n[1],n[2]);ce(e,e),ce(r,r);let i=fe(e,r);return i>1?0:i<-1?Math.PI:Math.acos(i)}function we(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function Te(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]}function Ae(t,n){let e=t[0],r=t[1],i=t[2],o=n[0],a=n[1],u=n[2];return Math.abs(e-o)<=h*Math.max(1,Math.abs(e),Math.abs(o))&&Math.abs(r-a)<=h*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(i-u)<=h*Math.max(1,Math.abs(i),Math.abs(u))}const Se=Xn,Ee=Qn,Oe=Zn,Re=ie,Ce=oe,Le=Gn,Pe=ae,Fe=function(){let t=Vn();return function(n,e,r,i,o,a){let u,s;for(e||(e=3),r||(r=0),s=i?Math.min(i*e+r,n.length):n.length,u=r;u<s;u+=e)t[0]=n[u],t[1]=n[u+1],t[2]=n[u+2],o(t,t,a),n[u]=t[0],n[u+1]=t[1],n[u+2]=t[2];return n}}();function Be(){let t=new d(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function Ie(t){let n=new d(4);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n}function Ne(t,n,e,r){let i=new d(4);return i[0]=t,i[1]=n,i[2]=e,i[3]=r,i}function ze(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t}function qe(t,n,e,r,i){return t[0]=n,t[1]=e,t[2]=r,t[3]=i,t}function Ue(t,n,e){return t[0]=n[0]+e[0],t[1]=n[1]+e[1],t[2]=n[2]+e[2],t[3]=n[3]+e[3],t}function De(t,n,e){return t[0]=n[0]-e[0],t[1]=n[1]-e[1],t[2]=n[2]-e[2],t[3]=n[3]-e[3],t}function Ve(t,n,e){return t[0]=n[0]*e[0],t[1]=n[1]*e[1],t[2]=n[2]*e[2],t[3]=n[3]*e[3],t}function je(t,n,e){return t[0]=n[0]/e[0],t[1]=n[1]/e[1],t[2]=n[2]/e[2],t[3]=n[3]/e[3],t}function Ge(t,n){return t[0]=Math.ceil(n[0]),t[1]=Math.ceil(n[1]),t[2]=Math.ceil(n[2]),t[3]=Math.ceil(n[3]),t}function ke(t,n){return t[0]=Math.floor(n[0]),t[1]=Math.floor(n[1]),t[2]=Math.floor(n[2]),t[3]=Math.floor(n[3]),t}function He(t,n,e){return t[0]=Math.min(n[0],e[0]),t[1]=Math.min(n[1],e[1]),t[2]=Math.min(n[2],e[2]),t[3]=Math.min(n[3],e[3]),t}function Ye(t,n,e){return t[0]=Math.max(n[0],e[0]),t[1]=Math.max(n[1],e[1]),t[2]=Math.max(n[2],e[2]),t[3]=Math.max(n[3],e[3]),t}function We(t,n){return t[0]=Math.round(n[0]),t[1]=Math.round(n[1]),t[2]=Math.round(n[2]),t[3]=Math.round(n[3]),t}function Xe(t,n,e){return t[0]=n[0]*e,t[1]=n[1]*e,t[2]=n[2]*e,t[3]=n[3]*e,t}function Qe(t,n,e,r){return t[0]=n[0]+e[0]*r,t[1]=n[1]+e[1]*r,t[2]=n[2]+e[2]*r,t[3]=n[3]+e[3]*r,t}function Ze(t,n){let e=n[0]-t[0],r=n[1]-t[1],i=n[2]-t[2],o=n[3]-t[3];return Math.sqrt(e*e+r*r+i*i+o*o)}function $e(t,n){let e=n[0]-t[0],r=n[1]-t[1],i=n[2]-t[2],o=n[3]-t[3];return e*e+r*r+i*i+o*o}function Je(t){let n=t[0],e=t[1],r=t[2],i=t[3];return Math.sqrt(n*n+e*e+r*r+i*i)}function Ke(t){let n=t[0],e=t[1],r=t[2],i=t[3];return n*n+e*e+r*r+i*i}function tr(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t[3]=-n[3],t}function nr(t,n){return t[0]=1/n[0],t[1]=1/n[1],t[2]=1/n[2],t[3]=1/n[3],t}function er(t,n){let e=n[0],r=n[1],i=n[2],o=n[3],a=e*e+r*r+i*i+o*o;return a>0&&(a=1/Math.sqrt(a),t[0]=e*a,t[1]=r*a,t[2]=i*a,t[3]=o*a),t}function rr(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]+t[3]*n[3]}function ir(t,n,e,r){let i=n[0],o=n[1],a=n[2],u=n[3];return t[0]=i+r*(e[0]-i),t[1]=o+r*(e[1]-o),t[2]=a+r*(e[2]-a),t[3]=u+r*(e[3]-u),t}function or(t,n){return n=n||1,t[0]=m(),t[1]=m(),t[2]=m(),t[3]=m(),er(t,t),Xe(t,t,n),t}function ar(t,n,e){let r=n[0],i=n[1],o=n[2],a=n[3];return t[0]=e[0]*r+e[4]*i+e[8]*o+e[12]*a,t[1]=e[1]*r+e[5]*i+e[9]*o+e[13]*a,t[2]=e[2]*r+e[6]*i+e[10]*o+e[14]*a,t[3]=e[3]*r+e[7]*i+e[11]*o+e[15]*a,t}function ur(t,n,e){let r=n[0],i=n[1],o=n[2],a=e[0],u=e[1],s=e[2],c=e[3],f=c*r+u*o-s*i,l=c*i+s*r-a*o,h=c*o+a*i-u*r,d=-a*r-u*i-s*o;return t[0]=f*c+d*-a+l*-s-h*-u,t[1]=l*c+d*-u+h*-a-f*-s,t[2]=h*c+d*-s+f*-u-l*-a,t[3]=n[3],t}function sr(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function cr(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]}function fr(t,n){let e=t[0],r=t[1],i=t[2],o=t[3],a=n[0],u=n[1],s=n[2],c=n[3];return Math.abs(e-a)<=h*Math.max(1,Math.abs(e),Math.abs(a))&&Math.abs(r-u)<=h*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(i-s)<=h*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(o-c)<=h*Math.max(1,Math.abs(o),Math.abs(c))}const lr=De,hr=Ve,dr=je,mr=Ze,br=$e,pr=Je,Mr=Ke,vr=function(){let t=Be();return function(n,e,r,i,o,a){let u,s;for(e||(e=4),r||(r=0),s=i?Math.min(i*e+r,n.length):n.length,u=r;u<s;u+=e)t[0]=n[u],t[1]=n[u+1],t[2]=n[u+2],t[3]=n[u+3],o(t,t,a),n[u]=t[0],n[u+1]=t[1],n[u+2]=t[2],n[u+3]=t[3];return n}}();function _r(){let t=new d(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function yr(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function gr(t,n,e){e*=.5;let r=Math.sin(e);return t[0]=r*n[0],t[1]=r*n[1],t[2]=r*n[2],t[3]=Math.cos(e),t}function xr(t,n){let e=2*Math.acos(n[3]),r=Math.sin(e/2);return 0!=r?(t[0]=n[0]/r,t[1]=n[1]/r,t[2]=n[2]/r):(t[0]=1,t[1]=0,t[2]=0),e}function wr(t,n,e){let r=n[0],i=n[1],o=n[2],a=n[3],u=e[0],s=e[1],c=e[2],f=e[3];return t[0]=r*f+a*u+i*c-o*s,t[1]=i*f+a*s+o*u-r*c,t[2]=o*f+a*c+r*s-i*u,t[3]=a*f-r*u-i*s-o*c,t}function Tr(t,n,e){e*=.5;let r=n[0],i=n[1],o=n[2],a=n[3],u=Math.sin(e),s=Math.cos(e);return t[0]=r*s+a*u,t[1]=i*s+o*u,t[2]=o*s-i*u,t[3]=a*s-r*u,t}function Ar(t,n,e){e*=.5;let r=n[0],i=n[1],o=n[2],a=n[3],u=Math.sin(e),s=Math.cos(e);return t[0]=r*s-o*u,t[1]=i*s+a*u,t[2]=o*s+r*u,t[3]=a*s-i*u,t}function Sr(t,n,e){e*=.5;let r=n[0],i=n[1],o=n[2],a=n[3],u=Math.sin(e),s=Math.cos(e);return t[0]=r*s+i*u,t[1]=i*s-r*u,t[2]=o*s+a*u,t[3]=a*s-o*u,t}function Er(t,n){let e=n[0],r=n[1],i=n[2];return t[0]=e,t[1]=r,t[2]=i,t[3]=Math.sqrt(Math.abs(1-e*e-r*r-i*i)),t}function Or(t,n,e,r){let i,o,a,u,s,c=n[0],f=n[1],l=n[2],h=n[3],d=e[0],m=e[1],b=e[2],p=e[3];return(o=c*d+f*m+l*b+h*p)<0&&(o=-o,d=-d,m=-m,b=-b,p=-p),1-o>1e-6?(i=Math.acos(o),a=Math.sin(i),u=Math.sin((1-r)*i)/a,s=Math.sin(r*i)/a):(u=1-r,s=r),t[0]=u*c+s*d,t[1]=u*f+s*m,t[2]=u*l+s*b,t[3]=u*h+s*p,t}function Rr(t,n){let e=n[0],r=n[1],i=n[2],o=n[3],a=e*e+r*r+i*i+o*o,u=a?1/a:0;return t[0]=-e*u,t[1]=-r*u,t[2]=-i*u,t[3]=o*u,t}function Cr(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t[3]=n[3],t}function Lr(t,n){let e,r=n[0]+n[4]+n[8];if(r>0)e=Math.sqrt(r+1),t[3]=.5*e,e=.5/e,t[0]=(n[5]-n[7])*e,t[1]=(n[6]-n[2])*e,t[2]=(n[1]-n[3])*e;else{let r=0;n[4]>n[0]&&(r=1),n[8]>n[3*r+r]&&(r=2);let i=(r+1)%3,o=(r+2)%3;e=Math.sqrt(n[3*r+r]-n[3*i+i]-n[3*o+o]+1),t[r]=.5*e,e=.5/e,t[3]=(n[3*i+o]-n[3*o+i])*e,t[i]=(n[3*i+r]+n[3*r+i])*e,t[o]=(n[3*o+r]+n[3*r+o])*e}return t}function Pr(t,n,e,r){let i=.5*Math.PI/180;n*=i,e*=i,r*=i;let o=Math.sin(n),a=Math.cos(n),u=Math.sin(e),s=Math.cos(e),c=Math.sin(r),f=Math.cos(r);return t[0]=o*s*f-a*u*c,t[1]=a*u*f+o*s*c,t[2]=a*s*c-o*u*f,t[3]=a*s*f+o*u*c,t}function Fr(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}const Br=Ie,Ir=Ne,Nr=ze,zr=qe,qr=Ue,Ur=wr,Dr=Xe,Vr=rr,jr=ir,Gr=Je,kr=Gr,Hr=Ke,Yr=Hr,Wr=er,Xr=cr,Qr=fr,Zr=function(){let t=Vn(),n=kn(1,0,0),e=kn(0,1,0);return function(r,i,o){let a=fe(i,o);return a<-.999999?(le(t,n,i),Le(t)<1e-6&&le(t,e,i),ce(t,t),gr(r,t,Math.PI),r):a>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(le(t,i,o),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+a,Wr(r,r))}}(),$r=function(){let t=_r(),n=_r();return function(e,r,i,o,a,u){return Or(t,r,a,u),Or(n,i,o,u),Or(e,t,n,2*u*(1-u)),e}}(),Jr=function(){let t=pt();return function(n,e,r,i){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=i[0],t[4]=i[1],t[7]=i[2],t[2]=-e[0],t[5]=-e[1],t[8]=-e[2],Wr(n,Lr(n,t))}}();function Kr(){let t=new d(2);return t[0]=0,t[1]=0,t}function ti(t){let n=new d(2);return n[0]=t[0],n[1]=t[1],n}function ni(t,n){let e=new d(2);return e[0]=t,e[1]=n,e}function ei(t,n){return t[0]=n[0],t[1]=n[1],t}function ri(t,n,e){return t[0]=n,t[1]=e,t}function ii(t,n,e){return t[0]=n[0]+e[0],t[1]=n[1]+e[1],t}function oi(t,n,e){return t[0]=n[0]-e[0],t[1]=n[1]-e[1],t}function ai(t,n,e){return t[0]=n[0]*e[0],t[1]=n[1]*e[1],t}function ui(t,n,e){return t[0]=n[0]/e[0],t[1]=n[1]/e[1],t}function si(t,n){return t[0]=Math.ceil(n[0]),t[1]=Math.ceil(n[1]),t}function ci(t,n){return t[0]=Math.floor(n[0]),t[1]=Math.floor(n[1]),t}function fi(t,n,e){return t[0]=Math.min(n[0],e[0]),t[1]=Math.min(n[1],e[1]),t}function li(t,n,e){return t[0]=Math.max(n[0],e[0]),t[1]=Math.max(n[1],e[1]),t}function hi(t,n){return t[0]=Math.round(n[0]),t[1]=Math.round(n[1]),t}function di(t,n,e){return t[0]=n[0]*e,t[1]=n[1]*e,t}function mi(t,n,e,r){return t[0]=n[0]+e[0]*r,t[1]=n[1]+e[1]*r,t}function bi(t,n){var e=n[0]-t[0],r=n[1]-t[1];return Math.sqrt(e*e+r*r)}function pi(t,n){var e=n[0]-t[0],r=n[1]-t[1];return e*e+r*r}function Mi(t){var n=t[0],e=t[1];return Math.sqrt(n*n+e*e)}function vi(t){var n=t[0],e=t[1];return n*n+e*e}function _i(t,n){return t[0]=-n[0],t[1]=-n[1],t}function yi(t,n){return t[0]=1/n[0],t[1]=1/n[1],t}function gi(t,n){var e=n[0],r=n[1],i=e*e+r*r;return i>0&&(i=1/Math.sqrt(i),t[0]=n[0]*i,t[1]=n[1]*i),t}function xi(t,n){return t[0]*n[0]+t[1]*n[1]}function wi(t,n,e){var r=n[0]*e[1]-n[1]*e[0];return t[0]=t[1]=0,t[2]=r,t}function Ti(t,n,e,r){var i=n[0],o=n[1];return t[0]=i+r*(e[0]-i),t[1]=o+r*(e[1]-o),t}function Ai(t,n){n=n||1;var e=2*m()*Math.PI;return t[0]=Math.cos(e)*n,t[1]=Math.sin(e)*n,t}function Si(t,n,e){var r=n[0],i=n[1];return t[0]=e[0]*r+e[2]*i,t[1]=e[1]*r+e[3]*i,t}function Ei(t,n,e){var r=n[0],i=n[1];return t[0]=e[0]*r+e[2]*i+e[4],t[1]=e[1]*r+e[3]*i+e[5],t}function Oi(t,n,e){var r=n[0],i=n[1];return t[0]=e[0]*r+e[3]*i+e[6],t[1]=e[1]*r+e[4]*i+e[7],t}function Ri(t,n,e){let r=n[0],i=n[1];return t[0]=e[0]*r+e[4]*i+e[12],t[1]=e[1]*r+e[5]*i+e[13],t}function Ci(t){return"vec2("+t[0]+", "+t[1]+")"}function Li(t,n){return t[0]===n[0]&&t[1]===n[1]}function Pi(t,n){let e=t[0],r=t[1],i=n[0],o=n[1];return Math.abs(e-i)<=h*Math.max(1,Math.abs(e),Math.abs(i))&&Math.abs(r-o)<=h*Math.max(1,Math.abs(r),Math.abs(o))}const Fi=Mi,Bi=oi,Ii=ai,Ni=ui,zi=bi,qi=pi,Ui=vi,Di=function(){let t=Kr();return function(n,e,r,i,o,a){let u,s;for(e||(e=2),r||(r=0),s=i?Math.min(i*e+r,n.length):n.length,u=r;u<s;u+=e)t[0]=n[u],t[1]=n[u+1],o(t,t,a),n[u]=t[0],n[u+1]=t[1];return n}}();e.d(n,"glMatrix",function(){return r}),e.d(n,"mat2",function(){return i}),e.d(n,"mat2d",function(){return o}),e.d(n,"mat3",function(){return a}),e.d(n,"mat4",function(){return u}),e.d(n,"quat",function(){return f}),e.d(n,"vec2",function(){return l}),e.d(n,"vec3",function(){return s}),e.d(n,"vec4",function(){return c})},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e(0);function i(t){return"a_"+t.toLowerCase()}n.ATTRIB_LOCATIONS={POSITION:0,NORMAL:1,TANGENT:2,TEXCOORD_0:3,TEXCOORD_1:4,COLOR_0:5,JOINTS_0:6,WEIGHTS_0:7},n.attribName=i,function(t){t[t.HAS_NORMALS=1]="HAS_NORMALS",t[t.HAS_TANGENTS=2]="HAS_TANGENTS",t[t.HAS_UV=4]="HAS_UV",t[t.HAS_COLORS=8]="HAS_COLORS",t[t.USE_IBL=16]="USE_IBL",t[t.HAS_BASECOLORMAP=32]="HAS_BASECOLORMAP",t[t.HAS_NORMALMAP=64]="HAS_NORMALMAP",t[t.HAS_EMISSIVEMAP=128]="HAS_EMISSIVEMAP",t[t.HAS_METALROUGHNESSMAP=256]="HAS_METALROUGHNESSMAP",t[t.HAS_OCCLUSIONMAP=512]="HAS_OCCLUSIONMAP",t[t.USE_TEX_LOD=1024]="USE_TEX_LOD"}(n.ShaderFlags||(n.ShaderFlags={}));var o=function(){function t(t){this.attribLocations={};var o=t.gl,a=new r.Shader(t,o.VERTEX_SHADER,"simple.vert");a.initialize(e(4));var u=new r.Shader(t,o.FRAGMENT_SHADER,"simple.frag");if(u.initialize(e(3)),this.program=new r.Program(t),this.program.initialize([a,u]),t.isWebGL2)Object.assign(this.attribLocations,n.ATTRIB_LOCATIONS);else for(var s=0,c=Object.keys(n.ATTRIB_LOCATIONS);s<c.length;s++){var f=c[s],l=i(f);this.attribLocations[f]=this.program.attribute(l)}this.uViewProjection=this.program.uniform("u_viewProjection"),this.uModel=this.program.uniform("u_model")}return t.prototype.bind=function(){this.program.bind()},t.prototype.unbind=function(){this.program.unbind()},t.prototype.uninitialize=function(){this.program.uninitialize()},t}();n.PbrShader=o},function(t,n){t.exports="precision mediump float;\n\n\n#if __VERSION__ == 100\n    #define texture(sampler, coord) texture2D(sampler, coord)\n#else \n    #define varying in\n#endif\n\n\n#if __VERSION__ == 100\n    #define fragColor gl_FragColor\n#else\n    layout(location = 0) out vec4 fragColor;\n#endif\n\n\nvarying vec3 Normal;\n// in vec4 Tangent;\n// in vec2 TexCoords_0;\n// in vec2 TexCoords_1;\n// in vec3 Color;\n\n// uniform sampler2D base_color_texture;\n// uniform vec4 base_color_factor;\n\nvoid main()\n{\n    // vec4 baseColor = texture(base_color_texture, TexCoords_0);\n    // // TODO!: HACK\n    // if (baseColor.x > 0.0 || baseColor.y > 0.0 || baseColor.z > 0.0) {\n    //     fragColor = baseColor * base_color_factor;\n    // }\n    // else {\n    //     fragColor = base_color_factor;\n    // }\n\n    // fragColor = vec4(1.0, 0.0, 0.0, 1.0);\n\n    fragColor = vec4(Normal, 1.0);\n    // fragColor = vec4(Tangent.xyz, 1.0);\n    // fragColor = vec4(TexCoords_0, 0.0, 1.0);\n    // fragColor = vec4(TexCoords_1, 0,0, 1.0);\n    // fragColor = vec4(Color, 1.0);\n}\n"},function(t,n){t.exports="\n#if __VERSION__ == 100\n#else \n    #define varying out\n#endif\n\n\n#if __VERSION__ == 100\n    attribute vec3 a_position;\n    attribute vec3 a_normal;\n    // TODO! webgl1 support\n#else\n    layout (location = 0) in vec3 a_position;\n    layout (location = 1) in vec3 a_normal;\n    layout (location = 2) in vec4 a_tangent;\n    layout (location = 3) in vec2 a_texCoords_0;\n    layout (location = 4) in vec2 a_texCoords_1;\n    layout (location = 5) in vec3 a_color;\n#endif\n\nvarying vec3 Normal;\n// out vec4 Tangent;\n// out vec2 TexCoords_0;\n// out vec2 TexCoords_1;\n// out vec3 Color;\n\nuniform mat4 u_model;\nuniform mat4 u_viewProjection;\n// uniform mat4 u_modelViewProjection;\n\nvoid main()\n{\n    Normal = a_normal;\n    // Tangent = a_tangent;\n    // TexCoords_0 = a_texCoords_0;\n    // TexCoords_1 = a_texCoords_1;\n    // Color = a_color;\n    gl_Position = u_viewProjection * u_model\n        * vec4(a_position, 1.0);\n}\n"},function(t,n,e){"use strict";var r=this&&this.__awaiter||function(t,n,e,r){return new(e||(e=Promise))(function(i,o){function a(t){try{s(r.next(t))}catch(t){o(t)}}function u(t){try{s(r.throw(t))}catch(t){o(t)}}function s(t){t.done?i(t.value):new e(function(n){n(t.value)}).then(a,u)}s((r=r.apply(t,n||[])).next())})},i=this&&this.__generator||function(t,n){var e,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(i=r[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=n.call(t,a)}catch(t){o=[6,t],r=0}finally{e=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}};Object.defineProperty(n,"__esModule",{value:!0});var o=e(1),a=e(0),u=e(2),s=function(){function t(){this.baseColorFactor=o.vec4.fromValues(1,1,1,1),this.metallicFactor=1,this.roughnessFactor=1,this.emissiveFactor=o.vec3.fromValues(0,0,0),this.alphaCutoff=.5,this.alphaMode="OPAQUE",this.doubleSided=!1}return t.fromGltf=function(n,e,a){return r(this,void 0,void 0,function(){var r,u,s,c,f,l,h,d,m,b,p,M;return i(this,function(i){switch(i.label){case 0:return r=e.gltf.materials[n],(u=new t).name=r.name||n.toString(),s=r.pbrMetallicRoughness,c={baseColorTexture:void 0,metallicRoghnessTexture:void 0,normalTexture:void 0,occlusionTexture:void 0,emissiveTexture:void 0},s&&(s.baseColorFactor&&(u.baseColorFactor=o.vec4.fromValues.apply(void 0,s.baseColorFactor)),s.baseColorTexture&&(c.baseColor=this.loadTexture(s.baseColorTexture,e,a,"mat_"+u.name+"_baseColorTexture")),void 0!==s.metallicFactor&&(u.metallicFactor=s.metallicFactor),void 0!==s.roughnessFactor&&(u.roughnessFactor=s.roughnessFactor),s.metallicRoughnessTexture&&(c.metallicRoughnessTexture=this.loadTexture(s.metallicRoughnessTexture,e,a,"mat_"+u.name+"_metallicRoughnessTexture"))),(f=r.normalTexture)&&(c.normalTexture=this.loadTexture(f,e,a,"mat_"+u.name+"_normalTexture"),u.normalScale=f.scale||1),(l=r.occlusionTexture)&&(c.occlusionTexture=this.loadTexture(l,e,a,"mat_"+u.name+"_occlusionTexture"),u.occlusionStrength=l.strength||1),r.emissiveTexture&&(c.emissiveTexture=this.loadTexture(r.emissiveTexture,e,a,"mat_"+u.name+"_emissiveTexture")),r.emissiveFactor&&(u.emissiveFactor=o.vec3.fromValues.apply(void 0,r.emissiveFactor)),void 0!==r.alphaCutoff&&(u.alphaCutoff=r.alphaCutoff),r.alphaMode&&(u.alphaMode=r.alphaMode),void 0!==r.doubleSided&&(u.doubleSided=r.doubleSided),[4,Promise.all(Object.values(c))];case 1:for(d in i.sent(),h=[],c)h.push(d);m=0,i.label=2;case 2:return m<h.length?(b=h[m],p=u,M=b,[4,c[b]]):[3,5];case 3:p[M]=i.sent(),i.label=4;case 4:return m++,[3,2];case 5:return[2,u]}})})},t.loadTexture=function(t,n,e,o){return r(this,void 0,void 0,function(){var r,u,s,c,f,l,h,d;return i(this,function(i){switch(i.label){case 0:return r=e.gl,u=n.gltf,t.texCoord||0,s=u.textures[t.index],[4,n.imageData.get(s.source)];case 1:return c=i.sent(),f=s.sampler?u.samplers[s.sampler]:{wrapS:r.REPEAT,wrapT:r.REPEAT},(l=new a.Texture2(e,o)).initialize(c.width,c.height,r.RGBA,r.RGBA,r.UNSIGNED_BYTE),l.wrap(f.wrapS||r.REPEAT,f.wrapT||r.REPEAT,!0,!1),h=f.magFilter||r.LINEAR,d=f.minFilter||r.LINEAR_MIPMAP_LINEAR,l.filter(h,d,!1,!1),l.data(c,!1,!1),(d===r.LINEAR_MIPMAP_LINEAR||d===r.LINEAR_MIPMAP_NEAREST||d===r.NEAREST_MIPMAP_LINEAR||d===r.NEAREST_MIPMAP_NEAREST)&&r.generateMipmap(r.TEXTURE_2D),l.unbind(),[2,l]}})})},Object.defineProperty(t.prototype,"shaderFlags",{get:function(){var t=0;return this.baseColorTexture&&(t|=u.ShaderFlags.HAS_BASECOLORMAP),this.normalTexture&&(t|=u.ShaderFlags.HAS_NORMALMAP),this.emissiveTexture&&(t|=u.ShaderFlags.HAS_EMISSIVEMAP),this.metallicRoughnessTexture&&(t|=u.ShaderFlags.HAS_METALROUGHNESSMAP),this.occlusionTexture&&(t|=u.ShaderFlags.HAS_OCCLUSIONMAP),t},enumerable:!0,configurable:!0}),t.prototype.bind=function(){},t.prototype.unbind=function(){},t}();n.Material=s},function(t,n,e){"use strict";var r=this&&this.__awaiter||function(t,n,e,r){return new(e||(e=Promise))(function(i,o){function a(t){try{s(r.next(t))}catch(t){o(t)}}function u(t){try{s(r.throw(t))}catch(t){o(t)}}function s(t){t.done?i(t.value):new e(function(n){n(t.value)}).then(a,u)}s((r=r.apply(t,n||[])).next())})},i=this&&this.__generator||function(t,n){var e,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(i=r[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=n.call(t,a)}catch(t){o=[6,t],r=0}finally{e=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}};Object.defineProperty(n,"__esModule",{value:!0});var o=e(0),a=o.auxiliaries.assert,u=e(1),s=e(19),c=e(5),f=e(2),l={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},h=function(){function t(t,n,e,r,i,o){this.buffer=t,this.size=n,this.type=e,this.normalized=r,this.stride=i,this.offset=o}return t.fromGltf=function(n,e,r){return new t(r,l[n.type],n.componentType,n.normalized||!1,e.byteStride||0,n.byteOffset||0)},t.prototype.enable=function(t){this.buffer.attribEnable(t,this.size,this.type,this.normalized,this.stride,this.offset,!0,!1)},t.prototype.disable=function(t){this.buffer.attribDisable(t,!0,!0)},t}(),d=function(){function t(t,n){void 0===n&&(n="Primitive"),this.attributes={},this.identifier=n,this.vertexArray=new o.VertexArray(t,n+"_VAO")}return t.fromGltf=function(n,e,l,d){return r(this,void 0,void 0,function(){var r,m,b,p,M,v,_,y,g,x,w,T,A,S,E,O;return i(this,function(i){switch(i.label){case 0:if((r=new t(l,d)).mode=n.mode||4,m=r.context.gl,b=e.gltf,a(!!n.attributes.POSITION,"primitives must have the POSITION attribute"),void 0===b.bufferViews)throw new Error("invalid gltf");for(v in p={},M=[],n.attributes)M.push(v);_=0,i.label=1;case 1:return _<M.length?(y=M[_],g=r.getAccessor(b,n.attributes[y]),r.numVertices=g.count,x=g.bufferView,w=void 0,x in p?(w=p[x],[3,4]):[3,2]):[3,6];case 2:return[4,e.bufferViewData(x)];case 3:T=i.sent(),(w=new o.Buffer(r.context,r.identifier+"_VBO_"+Object.keys(p).length)).initialize(m.ARRAY_BUFFER),w.data(T,m.STATIC_DRAW),p[x]=w,i.label=4;case 4:r.attributes[y]=h.fromGltf(g,b.bufferViews[x],w),"POSITION"===y&&(r.bounds=new s.Aabb3(u.vec3.fromValues.apply(void 0,g.min),u.vec3.fromValues.apply(void 0,g.max))),i.label=5;case 5:return _++,[3,1];case 6:return A=0,n.attributes.NORMALS&&(A|=f.ShaderFlags.HAS_NORMALS),n.attributes.TANGENT&&(A|=f.ShaderFlags.HAS_TANGENTS),n.attributes.TEXCOORD_0&&(A|=f.ShaderFlags.HAS_UV),n.attributes.COLOR_0&&(A|=f.ShaderFlags.HAS_COLORS),void 0===n.indices?[3,8]:(S=r.getAccessor(b,n.indices),[4,e.bufferViewData(S.bufferView)]);case 7:if(E=i.sent(),r.indexBuffer=new o.Buffer(r.context,r.identifier+"_EBO"),r.numIndices=S.count,r.indexByteOffset=S.byteOffset||0,r.indexType=S.componentType,r.indexType===m.UNSIGNED_INT)throw new Error("not yet supported: UNSIGNED_INT indices");return r.indexBuffer.initialize(m.ELEMENT_ARRAY_BUFFER),r.indexBuffer.data(E,m.STATIC_DRAW),o.auxiliaries.assert(void 0!==r.indexBuffer&&r.indexBuffer.object instanceof WebGLBuffer,"expected valid WebGLBuffer"),[3,9];case 8:r.initialize(),i.label=9;case 9:return void 0!==n.material?[3,10]:(r.material=new c.Material,r.material.name="DefaultMaterial",[3,12]);case 10:return O=r,[4,c.Material.fromGltf(n.material,e,r.context)];case 11:O.material=i.sent(),i.label=12;case 12:return r.shaderFlags=A|r.material.shaderFlags,r.initialize(),[2,r]}})})},t.prototype.getAccessor=function(t,n){if(void 0===t.accessors)throw new Error("invalid gltf");var e=t.accessors[n];if(e.sparse)throw new Error("sparse accessors not implemented yet");return e},t.prototype.bindBuffers=function(){for(var t in this.attributes){var n=this.shader.attribLocations[t];void 0!==n&&-1!==n&&this.attributes[t].enable(n)}this.numIndices&&this.indexBuffer.bind()},t.prototype.unbindBuffers=function(){for(var t in this.attributes){var n=this.shader.attribLocations[t];void 0!==n&&-1!==n&&this.attributes[t].disable(n)}this.numIndices&&this.indexBuffer.unbind()},t.prototype.initialize=function(){for(var t=this,n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var r=this.context.gl;return this.numIndices?this.drawCall=function(){r.drawElements(t.mode,t.numIndices,t.indexType,t.indexByteOffset)}:this.drawCall=function(){r.drawArrays(t.mode,0,t.numVertices)},this.vertexArray.initialize(function(){return t.bindBuffers()},function(){return t.unbindBuffers()}),this.vertexArray.valid},t.prototype.uninitialize=function(){for(var t in this.vertexArray.uninitialize(),this.attributes)this.attributes[t].buffer.uninitialize();this.indexBuffer.uninitialize()},t.prototype.draw=function(t){this.shader=t,this.vertexArray.bind(),this.drawCall(),this.vertexArray.unbind(),this.shader=void 0},Object.defineProperty(t.prototype,"context",{get:function(){return this.vertexArray.context},enumerable:!0,configurable:!0}),t}();n.Primitive=d},function(t,n,e){"use strict";var r=this&&this.__awaiter||function(t,n,e,r){return new(e||(e=Promise))(function(i,o){function a(t){try{s(r.next(t))}catch(t){o(t)}}function u(t){try{s(r.throw(t))}catch(t){o(t)}}function s(t){t.done?i(t.value):new e(function(n){n(t.value)}).then(a,u)}s((r=r.apply(t,n||[])).next())})},i=this&&this.__generator||function(t,n){var e,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(i=r[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=n.call(t,a)}catch(t){o=[6,t],r=0}finally{e=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}};Object.defineProperty(n,"__esModule",{value:!0});var o=e(19),a=e(6),u=function(){function t(){this.bounds=new o.Aabb3}return t.fromGltf=function(n,e,o){return r(this,void 0,void 0,function(){var r,u,s,c,f,l;return i(this,function(i){switch(i.label){case 0:return r=e.gltf.meshes[n],(u=new t).context=o,u.name=r.name,s=u,[4,Promise.all(r.primitives.map(function(t,i){var u="mesh_"+(r.name||n)+"_prim_"+i;return a.Primitive.fromGltf(t,e,o,u)}))];case 1:for(s.primitives=i.sent(),c=0,f=u.primitives;c<f.length;c++)l=f[c],u.bounds.union(l.bounds);return[2,u]}})})},t.prototype.draw=function(t){for(var n=0,e=this.primitives;n<e.length;n++){e[n].draw(t)}},t.prototype.uninitialize=function(){for(var t=0,n=this.primitives;t<n.length;t++){n[t].uninitialize()}},t}();n.Mesh=u},function(t,n,e){"use strict";var r=this&&this.__awaiter||function(t,n,e,r){return new(e||(e=Promise))(function(i,o){function a(t){try{s(r.next(t))}catch(t){o(t)}}function u(t){try{s(r.throw(t))}catch(t){o(t)}}function s(t){t.done?i(t.value):new e(function(n){n(t.value)}).then(a,u)}s((r=r.apply(t,n||[])).next())})},i=this&&this.__generator||function(t,n){var e,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(i=r[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=n.call(t,a)}catch(t){o=[6,t],r=0}finally{e=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}};Object.defineProperty(n,"__esModule",{value:!0});var o=e(1),a=e(19),u=e(7),s=function(){function t(){this.children=[],this.finalTransform=o.mat4.create()}return t.fromGltf=function(n,e,a){return r(this,void 0,void 0,function(){var r,s,c;return i(this,function(i){switch(i.label){case 0:return(r=new t).name=n.name,r.context=a,void 0!==n.matrix?r.matrix=o.mat4.fromValues.apply(void 0,n.matrix):n.translation||n.rotation||n.scale?(r.translation=n.translation?o.vec3.fromValues.apply(void 0,n.translation):o.vec3.create(),r.rotation=n.rotation?o.quat.fromValues.apply(void 0,n.rotation):o.quat.create(),r.scale=n.scale?o.vec3.fromValues.apply(void 0,n.scale):o.vec3.fromValues(1,1,1)):r.matrix=o.mat4.create(),void 0===n.mesh?[3,2]:(s=r,[4,u.Mesh.fromGltf(n.mesh,e,a)]);case 1:s.mesh=i.sent(),i.label=2;case 2:return n.children?(c=r,[4,Promise.all(n.children.map(function(n){return t.fromGltf(e.gltf.nodes[n],e,a)}))]):[3,4];case 3:c.children=i.sent(),i.label=4;case 4:return[2,r]}})})},t.prototype.updateTransform=function(t){if(this.finalTransform=o.mat4.clone(t),this.matrix)o.mat4.mul(this.finalTransform,this.finalTransform,this.matrix);else{var n=o.mat4.fromRotationTranslationScale(o.mat4.create(),this.rotation,this.translation,this.scale);o.mat4.mul(this.finalTransform,this.finalTransform,n)}for(var e=0,r=this.children;e<r.length;e++){r[e].updateTransform(this.finalTransform)}},t.prototype.updateBounds=function(){if(this.mesh)this.bounds=this.mesh.bounds.clone(),this.bounds.transform(this.finalTransform);else if(0===this.children.length)this.bounds=new a.Aabb3(o.vec3.fromValues(0,0,0),o.vec3.fromValues(0,0,0)),this.bounds.transform(this.finalTransform);else{this.bounds=new a.Aabb3;for(var t=0,n=this.children;t<n.length;t++){var e=n[t];e.updateBounds(),this.bounds.union(e.bounds)}}},t.prototype.draw=function(t,n){if(this.mesh){var e=this.context.gl;e.uniformMatrix4fv(n.uModel,e.FALSE,this.finalTransform),this.mesh.draw(n)}for(var r=0,i=this.children;r<i.length;r++){i[r].draw(t,n)}},t.prototype.uninitialize=function(){this.mesh&&this.mesh.uninitialize();for(var t=0,n=this.children;t<n.length;t++){n[t].uninitialize()}},t}();n.Node=s},function(t,n,e){"use strict";var r=this&&this.__awaiter||function(t,n,e,r){return new(e||(e=Promise))(function(i,o){function a(t){try{s(r.next(t))}catch(t){o(t)}}function u(t){try{s(r.throw(t))}catch(t){o(t)}}function s(t){t.done?i(t.value):new e(function(n){n(t.value)}).then(a,u)}s((r=r.apply(t,n||[])).next())})},i=this&&this.__generator||function(t,n){var e,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(i=r[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=n.call(t,a)}catch(t){o=[6,t],r=0}finally{e=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}};Object.defineProperty(n,"__esModule",{value:!0});var o=e(1),a=e(19),u=e(8),s=function(){function t(){this.bounds=new a.Aabb3}return t.fromGltf=function(n,e,a){return r(this,void 0,void 0,function(){var r,s,c,f,l,h;return i(this,function(i){switch(i.label){case 0:return(r=new t).name=n.name,s=r,[4,Promise.all(n.nodes.map(function(t){var n=e.gltf.nodes[t];return u.Node.fromGltf(n,e,a)}))];case 1:for(s.nodes=i.sent(),c=o.mat4.create(),f=0,l=r.nodes;f<l.length;f++)(h=l[f]).updateTransform(c),h.updateBounds(),r.bounds.union(h.bounds);return[2,r]}})})},t.prototype.draw=function(t,n){for(var e=0,r=this.nodes;e<r.length;e++){r[e].draw(t,n)}},t.prototype.uninitialize=function(){for(var t=0,n=this.nodes;t<n.length;t++){n[t].uninitialize()}},t}();n.Scene=s},function(t,n){t.exports="\nprecision lowp float;\n\n\n#if __VERSION__ == 100\n    #define texture(sampler, coord) texture2D(sampler, coord)\n#else \n    #define varying in\n#endif\n\n\n\n#if __VERSION__ == 100\n    #define fragColor gl_FragColor\n#else \n    layout(location = 0) out vec4 fragColor;\n#endif\n\n\nuniform samplerCube u_background;\n\nvarying vec3 v_uv;\n\n\nvoid main(void)\n{\n    vec3 uv = (v_uv);\n    /*\n    vec3 w3 = abs(fwidth(uv));\n    float density = sqrt(w3.x * w3.x + w3.y * w3.y + w3.z * w3.z);\n    density *= 100.0;\n    vec3 color = texture(background, uv).rgb;\n    out_color = vec4(mix(vec3(0,0,0), vec3(1,0,0), density), 1.0);\n    */\n\n#if __VERSION__ == 100\n    vec3 color = textureCube(u_background, normalize(v_uv)).rgb;\n#else\n    vec3 color = texture(u_background, normalize(v_uv)).rgb;\n#endif\n\n    fragColor = vec4(color, 1.0);\n}\n"},function(t,n){t.exports="\nprecision lowp float;\n\n\n#if __VERSION__ == 100\n#else \n    #define varying out\n#endif\n\n\n\n#if __VERSION__ == 100\n    attribute vec3 a_vertex;\n#else \n    layout(location = 0) in vec3 a_vertex;\n#endif\n\n\nuniform mat4 u_transform;\nuniform vec3 u_eye;\n\nvarying vec3 v_uv;\n\n\nvoid main(void)\n{\n    v_uv = a_vertex;\n\n    vec4 vertex = u_transform * vec4(a_vertex + u_eye, 1.0);\n    gl_Position = vertex.xyww;    \n}\n"},function(t,n,e){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])},function(t,n){function e(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)});Object.defineProperty(n,"__esModule",{value:!0});var o=e(0),a=function(t){function n(n,e){var r=t.call(this,n,e)||this;e=void 0!==e&&""!==e?e:r.constructor.name;var i=new o.Buffer(n,e+"VBO"),a=new o.Buffer(n,e+"IndexBuffer");return r._buffers.push(i),r._buffers.push(a),r}return i(n,t),n.prototype.bindBuffers=function(t){this._buffers[0].attribEnable(t[0],3,this.context.gl.FLOAT,!1,0,0,!0,!1),this._buffers[1].bind()},n.prototype.unbindBuffers=function(t){this._buffers[0].attribDisable(t[0],!0,!0),this._buffers[1].unbind()},n.prototype.initialize=function(e){var r=this.context.gl,i=t.prototype.initialize.call(this,[r.ARRAY_BUFFER,r.ELEMENT_ARRAY_BUFFER],[e,8]);return o.auxiliaries.assert(void 0!==this._buffers[0]&&this._buffers[0].object instanceof WebGLBuffer,"expected valid WebGLBuffer"),o.auxiliaries.assert(void 0!==this._buffers[1]&&this._buffers[1].object instanceof WebGLBuffer,"expected valid WebGLBuffer"),this._buffers[0].data(n.VERTICES,r.STATIC_DRAW),this._buffers[1].data(n.INDICES,r.STATIC_DRAW),i},n.prototype.draw=function(){var t=this.context.gl;t.drawElements(t.TRIANGLE_STRIP,n.INDICES.length,t.UNSIGNED_BYTE,0)},n.VERTICES=new Float32Array([-1,-1,1,1,-1,1,-1,1,1,1,1,1,-1,-1,-1,1,-1,-1,-1,1,-1,1,1,-1]),n.INDICES=new Uint8Array([0,1,2,3,7,1,5,4,7,6,2,4,0,1]),n}(o.Geometry);n.Cube=a},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e(0),i=e(12),o=function(){function t(){}return t.prototype.initialize=function(t,n,o){this._context=t,this._camera=n,this._texture=o;var a=this._context.gl,u=new r.Shader(this._context,a.VERTEX_SHADER,"skybox.vert");u.initialize(e(11));var s=new r.Shader(this._context,a.FRAGMENT_SHADER,"skybox.frag");s.initialize(e(10)),this._program=new r.Program(t),this._program.initialize([u,s]),this._uTransform=this._program.uniform("u_transform"),this._uEye=this._program.uniform("u_eye"),this._uBackground=this._program.uniform("u_background"),this._cube=new i.Cube(this._context);var c=this._program.attribute("a_vertex",0);this._cube.initialize(c)},t.prototype.uninitialize=function(){this._uTransform=-1,this._uEye=-1,this._uBackground=-1,this._program.uninitialize(),this._cube.uninitialize()},t.prototype.frame=function(){var t=this._context.gl;t.enable(t.CULL_FACE),t.cullFace(t.FRONT),t.enable(t.DEPTH_TEST),t.depthMask(!1),t.depthFunc(t.LEQUAL),this._program.bind(),t.uniformMatrix4fv(this._uTransform,t.GL_FALSE,this._camera.viewProjection),t.uniform3fv(this._uEye,this._camera.eye),t.uniform1i(this._uBackground,0),this._texture.bind(0),this._cube.bind(),this._cube.draw(),this._cube.unbind(),this._texture.unbind(),this._program.unbind(),t.depthFunc(t.LESS),t.depthMask(!0),t.cullFace(t.BACK),t.disable(t.CULL_FACE)},t}();n.Skybox=o},function(t,n,e){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])},function(t,n){function e(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)});Object.defineProperty(n,"__esModule",{value:!0});var o=e(1),a=e(0),u=e(13),s=e(2),c=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),Object.defineProperty(n.prototype,"scene",{set:function(t){this._scene&&this._scene.uninitialize(),this._scene=t,this._sceneChanged=!0,this.setCameraFromBounds(),this.invalidate()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"context",{get:function(){return this._context},enumerable:!0,configurable:!0}),n.prototype.onInitialize=function(t,n,e){var r=this,i=this._context.gl,c=this._context.gl2facade;this.pbrShader=new s.PbrShader(t),this._camera=new a.Camera,this._camera.center=o.vec3.fromValues(0,0,0),this._camera.up=o.vec3.fromValues(0,1,0),this._camera.eye=o.vec3.fromValues(0,0,3),this._camera.near=.1,this._camera.far=20,this._navigation=new a.Navigation(n,e),this._navigation.camera=this._camera,this._defaultFBO=new a.DefaultFramebuffer(this._context,"DefaultFBO"),this._defaultFBO.initialize(),this._colorRenderTexture=new a.Texture2(this._context,"ColorRenderTexture"),this._colorRenderTexture.initialize(480,270,this._context.isWebGL2?i.RGBA8:i.RGBA,i.RGBA,i.UNSIGNED_BYTE),this._depthRenderbuffer=new a.Renderbuffer(this._context,"DepthRenderbuffer"),this._depthRenderbuffer.initialize(480,270,i.DEPTH_COMPONENT16),this._intermediateFBO=new a.Framebuffer(this._context,"IntermediateFBO"),this._intermediateFBO.initialize([[c.COLOR_ATTACHMENT0,this._colorRenderTexture],[i.DEPTH_ATTACHMENT,this._depthRenderbuffer]]),this._blit=new a.BlitPass(this._context),this._blit.initialize(),this._blit.framebuffer=this._intermediateFBO,this._blit.readBuffer=c.COLOR_ATTACHMENT0,this._blit.drawBuffer=i.BACK,this._blit.target=this._defaultFBO;var f=a.Wizard.queryInternalTextureFormat(this._context,i.RGB,"byte");return this._cubeMap=new a.TextureCube(this._context),this._cubeMap.initialize(512,f[0],i.RGB,f[1]),this._skyBox=new u.Skybox,this._skyBox.initialize(this._context,this._camera,this._cubeMap),this._cubeMap.load({positiveX:"data/skybox.px.png",negativeX:"data/skybox.nx.png",positiveY:"data/skybox.py.png",negativeY:"data/skybox.ny.png",positiveZ:"data/skybox.pz.png",negativeZ:"data/skybox.nz.png"}).then(function(){return r.invalidate(!0)}),setTimeout(function(){r.clearColor=[0,0,1,1]},0),!0},n.prototype.onUninitialize=function(){this._scene.uninitialize(),this.pbrShader.uninitialize(),this._intermediateFBO.uninitialize(),this._defaultFBO.uninitialize(),this._colorRenderTexture.uninitialize(),this._depthRenderbuffer.uninitialize(),this._blit.uninitialize(),this._skyBox.uninitialize()},n.prototype.onUpdate=function(){this._altered.frameSize&&(this._intermediateFBO.resize(this._frameSize[0],this._frameSize[1]),this._camera.viewport=[this._frameSize[0],this._frameSize[1]]),this._altered.canvasSize&&(this._camera.aspect=this._canvasSize[0]/this._canvasSize[1]),this._altered.clearColor&&this._intermediateFBO.clearColor(this._clearColor),this._navigation.update();var t=this._altered.any||this._camera.altered||this._cubeMapChanged||this._sceneChanged;return this._altered.reset(),this._camera.altered=!1,this._cubeMapChanged=!1,this._sceneChanged=!1,t},n.prototype.onPrepare=function(){},n.prototype.onFrame=function(t){var n=this._context.gl;this._intermediateFBO.bind(),this._intermediateFBO.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT,!1,!1),n.viewport(0,0,this._frameSize[0],this._frameSize[1]),this.pbrShader.bind(),n.uniformMatrix4fv(this.pbrShader.uViewProjection,n.GL_FALSE,this._camera.viewProjection),this._scene&&this._scene.draw(this._camera,this.pbrShader),this.pbrShader.unbind(),this._skyBox.frame(),this._intermediateFBO.unbind()},n.prototype.onSwap=function(){this._blit.frame(),this.invalidate()},n.prototype.setCameraFromBounds=function(){var t=this._scene.bounds,n=o.vec3.len(t.size),e=t.center;this._camera.eye=o.vec3.fromValues(e[0]+n/1.5,e[1]+n/5,e[2]+n/1.5),this._camera.center=e,this._camera.near=n/100,this._camera.far=20*n},n}(a.Renderer);n.GltfRenderer=c},function(t,n){t.exports=function(t){var n={};function e(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=7)}([function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.LoadingManager=class{constructor(){this.urlModifier=void 0,this.onStart=void 0,this.onProgress=void 0,this.onLoad=void 0,this.onError=void 0,this.isLoading=!1,this.itemsLoaded=0,this.itemsTotal=0}itemStart(t){this.itemsTotal++,!this.isLoading&&this.onStart&&this.onStart(t,this.itemsLoaded,this.itemsTotal),this.isLoading=!0}itemEnd(t){this.itemsLoaded++,this.onProgress&&this.onProgress(t,this.itemsLoaded,this.itemsTotal),this.itemsLoaded===this.itemsTotal&&(this.isLoading=!1,this.onLoad&&this.onLoad())}itemError(t){this.onError&&this.onError(t)}resolveURL(t){return this.urlModifier?this.urlModifier(t):t}}},function(t,n,e){"use strict";var r=this&&this.__awaiter||function(t,n,e,r){return new(e||(e=Promise))(function(i,o){function a(t){try{s(r.next(t))}catch(t){o(t)}}function u(t){try{s(r.throw(t))}catch(t){o(t)}}function s(t){t.done?i(t.value):new e(function(n){n(t.value)}).then(a,u)}s((r=r.apply(t,n||[])).next())})};Object.defineProperty(n,"__esModule",{value:!0});const i=e(3),o=e(0);n.GltfAsset=class{constructor(t,n,e,r=new o.LoadingManager){this.gltf=t,this.glbData=e,this.bufferData=new a(this,n,r),this.imageData=new u(this,n,r)}bufferViewData(t){return r(this,void 0,void 0,function*(){if(!this.gltf.bufferViews)throw new Error("No buffer views found.");const n=this.gltf.bufferViews[t],e=yield this.bufferData.get(n.buffer),r=n.byteLength||0,i=n.byteOffset||0,o=e.buffer,a=e.byteOffset;return new Uint8Array(o,a+i,r)})}preFetchAll(){return r(this,void 0,void 0,function*(){return Promise.all([this.bufferData.preFetchAll(),this.imageData.preFetchAll()])})}};class a{constructor(t,n,e){this.bufferCache=[],this.asset=t,this.baseUri=n,this.manager=e,this.loader=new i.FileLoader(e),this.loader.responseType="arraybuffer"}get(t){return r(this,void 0,void 0,function*(){if(void 0!==this.bufferCache[t])return this.bufferCache[t];const n=this.asset.gltf;if(!n.buffers)throw new Error("No buffers found.");const e=n.buffers[t];if(void 0===e.uri){if(0!==t)throw new Error("GLB container is required to be the first buffer");if(void 0===this.asset.glbData)throw new Error("invalid gltf: buffer has no uri nor is there a GLB buffer");return this.asset.glbData.binaryChunk}const r=s(e.uri,this.baseUri),i=yield this.loader.load(r),o=new Uint8Array(i);return this.bufferCache[t]=o,o})}preFetchAll(){return r(this,void 0,void 0,function*(){const t=this.asset.gltf.buffers;return t?Promise.all(t.map((t,n)=>this.get(n))):[]})}}n.BufferData=a;class u{constructor(t,n,e){this.crossOrigin="anonymous",this.imageCache=[],this.asset=t,this.baseUri=n,this.manager=e}get(t){return r(this,void 0,void 0,function*(){if(void 0!==this.imageCache[t])return this.imageCache[t];const n=this.asset.gltf;if(!n.images)throw new Error("No images found.");const e=n.images[t];let r,i=!1;if(void 0!==e.bufferView){const t=yield this.asset.bufferViewData(e.bufferView);i=!0;const n=new Blob([t],{type:e.mimeType});r=URL.createObjectURL(n)}else{if(void 0===e.uri)throw new Error("Invalid glTF: image must either have a `uri` or a `bufferView`");r=this.manager.resolveURL(s(e.uri,this.baseUri))}const o=new Image;return o.crossOrigin=this.crossOrigin,new Promise((n,e)=>{o.onerror=(()=>{e(`Failed to load ${r}`),this.manager.itemEnd(r),this.manager.itemError(r)}),o.onload=(()=>{i&&URL.revokeObjectURL(r),this.imageCache[t]=o,n(o),this.manager.itemEnd(r)}),o.src=r,this.manager.itemStart(r)})})}preFetchAll(){return r(this,void 0,void 0,function*(){const t=this.asset.gltf.images;return t?Promise.all(t.map((t,n)=>this.get(n))):[]})}}function s(t,n){return"string"!=typeof t||""===t?"":/^(https?:)?\/\//i.test(t)?t:/^data:.*,.*$/i.test(t)?t:/^blob:.*$/i.test(t)?t:n+t}n.ImageData=u,n.resolveURL=s},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.LoaderUtils=class{static decodeText(t){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(t);let n="";for(const e of t)n+=String.fromCharCode(e);return decodeURIComponent(escape(n))}static extractUrlBase(t){const n=t.split("/");return 1===n.length?"./":(n.pop(),n.join("/")+"/")}}},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.FileLoader=class{constructor(t){this.manager=t}load(t,n){return void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t),new Promise((e,r)=>{const i=new XMLHttpRequest;i.open("GET",t,!0);const o=this;i.onload=function(n){const a=this.response;0===this.status?(console.warn("FileLoader: HTTP Status 0 received."),e(a),o.manager.itemEnd(t)):200===this.status?(e(a),o.manager.itemEnd(t)):(r({status:this.status,statusText:i.statusText}),o.manager.itemEnd(t),o.manager.itemError(t))},i.onprogress=(t=>{n&&n(t)}),i.onerror=function(n){r({status:this.status,statusText:i.statusText}),o.manager.itemEnd(t),o.manager.itemError(t)},this.responseType&&(i.responseType=this.responseType),this.withCredentials&&(i.withCredentials=this.withCredentials),this.mimeType&&i.overrideMimeType&&i.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain");for(const t in this.requestHeaders)i.setRequestHeader(t,this.requestHeaders[t]);i.send(null),this.manager.itemStart(t)})}setRequestHeader(t,n){return this.requestHeaders[t]=n,this}}},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0})},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const r=e(2);n.BINARY_HEADER_MAGIC="glTF";const i=1313821514,o=5130562;n.GLTFBinaryData=class{constructor(t){const e=new DataView(t,0,12),a=r.LoaderUtils.decodeText(new Uint8Array(t,0,4)),u=e.getUint32(4,!0);if(e.getUint32(8,!0),a!==n.BINARY_HEADER_MAGIC)throw new Error("Unsupported glTF-Binary header.");if(u<2)throw new Error("Unsupported legacy binary file detected.");const s=new DataView(t,12);let c=0;for(;c<s.byteLength;){const n=s.getUint32(c,!0);c+=4;const e=s.getUint32(c,!0);if(c+=4,e===i){const e=new Uint8Array(t,12+c,n);this.json=r.LoaderUtils.decodeText(e)}else if(e===o){const e=12+c;this.binaryChunk=new Uint8Array(t,e,n)}c+=n}if(null===this.json)throw new Error("glTF-Binary: JSON content not found.")}}},function(t,n,e){"use strict";var r=this&&this.__awaiter||function(t,n,e,r){return new(e||(e=Promise))(function(i,o){function a(t){try{s(r.next(t))}catch(t){o(t)}}function u(t){try{s(r.throw(t))}catch(t){o(t)}}function s(t){t.done?i(t.value):new e(function(n){n(t.value)}).then(a,u)}s((r=r.apply(t,n||[])).next())})};function i(t){for(var e in t)n.hasOwnProperty(e)||(n[e]=t[e])}Object.defineProperty(n,"__esModule",{value:!0});const o=e(3),a=e(5),u=e(1),s=e(2),c=e(0),f=e(4);n.gltf=f,i(e(1)),i(e(0)),n.GltfLoader=class{constructor(t){this.manager=t||new c.LoadingManager}load(t,n){return r(this,void 0,void 0,function*(){const e=s.LoaderUtils.extractUrlBase(t),r=new o.FileLoader(this.manager);r.responseType="arraybuffer";const i=yield r.load(t,n);return yield this.parse(i,e)})}loadFromFiles(t){return r(this,void 0,void 0,function*(){let n,e;for(const[r,i]of t)i.name.match(/\.(gltf|glb)$/)&&(n=i,e=r.replace(i.name,""));if(!n)throw new Error("No .gltf or .glb asset found.");const r="string"==typeof n?n:URL.createObjectURL(n),i=s.LoaderUtils.extractUrlBase(r),o=[];this.manager.urlModifier=(n=>{const r=e+n.replace(i,"").replace(/^(\.?\/)/,"");if(t.has(r)){const n=t.get(r),e=URL.createObjectURL(n);return o.push(e),e}return n});const a=yield this.load(r);return yield a.preFetchAll(),URL.revokeObjectURL(r),o.forEach(URL.revokeObjectURL),a})}parse(t,n){return r(this,void 0,void 0,function*(){let e,r=void 0;e="string"==typeof t?t:s.LoaderUtils.decodeText(new Uint8Array(t,0,4))===a.BINARY_HEADER_MAGIC?(r=new a.GLTFBinaryData(t)).json:s.LoaderUtils.decodeText(new Uint8Array(t));const i=JSON.parse(e);if(void 0===i.asset||i.asset.version[0]<2)throw new Error("Unsupported asset. glTF versions >=2.0 are supported.");return new u.GltfAsset(i,n,r,this.manager)})}}},function(t,n,e){t.exports=e(6)}])},function(t,n,e){"use strict";var r=this&&this.__awaiter||function(t,n,e,r){return new(e||(e=Promise))(function(i,o){function a(t){try{s(r.next(t))}catch(t){o(t)}}function u(t){try{s(r.throw(t))}catch(t){o(t)}}function s(t){t.done?i(t.value):new e(function(n){n(t.value)}).then(a,u)}s((r=r.apply(t,n||[])).next())})},i=this&&this.__generator||function(t,n){var e,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,r&&(i=r[2&o[0]?"return":o[0]?"throw":"next"])&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[0,i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=n.call(t,a)}catch(t){o=[6,t],r=0}finally{e=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}};Object.defineProperty(n,"__esModule",{value:!0});var o=e(15),a=e(0),u=e(14),s=e(9),c="https://raw.githubusercontent.com/bwasty/glTF-Sample-Models/generate_index/2.0/";function f(t,n,e){return r(this,void 0,void 0,function(){var o,a,u,s,f,d,m=this;return i(this,function(b){switch(b.label){case 0:return[4,fetch("https://raw.githubusercontent.com/bwasty/glTF-Sample-Models/generate_index/2.0/model-index.json")];case 1:return[4,b.sent().json()];case 2:for(o=b.sent(),a=document.getElementById("sample-select"),u=0,s=o;u<s.length;u++)f=s[u],(d=new Option).value=l(f),d.text=f.name,f.name===e&&(d.selected=!0),a.options.add(d);return a.onchange=function(){return r(this,void 0,void 0,function(){var e;return i(this,function(r){switch(r.label){case 0:return e=this.selectedOptions[0],[4,n.load(c+e.value)];case 1:return h(r.sent(),t),history.pushState(e.value,void 0,"?model="+e.text),[2]}})})},window.onpopstate=function(e){return r(m,void 0,void 0,function(){var r;return i(this,function(i){switch(i.label){case 0:return(r=e.state)?[4,n.load(c+r)]:(console.warn("yes, remove todo above..."),location.reload(),[2]);case 1:return h(i.sent(),t),[2]}})})},[2]}})})}function l(t,n,e){return void 0===n&&(n="/"),void 0===e&&(e="glTF"),""+n+t.name+"/"+e+"/"+t.variants[e]}function h(t,n){return r(this,void 0,void 0,function(){var e,r;return i(this,function(i){switch(i.label){case 0:return e=t.gltf.scenes[t.gltf.scene||0],[4,s.Scene.fromGltf(e,t,n.context)];case 1:return r=i.sent(),n.scene=r,[2]}})})}function d(){return r(this,void 0,void 0,function(){var t,n,e,r,s,l,d,m;return i(this,function(i){switch(i.label){case 0:return t=new a.Canvas("example-canvas"),n=t.context,e=new u.GltfRenderer,t.renderer=e,r=new o.GltfLoader,(l=document.location.search.match(/model=(.+)/))?(d=l[1],s=""+c+d+"/glTF/"+d+".gltf",f(e,r,d)):(s=c+"DamagedHelmet/glTF/DamagedHelmet.gltf",f(e,r,"DamagedHelmet")),[4,r.load(s)];case 1:return[4,(m=i.sent()).preFetchAll()];case 2:return i.sent(),h(m,e),t.element.addEventListener("dblclick",function(){return a.viewer.Fullscreen.toggle(t.element)}),t.element.addEventListener("touchstart",function(){return a.viewer.Fullscreen.toggle(t.element)}),window.canvas=t,window.context=n,window.renderer=e,[2]}})})}"complete"===window.document.readyState?d():window.onload=d},function(t,n,e){"use strict"},function(t,n,e){e(17),t.exports=e(16)},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e(1),i=function(){function t(t,n){void 0===t&&(t=r.vec3.fromValues(1/0,1/0,1/0)),void 0===n&&(n=r.vec3.fromValues(-1/0,-1/0,-1/0)),this.min=t,this.max=n}return t.prototype.transform=function(t){var n=r.vec3.fromValues(1/0,1/0,1/0),e=r.vec3.fromValues(-1/0,-1/0,-1/0),i=r.vec3.create(),o=function(t){r.vec3.transformMat4(i,i,t),r.vec3.min(n,n,i),r.vec3.max(e,e,i)};r.vec3.set(i,this.min[0],this.min[1],this.min[2]),o(t),r.vec3.set(i,this.min[0],this.min[1],this.max[2]),o(t),r.vec3.set(i,this.min[0],this.max[1],this.min[2]),o(t),r.vec3.set(i,this.min[0],this.max[1],this.max[2]),o(t),r.vec3.set(i,this.max[0],this.min[1],this.min[2]),o(t),r.vec3.set(i,this.max[0],this.min[1],this.max[2]),o(t),r.vec3.set(i,this.max[0],this.max[1],this.min[2]),o(t),r.vec3.set(i,this.max[0],this.max[1],this.max[2]),o(t),this.min=n,this.max=e},Object.defineProperty(t.prototype,"size",{get:function(){return r.vec3.sub(r.vec3.create(),this.max,this.min)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"center",{get:function(){var t=r.vec3.create();return r.vec3.add(t,this.min,this.max),r.vec3.scale(t,t,.5)},enumerable:!0,configurable:!0}),t.prototype.union=function(t){return r.vec3.min(this.min,this.min,t.min),r.vec3.max(this.max,this.max,t.max),this},t.prototype.clone=function(){return new t(r.vec3.clone(this.min),r.vec3.clone(this.max))},t}();n.Aabb3=i}])});
//# sourceMappingURL=gltf.js.map