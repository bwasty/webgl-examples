!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("Rx")):"function"==typeof define&&define.amd?define(["Rx"],t):"object"==typeof exports?exports.gloperate=t(require("Rx")):e.gloperate=t(e.Rx)}(window,function(e){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=84)}([function(e,t,r){"use strict";var n,i=r(63);!function(e){try{e.disableAssertions=!1}catch(t){e.disableAssertions=!1}try{e.logVerbosityThreshold=1}catch(t){e.logVerbosityThreshold=2}function t(t,r){t>e.logVerbosityThreshold||console.log("["+t+"] "+r)}!function(e){e[e.User=0]="User",e[e.Dev=1]="Dev",e[e.ModuleDev=2]="ModuleDev"}(e.LogLevel||(e.LogLevel={})),e.assert=function(t,r){if(!e.disableAssertions&&!t)throw new EvalError(r)},e.log=t,e.logIf=function(e,r,n){e&&t(r,n)},e.rand=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=1),Math.random()*(t-e)+e};var r=["","Ki","Mi","Gi","Ti","Pi","Ei","Zi","Yi"];function n(){return window.location.search}e.prettyPrintBytes=function(e){var t=e>0?Math.floor(Math.log(e)/Math.log(1024)):0,n=e/Math.pow(1024,t);return""+(t>0?n.toFixed(3):n)+r[t]+"B"},e.bitInBitfield=function(e,t){return void 0!==t&&(e&t)===t},e.RAD2DEG=57.29577951308232,e.DEG2RAD=.017453292519943295,e.GETsearch=n,e.GETparameter=function(e){return i.parse(n())[e]}}(n||(n={})),e.exports=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=function(){function e(){var t=this;this._initialized=!1,this.assertInitialized=function(){return e.assertInitializedFalse(t)},this.assertUninitialized=function(){}}return e.initialize=function(){return function(t,r,i){var o=i.value;return i.value=function(){var t=this;return n.assert(!1===this._initialized,"re-initialization of initialized object not anticipated"),this._initialized=o.apply(this,arguments),this._initialized?(this.assertInitialized=function(){},this.assertUninitialized=function(){return e.assertUninitializedFalse(t)}):(this.assertUninitialized=function(){},this.assertInitialized=function(){return e.assertInitializedFalse(t)}),this._initialized},i}},e.uninitialize=function(){return function(t,r,i){var o=i.value;return i.value=function(){var t=this;n.assert(!0===this._initialized,"expected object to be initialized in order to uninitialize"),o.apply(this),this._initialized=!1,this.assertUninitialized=function(){},this.assertInitialized=function(){return e.assertInitializedFalse(t)}},i}},e.assert_initialized=function(){return function(e,t,r){var n=r.value;return r.value=function(){return this.assertInitialized(),n.apply(this,arguments)},r}},e.assert_uninitialized=function(){return function(e,t,r){var n=r.value;return r.value=function(){this.assertUninitialized(),n.apply(this,arguments)},r}},Object.defineProperty(e.prototype,"initialized",{get:function(){return this._initialized},enumerable:!0,configurable:!0}),e.assertInitializedFalse=function(e){return n.assert(!1,"instance of "+e.constructor.name+" expected to be initialized")},e.assertUninitializedFalse=function(e){return n.assert(!1,"instance of "+e.constructor.name+" not expected to be initialized")},e}();t.Initializable=i},function(e,t,r){"use strict";r.r(t);var n={};r.d(n,"EPSILON",function(){return h}),r.d(n,"ARRAY_TYPE",function(){return p}),r.d(n,"RANDOM",function(){return d}),r.d(n,"setMatrixArrayType",function(){return _}),r.d(n,"toRadian",function(){return m}),r.d(n,"equals",function(){return v});var i={};r.d(i,"create",function(){return g}),r.d(i,"clone",function(){return y}),r.d(i,"copy",function(){return x}),r.d(i,"identity",function(){return E}),r.d(i,"fromValues",function(){return T}),r.d(i,"set",function(){return O}),r.d(i,"transpose",function(){return M}),r.d(i,"invert",function(){return A}),r.d(i,"adjoint",function(){return P}),r.d(i,"determinant",function(){return j}),r.d(i,"multiply",function(){return w}),r.d(i,"rotate",function(){return R}),r.d(i,"scale",function(){return L}),r.d(i,"fromRotation",function(){return F}),r.d(i,"fromScaling",function(){return S}),r.d(i,"str",function(){return B}),r.d(i,"frob",function(){return I}),r.d(i,"LDU",function(){return z}),r.d(i,"add",function(){return N}),r.d(i,"subtract",function(){return C}),r.d(i,"exactEquals",function(){return G}),r.d(i,"equals",function(){return U}),r.d(i,"multiplyScalar",function(){return D}),r.d(i,"multiplyScalarAndAdd",function(){return k}),r.d(i,"mul",function(){return W}),r.d(i,"sub",function(){return q});var o={};r.d(o,"create",function(){return X}),r.d(o,"clone",function(){return H}),r.d(o,"copy",function(){return V}),r.d(o,"identity",function(){return Y}),r.d(o,"fromValues",function(){return Z}),r.d(o,"set",function(){return K}),r.d(o,"invert",function(){return $}),r.d(o,"determinant",function(){return J}),r.d(o,"multiply",function(){return Q}),r.d(o,"rotate",function(){return ee}),r.d(o,"scale",function(){return te}),r.d(o,"translate",function(){return re}),r.d(o,"fromRotation",function(){return ne}),r.d(o,"fromScaling",function(){return ie}),r.d(o,"fromTranslation",function(){return oe}),r.d(o,"str",function(){return ae}),r.d(o,"frob",function(){return se}),r.d(o,"add",function(){return ue}),r.d(o,"subtract",function(){return ce}),r.d(o,"multiplyScalar",function(){return le}),r.d(o,"multiplyScalarAndAdd",function(){return fe}),r.d(o,"exactEquals",function(){return he}),r.d(o,"equals",function(){return pe}),r.d(o,"mul",function(){return de}),r.d(o,"sub",function(){return _e});var a={};r.d(a,"create",function(){return be}),r.d(a,"fromMat4",function(){return me}),r.d(a,"clone",function(){return ve}),r.d(a,"copy",function(){return ge}),r.d(a,"fromValues",function(){return ye}),r.d(a,"set",function(){return xe}),r.d(a,"identity",function(){return Ee}),r.d(a,"transpose",function(){return Te}),r.d(a,"invert",function(){return Oe}),r.d(a,"adjoint",function(){return Me}),r.d(a,"determinant",function(){return Ae}),r.d(a,"multiply",function(){return Pe}),r.d(a,"translate",function(){return je}),r.d(a,"rotate",function(){return we}),r.d(a,"scale",function(){return Re}),r.d(a,"fromTranslation",function(){return Le}),r.d(a,"fromRotation",function(){return Fe}),r.d(a,"fromScaling",function(){return Se}),r.d(a,"fromMat2d",function(){return Be}),r.d(a,"fromQuat",function(){return Ie}),r.d(a,"normalFromMat4",function(){return ze}),r.d(a,"projection",function(){return Ne}),r.d(a,"str",function(){return Ce}),r.d(a,"frob",function(){return Ge}),r.d(a,"add",function(){return Ue}),r.d(a,"subtract",function(){return De}),r.d(a,"multiplyScalar",function(){return ke}),r.d(a,"multiplyScalarAndAdd",function(){return We}),r.d(a,"exactEquals",function(){return qe}),r.d(a,"equals",function(){return Xe}),r.d(a,"mul",function(){return He}),r.d(a,"sub",function(){return Ve});var s={};r.d(s,"create",function(){return Ye}),r.d(s,"clone",function(){return Ze}),r.d(s,"copy",function(){return Ke}),r.d(s,"fromValues",function(){return $e}),r.d(s,"set",function(){return Je}),r.d(s,"identity",function(){return Qe}),r.d(s,"transpose",function(){return et}),r.d(s,"invert",function(){return tt}),r.d(s,"adjoint",function(){return rt}),r.d(s,"determinant",function(){return nt}),r.d(s,"multiply",function(){return it}),r.d(s,"translate",function(){return ot}),r.d(s,"scale",function(){return at}),r.d(s,"rotate",function(){return st}),r.d(s,"rotateX",function(){return ut}),r.d(s,"rotateY",function(){return ct}),r.d(s,"rotateZ",function(){return lt}),r.d(s,"fromTranslation",function(){return ft}),r.d(s,"fromScaling",function(){return ht}),r.d(s,"fromRotation",function(){return pt}),r.d(s,"fromXRotation",function(){return dt}),r.d(s,"fromYRotation",function(){return _t}),r.d(s,"fromZRotation",function(){return bt}),r.d(s,"fromRotationTranslation",function(){return mt}),r.d(s,"getTranslation",function(){return vt}),r.d(s,"getScaling",function(){return gt}),r.d(s,"getRotation",function(){return yt}),r.d(s,"fromRotationTranslationScale",function(){return xt}),r.d(s,"fromRotationTranslationScaleOrigin",function(){return Et}),r.d(s,"fromQuat",function(){return Tt}),r.d(s,"frustum",function(){return Ot}),r.d(s,"perspective",function(){return Mt}),r.d(s,"perspectiveFromFieldOfView",function(){return At}),r.d(s,"ortho",function(){return Pt}),r.d(s,"lookAt",function(){return jt}),r.d(s,"targetTo",function(){return wt}),r.d(s,"str",function(){return Rt}),r.d(s,"frob",function(){return Lt}),r.d(s,"add",function(){return Ft}),r.d(s,"subtract",function(){return St}),r.d(s,"multiplyScalar",function(){return Bt}),r.d(s,"multiplyScalarAndAdd",function(){return It}),r.d(s,"exactEquals",function(){return zt}),r.d(s,"equals",function(){return Nt}),r.d(s,"mul",function(){return Ct}),r.d(s,"sub",function(){return Gt});var u={};r.d(u,"create",function(){return Ut}),r.d(u,"clone",function(){return Dt}),r.d(u,"length",function(){return kt}),r.d(u,"fromValues",function(){return Wt}),r.d(u,"copy",function(){return qt}),r.d(u,"set",function(){return Xt}),r.d(u,"add",function(){return Ht}),r.d(u,"subtract",function(){return Vt}),r.d(u,"multiply",function(){return Yt}),r.d(u,"divide",function(){return Zt}),r.d(u,"ceil",function(){return Kt}),r.d(u,"floor",function(){return $t}),r.d(u,"min",function(){return Jt}),r.d(u,"max",function(){return Qt}),r.d(u,"round",function(){return er}),r.d(u,"scale",function(){return tr}),r.d(u,"scaleAndAdd",function(){return rr}),r.d(u,"distance",function(){return nr}),r.d(u,"squaredDistance",function(){return ir}),r.d(u,"squaredLength",function(){return or}),r.d(u,"negate",function(){return ar}),r.d(u,"inverse",function(){return sr}),r.d(u,"normalize",function(){return ur}),r.d(u,"dot",function(){return cr}),r.d(u,"cross",function(){return lr}),r.d(u,"lerp",function(){return fr}),r.d(u,"hermite",function(){return hr}),r.d(u,"bezier",function(){return pr}),r.d(u,"random",function(){return dr}),r.d(u,"transformMat4",function(){return _r}),r.d(u,"transformMat3",function(){return br}),r.d(u,"transformQuat",function(){return mr}),r.d(u,"rotateX",function(){return vr}),r.d(u,"rotateY",function(){return gr}),r.d(u,"rotateZ",function(){return yr}),r.d(u,"angle",function(){return xr}),r.d(u,"str",function(){return Er}),r.d(u,"exactEquals",function(){return Tr}),r.d(u,"equals",function(){return Or}),r.d(u,"sub",function(){return Mr}),r.d(u,"mul",function(){return Ar}),r.d(u,"div",function(){return Pr}),r.d(u,"dist",function(){return jr}),r.d(u,"sqrDist",function(){return wr}),r.d(u,"len",function(){return Rr}),r.d(u,"sqrLen",function(){return Lr}),r.d(u,"forEach",function(){return Fr});var c={};r.d(c,"create",function(){return Sr}),r.d(c,"clone",function(){return Br}),r.d(c,"fromValues",function(){return Ir}),r.d(c,"copy",function(){return zr}),r.d(c,"set",function(){return Nr}),r.d(c,"add",function(){return Cr}),r.d(c,"subtract",function(){return Gr}),r.d(c,"multiply",function(){return Ur}),r.d(c,"divide",function(){return Dr}),r.d(c,"ceil",function(){return kr}),r.d(c,"floor",function(){return Wr}),r.d(c,"min",function(){return qr}),r.d(c,"max",function(){return Xr}),r.d(c,"round",function(){return Hr}),r.d(c,"scale",function(){return Vr}),r.d(c,"scaleAndAdd",function(){return Yr}),r.d(c,"distance",function(){return Zr}),r.d(c,"squaredDistance",function(){return Kr}),r.d(c,"length",function(){return $r}),r.d(c,"squaredLength",function(){return Jr}),r.d(c,"negate",function(){return Qr}),r.d(c,"inverse",function(){return en}),r.d(c,"normalize",function(){return tn}),r.d(c,"dot",function(){return rn}),r.d(c,"lerp",function(){return nn}),r.d(c,"random",function(){return on}),r.d(c,"transformMat4",function(){return an}),r.d(c,"transformQuat",function(){return sn}),r.d(c,"str",function(){return un}),r.d(c,"exactEquals",function(){return cn}),r.d(c,"equals",function(){return ln}),r.d(c,"sub",function(){return fn}),r.d(c,"mul",function(){return hn}),r.d(c,"div",function(){return pn}),r.d(c,"dist",function(){return dn}),r.d(c,"sqrDist",function(){return _n}),r.d(c,"len",function(){return bn}),r.d(c,"sqrLen",function(){return mn}),r.d(c,"forEach",function(){return vn});var l={};r.d(l,"create",function(){return gn}),r.d(l,"identity",function(){return yn}),r.d(l,"setAxisAngle",function(){return xn}),r.d(l,"getAxisAngle",function(){return En}),r.d(l,"multiply",function(){return Tn}),r.d(l,"rotateX",function(){return On}),r.d(l,"rotateY",function(){return Mn}),r.d(l,"rotateZ",function(){return An}),r.d(l,"calculateW",function(){return Pn}),r.d(l,"slerp",function(){return jn}),r.d(l,"invert",function(){return wn}),r.d(l,"conjugate",function(){return Rn}),r.d(l,"fromMat3",function(){return Ln}),r.d(l,"fromEuler",function(){return Fn}),r.d(l,"str",function(){return Sn}),r.d(l,"clone",function(){return Bn}),r.d(l,"fromValues",function(){return In}),r.d(l,"copy",function(){return zn}),r.d(l,"set",function(){return Nn}),r.d(l,"add",function(){return Cn}),r.d(l,"mul",function(){return Gn}),r.d(l,"scale",function(){return Un}),r.d(l,"dot",function(){return Dn}),r.d(l,"lerp",function(){return kn}),r.d(l,"length",function(){return Wn}),r.d(l,"len",function(){return qn}),r.d(l,"squaredLength",function(){return Xn}),r.d(l,"sqrLen",function(){return Hn}),r.d(l,"normalize",function(){return Vn}),r.d(l,"exactEquals",function(){return Yn}),r.d(l,"equals",function(){return Zn}),r.d(l,"rotationTo",function(){return Kn}),r.d(l,"sqlerp",function(){return $n}),r.d(l,"setAxes",function(){return Jn});var f={};r.d(f,"create",function(){return Qn}),r.d(f,"clone",function(){return ei}),r.d(f,"fromValues",function(){return ti}),r.d(f,"copy",function(){return ri}),r.d(f,"set",function(){return ni}),r.d(f,"add",function(){return ii}),r.d(f,"subtract",function(){return oi}),r.d(f,"multiply",function(){return ai}),r.d(f,"divide",function(){return si}),r.d(f,"ceil",function(){return ui}),r.d(f,"floor",function(){return ci}),r.d(f,"min",function(){return li}),r.d(f,"max",function(){return fi}),r.d(f,"round",function(){return hi}),r.d(f,"scale",function(){return pi}),r.d(f,"scaleAndAdd",function(){return di}),r.d(f,"distance",function(){return _i}),r.d(f,"squaredDistance",function(){return bi}),r.d(f,"length",function(){return mi}),r.d(f,"squaredLength",function(){return vi}),r.d(f,"negate",function(){return gi}),r.d(f,"inverse",function(){return yi}),r.d(f,"normalize",function(){return xi}),r.d(f,"dot",function(){return Ei}),r.d(f,"cross",function(){return Ti}),r.d(f,"lerp",function(){return Oi}),r.d(f,"random",function(){return Mi}),r.d(f,"transformMat2",function(){return Ai}),r.d(f,"transformMat2d",function(){return Pi}),r.d(f,"transformMat3",function(){return ji}),r.d(f,"transformMat4",function(){return wi}),r.d(f,"str",function(){return Ri}),r.d(f,"exactEquals",function(){return Li}),r.d(f,"equals",function(){return Fi}),r.d(f,"len",function(){return Si}),r.d(f,"sub",function(){return Bi}),r.d(f,"mul",function(){return Ii}),r.d(f,"div",function(){return zi}),r.d(f,"dist",function(){return Ni}),r.d(f,"sqrDist",function(){return Ci}),r.d(f,"sqrLen",function(){return Gi}),r.d(f,"forEach",function(){return Ui});const h=1e-6;let p="undefined"!=typeof Float32Array?Float32Array:Array;const d=Math.random;function _(e){p=e}const b=Math.PI/180;function m(e){return e*b}function v(e,t){return Math.abs(e-t)<=h*Math.max(1,Math.abs(e),Math.abs(t))}function g(){let e=new p(4);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e}function y(e){let t=new p(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function x(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function E(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e}function T(e,t,r,n){let i=new p(4);return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i}function O(e,t,r,n,i){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e}function M(e,t){if(e===t){let r=t[1];e[1]=t[2],e[2]=r}else e[0]=t[0],e[1]=t[2],e[2]=t[1],e[3]=t[3];return e}function A(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],a=r*o-i*n;return a?(a=1/a,e[0]=o*a,e[1]=-n*a,e[2]=-i*a,e[3]=r*a,e):null}function P(e,t){let r=t[0];return e[0]=t[3],e[1]=-t[1],e[2]=-t[2],e[3]=r,e}function j(e){return e[0]*e[3]-e[2]*e[1]}function w(e,t,r){let n=t[0],i=t[1],o=t[2],a=t[3],s=r[0],u=r[1],c=r[2],l=r[3];return e[0]=n*s+o*u,e[1]=i*s+a*u,e[2]=n*c+o*l,e[3]=i*c+a*l,e}function R(e,t,r){let n=t[0],i=t[1],o=t[2],a=t[3],s=Math.sin(r),u=Math.cos(r);return e[0]=n*u+o*s,e[1]=i*u+a*s,e[2]=n*-s+o*u,e[3]=i*-s+a*u,e}function L(e,t,r){let n=t[0],i=t[1],o=t[2],a=t[3],s=r[0],u=r[1];return e[0]=n*s,e[1]=i*s,e[2]=o*u,e[3]=a*u,e}function F(e,t){let r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=-r,e[3]=n,e}function S(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e}function B(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function I(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2))}function z(e,t,r,n){return e[2]=n[2]/n[0],r[0]=n[0],r[1]=n[1],r[3]=n[3]-e[2]*r[1],[e,t,r]}function N(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e}function C(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}function G(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function U(e,t){let r=e[0],n=e[1],i=e[2],o=e[3],a=t[0],s=t[1],u=t[2],c=t[3];return Math.abs(r-a)<=h*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-s)<=h*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-u)<=h*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-c)<=h*Math.max(1,Math.abs(o),Math.abs(c))}function D(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function k(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e}const W=w,q=C;function X(){let e=new p(6);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e}function H(e){let t=new p(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function V(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function Y(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e}function Z(e,t,r,n,i,o){let a=new p(6);return a[0]=e,a[1]=t,a[2]=r,a[3]=n,a[4]=i,a[5]=o,a}function K(e,t,r,n,i,o,a){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=o,e[5]=a,e}function $(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=r*o-n*i;return u?(u=1/u,e[0]=o*u,e[1]=-n*u,e[2]=-i*u,e[3]=r*u,e[4]=(i*s-o*a)*u,e[5]=(n*a-r*s)*u,e):null}function J(e){return e[0]*e[3]-e[1]*e[2]}function Q(e,t,r){let n=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=r[0],l=r[1],f=r[2],h=r[3],p=r[4],d=r[5];return e[0]=n*c+o*l,e[1]=i*c+a*l,e[2]=n*f+o*h,e[3]=i*f+a*h,e[4]=n*p+o*d+s,e[5]=i*p+a*d+u,e}function ee(e,t,r){let n=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=Math.sin(r),l=Math.cos(r);return e[0]=n*l+o*c,e[1]=i*l+a*c,e[2]=n*-c+o*l,e[3]=i*-c+a*l,e[4]=s,e[5]=u,e}function te(e,t,r){let n=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=r[0],l=r[1];return e[0]=n*c,e[1]=i*c,e[2]=o*l,e[3]=a*l,e[4]=s,e[5]=u,e}function re(e,t,r){let n=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=r[0],l=r[1];return e[0]=n,e[1]=i,e[2]=o,e[3]=a,e[4]=n*c+o*l+s,e[5]=i*c+a*l+u,e}function ne(e,t){let r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=-r,e[3]=n,e[4]=0,e[5]=0,e}function ie(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e[4]=0,e[5]=0,e}function oe(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0],e[5]=t[1],e}function ae(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"}function se(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+1)}function ue(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e}function ce(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e}function le(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e}function fe(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e}function he(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]}function pe(e,t){let r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=t[0],c=t[1],l=t[2],f=t[3],p=t[4],d=t[5];return Math.abs(r-u)<=h*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(n-c)<=h*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(i-l)<=h*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(o-f)<=h*Math.max(1,Math.abs(o),Math.abs(f))&&Math.abs(a-p)<=h*Math.max(1,Math.abs(a),Math.abs(p))&&Math.abs(s-d)<=h*Math.max(1,Math.abs(s),Math.abs(d))}const de=Q,_e=ce;function be(){let e=new p(9);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function me(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}function ve(e){let t=new p(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function ge(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function ye(e,t,r,n,i,o,a,s,u){let c=new p(9);return c[0]=e,c[1]=t,c[2]=r,c[3]=n,c[4]=i,c[5]=o,c[6]=a,c[7]=s,c[8]=u,c}function xe(e,t,r,n,i,o,a,s,u,c){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=o,e[5]=a,e[6]=s,e[7]=u,e[8]=c,e}function Ee(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Te(e,t){if(e===t){let r=t[1],n=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=r,e[5]=t[7],e[6]=n,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function Oe(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=t[8],f=l*a-s*c,h=-l*o+s*u,p=c*o-a*u,d=r*f+n*h+i*p;return d?(d=1/d,e[0]=f*d,e[1]=(-l*n+i*c)*d,e[2]=(s*n-i*a)*d,e[3]=h*d,e[4]=(l*r-i*u)*d,e[5]=(-s*r+i*o)*d,e[6]=p*d,e[7]=(-c*r+n*u)*d,e[8]=(a*r-n*o)*d,e):null}function Me(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=t[8];return e[0]=a*l-s*c,e[1]=i*c-n*l,e[2]=n*s-i*a,e[3]=s*u-o*l,e[4]=r*l-i*u,e[5]=i*o-r*s,e[6]=o*c-a*u,e[7]=n*u-r*c,e[8]=r*a-n*o,e}function Ae(e){let t=e[0],r=e[1],n=e[2],i=e[3],o=e[4],a=e[5],s=e[6],u=e[7],c=e[8];return t*(c*o-a*u)+r*(-c*i+a*s)+n*(u*i-o*s)}function Pe(e,t,r){let n=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],l=t[7],f=t[8],h=r[0],p=r[1],d=r[2],_=r[3],b=r[4],m=r[5],v=r[6],g=r[7],y=r[8];return e[0]=h*n+p*a+d*c,e[1]=h*i+p*s+d*l,e[2]=h*o+p*u+d*f,e[3]=_*n+b*a+m*c,e[4]=_*i+b*s+m*l,e[5]=_*o+b*u+m*f,e[6]=v*n+g*a+y*c,e[7]=v*i+g*s+y*l,e[8]=v*o+g*u+y*f,e}function je(e,t,r){let n=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],l=t[7],f=t[8],h=r[0],p=r[1];return e[0]=n,e[1]=i,e[2]=o,e[3]=a,e[4]=s,e[5]=u,e[6]=h*n+p*a+c,e[7]=h*i+p*s+l,e[8]=h*o+p*u+f,e}function we(e,t,r){let n=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],l=t[7],f=t[8],h=Math.sin(r),p=Math.cos(r);return e[0]=p*n+h*a,e[1]=p*i+h*s,e[2]=p*o+h*u,e[3]=p*a-h*n,e[4]=p*s-h*i,e[5]=p*u-h*o,e[6]=c,e[7]=l,e[8]=f,e}function Re(e,t,r){let n=r[0],i=r[1];return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function Le(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e}function Fe(e,t){let r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=-r,e[4]=n,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Se(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Be(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e}function Ie(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],a=r+r,s=n+n,u=i+i,c=r*a,l=n*a,f=n*s,h=i*a,p=i*s,d=i*u,_=o*a,b=o*s,m=o*u;return e[0]=1-f-d,e[3]=l-m,e[6]=h+b,e[1]=l+m,e[4]=1-c-d,e[7]=p-_,e[2]=h-b,e[5]=p+_,e[8]=1-c-f,e}function ze(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=t[8],f=t[9],h=t[10],p=t[11],d=t[12],_=t[13],b=t[14],m=t[15],v=r*s-n*a,g=r*u-i*a,y=r*c-o*a,x=n*u-i*s,E=n*c-o*s,T=i*c-o*u,O=l*_-f*d,M=l*b-h*d,A=l*m-p*d,P=f*b-h*_,j=f*m-p*_,w=h*m-p*b,R=v*w-g*j+y*P+x*A-E*M+T*O;return R?(R=1/R,e[0]=(s*w-u*j+c*P)*R,e[1]=(u*A-a*w-c*M)*R,e[2]=(a*j-s*A+c*O)*R,e[3]=(i*j-n*w-o*P)*R,e[4]=(r*w-i*A+o*M)*R,e[5]=(n*A-r*j-o*O)*R,e[6]=(_*T-b*E+m*x)*R,e[7]=(b*y-d*T-m*g)*R,e[8]=(d*E-_*y+m*v)*R,e):null}function Ne(e,t,r){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/r,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e}function Ce(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"}function Ge(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2))}function Ue(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e}function De(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e}function ke(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e}function We(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e[6]=t[6]+r[6]*n,e[7]=t[7]+r[7]*n,e[8]=t[8]+r[8]*n,e}function qe(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]}function Xe(e,t){let r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],f=t[0],p=t[1],d=t[2],_=t[3],b=t[4],m=t[5],v=t[6],g=t[7],y=t[8];return Math.abs(r-f)<=h*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(n-p)<=h*Math.max(1,Math.abs(n),Math.abs(p))&&Math.abs(i-d)<=h*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(o-_)<=h*Math.max(1,Math.abs(o),Math.abs(_))&&Math.abs(a-b)<=h*Math.max(1,Math.abs(a),Math.abs(b))&&Math.abs(s-m)<=h*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(u-v)<=h*Math.max(1,Math.abs(u),Math.abs(v))&&Math.abs(c-g)<=h*Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(l-y)<=h*Math.max(1,Math.abs(l),Math.abs(y))}const He=Pe,Ve=De;function Ye(){let e=new p(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ze(e){let t=new p(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Ke(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function $e(e,t,r,n,i,o,a,s,u,c,l,f,h,d,_,b){let m=new p(16);return m[0]=e,m[1]=t,m[2]=r,m[3]=n,m[4]=i,m[5]=o,m[6]=a,m[7]=s,m[8]=u,m[9]=c,m[10]=l,m[11]=f,m[12]=h,m[13]=d,m[14]=_,m[15]=b,m}function Je(e,t,r,n,i,o,a,s,u,c,l,f,h,p,d,_,b){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=o,e[5]=a,e[6]=s,e[7]=u,e[8]=c,e[9]=l,e[10]=f,e[11]=h,e[12]=p,e[13]=d,e[14]=_,e[15]=b,e}function Qe(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function et(e,t){if(e===t){let r=t[1],n=t[2],i=t[3],o=t[6],a=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=n,e[9]=o,e[11]=t[14],e[12]=i,e[13]=a,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function tt(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=t[8],f=t[9],h=t[10],p=t[11],d=t[12],_=t[13],b=t[14],m=t[15],v=r*s-n*a,g=r*u-i*a,y=r*c-o*a,x=n*u-i*s,E=n*c-o*s,T=i*c-o*u,O=l*_-f*d,M=l*b-h*d,A=l*m-p*d,P=f*b-h*_,j=f*m-p*_,w=h*m-p*b,R=v*w-g*j+y*P+x*A-E*M+T*O;return R?(R=1/R,e[0]=(s*w-u*j+c*P)*R,e[1]=(i*j-n*w-o*P)*R,e[2]=(_*T-b*E+m*x)*R,e[3]=(h*E-f*T-p*x)*R,e[4]=(u*A-a*w-c*M)*R,e[5]=(r*w-i*A+o*M)*R,e[6]=(b*y-d*T-m*g)*R,e[7]=(l*T-h*y+p*g)*R,e[8]=(a*j-s*A+c*O)*R,e[9]=(n*A-r*j-o*O)*R,e[10]=(d*E-_*y+m*v)*R,e[11]=(f*y-l*E-p*v)*R,e[12]=(s*M-a*P-u*O)*R,e[13]=(r*P-n*M+i*O)*R,e[14]=(_*g-d*x-b*v)*R,e[15]=(l*x-f*g+h*v)*R,e):null}function rt(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=t[8],f=t[9],h=t[10],p=t[11],d=t[12],_=t[13],b=t[14],m=t[15];return e[0]=s*(h*m-p*b)-f*(u*m-c*b)+_*(u*p-c*h),e[1]=-(n*(h*m-p*b)-f*(i*m-o*b)+_*(i*p-o*h)),e[2]=n*(u*m-c*b)-s*(i*m-o*b)+_*(i*c-o*u),e[3]=-(n*(u*p-c*h)-s*(i*p-o*h)+f*(i*c-o*u)),e[4]=-(a*(h*m-p*b)-l*(u*m-c*b)+d*(u*p-c*h)),e[5]=r*(h*m-p*b)-l*(i*m-o*b)+d*(i*p-o*h),e[6]=-(r*(u*m-c*b)-a*(i*m-o*b)+d*(i*c-o*u)),e[7]=r*(u*p-c*h)-a*(i*p-o*h)+l*(i*c-o*u),e[8]=a*(f*m-p*_)-l*(s*m-c*_)+d*(s*p-c*f),e[9]=-(r*(f*m-p*_)-l*(n*m-o*_)+d*(n*p-o*f)),e[10]=r*(s*m-c*_)-a*(n*m-o*_)+d*(n*c-o*s),e[11]=-(r*(s*p-c*f)-a*(n*p-o*f)+l*(n*c-o*s)),e[12]=-(a*(f*b-h*_)-l*(s*b-u*_)+d*(s*h-u*f)),e[13]=r*(f*b-h*_)-l*(n*b-i*_)+d*(n*h-i*f),e[14]=-(r*(s*b-u*_)-a*(n*b-i*_)+d*(n*u-i*s)),e[15]=r*(s*h-u*f)-a*(n*h-i*f)+l*(n*u-i*s),e}function nt(e){let t=e[0],r=e[1],n=e[2],i=e[3],o=e[4],a=e[5],s=e[6],u=e[7],c=e[8],l=e[9],f=e[10],h=e[11],p=e[12],d=e[13],_=e[14],b=e[15];return(t*a-r*o)*(f*b-h*_)-(t*s-n*o)*(l*b-h*d)+(t*u-i*o)*(l*_-f*d)+(r*s-n*a)*(c*b-h*p)-(r*u-i*a)*(c*_-f*p)+(n*u-i*s)*(c*d-l*p)}function it(e,t,r){let n=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],l=t[7],f=t[8],h=t[9],p=t[10],d=t[11],_=t[12],b=t[13],m=t[14],v=t[15],g=r[0],y=r[1],x=r[2],E=r[3];return e[0]=g*n+y*s+x*f+E*_,e[1]=g*i+y*u+x*h+E*b,e[2]=g*o+y*c+x*p+E*m,e[3]=g*a+y*l+x*d+E*v,g=r[4],y=r[5],x=r[6],E=r[7],e[4]=g*n+y*s+x*f+E*_,e[5]=g*i+y*u+x*h+E*b,e[6]=g*o+y*c+x*p+E*m,e[7]=g*a+y*l+x*d+E*v,g=r[8],y=r[9],x=r[10],E=r[11],e[8]=g*n+y*s+x*f+E*_,e[9]=g*i+y*u+x*h+E*b,e[10]=g*o+y*c+x*p+E*m,e[11]=g*a+y*l+x*d+E*v,g=r[12],y=r[13],x=r[14],E=r[15],e[12]=g*n+y*s+x*f+E*_,e[13]=g*i+y*u+x*h+E*b,e[14]=g*o+y*c+x*p+E*m,e[15]=g*a+y*l+x*d+E*v,e}function ot(e,t,r){let n,i,o,a,s,u,c,l,f,h,p,d,_=r[0],b=r[1],m=r[2];return t===e?(e[12]=t[0]*_+t[4]*b+t[8]*m+t[12],e[13]=t[1]*_+t[5]*b+t[9]*m+t[13],e[14]=t[2]*_+t[6]*b+t[10]*m+t[14],e[15]=t[3]*_+t[7]*b+t[11]*m+t[15]):(n=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],l=t[7],f=t[8],h=t[9],p=t[10],d=t[11],e[0]=n,e[1]=i,e[2]=o,e[3]=a,e[4]=s,e[5]=u,e[6]=c,e[7]=l,e[8]=f,e[9]=h,e[10]=p,e[11]=d,e[12]=n*_+s*b+f*m+t[12],e[13]=i*_+u*b+h*m+t[13],e[14]=o*_+c*b+p*m+t[14],e[15]=a*_+l*b+d*m+t[15]),e}function at(e,t,r){let n=r[0],i=r[1],o=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function st(e,t,r,n){let i,o,a,s,u,c,l,f,p,d,_,b,m,v,g,y,x,E,T,O,M,A,P,j,w=n[0],R=n[1],L=n[2],F=Math.sqrt(w*w+R*R+L*L);return Math.abs(F)<h?null:(w*=F=1/F,R*=F,L*=F,i=Math.sin(r),a=1-(o=Math.cos(r)),s=t[0],u=t[1],c=t[2],l=t[3],f=t[4],p=t[5],d=t[6],_=t[7],b=t[8],m=t[9],v=t[10],g=t[11],y=w*w*a+o,x=R*w*a+L*i,E=L*w*a-R*i,T=w*R*a-L*i,O=R*R*a+o,M=L*R*a+w*i,A=w*L*a+R*i,P=R*L*a-w*i,j=L*L*a+o,e[0]=s*y+f*x+b*E,e[1]=u*y+p*x+m*E,e[2]=c*y+d*x+v*E,e[3]=l*y+_*x+g*E,e[4]=s*T+f*O+b*M,e[5]=u*T+p*O+m*M,e[6]=c*T+d*O+v*M,e[7]=l*T+_*O+g*M,e[8]=s*A+f*P+b*j,e[9]=u*A+p*P+m*j,e[10]=c*A+d*P+v*j,e[11]=l*A+_*P+g*j,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function ut(e,t,r){let n=Math.sin(r),i=Math.cos(r),o=t[4],a=t[5],s=t[6],u=t[7],c=t[8],l=t[9],f=t[10],h=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*i+c*n,e[5]=a*i+l*n,e[6]=s*i+f*n,e[7]=u*i+h*n,e[8]=c*i-o*n,e[9]=l*i-a*n,e[10]=f*i-s*n,e[11]=h*i-u*n,e}function ct(e,t,r){let n=Math.sin(r),i=Math.cos(r),o=t[0],a=t[1],s=t[2],u=t[3],c=t[8],l=t[9],f=t[10],h=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i-c*n,e[1]=a*i-l*n,e[2]=s*i-f*n,e[3]=u*i-h*n,e[8]=o*n+c*i,e[9]=a*n+l*i,e[10]=s*n+f*i,e[11]=u*n+h*i,e}function lt(e,t,r){let n=Math.sin(r),i=Math.cos(r),o=t[0],a=t[1],s=t[2],u=t[3],c=t[4],l=t[5],f=t[6],h=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i+c*n,e[1]=a*i+l*n,e[2]=s*i+f*n,e[3]=u*i+h*n,e[4]=c*i-o*n,e[5]=l*i-a*n,e[6]=f*i-s*n,e[7]=h*i-u*n,e}function ft(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function ht(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function pt(e,t,r){let n,i,o,a=r[0],s=r[1],u=r[2],c=Math.sqrt(a*a+s*s+u*u);return Math.abs(c)<h?null:(a*=c=1/c,s*=c,u*=c,n=Math.sin(t),o=1-(i=Math.cos(t)),e[0]=a*a*o+i,e[1]=s*a*o+u*n,e[2]=u*a*o-s*n,e[3]=0,e[4]=a*s*o-u*n,e[5]=s*s*o+i,e[6]=u*s*o+a*n,e[7]=0,e[8]=a*u*o+s*n,e[9]=s*u*o-a*n,e[10]=u*u*o+i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function dt(e,t){let r=Math.sin(t),n=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function _t(e,t){let r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function bt(e,t){let r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function mt(e,t,r){let n=t[0],i=t[1],o=t[2],a=t[3],s=n+n,u=i+i,c=o+o,l=n*s,f=n*u,h=n*c,p=i*u,d=i*c,_=o*c,b=a*s,m=a*u,v=a*c;return e[0]=1-(p+_),e[1]=f+v,e[2]=h-m,e[3]=0,e[4]=f-v,e[5]=1-(l+_),e[6]=d+b,e[7]=0,e[8]=h+m,e[9]=d-b,e[10]=1-(l+p),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function vt(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function gt(e,t){let r=t[0],n=t[1],i=t[2],o=t[4],a=t[5],s=t[6],u=t[8],c=t[9],l=t[10];return e[0]=Math.sqrt(r*r+n*n+i*i),e[1]=Math.sqrt(o*o+a*a+s*s),e[2]=Math.sqrt(u*u+c*c+l*l),e}function yt(e,t){let r=t[0]+t[5]+t[10],n=0;return r>0?(n=2*Math.sqrt(r+1),e[3]=.25*n,e[0]=(t[6]-t[9])/n,e[1]=(t[8]-t[2])/n,e[2]=(t[1]-t[4])/n):t[0]>t[5]&t[0]>t[10]?(n=2*Math.sqrt(1+t[0]-t[5]-t[10]),e[3]=(t[6]-t[9])/n,e[0]=.25*n,e[1]=(t[1]+t[4])/n,e[2]=(t[8]+t[2])/n):t[5]>t[10]?(n=2*Math.sqrt(1+t[5]-t[0]-t[10]),e[3]=(t[8]-t[2])/n,e[0]=(t[1]+t[4])/n,e[1]=.25*n,e[2]=(t[6]+t[9])/n):(n=2*Math.sqrt(1+t[10]-t[0]-t[5]),e[3]=(t[1]-t[4])/n,e[0]=(t[8]+t[2])/n,e[1]=(t[6]+t[9])/n,e[2]=.25*n),e}function xt(e,t,r,n){let i=t[0],o=t[1],a=t[2],s=t[3],u=i+i,c=o+o,l=a+a,f=i*u,h=i*c,p=i*l,d=o*c,_=o*l,b=a*l,m=s*u,v=s*c,g=s*l,y=n[0],x=n[1],E=n[2];return e[0]=(1-(d+b))*y,e[1]=(h+g)*y,e[2]=(p-v)*y,e[3]=0,e[4]=(h-g)*x,e[5]=(1-(f+b))*x,e[6]=(_+m)*x,e[7]=0,e[8]=(p+v)*E,e[9]=(_-m)*E,e[10]=(1-(f+d))*E,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function Et(e,t,r,n,i){let o=t[0],a=t[1],s=t[2],u=t[3],c=o+o,l=a+a,f=s+s,h=o*c,p=o*l,d=o*f,_=a*l,b=a*f,m=s*f,v=u*c,g=u*l,y=u*f,x=n[0],E=n[1],T=n[2],O=i[0],M=i[1],A=i[2];return e[0]=(1-(_+m))*x,e[1]=(p+y)*x,e[2]=(d-g)*x,e[3]=0,e[4]=(p-y)*E,e[5]=(1-(h+m))*E,e[6]=(b+v)*E,e[7]=0,e[8]=(d+g)*T,e[9]=(b-v)*T,e[10]=(1-(h+_))*T,e[11]=0,e[12]=r[0]+O-(e[0]*O+e[4]*M+e[8]*A),e[13]=r[1]+M-(e[1]*O+e[5]*M+e[9]*A),e[14]=r[2]+A-(e[2]*O+e[6]*M+e[10]*A),e[15]=1,e}function Tt(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],a=r+r,s=n+n,u=i+i,c=r*a,l=n*a,f=n*s,h=i*a,p=i*s,d=i*u,_=o*a,b=o*s,m=o*u;return e[0]=1-f-d,e[1]=l+m,e[2]=h-b,e[3]=0,e[4]=l-m,e[5]=1-c-d,e[6]=p+_,e[7]=0,e[8]=h+b,e[9]=p-_,e[10]=1-c-f,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Ot(e,t,r,n,i,o,a){let s=1/(r-t),u=1/(i-n),c=1/(o-a);return e[0]=2*o*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*o*u,e[6]=0,e[7]=0,e[8]=(r+t)*s,e[9]=(i+n)*u,e[10]=(a+o)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*o*2*c,e[15]=0,e}function Mt(e,t,r,n,i){let o=1/Math.tan(t/2),a=1/(n-i);return e[0]=o/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(i+n)*a,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*i*n*a,e[15]=0,e}function At(e,t,r,n){let i=Math.tan(t.upDegrees*Math.PI/180),o=Math.tan(t.downDegrees*Math.PI/180),a=Math.tan(t.leftDegrees*Math.PI/180),s=Math.tan(t.rightDegrees*Math.PI/180),u=2/(a+s),c=2/(i+o);return e[0]=u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c,e[6]=0,e[7]=0,e[8]=-(a-s)*u*.5,e[9]=(i-o)*c*.5,e[10]=n/(r-n),e[11]=-1,e[12]=0,e[13]=0,e[14]=n*r/(r-n),e[15]=0,e}function Pt(e,t,r,n,i,o,a){let s=1/(t-r),u=1/(n-i),c=1/(o-a);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+r)*s,e[13]=(i+n)*u,e[14]=(a+o)*c,e[15]=1,e}function jt(e,t,r,n){let i,o,a,s,u,c,l,f,p,d,_=t[0],b=t[1],m=t[2],v=n[0],g=n[1],y=n[2],x=r[0],E=r[1],T=r[2];return Math.abs(_-x)<h&&Math.abs(b-E)<h&&Math.abs(m-T)<h?mat4.identity(e):(l=_-x,f=b-E,p=m-T,i=g*(p*=d=1/Math.sqrt(l*l+f*f+p*p))-y*(f*=d),o=y*(l*=d)-v*p,a=v*f-g*l,(d=Math.sqrt(i*i+o*o+a*a))?(i*=d=1/d,o*=d,a*=d):(i=0,o=0,a=0),s=f*a-p*o,u=p*i-l*a,c=l*o-f*i,(d=Math.sqrt(s*s+u*u+c*c))?(s*=d=1/d,u*=d,c*=d):(s=0,u=0,c=0),e[0]=i,e[1]=s,e[2]=l,e[3]=0,e[4]=o,e[5]=u,e[6]=f,e[7]=0,e[8]=a,e[9]=c,e[10]=p,e[11]=0,e[12]=-(i*_+o*b+a*m),e[13]=-(s*_+u*b+c*m),e[14]=-(l*_+f*b+p*m),e[15]=1,e)}function wt(e,t,r,n){let i=t[0],o=t[1],a=t[2],s=n[0],u=n[1],c=n[2],l=i-r[0],f=o-r[1],h=a-r[2],p=l*l+f*f+h*h;p>0&&(l*=p=1/Math.sqrt(p),f*=p,h*=p);let d=u*h-c*f,_=c*l-s*h,b=s*f-u*l;return e[0]=d,e[1]=_,e[2]=b,e[3]=0,e[4]=f*b-h*_,e[5]=h*d-l*b,e[6]=l*_-f*d,e[7]=0,e[8]=l,e[9]=f,e[10]=h,e[11]=0,e[12]=i,e[13]=o,e[14]=a,e[15]=1,e}function Rt(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function Lt(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))}function Ft(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e[9]=t[9]+r[9],e[10]=t[10]+r[10],e[11]=t[11]+r[11],e[12]=t[12]+r[12],e[13]=t[13]+r[13],e[14]=t[14]+r[14],e[15]=t[15]+r[15],e}function St(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e[9]=t[9]-r[9],e[10]=t[10]-r[10],e[11]=t[11]-r[11],e[12]=t[12]-r[12],e[13]=t[13]-r[13],e[14]=t[14]-r[14],e[15]=t[15]-r[15],e}function Bt(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12]*r,e[13]=t[13]*r,e[14]=t[14]*r,e[15]=t[15]*r,e}function It(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e[6]=t[6]+r[6]*n,e[7]=t[7]+r[7]*n,e[8]=t[8]+r[8]*n,e[9]=t[9]+r[9]*n,e[10]=t[10]+r[10]*n,e[11]=t[11]+r[11]*n,e[12]=t[12]+r[12]*n,e[13]=t[13]+r[13]*n,e[14]=t[14]+r[14]*n,e[15]=t[15]+r[15]*n,e}function zt(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function Nt(e,t){let r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],l=e[8],f=e[9],p=e[10],d=e[11],_=e[12],b=e[13],m=e[14],v=e[15],g=t[0],y=t[1],x=t[2],E=t[3],T=t[4],O=t[5],M=t[6],A=t[7],P=t[8],j=t[9],w=t[10],R=t[11],L=t[12],F=t[13],S=t[14],B=t[15];return Math.abs(r-g)<=h*Math.max(1,Math.abs(r),Math.abs(g))&&Math.abs(n-y)<=h*Math.max(1,Math.abs(n),Math.abs(y))&&Math.abs(i-x)<=h*Math.max(1,Math.abs(i),Math.abs(x))&&Math.abs(o-E)<=h*Math.max(1,Math.abs(o),Math.abs(E))&&Math.abs(a-T)<=h*Math.max(1,Math.abs(a),Math.abs(T))&&Math.abs(s-O)<=h*Math.max(1,Math.abs(s),Math.abs(O))&&Math.abs(u-M)<=h*Math.max(1,Math.abs(u),Math.abs(M))&&Math.abs(c-A)<=h*Math.max(1,Math.abs(c),Math.abs(A))&&Math.abs(l-P)<=h*Math.max(1,Math.abs(l),Math.abs(P))&&Math.abs(f-j)<=h*Math.max(1,Math.abs(f),Math.abs(j))&&Math.abs(p-w)<=h*Math.max(1,Math.abs(p),Math.abs(w))&&Math.abs(d-R)<=h*Math.max(1,Math.abs(d),Math.abs(R))&&Math.abs(_-L)<=h*Math.max(1,Math.abs(_),Math.abs(L))&&Math.abs(b-F)<=h*Math.max(1,Math.abs(b),Math.abs(F))&&Math.abs(m-S)<=h*Math.max(1,Math.abs(m),Math.abs(S))&&Math.abs(v-B)<=h*Math.max(1,Math.abs(v),Math.abs(B))}const Ct=it,Gt=St;function Ut(){let e=new p(3);return e[0]=0,e[1]=0,e[2]=0,e}function Dt(e){var t=new p(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function kt(e){let t=e[0],r=e[1],n=e[2];return Math.sqrt(t*t+r*r+n*n)}function Wt(e,t,r){let n=new p(3);return n[0]=e,n[1]=t,n[2]=r,n}function qt(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Xt(e,t,r,n){return e[0]=t,e[1]=r,e[2]=n,e}function Ht(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e}function Vt(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e}function Yt(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e}function Zt(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e}function Kt(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}function $t(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}function Jt(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e}function Qt(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e}function er(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e}function tr(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e}function rr(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e}function nr(e,t){let r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return Math.sqrt(r*r+n*n+i*i)}function ir(e,t){let r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return r*r+n*n+i*i}function or(e){let t=e[0],r=e[1],n=e[2];return t*t+r*r+n*n}function ar(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function sr(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}function ur(e,t){let r=t[0],n=t[1],i=t[2],o=r*r+n*n+i*i;return o>0&&(o=1/Math.sqrt(o),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o),e}function cr(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function lr(e,t,r){let n=t[0],i=t[1],o=t[2],a=r[0],s=r[1],u=r[2];return e[0]=i*u-o*s,e[1]=o*a-n*u,e[2]=n*s-i*a,e}function fr(e,t,r,n){let i=t[0],o=t[1],a=t[2];return e[0]=i+n*(r[0]-i),e[1]=o+n*(r[1]-o),e[2]=a+n*(r[2]-a),e}function hr(e,t,r,n,i,o){let a=o*o,s=a*(2*o-3)+1,u=a*(o-2)+o,c=a*(o-1),l=a*(3-2*o);return e[0]=t[0]*s+r[0]*u+n[0]*c+i[0]*l,e[1]=t[1]*s+r[1]*u+n[1]*c+i[1]*l,e[2]=t[2]*s+r[2]*u+n[2]*c+i[2]*l,e}function pr(e,t,r,n,i,o){let a=1-o,s=a*a,u=o*o,c=s*a,l=3*o*s,f=3*u*a,h=u*o;return e[0]=t[0]*c+r[0]*l+n[0]*f+i[0]*h,e[1]=t[1]*c+r[1]*l+n[1]*f+i[1]*h,e[2]=t[2]*c+r[2]*l+n[2]*f+i[2]*h,e}function dr(e,t){t=t||1;let r=2*d()*Math.PI,n=2*d()-1,i=Math.sqrt(1-n*n)*t;return e[0]=Math.cos(r)*i,e[1]=Math.sin(r)*i,e[2]=n*t,e}function _r(e,t,r){let n=t[0],i=t[1],o=t[2],a=r[3]*n+r[7]*i+r[11]*o+r[15];return a=a||1,e[0]=(r[0]*n+r[4]*i+r[8]*o+r[12])/a,e[1]=(r[1]*n+r[5]*i+r[9]*o+r[13])/a,e[2]=(r[2]*n+r[6]*i+r[10]*o+r[14])/a,e}function br(e,t,r){let n=t[0],i=t[1],o=t[2];return e[0]=n*r[0]+i*r[3]+o*r[6],e[1]=n*r[1]+i*r[4]+o*r[7],e[2]=n*r[2]+i*r[5]+o*r[8],e}function mr(e,t,r){let n=t[0],i=t[1],o=t[2],a=r[0],s=r[1],u=r[2],c=r[3],l=c*n+s*o-u*i,f=c*i+u*n-a*o,h=c*o+a*i-s*n,p=-a*n-s*i-u*o;return e[0]=l*c+p*-a+f*-u-h*-s,e[1]=f*c+p*-s+h*-a-l*-u,e[2]=h*c+p*-u+l*-s-f*-a,e}function vr(e,t,r,n){let i=[],o=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],o[0]=i[0],o[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),o[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),e[0]=o[0]+r[0],e[1]=o[1]+r[1],e[2]=o[2]+r[2],e}function gr(e,t,r,n){let i=[],o=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],o[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),o[1]=i[1],o[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),e[0]=o[0]+r[0],e[1]=o[1]+r[1],e[2]=o[2]+r[2],e}function yr(e,t,r,n){let i=[],o=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],o[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),o[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),o[2]=i[2],e[0]=o[0]+r[0],e[1]=o[1]+r[1],e[2]=o[2]+r[2],e}function xr(e,t){let r=Wt(e[0],e[1],e[2]),n=Wt(t[0],t[1],t[2]);ur(r,r),ur(n,n);let i=cr(r,n);return i>1?0:i<-1?Math.PI:Math.acos(i)}function Er(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function Tr(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function Or(e,t){let r=e[0],n=e[1],i=e[2],o=t[0],a=t[1],s=t[2];return Math.abs(r-o)<=h*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-a)<=h*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(i-s)<=h*Math.max(1,Math.abs(i),Math.abs(s))}const Mr=Vt,Ar=Yt,Pr=Zt,jr=nr,wr=ir,Rr=kt,Lr=or,Fr=function(){let e=Ut();return function(t,r,n,i,o,a){let s,u;for(r||(r=3),n||(n=0),u=i?Math.min(i*r+n,t.length):t.length,s=n;s<u;s+=r)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],o(e,e,a),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2];return t}}();function Sr(){let e=new p(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function Br(e){let t=new p(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Ir(e,t,r,n){let i=new p(4);return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i}function zr(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function Nr(e,t,r,n,i){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e}function Cr(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e}function Gr(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}function Ur(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e}function Dr(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e[3]=t[3]/r[3],e}function kr(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e}function Wr(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e}function qr(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e[3]=Math.min(t[3],r[3]),e}function Xr(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e[3]=Math.max(t[3],r[3]),e}function Hr(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e}function Vr(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function Yr(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e}function Zr(e,t){let r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],o=t[3]-e[3];return Math.sqrt(r*r+n*n+i*i+o*o)}function Kr(e,t){let r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],o=t[3]-e[3];return r*r+n*n+i*i+o*o}function $r(e){let t=e[0],r=e[1],n=e[2],i=e[3];return Math.sqrt(t*t+r*r+n*n+i*i)}function Jr(e){let t=e[0],r=e[1],n=e[2],i=e[3];return t*t+r*r+n*n+i*i}function Qr(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}function en(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e}function tn(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],a=r*r+n*n+i*i+o*o;return a>0&&(a=1/Math.sqrt(a),e[0]=r*a,e[1]=n*a,e[2]=i*a,e[3]=o*a),e}function rn(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function nn(e,t,r,n){let i=t[0],o=t[1],a=t[2],s=t[3];return e[0]=i+n*(r[0]-i),e[1]=o+n*(r[1]-o),e[2]=a+n*(r[2]-a),e[3]=s+n*(r[3]-s),e}function on(e,t){return t=t||1,e[0]=d(),e[1]=d(),e[2]=d(),e[3]=d(),tn(e,e),Vr(e,e,t),e}function an(e,t,r){let n=t[0],i=t[1],o=t[2],a=t[3];return e[0]=r[0]*n+r[4]*i+r[8]*o+r[12]*a,e[1]=r[1]*n+r[5]*i+r[9]*o+r[13]*a,e[2]=r[2]*n+r[6]*i+r[10]*o+r[14]*a,e[3]=r[3]*n+r[7]*i+r[11]*o+r[15]*a,e}function sn(e,t,r){let n=t[0],i=t[1],o=t[2],a=r[0],s=r[1],u=r[2],c=r[3],l=c*n+s*o-u*i,f=c*i+u*n-a*o,h=c*o+a*i-s*n,p=-a*n-s*i-u*o;return e[0]=l*c+p*-a+f*-u-h*-s,e[1]=f*c+p*-s+h*-a-l*-u,e[2]=h*c+p*-u+l*-s-f*-a,e[3]=t[3],e}function un(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function cn(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function ln(e,t){let r=e[0],n=e[1],i=e[2],o=e[3],a=t[0],s=t[1],u=t[2],c=t[3];return Math.abs(r-a)<=h*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-s)<=h*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-u)<=h*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-c)<=h*Math.max(1,Math.abs(o),Math.abs(c))}const fn=Gr,hn=Ur,pn=Dr,dn=Zr,_n=Kr,bn=$r,mn=Jr,vn=function(){let e=Sr();return function(t,r,n,i,o,a){let s,u;for(r||(r=4),n||(n=0),u=i?Math.min(i*r+n,t.length):t.length,s=n;s<u;s+=r)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],e[3]=t[s+3],o(e,e,a),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2],t[s+3]=e[3];return t}}();function gn(){let e=new p(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function yn(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function xn(e,t,r){r*=.5;let n=Math.sin(r);return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=Math.cos(r),e}function En(e,t){let r=2*Math.acos(t[3]),n=Math.sin(r/2);return 0!=n?(e[0]=t[0]/n,e[1]=t[1]/n,e[2]=t[2]/n):(e[0]=1,e[1]=0,e[2]=0),r}function Tn(e,t,r){let n=t[0],i=t[1],o=t[2],a=t[3],s=r[0],u=r[1],c=r[2],l=r[3];return e[0]=n*l+a*s+i*c-o*u,e[1]=i*l+a*u+o*s-n*c,e[2]=o*l+a*c+n*u-i*s,e[3]=a*l-n*s-i*u-o*c,e}function On(e,t,r){r*=.5;let n=t[0],i=t[1],o=t[2],a=t[3],s=Math.sin(r),u=Math.cos(r);return e[0]=n*u+a*s,e[1]=i*u+o*s,e[2]=o*u-i*s,e[3]=a*u-n*s,e}function Mn(e,t,r){r*=.5;let n=t[0],i=t[1],o=t[2],a=t[3],s=Math.sin(r),u=Math.cos(r);return e[0]=n*u-o*s,e[1]=i*u+a*s,e[2]=o*u+n*s,e[3]=a*u-i*s,e}function An(e,t,r){r*=.5;let n=t[0],i=t[1],o=t[2],a=t[3],s=Math.sin(r),u=Math.cos(r);return e[0]=n*u+i*s,e[1]=i*u-n*s,e[2]=o*u+a*s,e[3]=a*u-o*s,e}function Pn(e,t){let r=t[0],n=t[1],i=t[2];return e[0]=r,e[1]=n,e[2]=i,e[3]=Math.sqrt(Math.abs(1-r*r-n*n-i*i)),e}function jn(e,t,r,n){let i,o,a,s,u,c=t[0],l=t[1],f=t[2],h=t[3],p=r[0],d=r[1],_=r[2],b=r[3];return(o=c*p+l*d+f*_+h*b)<0&&(o=-o,p=-p,d=-d,_=-_,b=-b),1-o>1e-6?(i=Math.acos(o),a=Math.sin(i),s=Math.sin((1-n)*i)/a,u=Math.sin(n*i)/a):(s=1-n,u=n),e[0]=s*c+u*p,e[1]=s*l+u*d,e[2]=s*f+u*_,e[3]=s*h+u*b,e}function wn(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],a=r*r+n*n+i*i+o*o,s=a?1/a:0;return e[0]=-r*s,e[1]=-n*s,e[2]=-i*s,e[3]=o*s,e}function Rn(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function Ln(e,t){let r,n=t[0]+t[4]+t[8];if(n>0)r=Math.sqrt(n+1),e[3]=.5*r,r=.5/r,e[0]=(t[5]-t[7])*r,e[1]=(t[6]-t[2])*r,e[2]=(t[1]-t[3])*r;else{let n=0;t[4]>t[0]&&(n=1),t[8]>t[3*n+n]&&(n=2);let i=(n+1)%3,o=(n+2)%3;r=Math.sqrt(t[3*n+n]-t[3*i+i]-t[3*o+o]+1),e[n]=.5*r,r=.5/r,e[3]=(t[3*i+o]-t[3*o+i])*r,e[i]=(t[3*i+n]+t[3*n+i])*r,e[o]=(t[3*o+n]+t[3*n+o])*r}return e}function Fn(e,t,r,n){let i=.5*Math.PI/180;t*=i,r*=i,n*=i;let o=Math.sin(t),a=Math.cos(t),s=Math.sin(r),u=Math.cos(r),c=Math.sin(n),l=Math.cos(n);return e[0]=o*u*l-a*s*c,e[1]=a*s*l+o*u*c,e[2]=a*u*c-o*s*l,e[3]=a*u*l+o*s*c,e}function Sn(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}const Bn=Br,In=Ir,zn=zr,Nn=Nr,Cn=Cr,Gn=Tn,Un=Vr,Dn=rn,kn=nn,Wn=$r,qn=Wn,Xn=Jr,Hn=Xn,Vn=tn,Yn=cn,Zn=ln,Kn=function(){let e=Ut(),t=Wt(1,0,0),r=Wt(0,1,0);return function(n,i,o){let a=cr(i,o);return a<-.999999?(lr(e,t,i),Rr(e)<1e-6&&lr(e,r,i),ur(e,e),xn(n,e,Math.PI),n):a>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(lr(e,i,o),n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=1+a,Vn(n,n))}}(),$n=function(){let e=gn(),t=gn();return function(r,n,i,o,a,s){return jn(e,n,a,s),jn(t,i,o,s),jn(r,e,t,2*s*(1-s)),r}}(),Jn=function(){let e=be();return function(t,r,n,i){return e[0]=n[0],e[3]=n[1],e[6]=n[2],e[1]=i[0],e[4]=i[1],e[7]=i[2],e[2]=-r[0],e[5]=-r[1],e[8]=-r[2],Vn(t,Ln(t,e))}}();function Qn(){let e=new p(2);return e[0]=0,e[1]=0,e}function ei(e){let t=new p(2);return t[0]=e[0],t[1]=e[1],t}function ti(e,t){let r=new p(2);return r[0]=e,r[1]=t,r}function ri(e,t){return e[0]=t[0],e[1]=t[1],e}function ni(e,t,r){return e[0]=t,e[1]=r,e}function ii(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e}function oi(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e}function ai(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e}function si(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e}function ui(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e}function ci(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e}function li(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e}function fi(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e}function hi(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e}function pi(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e}function di(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e}function _i(e,t){var r=t[0]-e[0],n=t[1]-e[1];return Math.sqrt(r*r+n*n)}function bi(e,t){var r=t[0]-e[0],n=t[1]-e[1];return r*r+n*n}function mi(e){var t=e[0],r=e[1];return Math.sqrt(t*t+r*r)}function vi(e){var t=e[0],r=e[1];return t*t+r*r}function gi(e,t){return e[0]=-t[0],e[1]=-t[1],e}function yi(e,t){return e[0]=1/t[0],e[1]=1/t[1],e}function xi(e,t){var r=t[0],n=t[1],i=r*r+n*n;return i>0&&(i=1/Math.sqrt(i),e[0]=t[0]*i,e[1]=t[1]*i),e}function Ei(e,t){return e[0]*t[0]+e[1]*t[1]}function Ti(e,t,r){var n=t[0]*r[1]-t[1]*r[0];return e[0]=e[1]=0,e[2]=n,e}function Oi(e,t,r,n){var i=t[0],o=t[1];return e[0]=i+n*(r[0]-i),e[1]=o+n*(r[1]-o),e}function Mi(e,t){t=t||1;var r=2*d()*Math.PI;return e[0]=Math.cos(r)*t,e[1]=Math.sin(r)*t,e}function Ai(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i,e[1]=r[1]*n+r[3]*i,e}function Pi(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i+r[4],e[1]=r[1]*n+r[3]*i+r[5],e}function ji(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[3]*i+r[6],e[1]=r[1]*n+r[4]*i+r[7],e}function wi(e,t,r){let n=t[0],i=t[1];return e[0]=r[0]*n+r[4]*i+r[12],e[1]=r[1]*n+r[5]*i+r[13],e}function Ri(e){return"vec2("+e[0]+", "+e[1]+")"}function Li(e,t){return e[0]===t[0]&&e[1]===t[1]}function Fi(e,t){let r=e[0],n=e[1],i=t[0],o=t[1];return Math.abs(r-i)<=h*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(n-o)<=h*Math.max(1,Math.abs(n),Math.abs(o))}const Si=mi,Bi=oi,Ii=ai,zi=si,Ni=_i,Ci=bi,Gi=vi,Ui=function(){let e=Qn();return function(t,r,n,i,o,a){let s,u;for(r||(r=2),n||(n=0),u=i?Math.min(i*r+n,t.length):t.length,s=n;s<u;s+=r)e[0]=t[s],e[1]=t[s+1],o(e,e,a),t[s]=e[0],t[s+1]=e[1];return t}}();r.d(t,"glMatrix",function(){return n}),r.d(t,"mat2",function(){return i}),r.d(t,"mat2d",function(){return o}),r.d(t,"mat3",function(){return a}),r.d(t,"mat4",function(){return s}),r.d(t,"quat",function(){return l}),r.d(t,"vec2",function(){return f}),r.d(t,"vec3",function(){return u}),r.d(t,"vec4",function(){return c})},function(e,t,r){"use strict";var n,i=r(2);!function(e){function t(e){return e>0?e-Math.floor(e):e-Math.ceil(e)}e.sign=function(e){return e>0?1:e<0?-1:0},e.clamp=function(e,t,r){return Math.max(t,Math.min(r,e))},e.fract=t,e.v2=function(){return i.vec2.create()},e.clamp2=function(e,t,r,n){return e[0]=Math.max(r[0],Math.min(n[0],t[0])),e[1]=Math.max(r[1],Math.min(n[1],t[1])),e},e.abs2=function(e,t){return e[0]=Math.abs(t[0]),e[1]=Math.abs(t[1]),e},e.v3=function(){return i.vec3.create()},e.clamp3=function(e,t,r,n){return e[0]=Math.max(r[0],Math.min(n[0],t[0])),e[1]=Math.max(r[1],Math.min(n[1],t[1])),e[2]=Math.max(r[2],Math.min(n[2],t[2])),e},e.abs3=function(e,t){return e[0]=Math.abs(t[0]),e[1]=Math.abs(t[1]),e[2]=Math.abs(t[2]),e};var r=1/256;e.encode_float24x1_to_uint8x3=function(e,r){return e[0]=Math.floor(256*r),e[1]=Math.floor(256*t(256*r)),e[2]=Math.floor(256*t(65536*r)),e},e.decode_float24x1_from_uint8x3=function(e){return(e[0]+(e[1]+e[2]*r)*r)*r},e.encode_uint24_to_rgb8=function(e,t){return e[0]=t>>0&255,e[1]=t>>8&255,e[2]=t>>16&255,e},e.encode_uint32_to_rgba8=function(e,t){return e[0]=t>>0&255,e[1]=t>>8&255,e[2]=t>>16&255,e[3]=t>>24&255,e},e.decode_uint24_from_rgb8=function(e){return e[0]+(e[1]<<8)+(e[2]<<16)},e.decode_uint32_from_rgba8=function(e){return e[0]+(e[1]<<8)+(e[2]<<16)+(e[3]<<24)},e.fromVec4=function(e){return i.vec3.fromValues(e[0]/e[3],e[1]/e[3],e[2]/e[3])},e.v4=function(){return i.vec4.create()},e.clamp4=function(e,t,r,n){return e[0]=Math.max(r[0],Math.min(n[0],t[0])),e[1]=Math.max(r[1],Math.min(n[1],t[1])),e[2]=Math.max(r[2],Math.min(n[2],t[2])),e[3]=Math.max(r[3],Math.min(n[3],t[3])),e},e.abs4=function(e,t){return e[0]=Math.abs(t[0]),e[1]=Math.abs(t[1]),e[2]=Math.abs(t[2]),e[3]=Math.abs(t[3]),e},e.fromVec3=function(e){return i.vec4.fromValues(e[0],e[1],e[2],1)},e.parseVec2=function(e){if(void 0!==e&&""!==e){var t=[];try{t=JSON.parse("["+e+"]")}catch(e){return}return 2!==t.length||isNaN(t[0])||isNaN(t[1])?void 0:i.vec2.clone(t)}},e.parseVec3=function(e){if(void 0!==e&&""!==e){var t=[];try{t=JSON.parse("["+e+"]")}catch(e){return}return 3!==t.length||isNaN(t[0])||isNaN(t[1])||isNaN(t[2])?void 0:i.vec3.clone(t)}},e.parseVec4=function(e){if(void 0!==e&&""!==e){var t=[];try{t=JSON.parse("["+e+"]")}catch(e){return}return 4!==t.length||isNaN(t[0])||isNaN(t[1])||isNaN(t[2])||isNaN(t[3])?void 0:i.vec4.clone(t)}},e.mix=function(e,t,r){return e*(1-r)+t*r},e.m2=function(){return i.mat2.create()},e.m3=function(){return i.mat3.create()},e.m4=function(){return i.mat4.create()}}(n||(n={})),e.exports=n},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),s=r(1),u=function(e){function t(t,r){var n=e.call(this)||this;return n._valid=!1,n._referenceCount=0,n._context=t,n._identifier=void 0!==r&&""!==r?r:n.constructor.name,n}return i(t,e),t.prototype.initialize=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._identifier=this._context.allocationRegister.createUniqueIdentifier(this._identifier),this.create.apply(this,e),this._valid||(this._context.allocationRegister.deleteUniqueIdentifier(this._identifier),a.log(a.LogLevel.Dev,"initialization of '"+this._identifier+"' failed")),this._valid},t.prototype.uninitialize=function(){this._context.allocationRegister.reallocate(this._identifier,0),this._context.allocationRegister.deleteUniqueIdentifier(this._identifier),this.delete(),a.assert(void 0===this._object,"expected object '"+this._identifier+"' to be undefined after delete"),a.assert(!1===this._valid,"expected object '"+this._identifier+"' to be invalid after delete")},Object.defineProperty(t.prototype,"context",{get:function(){return this._context},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"identifier",{get:function(){return this._identifier},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"object",{get:function(){return a.assert(void 0!==this._object,"access to undefined object"),this._object},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"valid",{get:function(){return this._valid},enumerable:!0,configurable:!0}),t.prototype.ref=function(){a.assert(this.initialized,"expected object to be initialized in order to be referenced"),++this._referenceCount},t.prototype.unref=function(){a.assert(this._referenceCount>0,"expected object to be referenced in order to decrease its reference count"),--this._referenceCount},o([s.Initializable.initialize()],t.prototype,"initialize",null),o([s.Initializable.uninitialize()],t.prototype,"uninitialize",null),t}(s.Initializable);t.AbstractObject=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(29),i=function(){function e(){this._camera=void 0,this._reference=new n.Camera}return Object.defineProperty(e.prototype,"camera",{set:function(e){this._camera!==e&&(this._camera=e,void 0!==e&&(Object.assign(this._reference,e),this.update()))},enumerable:!0,configurable:!0}),e}();t.CameraModifier=i},function(t,r){t.exports=e},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),s=r(16),u=r(14),c=r(1),l=function(e){function t(t,r){var n=e.call(this,t,r)||this;r=void 0!==r&&""!==r?r:n.constructor.name;var i=new s.Buffer(t,r+"VBO");return n._buffers.push(i),n}return i(t,e),t.prototype.bindBuffers=function(e){this._buffers[0].attribEnable(e[0],2,this.context.gl.FLOAT,!1,0,0,!0,!1),this._aVertex=e[0]},t.prototype.unbindBuffers=function(e){this._buffers[0].attribDisable(e[0],!0,!0)},t.prototype.initialize=function(r){var n=this.context.gl,i=e.prototype.initialize.call(this,[n.ARRAY_BUFFER],[r]);return a.assert(void 0!==this._buffers[0]&&this._buffers[0].object instanceof WebGLBuffer,"expected valid WebGLBuffer"),this._buffers[0].data(t.VERTICES,n.STATIC_DRAW),i},t.prototype.draw=function(){var e=this.context.gl;e.drawArrays(e.TRIANGLES,0,3)},Object.defineProperty(t.prototype,"aVertex",{get:function(){return this._aVertex},enumerable:!0,configurable:!0}),t.VERTICES=new Float32Array([-1,-3,3,1,-1,1]),o([c.Initializable.assert_initialized()],t.prototype,"draw",null),t}(u.Geometry);t.NdcFillingTriangle=l},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),a=function(e){function t(t,r,n){var i=this,a=t.gl;if(void 0===n)switch(r){case t.gl.FRAGMENT_SHADER:n="FragmentShader";break;case t.gl.VERTEX_SHADER:n="VertexShader";break;default:o.assert(!1,"expected either a FRAGMENT_SHADER ("+a.FRAGMENT_SHADER+") or a VERTEX_SHADER ("+a.VERTEX_SHADER+"), given "+r)}return(i=e.call(this,t,n)||this)._type=r,i}return i(t,e),t.prototype.create=function(e){var t=this._context.gl;if(this._object=t.createShader(this._type),o.assert(this._object instanceof WebGLShader,"expected WebGLShader object to be created"),this._context.isWebGL2&&(e="#version 300 es\n"+e),t.shaderSource(this._object,e),t.compileShader(this._object),!t.getShaderParameter(this._object,t.COMPILE_STATUS)){var r=t.getShaderInfoLog(this._object);return o.log(o.LogLevel.Dev,"compilation of shader '"+this._identifier+"' failed: "+r),void this.delete()}return this._valid=t.isShader(this._object),this._object},t.prototype.delete=function(){o.assert(void 0!==this._object,"expected WebGLShader object"),this._context.gl.deleteShader(this._object),this._object=void 0,this._valid=!1},Object.defineProperty(t.prototype,"type",{get:function(){return this.assertInitialized(),this._type},enumerable:!0,configurable:!0}),t}(r(4).AbstractObject);t.Shader=a},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),s=r(1),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.attach=function(e){a.assert(void 0!==this._object,"expected a WebGLProgram object");for(var t=this._context.gl,r=0,n=e;r<n.length;r++){var i=n[r];i.initialized?(t.attachShader(this._object,i.object),i.ref()):a.log(a.LogLevel.Dev,"shader '"+i.identifier+"' not initialized.")}return!0},t.prototype.link=function(){a.assert(void 0!==this._object,"expected WebGLProgram object");var e=this._context.gl;if(e.linkProgram(this._object),!e.getProgramParameter(this._object,e.LINK_STATUS)){var t=e.getProgramInfoLog(this._object);return a.log(a.LogLevel.Dev,"linking of program '"+this._identifier+"' failed: '"+t+"'"),!1}return!0},t.prototype.detach=function(e){a.assert(void 0!==this._object,"expected WebGLProgram object");for(var t=this._context.gl,r=0,n=e;r<n.length;r++){var i=n[r];a.assert(i.initialized,"expected shader '"+i.identifier+"' to be initialized"),t.detachShader(this._object,i.object),i.unref()}},t.prototype.create=function(e){for(var t=this._context.gl,r=0,n=0,i=0,o=e;i<o.length;i++){switch(o[i].type){case t.VERTEX_SHADER:++r;break;case t.FRAGMENT_SHADER:++n;break;default:a.assert(!1,"Unknown shader type detected.")}}if(a.logIf(r<1,a.LogLevel.Dev,"at least one vertex shader is expected"),a.logIf(n<1,a.LogLevel.Dev,"at least one fragment shader is expected"),!(r<1||n<1)){if(this._object=t.createProgram(),a.assert(this._object instanceof WebGLProgram,"expected WebGLProgram object to be created"),this.attach(e)&&this.link())return this.detach(e),this._valid=t.isProgram(this._object),this._object;this.delete()}},t.prototype.delete=function(){a.assert(void 0!==this._object,"expected WebGLProgram object"),this._context.gl.deleteProgram(this._object),this._object=void 0,this._valid=!1},t.prototype.bind=function(){this._context.gl.useProgram(this._object)},t.prototype.unbind=function(){this._context.gl.useProgram(t.DEFAULT_PROGRAM)},t.prototype.uniform=function(e){return this._context.gl.getUniformLocation(this._object,e)},t.prototype.attribute=function(e,t){return this._context.isWebGL2&&void 0!==t?(this._context.gl.bindAttribLocation(this._object,t,e),t):this._context.gl.getAttribLocation(this._object,e)},t.DEFAULT_PROGRAM=void 0,o([s.Initializable.assert_initialized()],t.prototype,"bind",null),o([s.Initializable.assert_initialized()],t.prototype,"unbind",null),o([s.Initializable.assert_initialized()],t.prototype,"uniform",null),o([s.Initializable.assert_initialized()],t.prototype,"attribute",null),t}(r(4).AbstractObject);t.Program=u},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),s=r(15),u=r(1),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._width=0,t._height=0,t._internalFormat=0,t._format=0,t._type=0,t}return i(t,e),t.prototype.create=function(e,r,n,i,o){a.assert(e>0&&r>0,"texture requires valid width and height of greater than zero");var s=this._context.gl,u=this._context.gl2facade;return this._object=s.createTexture(),this._width=e,this._height=r,this._internalFormat=n,this._format=i,this._type=o,s.bindTexture(s.TEXTURE_2D,this._object),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.NEAREST),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.NEAREST),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE),u.texImage2D(s.TEXTURE_2D,0,this._internalFormat,this._width,this._height,0,this._format,this._type),s.bindTexture(s.TEXTURE_2D,t.DEFAULT_TEXTURE),this._valid=s.isTexture(this._object),this.context.allocationRegister.reallocate(this._identifier,0),this._object},t.prototype.delete=function(){a.assert(this._object instanceof WebGLTexture,"expected WebGLTexture object"),this._context.gl.deleteTexture(this._object),this._object=void 0,this._valid=!1,this._internalFormat=0,this._format=0,this._type=0,this._width=0,this._height=0},t.prototype.bind=function(e){var t=this.context.gl;e&&t.activeTexture(e),t.bindTexture(t.TEXTURE_2D,this._object)},t.prototype.unbind=function(e){var r=this.context.gl;e&&r.activeTexture(e),r.bindTexture(r.TEXTURE_2D,t.DEFAULT_TEXTURE)},t.prototype.load=function(e,t){var r=this;return void 0===t&&(t=!1),new Promise(function(n,i){var o=new Image;o.onerror=function(){return i()},o.onload=function(){r.resize(o.width,o.height),r.data(o),n()},t&&(o.crossOrigin="anonymous"),o.src=e})},t.prototype.data=function(e,t,r){void 0===t&&(t=!0),void 0===r&&(r=!0);var n=this.context.gl,i=this._context.gl2facade;t&&this.bind(),i.texImage2D(n.TEXTURE_2D,0,this._internalFormat,this._width,this._height,0,this._format,this._type,e),r&&this.unbind();var o=0;void 0!==e&&(o=this._width*this._height*s.byteSizeOfFormat(this.context,this._internalFormat),this._type===this.context.gl2facade.HALF_FLOAT&&this._internalFormat!==this.context.gl.RGBA16F?o*=2:this._type===this.context.gl.FLOAT&&this._internalFormat!==this.context.gl.RGBA16F&&(o*=4)),this.context.allocationRegister.reallocate(this._identifier,o)},t.prototype.filter=function(e,t,r,n){void 0===r&&(r=!0),void 0===n&&(n=!0);var i=this.context.gl;r&&this.bind(),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,e),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,t),n&&this.unbind()},t.prototype.wrap=function(e,t,r,n){void 0===r&&(r=!0),void 0===n&&(n=!0);var i=this.context.gl;r&&this.bind(),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,e),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,t),n&&this.unbind()},t.prototype.reformat=function(e,t,r,n,i){void 0===n&&(n=!0),void 0===i&&(i=!0),(e!==this._internalFormat||void 0!==t&&t!==this._format||void 0!==r&&r!==this._type)&&(a.assert(void 0!==e,"valid internal format expected"),this._internalFormat=e,t&&(this._format=t),r&&(this._type=r),this.data(void 0,n,i))},t.prototype.resize=function(e,t,r,n){void 0===r&&(r=!0),void 0===n&&(n=!0),e===this._width&&t===this._height||(this._width=e,this._height=t,this.data(void 0,r,n))},Object.defineProperty(t.prototype,"bytes",{get:function(){return this.assertInitialized(),this.context.allocationRegister.allocated(this._identifier)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"internalFormat",{get:function(){return this.assertInitialized(),this._internalFormat},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"format",{get:function(){return this.assertInitialized(),this._format},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this.assertInitialized(),this._type},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.assertInitialized(),this._width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.assertInitialized(),this._height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return[this.width,this.height]},enumerable:!0,configurable:!0}),t.DEFAULT_TEXTURE=void 0,o([u.Initializable.assert_initialized()],t.prototype,"bind",null),o([u.Initializable.assert_initialized()],t.prototype,"unbind",null),o([u.Initializable.assert_initialized()],t.prototype,"load",null),o([u.Initializable.assert_initialized()],t.prototype,"data",null),o([u.Initializable.assert_initialized()],t.prototype,"filter",null),o([u.Initializable.assert_initialized()],t.prototype,"wrap",null),o([u.Initializable.assert_initialized()],t.prototype,"reformat",null),o([u.Initializable.assert_initialized()],t.prototype,"resize",null),t}(r(4).AbstractObject);t.Texture2=c},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),s=r(1),u=r(4),c=r(22),l=r(10),f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._buffersByAttachment=new Map,t._texturesByAttachment=new Map,t._colorClearQueue=new Array,t._drawBuffers=new Array,t._drawBuffersChanged=!1,t}return i(t,e),t.statusString=function(e,t){var r=e.gl;switch(t){case r.FRAMEBUFFER_COMPLETE:return"the framebuffer is ready to display (COMPLETE)";case r.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"the attachment types are mismatched or not all framebuffer attachment points are framebuffer attachment complete (INCOMPLETE_ATTACHMENT)";case r.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"there is no attachment (INCOMPLETE_MISSING_ATTACHMENT)";case r.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"height and width of the attachment are not the same (INCOMPLETE_DIMENSIONS)";case r.FRAMEBUFFER_UNSUPPORTED:return"the format of the attachment is not supported or if depth and stencil attachments are not the same renderbuffer (UNSUPPORTED)";case r.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:return"the values of gl.RENDERBUFFER_SAMPLES are different among attached renderbuffers, or are non-zero if the attached images are a mix of renderbuffers and textures (INCOMPLETE_MULTISAMPLE)";default:return a.assert(!1,"expected known framebuffer status, given "+t),""}},t.prototype.create=function(e){var r=this._context.gl,n=this.context.gl2facade;this._object=r.createFramebuffer(),this._clearColors=new Array(n.COLOR_ATTACHMENT_MAX-n.COLOR_ATTACHMENT0),this._clearDepth=1,this._clearStencil=0,this.clear=this.context.isWebGL1?this.es2Clear:this.es3Clear;for(var i=0,o=e;i<o.length;i++){var s=o[i],u=s[0],f=s[1];if(f instanceof c.Renderbuffer?this._buffersByAttachment.set(u,f):f instanceof l.Texture2&&this._texturesByAttachment.set(u,f),!(u<n.COLOR_ATTACHMENT_MIN||u>n.COLOR_ATTACHMENT_MAX)){this._drawBuffers.push(u);var h=u-r.COLOR_ATTACHMENT0;this._colorClearQueue.push(h),this._clearColors[h]=[0,0,0,0]}}this._drawBuffersChanged=!0,r.bindFramebuffer(r.FRAMEBUFFER,this._object),this._buffersByAttachment.forEach(function(e,t){r.framebufferRenderbuffer(r.FRAMEBUFFER,t,r.RENDERBUFFER,e.object)}),this._texturesByAttachment.forEach(function(e,t){r.framebufferTexture2D(r.FRAMEBUFFER,t,r.TEXTURE_2D,e.object,0)}),n.drawBuffers&&n.drawBuffers(this._drawBuffers);var p=r.checkFramebufferStatus(r.FRAMEBUFFER);return this._valid=r.isFramebuffer(this._object)&&p===r.FRAMEBUFFER_COMPLETE,a.logIf(!this._valid,a.LogLevel.Dev,t.statusString(this.context,p)),r.bindFramebuffer(r.FRAMEBUFFER,t.DEFAULT_FRAMEBUFFER),this._object},t.prototype.delete=function(){a.assert(this._object instanceof WebGLFramebuffer,"expected WebGLFramebuffer object"),this.context.gl.deleteFramebuffer(this._object),this._object=void 0,this._valid=!1},t.prototype.es2Clear=function(e,t,r){void 0===t&&(t=!0),void 0===r&&(r=!0);var n=this.context.gl,i=a.bitInBitfield(e,n.DEPTH_BUFFER_BIT),o=a.bitInBitfield(e,n.STENCIL_BUFFER_BIT),s=a.bitInBitfield(e,n.COLOR_BUFFER_BIT);if(s||i||o){if(t&&this.bind(),s&&void 0!==this._clearColors[0]){var u=this._clearColors[0];n.clearColor(u[0],u[1],u[2],u[3])}i&&void 0!==this._clearDepth&&n.clearDepth(this._clearDepth),o&&void 0!==this._clearStencil&&n.clearStencil(this._clearStencil),n.clear(e),r&&this.unbind()}},t.prototype.es3Clear=function(e,t,r,n){void 0===t&&(t=!0),void 0===r&&(r=!0);var i=this.context.gl,o=a.bitInBitfield(e,i.DEPTH_BUFFER_BIT),s=a.bitInBitfield(e,i.STENCIL_BUFFER_BIT),u=a.bitInBitfield(e,i.COLOR_BUFFER_BIT);if(u||o||s){if(t&&this.bind(),u)for(var c=0,l=n||this._colorClearQueue;c<l.length;c++){var f=l[c];i.clearBufferfv(i.COLOR,f,this._clearColors[f])}o&&s?(i.clearStencil(this._clearStencil),i.clearDepth(this._clearDepth),i.clear(i.STENCIL_BUFFER_BIT|i.DEPTH_BUFFER_BIT)):o?i.clearBufferfv(i.DEPTH,0,[this._clearDepth]):s&&(i.clearStencil(this._clearStencil),i.clear(i.STENCIL_BUFFER_BIT)),r&&this.unbind()}},t.prototype.hasAttachment=function(e){return this._texturesByAttachment.has(e)||this._buffersByAttachment.has(e)},t.prototype.bind=function(e){void 0===e&&(e=this.context.gl.FRAMEBUFFER),this.context.gl.bindFramebuffer(e,this._object),this._drawBuffersChanged&&this.context.gl2facade.drawBuffers&&(this.context.gl2facade.drawBuffers(this._drawBuffers),this._drawBuffersChanged=!1)},t.prototype.unbind=function(e){void 0===e&&(e=this.context.gl.FRAMEBUFFER),this.context.gl.bindFramebuffer(e,t.DEFAULT_FRAMEBUFFER)},t.prototype.clearColor=function(e,t){a.assert(void 0===t||0===t||this.context.isWebGL2||this.context.supportsDrawBuffers,"WebGL2 context expected for clearing multiple color attachments.");var r=e[3]<1&&!this.context.alpha;a.logIf(r,a.LogLevel.Dev,"context has alpha disabled, clear color alpha is ignored");var n=[e[0],e[1],e[2],r?1:e[3]];if(this.context.premultipliedAlpha&&!r&&(n[0]*=n[3],n[1]*=n[3],n[2]*=n[3]),t)this._clearColors[t]=n;else for(var i=0;i<this._clearColors.length;++i)this._clearColors[i]=n},t.prototype.clearDepth=function(e){this._clearDepth=e},t.prototype.clearStencil=function(e){this._clearStencil=e},t.prototype.texture=function(e){return this._texturesByAttachment.get(e)},t.prototype.resize=function(e,t,r,n){void 0===r&&(r=!0),void 0===n&&(n=!0),this._buffersByAttachment.forEach(function(i){i.resize(e,t,r,n)}),this._texturesByAttachment.forEach(function(i){i.resize(e,t,r,n)})},Object.defineProperty(t.prototype,"width",{get:function(){this.assertInitialized();var e=NaN;return this._buffersByAttachment.forEach(function(t){(isNaN(e)||t.width<e)&&(e=t.width)}),this._texturesByAttachment.forEach(function(t){(isNaN(e)||t.width<e)&&(e=t.width)}),e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){this.assertInitialized();var e=NaN;return this._buffersByAttachment.forEach(function(t){(isNaN(e)||t.height<e)&&(e=t.height)}),this._texturesByAttachment.forEach(function(t){(isNaN(e)||t.height<e)&&(e=t.height)}),e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return[this.width,this.height]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"drawBuffers",{get:function(){return this.assertInitialized(),this._drawBuffers},set:function(e){this.assertInitialized();for(var t=this.context.gl2facade,r=0,n=e;r<n.length;r++){var i=n[r];a.assert(this.hasAttachment(i),"valid attachment expected for draw buffer, given "+i),a.assert(i>=t.COLOR_ATTACHMENT_MIN&&i<=t.COLOR_ATTACHMENT_MAX,"color attachment expected for draw buffer, given "+i),this._drawBuffersChanged=this._drawBuffersChanged||-1===this._drawBuffers.indexOf(i)}this._drawBuffersChanged=this._drawBuffersChanged||e.length!==this._drawBuffers.length,this._drawBuffersChanged&&(this._drawBuffers=e)},enumerable:!0,configurable:!0}),t.DEFAULT_FRAMEBUFFER=void 0,o([s.Initializable.assert_initialized()],t.prototype,"es2Clear",null),o([s.Initializable.assert_initialized()],t.prototype,"es3Clear",null),o([s.Initializable.assert_initialized()],t.prototype,"bind",null),o([s.Initializable.assert_initialized()],t.prototype,"unbind",null),o([s.Initializable.assert_initialized()],t.prototype,"clearColor",null),o([s.Initializable.assert_initialized()],t.prototype,"clearDepth",null),o([s.Initializable.assert_initialized()],t.prototype,"clearStencil",null),o([s.Initializable.assert_initialized()],t.prototype,"texture",null),o([s.Initializable.assert_initialized()],t.prototype,"resize",null),t}(u.AbstractObject);t.Framebuffer=f},function(e,t,r){"use strict";var n,i=r(2),o=r(3),a=r(0);!function(e){function t(e){return a.assert(2===e.length,"expected length of buffer to be 2, given "+e.length),[e[0],e[1]]}function r(e){return a.assert(3===e.length,"expected length of buffer to be 3, given "+e.length),[e[0],e[1],e[2]]}function n(e){return a.assert(4===e.length,"expected length of buffer to be 4, given "+e.length),[e[0],e[1],e[2],e[3]]}e.tuple2=t,e.tuple3=r,e.tuple4=n,e.clampf=function(e,t){var r=o.clamp(e,0,1);return a.logIf(void 0!==t&&e<0||e>1,a.LogLevel.User,t+" clamped to ["+r+"], given ["+e+"]"),r},e.clampf2=function(e,r){var n=i.vec2.fromValues(e[0],e[1]);return(e[0]<0||e[0]>1||e[1]<0||e[1]>1)&&(o.clamp2(n,n,i.vec2.fromValues(0,0),i.vec2.fromValues(1,1)),a.logIf(void 0!==r,a.LogLevel.User,r+" clamped to ["+n+"], given ["+e+"]")),t(n)},e.clampf3=function(e,t){var n=i.vec3.fromValues(e[0],e[1],e[2]);return(e[0]<0||e[0]>1||e[1]<0||e[1]>1||e[2]<0||e[2]>1)&&(o.clamp3(n,n,i.vec3.fromValues(0,0,0),i.vec3.fromValues(1,1,1)),a.logIf(void 0!==t,a.LogLevel.User,t+" clamped to ["+n+"], given ["+e+"]")),r(n)},e.clampf4=function(e,t){var r=i.vec4.fromValues(e[0],e[1],e[2],e[3]);return(e[0]<0||e[0]>1||e[1]<0||e[1]>1||e[2]<0||e[2]>1||e[3]<0||e[3]>1)&&(o.clamp4(r,r,i.vec4.fromValues(0,0,0,0),i.vec4.fromValues(1,1,1,1)),a.logIf(void 0!==t,a.LogLevel.User,t+" clamped to ["+r+"], given ["+e+"]")),n(r)},e.duplicate2=function(e){return[e[0],e[1]]},e.duplicate3=function(e){return[e[0],e[1],e[2]]},e.duplicate4=function(e){return[e[0],e[1],e[2],e[3]]},e.equals2=function(e,t){return e[0]===t[0]&&e[1]===t[1]},e.equals3=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},e.equals4=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}}(n||(n={})),e.exports=n},function(e,t){e.exports="\r\nprecision lowp float;\r\n\r\n\r\n#if __VERSION__ == 100\r\n#else \r\n    #define varying out\r\n#endif\r\n\r\n\r\n\r\n#if __VERSION__ == 100\r\n    attribute vec2 a_vertex;\r\n#else \r\n    in vec2 a_vertex;\r\n#endif\r\n\r\n\r\nvarying vec2 v_uv;\r\n\r\n\r\nvoid main(void)\r\n{\r\n    v_uv = a_vertex * 0.5 + 0.5;\r\n    gl_Position = vec4(a_vertex, 0.0, 1.0);\r\n}\r\n"},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0});var a=r(1),s=r(31),u=function(e){function t(t,r){var n=e.call(this)||this;return n._buffers=new Array,r=void 0!==r&&""!==r?r:n.constructor.name,n._vertexArray=new s.VertexArray(t,r+"VAO"),n}return i(t,e),t.prototype.initialize=function(){for(var e=this,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(var n=t[0],i=t[1],o=!0,a=0;a<this._buffers.length;++a)o=this._buffers[a].initialize(n[a])&&o;return this._vertexArray.initialize(function(){return e.bindBuffers(i)},function(){return e.unbindBuffers(i)}),this._vertexArray.valid&&o},t.prototype.uninitialize=function(){this._vertexArray.uninitialize(),this._buffers.forEach(function(e){return e.uninitialize()});for(var e=0,t=this._buffers;e<t.length;e++){t[e].uninitialize()}},t.prototype.bind=function(){this._vertexArray.bind()},t.prototype.unbind=function(){this._vertexArray.unbind()},Object.defineProperty(t.prototype,"buffers",{get:function(){return this._buffers},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"context",{get:function(){return this._vertexArray.context},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"vertexArray",{get:function(){return this._vertexArray},enumerable:!0,configurable:!0}),o([a.Initializable.initialize()],t.prototype,"initialize",null),o([a.Initializable.uninitialize()],t.prototype,"uninitialize",null),o([a.Initializable.assert_initialized()],t.prototype,"bind",null),o([a.Initializable.assert_initialized()],t.prototype,"unbind",null),t}(a.Initializable);t.Geometry=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);t.byteSizeOfFormat=function(e,t){var r=e.gl,i=e.gl2facade,o=e.supportsDepthTexture?e.depthTexture.UNSIGNED_INT_24_8_WEBGL:void 0;switch(t){case void 0:default:break;case r.UNSIGNED_BYTE:case r.UNSIGNED_SHORT_5_6_5:case r.UNSIGNED_SHORT_4_4_4_4:case r.UNSIGNED_SHORT_5_5_5_1:case r.UNSIGNED_SHORT:case r.UNSIGNED_INT:case o:case r.FLOAT:case i.HALF_FLOAT:case r.BYTE:case r.UNSIGNED_SHORT:case r.SHORT:case r.UNSIGNED_INT:case r.INT:case r.HALF_FLOAT:case r.FLOAT:case r.UNSIGNED_INT_2_10_10_10_REV:case r.UNSIGNED_INT_10F_11F_11F_REV:case r.UNSIGNED_INT_5_9_9_9_REV:case r.UNSIGNED_INT_24_8:case r.FLOAT_32_UNSIGNED_INT_24_8_REV:return n.assert(!1,"expected format instead of type "+t),0}var a=e.supportsSRGB?e.sRGB.SRGB8_ALPHA8_EXT:void 0,s=e.supportsSRGB?e.sRGB.SRGB_EXT:void 0,u=e.supportsSRGB?e.sRGB.SRGB_ALPHA_EXT:void 0,c=e.supportsColorBufferFloat?e.colorBufferFloat.RGB32F_EXT:void 0,l=e.supportsColorBufferFloat?e.colorBufferFloat.RGBA32F_EXT:void 0;switch(t){case void 0:default:return n.assert(!1,"size of format "+t+" is unknown"),0;case r.ALPHA:case r.LUMINANCE:case r.R8:case r.R8I:case r.R8UI:case r.STENCIL_INDEX8:return 1;case r.DEPTH_COMPONENT16:case r.LUMINANCE_ALPHA:case r.R16F:case r.R16I:case r.R16UI:case r.RG8:case r.RG8I:case r.RG8UI:case r.RGB565:case r.RGB5_A1:case r.RGBA4:return 2;case r.DEPTH_COMPONENT24:case r.RGB:case r.RGB8:case r.RGB8UI:case r.SRGB:case s:case r.SRGB8:return 3;case r.DEPTH_STENCIL:case r.DEPTH24_STENCIL8:case r.DEPTH_COMPONENT32F:case r.R11F_G11F_B10F:case r.R32F:case r.R32I:case r.R32UI:case r.RG16F:case r.RG16I:case r.RG16UI:case r.RGB10_A2:case r.RGB10_A2UI:case r.RGB9_E5:case r.RGBA:case r.RGBA8:case r.RGBA8I:case r.RGBA8UI:case r.SRGB8_ALPHA8:case a:case r.SRGB_ALPHA:case u:case r.SRGB_ALPHA8:case r.SRGB_APLHA8:return 4;case r.DEPTH32F_STENCIL8:return 5;case r.RGB16F:return 6;case r.RG32F:case r.RG32I:case r.RG32UI:case r.RGBA16F:case r.RGBA16I:case r.RGBA16UI:return 8;case r.RGB32F:case r.RGB32F:case c:return 12;case r.RGBA32F:case l:case r.RGBA32I:case r.RGBA32UI:return 16;case r.DEPTH_COMPONENT:case r.DEPTH_STENCIL:return n.assert(!1,"byte size of DEPTH_COMPONENT or DEPTH_STENCIL formats depends on active render buffer"),0}}},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),s=r(1),u=function(e){function t(){var r=null!==e&&e.apply(this,arguments)||this;return r._target=t.DEFAULT_BUFFER,r}return i(t,e),t.prototype.create=function(e){var t=this._context.gl;return this._object=t.createBuffer(),this._valid=this._object instanceof WebGLBuffer,this._valid&&(a.assert(e===t.ARRAY_BUFFER||e===t.ELEMENT_ARRAY_BUFFER,"either ARRAY_BUFFER or ELEMENT_ARRAY_BUFFER expected as buffer target"),this._target=e),this._object},t.prototype.delete=function(){a.assert(this._object instanceof WebGLBuffer,"expected WebGLBuffer object"),this._context.gl.deleteBuffer(this._object),this._object=void 0,this._valid=!1,this._target=t.DEFAULT_BUFFER},t.prototype.bind=function(){a.assert(this._target===this._context.gl.ARRAY_BUFFER||this._target===this._context.gl.ELEMENT_ARRAY_BUFFER,"expected either ARRAY_BUFFER or ELEMENT_ARRAY_BUFFER as buffer target"),this._context.gl.bindBuffer(this._target,this._object)},t.prototype.unbind=function(){this.context.gl.bindBuffer(this._target,t.DEFAULT_BUFFER)},t.prototype.data=function(e,t,r,n){void 0===r&&(r=!0),void 0===n&&(n=!0);var i=this.context.gl;r&&this.bind(),i.bufferData(this._target,e,t),n&&this.unbind(),this._valid=i.isBuffer(this._object)&&i.getError()===i.NO_ERROR;var o=this._valid?e.byteLength:0;this.context.allocationRegister.reallocate(this._identifier,o)},t.prototype.attribEnable=function(e,t,r,n,i,o,a,s){void 0===n&&(n=!1),void 0===i&&(i=0),void 0===o&&(o=0),void 0===a&&(a=!0),void 0===s&&(s=!0);var u=this.context.gl;a&&this.bind(),u.vertexAttribPointer(e,t,r,n,i,o),u.enableVertexAttribArray(e),s&&this.unbind()},t.prototype.attribDisable=function(e,t,r){void 0===t&&(t=!0),void 0===r&&(r=!0);var n=this.context.gl;t&&this.bind(),n.disableVertexAttribArray(e),r&&this.unbind()},Object.defineProperty(t.prototype,"bytes",{get:function(){return this.assertInitialized(),this.context.allocationRegister.allocated(this._identifier)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"target",{get:function(){return this.assertInitialized(),this._target},enumerable:!0,configurable:!0}),t.DEFAULT_BUFFER=void 0,o([s.Initializable.assert_initialized()],t.prototype,"bind",null),o([s.Initializable.assert_initialized()],t.prototype,"unbind",null),o([s.Initializable.assert_initialized()],t.prototype,"data",null),o([s.Initializable.assert_initialized()],t.prototype,"attribEnable",null),o([s.Initializable.assert_initialized()],t.prototype,"attribDisable",null),t}(r(4).AbstractObject);t.Buffer=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=function(){function e(){}return e.alter=function(t,r){n.assert(r.hasOwnProperty("any"),"expected alterable object to provide 'any' key"),r.any=!0;var i=t.split("."),o=i.shift();if(n.assert(""===o||r.hasOwnProperty(o),"expected object to have key '"+o+"' in order to capture alterations"),""===o||"object"==typeof r[o])if(""!==o&&i.length>0)e.alter(i.join("."),r[o]);else for(var a=""!==o?r[o]:r,s=0,u=Object.getOwnPropertyNames(a);s<u.length;s++){var c=u[s];"any"!==c&&e.alter(c,a)}else r[o]=!0},e.reset=function(t){for(var r=0,n=Object.getOwnPropertyNames(t);r<n.length;r++){var i=n[r];"object"!=typeof t[i]?t[i]=!1:e.reset(t[i])}},e.prototype.alter=function(t){return e.alter(t,this)},e.prototype.reset=function(){return e.reset(this)},e}();t.ChangeLookup=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=function(){function e(){}return e.queryAndCacheAPI=function(){if(void 0===e._exit){for(var t=window.document,r=[t.exitPointerLock,t.mozExitPointerLock,t.webkitExitPointerLock,void 0],i=0;i<r.length&&void 0===r[i];++i);switch(i){case 0:e._exit=function(){return t.exitPointerLock()},e._request=function(e){return e.requestPointerLock()},e._element=function(){return t.pointerLockElement};break;case 1:e._exit=function(){return t.mozCancelPointerLock()},e._request=function(e){return e.mozRequestPointerLock()},e._element=function(){return t.mozPointerLockElement};break;case 2:e._exit=function(){return t.webkitExitPointerLock()},e._request=function(e){return e.webkitRequestPointerLock()},e._element=function(){return t.webkitPointerLockElement};break;default:n.assert(!1,"none of the following pointer lock apis was found: native, moz, or webkit")}}},e.active=function(t){return void 0!==this._element&&(void 0!==t&&e._element()===t||void 0===t&&void 0!==e._element()&&null!==e._element())},e.request=function(t,r){void 0!==t&&(e.queryAndCacheAPI(),e.active()&&e._element()!==t&&e._exit(),e.active()||e._request(t))},e.exit=function(){e._exit&&e._exit()},e}();t.PointerLock=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(6),i=r(0),o=r(18),a=function(){function e(e,t){var r=this;this._pointerLockRequestPending=!1,i.assert(void 0!==e,"expected valid canvas element on initialization, given "+e),this._element=e,this._timeframe=t,this._element.addEventListener("click",function(){return r.processPointerLockRequests()})}return e.prototype.processPointerLockRequests=function(){this._pointerLockRequestPending&&o.PointerLock.request(this._element)},e.prototype.observable=function(t){switch(t){case e.Type.Click:return this.clickObservable;case e.Type.Enter:return this.enterObservable;case e.Type.Leave:return this.leaveObservable;case e.Type.Down:return this.downObservable;case e.Type.Up:return this.upObservable;case e.Type.Move:return this.moveObservable;case e.Type.Wheel:return this.wheelObservable}},Object.defineProperty(e.prototype,"pointerLock",{get:function(){return o.PointerLock.active(this._element)},set:function(e){this._pointerLockRequestPending=e,!1===e&&(this._pointerLockRequestPending=!1,o.PointerLock.exit())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"clickObservable",{get:function(){var e=this;return void 0===this._clickSubject&&(this._clickSubject=new n.ReplaySubject(void 0,this._timeframe),this._clickListener=function(t){return e._clickSubject.next(t)},this._element.onclick=this._clickListener),this._clickSubject.asObservable()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enterObservable",{get:function(){var e=this;return void 0===this._enterSubject&&(this._enterSubject=new n.ReplaySubject(void 0,this._timeframe),this._enterListener=function(t){return e._enterSubject.next(t)},this._element.onmouseenter=this._enterListener),this._enterSubject.asObservable()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leaveObservable",{get:function(){var e=this;return void 0===this._leaveSubject&&(this._leaveSubject=new n.ReplaySubject(void 0,this._timeframe),this._leaveListener=function(t){return e._leaveSubject.next(t)},this._element.onmouseleave=this._leaveListener),this._leaveSubject.asObservable()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"downObservable",{get:function(){var e=this;return void 0===this._downSubject&&(this._downSubject=new n.ReplaySubject(void 0,this._timeframe),this._downListener=function(t){return e._downSubject.next(t)},this._element.onmousedown=this._downListener),this._downSubject.asObservable()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"upObservable",{get:function(){var e=this;return void 0===this._upSubject&&(this._upSubject=new n.ReplaySubject(void 0,this._timeframe),this._upListener=function(t){return e._upSubject.next(t)},this._element.onmouseup=this._upListener),this._upSubject.asObservable()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"moveObservable",{get:function(){var e=this;return void 0===this._moveSubject&&(this._moveSubject=new n.ReplaySubject(void 0,this._timeframe),this._moveListener=function(t){return e._moveSubject.next(t)},this._element.onmousemove=this._moveListener),this._moveSubject.asObservable()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"wheelObservable",{get:function(){var e=this;return void 0===this._wheelSubject&&(this._wheelSubject=new n.ReplaySubject(void 0,this._timeframe),this._wheelListener=function(t){return e._wheelSubject.next(t)},this._element.onwheel=this._wheelListener),this._wheelSubject.asObservable()},enumerable:!0,configurable:!0}),e}();t.MouseEventProvider=a,function(e){!function(e){e[e.Click=0]="Click",e[e.Enter=1]="Enter",e[e.Leave=2]="Leave",e[e.Down=3]="Down",e[e.Up=4]="Up",e[e.Move=5]="Move",e[e.Wheel=6]="Wheel"}(e.Type||(e.Type={}))}(a=t.MouseEventProvider||(t.MouseEventProvider={})),t.MouseEventProvider=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=r(0),o=r(60),a=r(36),s=r(34),u=r(58);!function(e){e[e.Invalid=0]="Invalid",e[e.WebGL1=1]="WebGL1",e[e.WebGL2=2]="WebGL2"}(n=t.BackendType||(t.BackendType={}));var c=function(){function e(e,t){this._extensions=new Array,this._allocationRegister=new o.AllocationRegister,this._context=e,this._mask=t;var r=e.toString(),a=/WebGLRenderingContext/.test(r)||/CaptureContext/.test(r),s=/WebGL2RenderingContext/.test(r);if(this._backend=a?n.WebGL1:s?n.WebGL2:void 0,i.assert(void 0!==this._backend&&this._backend.valueOf()!==n.Invalid.valueOf(),"context is neither webgl nor webgl2, given "+r),this.queryExtensionSupport(),this._mask&&this._mask.functionsUndefine)for(var c in this._mask.functionsUndefine)this._context[c]=void 0;this._gl2=new u.GL2Facade(this)}return e.createMasqueradeFromGETorDataAttribute=function(e){var t=a.ContextMasquerade.fromGET();return t||(e.msqrdH?a.ContextMasquerade.fromHash(e.msqrdH):e.msqrdP?a.ContextMasquerade.fromPreset(e.msqrdP):void 0)},e.request=function(t){var r,n=t.dataset,o=e.createMasqueradeFromGETorDataAttribute(n),a=o?o.backend:n.backend?n.backend.toLowerCase():"";switch(a||(i.log(i.LogLevel.Dev,"unknown backend '"+n.backend+"' changed to 'auto'"),a="auto"),a){case"webgl":break;case"experimental-webgl":case"experimental-webgl1":case"webgl1":a="webgl";break;case"experimental-webgl2":case"webgl2":a="webgl2";break;default:a="auto"}return"webgl"!==a&&(r=this.requestWebGL2(t)),r||(r=this.requestWebGL1(t),i.logIf(void 0!==r&&"webgl2"===a,i.LogLevel.Dev,"backend changed to 'webgl', given '"+a+"'")),i.assert(!!r,"creating a context failed"),new e(r,o)},e.requestWebGL1=function(t){var r=t.getContext("webgl",e.CONTEXT_ATTRIBUTES);return r||(r=t.getContext("experimental-webgl",e.CONTEXT_ATTRIBUTES))},e.requestWebGL2=function(t){var r=t.getContext("webgl2",e.CONTEXT_ATTRIBUTES);return r||(r=t.getContext("experimental-webgl2",e.CONTEXT_ATTRIBUTES))},Object.defineProperty(e.prototype,"alpha",{get:function(){return this._context.getContextAttributes().alpha},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"antialias",{get:function(){return this._context.getContextAttributes().antialias},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"depth",{get:function(){return this._context.getContextAttributes().depth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"failIfMajorPerformanceCaveat",{get:function(){return this._context.getContextAttributes().failIfMajorPerformanceCaveat},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"premultipliedAlpha",{get:function(){return this._context.getContextAttributes().premultipliedAlpha},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preserveDrawingBuffer",{get:function(){return this._context.getContextAttributes().preserveDrawingBuffer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stencil",{get:function(){return this._context.getContextAttributes().stencil},enumerable:!0,configurable:!0}),e.prototype.supports=function(e){if(this._mask&&this._mask.extensionsConceal.indexOf(e)>-1)return!1;switch(this._backend){case n.WebGL1:i.assert(s.WEBGL1_EXTENSIONS.indexOf(e)>-1,"extension "+e+" not available to WebGL1");break;case n.WebGL2:i.assert(-1===s.WEBGL2_DEFAULT_EXTENSIONS.indexOf(e),"extension "+e+" supported by default in WebGL2"),i.assert(s.WEBGL2_EXTENSIONS.indexOf(e)>-1,"extension "+e+" not available to WebGL2")}return this._extensions.indexOf(e)>-1},e.prototype.queryExtensionSupport=function(){this._extensions=this._context.getSupportedExtensions(),this._backend===n.WebGL1&&(this.ANGLE_instanced_arrays_supported=this.supports("ANGLE_instanced_arrays"),this.EXT_blend_minmax_supported=this.supports("EXT_blend_minmax"),this.EXT_color_buffer_half_float_supported=this.supports("EXT_color_buffer_half_float"),this.EXT_disjoint_timer_query_supported=this.supports("EXT_disjoint_timer_query"),this.EXT_frag_depth_supported=this.supports("EXT_frag_depth"),this.EXT_sRGB_supported=this.supports("EXT_sRGB"),this.EXT_shader_texture_lod_supported=this.supports("EXT_shader_texture_lod"),this.OES_element_index_uint_supported=this.supports("OES_element_index_uint"),this.OES_standard_derivatives_supported=this.supports("OES_standard_derivatives"),this.OES_texture_float_supported=this.supports("OES_texture_float"),this.OES_texture_half_float_supported=this.supports("OES_texture_half_float"),this.OES_vertex_array_object_supported=this.supports("OES_vertex_array_object"),this.WEBGL_color_buffer_float_supported=this.supports("WEBGL_color_buffer_float"),this.WEBGL_depth_texture_supported=this.supports("WEBGL_depth_texture"),this.WEBGL_draw_buffers_supported=this.supports("WEBGL_draw_buffers")),this._backend===n.WebGL2&&(this.EXT_color_buffer_float_supported=this.supports("EXT_color_buffer_float"),this.EXT_disjoint_timer_query_webgl2_supported=this.supports("EXT_disjoint_timer_query_webgl2")),this.EXT_texture_filter_anisotropic_supported=this.supports("EXT_texture_filter_anisotropic"),this.OES_texture_float_linear_supported=this.supports("OES_texture_float_linear"),this.OES_texture_half_float_linear_supported=this.supports("OES_texture_half_float_linear"),this.WEBGL_compressed_texture_astc_supported=this.supports("WEBGL_compressed_texture_astc"),this.WEBGL_compressed_texture_atc_supported=this.supports("WEBGL_compressed_texture_atc"),this.WEBGL_compressed_texture_etc_supported=this.supports("WEBGL_compressed_texture_etc"),this.WEBGL_compressed_texture_etc1_supported=this.supports("WEBGL_compressed_texture_etc1"),this.WEBGL_compressed_texture_pvrtc_supported=this.supports("WEBGL_compressed_texture_pvrtc"),this.WEBGL_compressed_texture_s3tc_supported=this.supports("WEBGL_compressed_texture_s3tc"),this.WEBGL_compressed_texture_s3tc_srgb_supported=this.supports("WEBGL_compressed_texture_s3tc_srgb"),this.WEBGL_debug_renderer_info_supported=this.supports("WEBGL_debug_renderer_info"),this.WEBGL_debug_shaders_supported=this.supports("WEBGL_debug_shaders"),this.WEBGL_lose_context_supported=this.supports("WEBGL_lose_context")},e.prototype.extension=function(e,t){return void 0===e&&(i.assert(this.supports(t),"extension "+t+" expected to be supported"),e=this._context.getExtension(t)),e},Object.defineProperty(e.prototype,"allocationRegister",{get:function(){return this._allocationRegister},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"backend",{get:function(){return this._backend},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"backendString",{get:function(){switch(this._backend){case n.WebGL1:return"WebGL";case n.WebGL2:return"WebGL2";default:return}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"extensions",{get:function(){return this._extensions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mask",{get:function(){return this._mask},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gl",{get:function(){return this._context},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gl2facade",{get:function(){return this._gl2},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isWebGL1",{get:function(){return this._backend===n.WebGL1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isWebGL2",{get:function(){return this._backend===n.WebGL2},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsInstancedArrays",{get:function(){return this.ANGLE_instanced_arrays_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"instancedArrays",{get:function(){return this.extension(this.ANGLE_instanced_arrays,"ANGLE_instanced_arrays")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsBlendMinmax",{get:function(){return this.EXT_blend_minmax_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blendMinmax",{get:function(){return this.extension(this.EXT_blend_minmax,"EXT_blend_minmax")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsColorBufferHalfFloat",{get:function(){return this.EXT_color_buffer_half_float_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"colorBufferHalfFloat",{get:function(){return this.extension(this.EXT_color_buffer_half_float,"EXT_color_buffer_half_float")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsDisjointTimerQuery",{get:function(){return this.EXT_disjoint_timer_query_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"disjointTimerQuery",{get:function(){return this.extension(this.EXT_disjoint_timer_query,"EXT_disjoint_timer_query")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsDisjointTimerQueryWebGL2",{get:function(){return this.EXT_disjoint_timer_query_webgl2_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"disjointTimerQueryWebGL2",{get:function(){return this.extension(this.EXT_disjoint_timer_query_webgl2,"EXT_disjoint_timer_query_webgl2")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsFragDepth",{get:function(){return this.EXT_frag_depth_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fragDepth",{get:function(){return this.extension(this.EXT_frag_depth,"EXT_frag_depth")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsSRGB",{get:function(){return this.EXT_sRGB_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sRGB",{get:function(){return this.extension(this.EXT_sRGB,"EXT_sRGB")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsShaderTextureLOD",{get:function(){return this.EXT_shader_texture_lod_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shaderTextureLOD",{get:function(){return this.extension(this.EXT_shader_texture_lod,"EXT_shader_texture_lod")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsTextureFilterAnisotropic",{get:function(){return this.EXT_texture_filter_anisotropic_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textureFilterAnisotropic",{get:function(){return this.extension(this.EXT_texture_filter_anisotropic,"EXT_texture_filter_anisotropic")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsElementIndexUint",{get:function(){return this.OES_element_index_uint_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"elementIndexUint",{get:function(){return this.extension(this.OES_element_index_uint,"OES_element_index_uint")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsStandardDerivatives",{get:function(){return this.OES_standard_derivatives_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"standardDerivatives",{get:function(){return this.extension(this.OES_standard_derivatives,"OES_standard_derivatives")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsTextureFloat",{get:function(){return this.OES_texture_float_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textureFloat",{get:function(){return this.extension(this.OES_texture_float,"OES_texture_float")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsTextureFloatLinear",{get:function(){return this.OES_texture_float_linear_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textureFloatLinear",{get:function(){return this.extension(this.OES_texture_float_linear,"OES_texture_float_linear")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsTextureHalfFloat",{get:function(){return this.OES_texture_half_float_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textureHalfFloat",{get:function(){return this.extension(this.OES_texture_half_float,"OES_texture_half_float")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsTextureHalfFloatLinear",{get:function(){return this.OES_texture_half_float_linear_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textureHalfFloatLinear",{get:function(){return this.extension(this.OES_texture_half_float_linear,"OES_texture_half_float_linear")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsVertexArrayObject",{get:function(){return this.OES_vertex_array_object_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vertexArrayObject",{get:function(){return this.extension(this.OES_vertex_array_object,"OES_vertex_array_object")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsColorBufferFloat",{get:function(){switch(this._backend){case n.WebGL1:return this.WEBGL_color_buffer_float_supported;case n.WebGL2:return this.EXT_color_buffer_float_supported;default:return}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"colorBufferFloat",{get:function(){switch(this._backend){case n.WebGL1:return this.extension(this.WEBGL_color_buffer_float,"WEBGL_color_buffer_float");case n.WebGL2:return this.extension(this.EXT_color_buffer_float,"EXT_color_buffer_float");default:return}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsCompressedTextureASTC",{get:function(){return this.WEBGL_compressed_texture_astc_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"compressedTextureASTC",{get:function(){return this.extension(this.WEBGL_compressed_texture_astc,"WEBGL_compressed_texture_astc")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsCompressedTextureATC",{get:function(){return this.WEBGL_compressed_texture_atc_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"compressedTextureATC",{get:function(){return this.extension(this.WEBGL_compressed_texture_atc,"WEBGL_compressed_texture_atc")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsCompressedTextureETC",{get:function(){return this.WEBGL_compressed_texture_etc_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"compressedTextureETC",{get:function(){return this.extension(this.WEBGL_compressed_texture_etc,"WEBGL_compressed_texture_etc")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsCompressedTextureETC1",{get:function(){return this.WEBGL_compressed_texture_etc1_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"compressedTextureETC1",{get:function(){return this.extension(this.WEBGL_compressed_texture_etc1,"WEBGL_compressed_texture_etc1")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsCompressedTexturePVRTC",{get:function(){return this.WEBGL_compressed_texture_pvrtc_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"compressedTexturePVRTC",{get:function(){return this.extension(this.WEBGL_compressed_texture_pvrtc,"WEBGL_compressed_texture_pvrtc")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsCompressedTextureS3TC",{get:function(){return this.WEBGL_compressed_texture_s3tc_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"compressedTextureS3TC",{get:function(){return this.extension(this.WEBGL_compressed_texture_s3tc,"WEBGL_compressed_texture_s3tc")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsCompressedTextureS3TCSRGB",{get:function(){return this.WEBGL_compressed_texture_s3tc_srgb_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"compressedTextureS3TCSRGB",{get:function(){return this.extension(this.WEBGL_compressed_texture_s3tc_srgb,"WEBGL_compressed_texture_s3tc_srgb")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsDebugRendererInfo",{get:function(){return this.WEBGL_debug_renderer_info_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"debugRendererInfo",{get:function(){return this.extension(this.WEBGL_debug_renderer_info,"WEBGL_debug_renderer_info")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsDebugShaders",{get:function(){return this.WEBGL_debug_shaders_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"debugShaders",{get:function(){return this.extension(this.WEBGL_debug_shaders,"WEBGL_debug_shaders")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsDepthTexture",{get:function(){return this.WEBGL_depth_texture_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"depthTexture",{get:function(){return this.extension(this.WEBGL_depth_texture,"WEBGL_depth_texture")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsDrawBuffers",{get:function(){return this.WEBGL_draw_buffers_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"drawBuffers",{get:function(){return this.extension(this.WEBGL_draw_buffers,"WEBGL_draw_buffers")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsLoseContext",{get:function(){return this.WEBGL_lose_context_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loseContext",{get:function(){return this.extension(this.WEBGL_lose_context,"WEBGL_lose_context")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsBlitFramebuffer",{get:function(){return void 0!==this._context.blitFramebuffer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsReadBuffer",{get:function(){return void 0!==this._context.readBuffer},enumerable:!0,configurable:!0}),e.CONTEXT_ATTRIBUTES={alpha:!0,antialias:!1,depth:!1,failIfMajorPerformanceCaveat:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,stencil:!1},e}();t.Context=c},function(e,t,r){"use strict";var n=r(43),i=t.ValidationError=function(e,t,r,n,i,o){n&&(this.property=n),e&&(this.message=e),r&&(r.id?this.schema=r.id:this.schema=r),t&&(this.instance=t),this.name=i,this.argument=o,this.stack=this.toString()};i.prototype.toString=function(){return this.property+" "+this.message};var o=t.ValidatorResult=function(e,t,r,n){this.instance=e,this.schema=t,this.propertyPath=n.propertyPath,this.errors=[],this.throwError=r&&r.throwError,this.disableFormat=r&&!0===r.disableFormat};function a(e,t){return t+": "+e.toString()+"\n"}o.prototype.addError=function(e){var t;if("string"==typeof e)t=new i(e,this.instance,this.schema,this.propertyPath);else{if(!e)throw new Error("Missing error detail");if(!e.message)throw new Error("Missing error message");if(!e.name)throw new Error("Missing validator type");t=new i(e.message,this.instance,this.schema,this.propertyPath,e.name,e.argument)}if(this.throwError)throw t;return this.errors.push(t),t},o.prototype.importErrors=function(e){"string"==typeof e||e&&e.validatorType?this.addError(e):e&&e.errors&&Array.prototype.push.apply(this.errors,e.errors)},o.prototype.toString=function(e){return this.errors.map(a).join("")},Object.defineProperty(o.prototype,"valid",{get:function(){return!this.errors.length}});var s=t.SchemaError=function e(t,r){this.message=t,this.schema=r,Error.call(this,t),Error.captureStackTrace(this,e)};s.prototype=Object.create(Error.prototype,{constructor:{value:s,enumerable:!1},name:{value:"SchemaError",enumerable:!1}});var u=t.SchemaContext=function(e,t,r,n,i){this.schema=e,this.options=t,this.propertyPath=r,this.base=n,this.schemas=i};u.prototype.resolve=function(e){return n.resolve(this.base,e)},u.prototype.makeChild=function(e,t){var r=void 0===t?this.propertyPath:this.propertyPath+l(t),i=n.resolve(this.base,e.id||""),o=new u(e,this.options,r,i,Object.create(this.schemas));return e.id&&!o.schemas[i]&&(o.schemas[i]=e),o};var c=t.FORMAT_REGEXPS={"date-time":/^\d{4}-(?:0[0-9]{1}|1[0-2]{1})-(3[01]|0[1-9]|[12][0-9])[tT ](2[0-4]|[01][0-9]):([0-5][0-9]):(60|[0-5][0-9])(\.\d+)?([zZ]|[+-]([0-5][0-9]):(60|[0-5][0-9]))$/,date:/^\d{4}-(?:0[0-9]{1}|1[0-2]{1})-(3[01]|0[1-9]|[12][0-9])$/,time:/^(2[0-4]|[01][0-9]):([0-5][0-9]):(60|[0-5][0-9])$/,email:/^(?:[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+\.)*[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+@(?:(?:(?:[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!\.)){0,61}[a-zA-Z0-9]?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!$)){0,61}[a-zA-Z0-9]?)|(?:\[(?:(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\.){3}(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\]))$/,"ip-address":/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,ipv6:/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,uri:/^[a-zA-Z][a-zA-Z0-9+-.]*:[^\s]*$/,color:/^(#?([0-9A-Fa-f]{3}){1,2}\b|aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|yellow|(rgb\(\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*\))|(rgb\(\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*\)))$/,hostname:/^(?=.{1,255}$)[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?(?:\.[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?)*\.?$/,"host-name":/^(?=.{1,255}$)[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?(?:\.[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?)*\.?$/,alpha:/^[a-zA-Z]+$/,alphanumeric:/^[a-zA-Z0-9]+$/,"utc-millisec":function(e){return"string"==typeof e&&parseFloat(e)===parseInt(e,10)&&!isNaN(e)},regex:function(e){var t=!0;try{new RegExp(e)}catch(e){t=!1}return t},style:/\s*(.+?):\s*([^;]+);?/g,phone:/^\+(?:[0-9] ?){6,14}[0-9]$/};c.regexp=c.regex,c.pattern=c.regex,c.ipv4=c["ip-address"],t.isFormat=function(e,t,r){if("string"==typeof e&&void 0!==c[t]){if(c[t]instanceof RegExp)return c[t].test(e);if("function"==typeof c[t])return c[t](e)}else if(r&&r.customFormats&&"function"==typeof r.customFormats[t])return r.customFormats[t](e);return!0};var l=t.makeSuffix=function(e){return(e=e.toString()).match(/[.\s\[\]]/)||e.match(/^[\d]/)?e.match(/^\d+$/)?"["+e+"]":"["+JSON.stringify(e)+"]":"."+e};function f(e,t){var r=Array.isArray(t),n=r&&[]||{};return r?(e=e||[],n=n.concat(e),t.forEach(function(e,t,r,n){"object"==typeof r?t[n]=f(e[n],r):-1===e.indexOf(r)&&t.push(r)}.bind(null,e,n))):(e&&"object"==typeof e&&Object.keys(e).forEach(function(e,t,r){t[r]=e[r]}.bind(null,e,n)),Object.keys(t).forEach(function(e,t,r,n){"object"==typeof t[n]&&t[n]&&e[n]?r[n]=f(e[n],t[n]):r[n]=t[n]}.bind(null,e,t,n))),n}function h(e){return"/"+encodeURIComponent(e).replace(/~/g,"%7E")}t.deepCompareStrict=function e(t,r){if(typeof t!=typeof r)return!1;if(t instanceof Array)return r instanceof Array&&(t.length===r.length&&t.every(function(n,i){return e(t[i],r[i])}));if("object"==typeof t){if(!t||!r)return t===r;var n=Object.keys(t),i=Object.keys(r);return n.length===i.length&&n.every(function(n){return e(t[n],r[n])})}return t===r},e.exports.deepMerge=f,t.objectGetPath=function(e,t){for(var r,n=t.split("/").slice(1);"string"==typeof(r=n.shift());){var i=decodeURIComponent(r.replace(/~0/,"~").replace(/~1/g,"/"));if(!(i in e))return;e=e[i]}return e},t.encodePath=function(e){return e.map(h).join("")},t.getDecimalPlaces=function(e){var t=0;if(isNaN(e))return t;"number"!=typeof e&&(e=Number(e));var r=e.toString().split("e");if(2===r.length){if("-"!==r[1][0])return t;t=Number(r[1].slice(1))}var n=r[0].split(".");return 2===n.length&&(t+=n[1].length),t}},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),s=r(15),u=r(1),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._internalFormat=void 0,t}return i(t,e),t.prototype.create=function(e,r,n){a.assert(e>0&&r>0,"renderbuffer object requires valid width and height greater than zero");var i=this.context.gl;this._object=i.createRenderbuffer(),this._width=e,this._height=r,this._internalFormat=n,i.bindRenderbuffer(i.RENDERBUFFER,this._object),i.renderbufferStorage(i.RENDERBUFFER,n,e,r),this._valid=i.isRenderbuffer(this._object),i.bindRenderbuffer(i.RENDERBUFFER,t.DEFAULT_RENDER_BUFFER);var o=e*r*s.byteSizeOfFormat(this.context,n);return this.context.allocationRegister.reallocate(this._identifier,o),this._object},t.prototype.delete=function(){a.assert(this._object instanceof WebGLRenderbuffer,"expected WebGLRenderbuffer object"),this.context.gl.deleteRenderbuffer(this._object),this._object=void 0,this._valid=!1,this._internalFormat=void 0,this._width=0,this._height=0},t.prototype.bind=function(){this.context.gl.bindRenderbuffer(this.context.gl.RENDERBUFFER,this._object)},t.prototype.unbind=function(){this.context.gl.bindRenderbuffer(this.context.gl.RENDERBUFFER,t.DEFAULT_RENDER_BUFFER)},t.prototype.resize=function(e,t,r,n){if(void 0===r&&(r=!1),void 0===n&&(n=!1),e!==this._width||t!==this._height){this._width=e,this._height=t;var i=this.context.gl;r&&this.bind(),i.renderbufferStorage(i.RENDERBUFFER,this._internalFormat,e,t),n&&this.unbind();var o=e*t*s.byteSizeOfFormat(this.context,this._internalFormat);this.context.allocationRegister.reallocate(this._identifier,o)}},Object.defineProperty(t.prototype,"bytes",{get:function(){return this.assertInitialized(),this.context.allocationRegister.allocated(this._identifier)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"internalFormat",{get:function(){return this.assertInitialized(),this._internalFormat},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.assertInitialized(),this._width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.assertInitialized(),this._height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return[this.width,this.height]},enumerable:!0,configurable:!0}),t.DEFAULT_RENDER_BUFFER=void 0,o([u.Initializable.assert_initialized()],t.prototype,"bind",null),o([u.Initializable.assert_initialized()],t.prototype,"unbind",null),o([u.Initializable.assert_initialized()],t.prototype,"resize",null),t}(r(4).AbstractObject);t.Renderbuffer=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=r(0),o=r(19),a=function(){function e(e,t){this._subscriptions=new Array,this._latestMouseEventsByType=new Map,this._previousMouseEventsByType=new Map,this._mouseEventHandlerByType=new Map,this._invalidate=e,this._mouseEventProvider=t}return e.prototype.invalidate=function(e){void 0===e&&(e=!1),this._invalidate&&this._invalidate(e)},e.prototype.pushMouseEventHandler=function(e,t){var r=this;if(!this._mouseEventHandlerByType.has(e)){this._mouseEventHandlerByType.set(e,new Array),this._previousMouseEventsByType.set(e,new Array);var n=new Array;this._latestMouseEventsByType.set(e,n),i.assert(void 0!==this._mouseEventProvider,"expected valid mouse event provider");var a=this._mouseEventProvider.observable(e);switch(e){case o.MouseEventProvider.Type.Wheel:default:this._subscriptions.push(a.subscribe(function(e){n.push(e),r.invalidate()}))}}this._mouseEventHandlerByType.get(e).push(t)},e.prototype.invokeMouseEventHandler=function(e){var t=this._mouseEventHandlerByType.get(e);if(void 0!==t&&0!==t.length){var r=this._latestMouseEventsByType.get(e);if(0!==r.length){var n=this._previousMouseEventsByType.get(e);t.forEach(function(e){return e(r,n)}),Object.assign(n,r),r.length=0}}},e.prototype.dispose=function(){this._latestMouseEventsByType.forEach(function(e){return e.length=0}),this._previousMouseEventsByType.forEach(function(e){return e.length=0});for(var e=0,t=this._subscriptions;e<t.length;e++){t[e].unsubscribe()}},e.prototype.update=function(){this.invokeMouseEventHandler(o.MouseEventProvider.Type.Click),this.invokeMouseEventHandler(o.MouseEventProvider.Type.Enter),this.invokeMouseEventHandler(o.MouseEventProvider.Type.Leave),this.invokeMouseEventHandler(o.MouseEventProvider.Type.Down),this.invokeMouseEventHandler(o.MouseEventProvider.Type.Up),this.invokeMouseEventHandler(o.MouseEventProvider.Type.Move),this.invokeMouseEventHandler(o.MouseEventProvider.Type.Wheel)},e.prototype.offsets=function(e,t){void 0===t&&(t=!0);var r=new Array;if(e instanceof MouseEvent){var i=e;r.push(n.vec2.fromValues(i.clientX,i.clientY))}else if(e instanceof WheelEvent){i=e;r.push(n.vec2.fromValues(i.clientX,i.clientY))}else if(e instanceof TouchEvent){i=e;for(var o=0;o<i.touches.length;++o){var a=i.touches[o];r.push(n.vec2.fromValues(a.clientX,a.clientY))}}for(var s=(e.target||e.currentTarget||e.srcElement).getBoundingClientRect(),u=0,c=r;u<c.length;u++){var l=c[u];l[0]=Math.floor(l[0]-s.left),l[1]=Math.floor(l[1]-s.top),t&&n.vec2.scale(l,l,window.devicePixelRatio)}return r},e.prototype.pushClickHandler=function(e){this.pushMouseEventHandler(o.MouseEventProvider.Type.Click,e)},e.prototype.pushMouseEnterHandler=function(e){this.pushMouseEventHandler(o.MouseEventProvider.Type.Enter,e)},e.prototype.pushMouseLeaveHandler=function(e){this.pushMouseEventHandler(o.MouseEventProvider.Type.Leave,e)},e.prototype.pushMouseDownHandler=function(e){this.pushMouseEventHandler(o.MouseEventProvider.Type.Down,e)},e.prototype.pushMouseUpHandler=function(e){this.pushMouseEventHandler(o.MouseEventProvider.Type.Up,e)},e.prototype.pushMouseMoveHandler=function(e){this.pushMouseEventHandler(o.MouseEventProvider.Type.Move,e)},e.prototype.pushMouseWheelHandler=function(e){this.pushMouseEventHandler(o.MouseEventProvider.Type.Wheel,e)},e.prototype.requestPointerLock=function(){this._mouseEventProvider&&(this._mouseEventProvider.pointerLock=!0)},e.prototype.exitPointerLock=function(){this._mouseEventProvider&&(this._mouseEventProvider.pointerLock=!1)},e}();t.EventHandler=a},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),a=function(){function e(e,t,r,n){void 0===r&&(r=1),void 0===n&&(n=1),this._components=e,this._width=Math.max(1,t),this._height=Math.max(1,r),this._depth=Math.max(1,n),this.resize()}return e.prototype.get=function(e,t,r){var n;switch(n=void 0===t&&void 0===r?this._components*e:this.index(e,t,r||0),o.logIf(n>=this.length,o.LogLevel.Dev,"index out of range [0, "+this.length+"], given "+n),this._components){case 1:return[this._samples[n]];case 2:return[this._samples[n],this._samples[n+1]];case 3:return[this._samples[n],this._samples[n+1],this._samples[n+2]];case 4:return[this._samples[n],this._samples[n+1],this._samples[n+2],this._samples[n+3]]}},e.prototype.set=function(e,t,r,n){var i;switch(o.logIf(e.length!==this._components,o.LogLevel.Dev,"number of components expected to be "+this._components+", given "+e.length),i=void 0===r&&void 0===n?this._components*Math.min(this.elements,Math.max(0,t)):this._components*this.index(t,r,n||0),o.logIf(i>=this.length,o.LogLevel.Dev,"index out of range [0, "+this.length+"], given "+i),this._components){case 4:this._samples[i+3]=e[3];case 3:this._samples[i+2]=e[2];case 2:this._samples[i+1]=e[1];case 1:this._samples[i+0]=e[0]}},e.prototype.fromJSON=function(e){o.assert(e.size&&void 0!==e.size.width&&void 0!==e.size.height&&void 0!==e.size.depth,"expected kernel width, height, and depth to be set, given '"+e.size+"'");var t=function(e){return e.reduce(function(e,r){return e.concat(Array.isArray(r)?t(r):r)},[])};this._width=Math.max(1,e.size.width),this._height=Math.max(1,e.size.height),this._depth=Math.max(1,e.size.depth);var r=t(e.kernel);this._components=Math.floor(r.length/this.elements),this.resize(),this.fromArray(r)},e.prototype.index=function(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=0),this._width*(this._height*Math.min(this._depth,Math.max(0,r))+Math.min(this._height,Math.max(0,t)))+Math.min(this._width,Math.max(0,e))},e.prototype.position=function(e){var t=Math.min(this.elements,Math.max(0,e)),r=Math.floor(t/(this._width*this._height));t-=r*this._width*this._height;var n=Math.floor(t/this._width);return[t-=n*this._width,n,r]},Object.defineProperty(e.prototype,"samples",{get:function(){return this._samples},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._width*this._height*this._depth*this._components},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"elements",{get:function(){return this._width*this._height*this._depth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"components",{get:function(){return this._components},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"depth",{get:function(){return this._depth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"xStride",{get:function(){return this.bytesPerComponent*this._components},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"yStride",{get:function(){return this.bytesPerComponent*this._components*this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"zStride",{get:function(){return this.bytesPerComponent*this._components*this._width*this._depth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bytesLength",{get:function(){return this.bytesPerComponent*this._components*this._width*this._height*this._depth},enumerable:!0,configurable:!0}),e}();t.AbstractKernel=a;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.resize=function(){this._samples=new Float32Array(this.length)},t.prototype.fromArray=function(e){o.assert(e.length===this.length,"expected samples length to match this kernel's length"),this._samples.set(new Float32Array(e))},Object.defineProperty(t.prototype,"bytesPerComponent",{get:function(){return 4},enumerable:!0,configurable:!0}),t}(a);t.KernelF32=s;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.resize=function(){this._samples=new Uint32Array(this.length)},t.prototype.fromArray=function(e){o.assert(e.length===this.length,"expected samples length to match this kernel's length"),this._samples.set(new Uint32Array(e))},Object.defineProperty(t.prototype,"bytesPerComponent",{get:function(){return 4},enumerable:!0,configurable:!0}),t}(a);t.KernelUI32=u;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.resize=function(){this._samples=new Int32Array(this.length)},t.prototype.fromArray=function(e){o.assert(e.length===this.length,"expected samples length to match this kernel's length"),this._samples.set(new Int32Array(e))},Object.defineProperty(t.prototype,"bytesPerComponent",{get:function(){return 4},enumerable:!0,configurable:!0}),t}(a);t.KernelI32=c;var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.resize=function(){this._samples=new Uint8Array(this.length)},t.prototype.fromArray=function(e){o.assert(e.length===this.length,"expected samples length to match this kernel's length"),this._samples.set(new Uint8Array(e))},Object.defineProperty(t.prototype,"bytesPerComponent",{get:function(){return 4},enumerable:!0,configurable:!0}),t}(a);t.KernelUI8=l;var f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.resize=function(){this._samples=new Int8Array(this.length)},t.prototype.fromArray=function(e){o.assert(e.length===this.length,"expected samples length to match this kernel's length"),this._samples.set(new Int8Array(e))},Object.defineProperty(t.prototype,"bytesPerComponent",{get:function(){return 4},enumerable:!0,configurable:!0}),t}(a);t.KernelI8=f},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),a=function(e){function t(t){var r=e.call(this,2,t)||this;return r.generate(),r}return i(t,e),t.prototype.generate=function(){this.width>0&&this.set([0,0],0);for(var e=1;e<this.width;++e)this.set([o.rand(-.5,.5),o.rand(-.5,.5)],e)},Object.defineProperty(t.prototype,"width",{get:function(){return this._width},set:function(e){this._width!==e&&(this._width=e,this.resize(),this.generate())},enumerable:!0,configurable:!0}),t}(r(24).KernelF32);t.RandomSquareKernel=a},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(2),a=r(3),s=function(e){function t(){var r=null!==e&&e.apply(this,arguments)||this;return r._rotation=a.m4(),r._maxAzimuth=.5*+Math.PI-1e-4,r._minAzimuth=.5*-Math.PI+1e-4,r._xAxisScreenSpace=a.v3(),r._sensitivity=t.DEFAULT_SENSITIVITY,r}return i(t,e),t.prototype.initiate=function(e){Object.assign(this._reference,this._camera),this._initialPoint=e;var t=o.vec3.sub(a.v3(),this._reference.eye,this._reference.center);o.vec3.normalize(t,t),this._xAxisScreenSpace=o.vec3.cross(a.v3(),[0,1,0],t),this._azimuth=Math.acos(o.vec3.dot(t,[0,1,0])),this._azimuth=.5*Math.PI-this._azimuth},t.prototype.process=function(e){this._currentPoint=e;var t=o.vec2.subtract(a.v2(),this._initialPoint,this._currentPoint);o.vec2.scale(t,t,window.devicePixelRatio*this._sensitivity),this._minAzimuth&&(t[1]=Math.min(this._azimuth-this._minAzimuth,t[1])),this._maxAzimuth&&(t[1]=Math.max(this._azimuth-this._maxAzimuth,t[1])),o.mat4.rotateY(this._rotation,a.m4(),t[0]),o.mat4.rotate(this._rotation,this._rotation,t[1],this._xAxisScreenSpace),this.update()},t.prototype.update=function(){if(void 0!==this._camera){var e=o.mat4.fromTranslation(a.m4(),this._reference.center);o.mat4.multiply(e,e,this._rotation),o.mat4.translate(e,e,o.vec3.negate(a.v3(),this._reference.center));var t=o.vec3.transformMat4(a.v3(),[0,1,0],this._rotation),r=o.vec3.transformMat4(a.v3(),this._reference.eye,e);this._camera.up=t,this._camera.eye=r}},Object.defineProperty(t.prototype,"sensitivity",{get:function(){return this._sensitivity},set:function(e){this._sensitivity=e},enumerable:!0,configurable:!0}),t.DEFAULT_SENSITIVITY=.002,t}(r(5).CameraModifier);t.TurntableModifier=s},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(2),a=r(3),s=function(e){function t(){var r=null!==e&&e.apply(this,arguments)||this;return r._rotation=o.mat4.create(),r._sensitivity=t.DEFAULT_SENSITIVITY,r}return i(t,e),t.prototype.initiate=function(e){this._initialPoint=e},t.prototype.process=function(e){this._currentPoint=e;var t=o.vec2.subtract(a.v2(),this._initialPoint,this._currentPoint);o.vec2.scale(t,t,window.devicePixelRatio*this._sensitivity),o.vec2.copy(this._initialPoint,this._currentPoint);var r=o.vec3.sub(a.v3(),this._reference.eye,this._reference.center);o.vec3.normalize(r,r);var n=o.vec3.normalize(a.v3(),this._reference.up),i=o.vec3.cross(a.v3(),r,n);o.vec3.scale(n,n,t[1]),o.vec3.scale(i,i,t[0]);var s=o.vec3.cross(a.v3(),o.vec3.add(a.v3(),n,i),r);o.vec3.normalize(s,s);var u=o.quat.setAxisAngle(o.quat.create(),s,o.vec2.len(t));o.mat4.multiply(this._rotation,this._rotation,o.mat4.fromQuat(a.m4(),u)),this.update()},t.prototype.update=function(){if(void 0!==this._camera){var e=o.mat4.fromTranslation(a.m4(),this._reference.center);o.mat4.multiply(e,e,this._rotation),o.mat4.translate(e,e,o.vec3.negate(a.v3(),this._reference.center));var t=o.vec3.transformMat4(a.v3(),[0,1,0],this._rotation),r=o.vec3.transformMat4(a.v3(),this._reference.eye,e);this._camera.up=t,this._camera.eye=r}},Object.defineProperty(t.prototype,"sensitivity",{get:function(){return this._sensitivity},set:function(e){this._sensitivity=e},enumerable:!0,configurable:!0}),t.DEFAULT_SENSITIVITY=.002,t}(r(5).CameraModifier);t.TrackballModifier=s},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(2),a=r(3),s=function(e){function t(){var r=null!==e&&e.apply(this,arguments)||this;return r._rotation=o.mat4.create(),r._sensitivity=t.DEFAULT_SENSITIVITY,r}return i(t,e),t.prototype.initiate=function(e){Object.assign(this._reference,this._camera),this._initialPoint=e},t.prototype.process=function(e,t){this._currentPoint=e;var r=o.vec2.create();void 0===t?o.vec2.subtract(r,this._initialPoint,this._currentPoint):o.vec2.copy(r,t),o.vec2.scale(r,r,window.devicePixelRatio*this._sensitivity),o.vec2.copy(this._initialPoint,this._currentPoint);var n=o.vec3.sub(a.v3(),this._reference.eye,this._reference.center);o.vec3.normalize(n,n);var i=o.vec3.cross(a.v3(),n,this._reference.up),s=o.mat4.fromRotation(a.m4(),-r[0],this._reference.up),u=o.mat4.fromRotation(a.m4(),r[1],i);o.mat4.mul(this._rotation,u,s),this.update()},t.prototype.update=function(){if(void 0!==this._camera){var e=o.mat4.fromTranslation(a.m4(),this._reference.eye);o.mat4.multiply(e,e,this._rotation),o.mat4.translate(e,e,o.vec3.negate(a.v3(),this._reference.eye));var t=o.vec3.transformMat4(a.v3(),this._reference.center,e);this._camera.center=t,Object.assign(this._reference,this._camera)}},Object.defineProperty(t.prototype,"sensitivity",{get:function(){return this._sensitivity},set:function(e){this._sensitivity=e},enumerable:!0,configurable:!0}),t.DEFAULT_SENSITIVITY=8e-4,t}(r(5).CameraModifier);t.FirstPersonModifier=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=r(3),o=r(0),a=function(){function e(t,r,i){this._fovy=e.DEFAULT_FOVY,this._near=e.DEFAULT_NEAR,this._far=e.DEFAULT_FAR,this._viewport=[1,1],this._aspect=1,this._altered=!1,this._eye=t?n.vec3.clone(t):n.vec3.clone(e.DEFAULT_EYE),this._center=r?n.vec3.clone(r):n.vec3.clone(e.DEFAULT_CENTER),this._up=i?n.vec3.clone(i):n.vec3.clone(e.DEFAULT_UP)}return e.calculateFovY=function(e,t){return 2*Math.atan(.5*e/t)},e.prototype.invalidate=function(e,t){e&&(this._view=void 0,this._viewInverse=void 0),t&&(this._projection=void 0,this._projectionInverse=void 0),(e||t)&&(this._viewProjection=void 0,this._viewProjectionInverse=void 0),this._altered=!0},Object.defineProperty(e.prototype,"eye",{get:function(){return this._eye},set:function(e){n.vec3.equals(this._eye,e)||(this._eye=n.vec3.clone(e),this.invalidate(!0,!1))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"center",{get:function(){return this._center},set:function(e){n.vec3.equals(this._center,e)||(this._center=n.vec3.clone(e),this.invalidate(!0,!1))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"up",{get:function(){return this._up},set:function(e){n.vec3.equals(this._up,e)||(this._up=n.vec3.clone(e),this.invalidate(!0,!1))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fovy",{get:function(){return this._fovy},set:function(e){this._fovy!==e&&(this._fovy=e,this.invalidate(!1,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"near",{get:function(){return this._near},set:function(e){this._near!==e&&(this._near>=this._far?o.log(o.LogLevel.Dev,"near expected to be smaller than far ("+this._far+"), given "+e):(this._near=e,this.invalidate(!1,!0)))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"far",{get:function(){return this._far},set:function(e){this._far!==e&&(this._near>=this._far?o.log(o.LogLevel.Dev,"far expected to be greater than near ("+this._near+"), given "+e):(this._far=e,this.invalidate(!1,!0)))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewport",{get:function(){return this._viewport},set:function(e){this._viewport[0]===e[0]&&this._viewport[1]===e[1]||(this._viewport=e,this.invalidate(!1,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._viewport[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._viewport[1]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"aspect",{get:function(){return this._aspect},set:function(e){this._aspect!==e&&(this._aspect=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"view",{get:function(){return this._view?this._view:(this._view=n.mat4.lookAt(i.m4(),this._eye,this._center,this._up),this._view)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewInverse",{get:function(){return void 0!==this._viewInverse?this._viewInverse:(this._viewInverse=n.mat4.invert(i.m4(),this.view),this._viewInverse)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"projection",{get:function(){return this._projection?this._projection:(this._projection=n.mat4.perspective(i.m4(),this.fovy*o.DEG2RAD,this.aspect,this.near,this.far),this._projection)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"projectionInverse",{get:function(){return void 0!==this._projectionInverse?this._projectionInverse:(this._projectionInverse=n.mat4.invert(i.m4(),this.projection),this._projectionInverse)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewProjection",{get:function(){return this._viewProjection?this._viewProjection:(this._viewProjection=n.mat4.multiply(i.m4(),this.projection,this.view),this._viewProjection)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewProjectionInverse",{get:function(){return void 0!==this._viewProjectionInverse?this._viewProjectionInverse:(this._viewProjectionInverse=n.mat4.invert(i.m4(),this.viewProjection),this._viewProjectionInverse)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"altered",{get:function(){return this._altered},set:function(e){this._altered=e},enumerable:!0,configurable:!0}),e.DEFAULT_EYE=n.vec3.fromValues(0,0,1),e.DEFAULT_CENTER=n.vec3.fromValues(0,0,0),e.DEFAULT_UP=n.vec3.fromValues(0,1,0),e.DEFAULT_FOVY=45,e.DEFAULT_NEAR=2,e.DEFAULT_FAR=8,e}();t.Camera=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=function(){function e(){}return e.queryInternalTextureFormat=function(e,t,r){var i,o,a=e.gl,s=e.gl2facade,u=e.isWebGL1&&e.supportsTextureFloat||e.isWebGL2&&e.supportsColorBufferFloat,c=e.isWebGL1&&e.supportsTextureHalfFloat||e.isWebGL2&&e.supportsColorBufferFloat,l=r;if("auto"===r&&(l=u?"float":c?"half":"byte"),"half"===l&&c?(e.isWebGL2?e.colorBufferFloat:e.textureHalfFloat,i=s.HALF_FLOAT,o=1):"float"!==l&&"half"!==l||!u?(i=a.UNSIGNED_BYTE,o=2):(e.isWebGL2?e.colorBufferFloat:e.textureFloat,i=a.FLOAT,o=0),e.isWebGL1)return[t,i];switch(t){case a.RGBA:return[[a.RGBA32F,a.RGBA16F,a.RGBA8][o],i];case a.RGB:return[[a.RGB32F,a.RGB16F,a.RGB8][o],i];default:n.assert(!1,"internal format querying is not yet supported for formats other than RGBA, RGB")}return[a.NONE,a.NONE]},e}();t.Wizard=i},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),s=r(1),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._buffersBound=!1,t}return i(t,e),t.prototype.create=function(e,r){var n=this;if(this.context.isWebGL2||this.context.supportsVertexArrayObject){var i=this.context.gl2facade;this._object=i.createVertexArray(),this._valid=void 0!==this._object,this._bind=function(){i.bindVertexArray(n.object),n._buffersBound||(e(),n._buffersBound=!0)},this._unbind=function(){return i.bindVertexArray(t.DEFAULT_VERTEX_ARRAY)}}else this._bind=function(){return e()},this._unbind=function(){return r()},this._valid=!0;return this._object},t.prototype.delete=function(){this.context.isWebGL2||this.context.supportsVertexArrayObject?(a.assert(void 0!==this._object,"expected WebGLVertexArrayObject object"),this._context.gl2facade.deleteVertexArray(this._object),this._object=void 0,this._valid=!1,this._buffersBound=!1):this._valid=!1},t.prototype.bind=function(){this._bind()},t.prototype.unbind=function(){this._unbind()},t.DEFAULT_VERTEX_ARRAY=void 0,o([s.Initializable.assert_initialized()],t.prototype,"bind",null),o([s.Initializable.assert_initialized()],t.prototype,"unbind",null),t}(r(4).AbstractObject);t.VertexArray=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(6),i=r(0),o=r(3),a=function(){function e(){this._batchSize=1,this._debug=!1,this._multiFrameNumber=1,this._multiFrameNumberSubject=new n.ReplaySubject(1),this._debugFrameNumber=0,this._debugFrameNumberSubject=new n.ReplaySubject(1),this._frameNumber=0,this._frameNumberSubject=new n.ReplaySubject(1),this._pendingRequest=0,this._pause=!1,this._block=!1,this._blockedUpdates=0,this._intermediateFrameCount=0,this._multiFrameCount=0,this._intermediateFrameTimes=new Array(2),this._multiTime=[0,0]}return Object.defineProperty(e.prototype,"batch",{set:function(e){i.log(i.LogLevel.Dev,"(adaptive) batch multi-frame rendering is experimental for now")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"debug",{set:function(e){this._debug=e},enumerable:!0,configurable:!0}),e.prototype.request=function(t){var r=this;if(0===this._pendingRequest)if(!this._pause&&this._controllable){i.logIf(this._debug,i.LogLevel.ModuleDev,"c request           | intermediates: #"+this._frameNumber);var n=this._debugFrameNumber,o=this._multiFrameNumber;i.assert(n<=o,"debug-frame number exceeds multi-frame number"),i.assert(0===this._pendingRequest,"another request is pending, cannot invoke multiple requests"),n>0&&this._frameNumber>=n&&this.pause();var a=Math.max((n>0?n:o)-this._frameNumber,0);void 0!==t?this._pendingRequest=window.requestAnimationFrame(function(){return r.invoke(t)}):a>0?this._pendingRequest=window.requestAnimationFrame(function(){return r.invoke(e.RequestType.Frame)}):n!==o&&0!==n||++this._multiFrameCount}else i.logIf(this._debug,i.LogLevel.ModuleDev,"c request (ignored) | pending: '"+this._pendingRequest+"'");else i.logIf(this._debug,i.LogLevel.ModuleDev,"c request (ignored) | pending: '"+this._pendingRequest+"'")},e.prototype.reset=function(){var e=this._block||0===this._frameNumber&&this._pendingRequest;return i.logIf(this._debug,i.LogLevel.ModuleDev,"c update  "+(e?"(blocked) ":"          ")+"| pending: '"+this._pendingRequest+"', intermediates: #"+this._frameNumber),e?(++this._blockedUpdates,!0):(this.cancel(),!1)},e.prototype.cancel=function(){0!==this._pendingRequest?(i.logIf(this._debug,i.LogLevel.ModuleDev,"c cancel            | pending: '"+this._pendingRequest+"'"),window.cancelAnimationFrame(this._pendingRequest),this._pendingRequest=0):i.logIf(this._debug,i.LogLevel.ModuleDev,"c cancel  (ignored) |")},e.prototype.invoke=function(t){switch(i.assert(0!==this._pendingRequest,"manual/explicit invocation not anticipated"),i.assert(void 0!==this._controllable,"expected valid controllable for invocation"),this._pendingRequest=0,t){case e.RequestType.Update:this.invokeUpdate(!1);break;case e.RequestType.NonOptionalUpdate:this.invokeUpdate(!0);break;case e.RequestType.Prepare:this.invokePrepare();break;case e.RequestType.Frame:this.invokeFrame()}},e.prototype.invokeUpdate=function(e){void 0===e&&(e=!1),i.logIf(this._debug,i.LogLevel.ModuleDev,"c invoke update     | pending: '"+this._pendingRequest+"', mfnum: "+this._multiFrameNumber),this.unblock(),i.assert(!this._pause,"updates should not be invoked when paused");var t=this._controllable.update(this._multiFrameNumber);e||t?this.invokePrepare():this.invokeFrame()},e.prototype.invokePrepare=function(){i.logIf(this._debug,i.LogLevel.ModuleDev,"c invoke prepare    |"),this._frameNumber=0,this._pause=!1,this._pauseTime=void 0,this._multiFrameTime=0,this._intermediateFrameTimes[0]=Number.MAX_VALUE,this._intermediateFrameTimes[1]=Number.MIN_VALUE,this._multiTime[0]=performance.now(),this._controllable.prepare(),this._multiTime[1]=performance.now();var e=this._multiTime[1]-this._multiTime[0];this._multiFrameTime=e,this._updateFrameTime=e,this.invokeFrame()},e.prototype.invokeFrame=function(){i.assert(!this._pause,"frames should not be invoked when paused"),i.logIf(this._debug,i.LogLevel.ModuleDev,"c invoke frame      | pending: '"+this._pendingRequest+"'");var e=this._debugFrameNumber,t=this._multiFrameNumber;if(this._frameNumber!==t){var r=e>0;i.assert(!r||this._frameNumber<e,"frame number about to exceed debug-frame number"),i.assert(void 0!==this._controllable,"update invoked without controllable set");var n=performance.now(),o=Math.min(this._multiFrameNumber,this._frameNumber+this._batchSize);for(this._debugFrameNumber>0&&(o=Math.min(o,this._debugFrameNumber));this._frameNumber<o;++this._frameNumber)i.logIf(this._debug,i.LogLevel.ModuleDev,"c -> frame          | frame: "+this._frameNumber),this._controllable.frame(this._frameNumber),++this._intermediateFrameCount;i.logIf(this._debug,i.LogLevel.ModuleDev,"c -> swap           |"),this._controllable.swap(),this._multiTime[1]=performance.now();var a=this._multiTime[1]-n;this._multiFrameTime+=a,this._intermediateFrameTimes[0]=Math.min(this._intermediateFrameTimes[0],a),this._intermediateFrameTimes[1]=Math.max(this._intermediateFrameTimes[1],a),this.frameNumberNext(),this.request()}},e.prototype.multiFrameNumberNext=function(){this._multiFrameNumberSubject.next(this._multiFrameNumber)},e.prototype.debugFrameNumberNext=function(){this._debugFrameNumberSubject.next(this._debugFrameNumber)},e.prototype.frameNumberNext=function(){this._frameNumberSubject.next(this._frameNumber)},e.prototype.pause=function(){var e=this._pause;i.logIf(this._debug,i.LogLevel.ModuleDev,"c pause   "+(e?"(ignored)":"")),this._pause||(this._pause=!0,this._pauseTime=performance.now(),this.cancel())},e.prototype.unpause=function(){var e=!this._pause;if(i.logIf(this._debug,i.LogLevel.ModuleDev,"c unpause "+(e?"(ignored)":"")),!e){if(this._pause=!1,void 0!==this._pauseTime&&!isNaN(this._pauseTime)){var t=performance.now()-this._pauseTime;this._multiTime[0]+=t,this._multiTime[1]+=t}this.request()}},e.prototype.update=function(t){void 0===t&&(t=!1),this.reset()||this.request(t?e.RequestType.NonOptionalUpdate:e.RequestType.Update)},e.prototype.prepare=function(){this.reset()||this.request(e.RequestType.Prepare)},e.prototype.block=function(){i.logIf(this._debug,i.LogLevel.ModuleDev,"c block   "+(this._block?"(ignored) ":"          ")+"|"),this._block||(this._block=!0)},e.prototype.unblock=function(){i.logIf(this._debug,i.LogLevel.ModuleDev,"c unblock "+(this._block?"          ":"(ignored) ")+"| blocked: #"+this._blockedUpdates),this._block&&(this._block=!1,this._blockedUpdates>0&&(this._blockedUpdates=0,this.update()))},Object.defineProperty(e.prototype,"paused",{get:function(){return this._pause},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blocked",{get:function(){return this._block},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"controllable",{set:function(e){e!==this._controllable&&(this._controllable=e,this.update())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"multiFrameNumber",{get:function(){return this._multiFrameNumber},set:function(e){var t=Math.max(1,isNaN(e)?1:e);t!==this._multiFrameNumber&&(this._multiFrameNumber=t,this.multiFrameNumberNext(),i.logIf(t!==e,i.LogLevel.ModuleDev,"multi-frame number adjusted to "+t+", given "+e),this.debugFrameNumber>this.multiFrameNumber?this.debugFrameNumber=this.multiFrameNumber:this.update())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"multiFrameNumberObservable",{get:function(){return this._multiFrameNumberSubject.asObservable()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"debugFrameNumber",{get:function(){return this._debugFrameNumber},set:function(e){var t=o.clamp(isNaN(e)?0:e,0,this.multiFrameNumber);t!==this._debugFrameNumber&&(this._debugFrameNumber=t,this.debugFrameNumberNext(),i.logIf(t!==e,i.LogLevel.ModuleDev,"debug-frame number adjusted to "+t+", given "+e),this._block||(this.debugFrameNumber<this._frameNumber?this.prepare():this._pendingRequest||(this.unpause(),this.request())))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"debugFrameNumberObservable",{get:function(){return this._debugFrameNumberSubject.asObservable()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"frameNumber",{get:function(){return this._frameNumber},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"frameNumberObservable",{get:function(){return this._frameNumberSubject.asObservable()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"intermediateFrameCount",{get:function(){return this._intermediateFrameCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"multiFrameCount",{get:function(){return this._multiFrameCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"averageFrameTime",{get:function(){return 0===this._frameNumber?0:this._multiFrameTime/this._frameNumber},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"updateFrameTime",{get:function(){return this._updateFrameTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minimumFrameTime",{get:function(){return this._intermediateFrameTimes[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maximumFrameTime",{get:function(){return this._intermediateFrameTimes[1]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"multiFrameTime",{get:function(){return 0===this._frameNumber?0:this._multiTime[1]-this._multiTime[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"framesPerSecond",{get:function(){return 0===this._frameNumber?0:1e3/(this.multiFrameTime/this._frameNumber)},enumerable:!0,configurable:!0}),e}();t.Controller=a,function(e){!function(e){e[e.Update=0]="Update",e[e.NonOptionalUpdate=1]="NonOptionalUpdate",e[e.Prepare=2]="Prepare",e[e.Frame=3]="Frame"}(e.RequestType||(e.RequestType={}))}(a=t.Controller||(t.Controller={})),t.Controller=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(3),o=r(12),a=function(){function e(t,r){this._rgba=[0,0,0,e.DEFAULT_ALPHA],this._altered=!1,void 0!==t&&(3===t.length&&void 0!==r?this.fromF32(t[0],t[1],t[2],r):4===t.length?(this.fromF32(t[0],t[1],t[2],t[3]),n.assert(void 0===r,"expected alpha to be undefined when given an 4-tuple in RGBA")):this.fromF32(t[0],t[1],t[2]))}return e.hue2rgb=function(e,t,r){return n.assert(r>=-1&&r<=2,"t is expected to be between -1 and 2"),r<0?r+=1:r>1&&(r-=1),6*r<1?e+6*(t-e)*r:2*r<1?t:3*r<2?e+6*(t-e)*(2/3-r):e},e.to2CharHexCode=function(e){return(e<15.5/255?"0":"")+Math.round(255*e).toString(16)},e.hsl2rgb=function(t){var r=o.clampf3(t,"HSL input");if(0===r[1])return[r[2],r[2],r[2]];var n=r[2]<.5?r[2]*(1+r[1]):r[2]+r[1]-r[1]*r[2],i=2*r[2]-n;return[e.hue2rgb(i,n,r[0]+1/3),e.hue2rgb(i,n,r[0]),e.hue2rgb(i,n,r[0]-1/3)]},e.rgb2hsl=function(e){var t=o.clampf3(e,"RGB input"),r=[0,0,0],n=Math.min(t[0],t[1],t[2]),i=Math.max(t[0],t[1],t[2]),a=i-n;if(r[2]=.5*(i+n),0===a)return r;r[1]=r[2]<.5?a/(i+n):a/(2-i-n);var s=((i-t[0])/6+a/2)/a,u=((i-t[1])/6+a/2)/a,c=((i-t[2])/6+a/2)/a;return t[0]===i?r[0]=c-u:t[1]===i?r[0]=s-c+1/3:r[0]=u-s+2/3,r},e.lab2xyz=function(e){var t=o.clampf3(e,"LAB input"),r=(100*t[0]+16)/116,n=100*t[1]/500+r,i=r-100*t[2]/200,a=r*r*r,s=n*n*n,u=i*i*i;return[.95047*(s>.008856?s:(n-16/116)/7.787),1*(a>.008856?a:(r-16/116)/7.787),1.08883*(u>.008856?u:(i-16/116)/7.787)]},e.xyz2lab=function(e){var t=[e[0]/.95047,1*e[1],e[2]/1.08883],r=t[0]>.008856?Math.pow(t[0],1/3):7.787*t[0]+16/116,n=t[1]>.008856?Math.pow(t[1],1/3):7.787*t[1]+16/116,i=t[2]>.008856?Math.pow(t[2],1/3):7.787*t[2]+16/116;return o.clampf3([.01*(116*n-16),500*(r-n)*.01,200*(n-i)*.01])},e.xyz2rgb=function(e){var t=2.04159*e[0]+-.56501*e[1]+-.34473*e[2],r=-.96924*e[0]+1.87597*e[1]+.04156*e[2],n=.01344*e[0]+-.11836*e[1]+1.01517*e[2];return o.clampf3([Math.pow(t,1/2.19921875),Math.pow(r,1/2.19921875),Math.pow(n,1/2.19921875)])},e.rgb2xyz=function(e){var t=o.clampf3(e,"RGB input"),r=Math.pow(t[0],2.19921875),n=Math.pow(t[1],2.19921875),i=Math.pow(t[2],2.19921875);return[.57667*r+.18556*n+.18823*i,.29734*r+.62736*n+.07529*i,.02703*r+.07069*n+.99134*i]},e.lab2rgb=function(t){return e.xyz2rgb(e.lab2xyz(t))},e.rgb2lab=function(t){return e.xyz2lab(e.rgb2xyz(t))},e.cmyk2rgb=function(e){var t=o.clampf4(e,"CMYK input"),r=1-t[3];return[(1-t[0])*r,(1-t[1])*r,(1-t[2])*r]},e.rgb2cmyk=function(e){var t=o.clampf3(e,"RGB input"),r=1-Math.max(t[0],t[1],t[2]),n=1-r,i=0===n?0:1/n;return[(n-t[0])*i,(n-t[1])*i,(n-t[2])*i,r]},e.hex2rgba=function(t){var r=[0,0,0,e.DEFAULT_ALPHA];if(!e.HEX_FORMAT_REGEX.test(t))return n.log(n.LogLevel.User,"hexadecimal RGBA color string must conform to either '0x0000', '#0000', '0000', '0x00000000', '#00000000', or '00000000', given '"+t+"'"),r;var i=t.startsWith("0x")?2:t.startsWith("#")?1:0,o=Math.floor((t.length-i)/3),a=o-1;return r[0]=parseInt(t[i+0*o]+t[i+0*o+a],16)/255,r[1]=parseInt(t[i+1*o]+t[i+1*o+a],16)/255,r[2]=parseInt(t[i+2*o]+t[i+2*o+a],16)/255,t.length-i!=4&&t.length-i!=8||(r[3]=parseInt(t[i+3*o]+t[i+3*o+a],16)/255),n.assert(!(isNaN(r[0])||isNaN(r[1])||isNaN(r[2])||isNaN(r[3])),"expected well formated hexadecimal RGBA string, given '"+t+"'"),r},e.rgb2hex=function(t){var r=o.clampf3(t,"RGB input");return"#"+e.to2CharHexCode(r[0])+e.to2CharHexCode(r[1])+e.to2CharHexCode(r[2])},e.rgba2hex=function(t){var r=o.clampf4(t,"RGBA input");return"#"+e.to2CharHexCode(r[0])+e.to2CharHexCode(r[1])+e.to2CharHexCode(r[2])+e.to2CharHexCode(r[3])},e.prototype.equals=function(e){return o.equals4(this._rgba,e._rgba)},e.prototype.fromF32=function(t,r,n,i){void 0===i&&(i=e.DEFAULT_ALPHA);var a=o.duplicate4(this._rgba);return this._rgba[0]=o.clampf(t,"red value"),this._rgba[1]=o.clampf(r,"green value"),this._rgba[2]=o.clampf(n,"blue value"),this._rgba[3]=o.clampf(i,"alpha value"),this._altered=!o.equals4(this._rgba,a),this},e.prototype.fromUI8=function(t,r,n,a){void 0===a&&(a=Math.floor(255*e.DEFAULT_ALPHA));var s=o.duplicate4(this._rgba);return this._rgba[0]=i.clamp(t,0,255)/255,this._rgba[1]=i.clamp(r,0,255)/255,this._rgba[2]=i.clamp(n,0,255)/255,this._rgba[3]=i.clamp(a,0,255)/255,this._altered=!o.equals4(this._rgba,s),this},e.prototype.fromHSL=function(t,r,n,i){void 0===i&&(i=e.DEFAULT_ALPHA);var a=o.duplicate4(this._rgba),s=e.hsl2rgb([t,r,n]),u=o.clampf(i,"ALPHA input");return this._rgba=[s[0],s[1],s[2],u],this._altered=!o.equals4(this._rgba,a),this},e.prototype.fromLAB=function(t,r,n,i){void 0===i&&(i=e.DEFAULT_ALPHA);var a=o.duplicate4(this._rgba),s=e.lab2rgb([t,r,n]),u=o.clampf(i,"ALPHA input");return this._rgba=[s[0],s[1],s[2],u],this._altered=!o.equals4(this._rgba,a),this},e.prototype.fromCMYK=function(t,r,n,i,a){void 0===a&&(a=e.DEFAULT_ALPHA);var s=o.duplicate4(this._rgba),u=e.cmyk2rgb([t,r,n,i]),c=o.clampf(a,"ALPHA input");return this._rgba=[u[0],u[1],u[2],c],this._altered=!o.equals4(this._rgba,s),this},e.prototype.fromHex=function(t){var r=o.duplicate4(this._rgba);return this._rgba=e.hex2rgba(t),this._altered=!o.equals4(this._rgba,r),this},e.prototype.gray=function(t){switch(void 0===t&&(t=e.GrayscaleAlgorithm.LinearLuminance),t){case e.GrayscaleAlgorithm.Average:return(this._rgba[0]+this._rgba[1]+this._rgba[2])/3;case e.GrayscaleAlgorithm.LeastSaturatedVariant:return.5*(Math.max(this._rgba[0],this._rgba[1],this._rgba[2])-Math.min(this._rgba[0],this._rgba[1],this._rgba[2]));case e.GrayscaleAlgorithm.MinimumDecomposition:return Math.min(this._rgba[0],this._rgba[1],this._rgba[2]);case e.GrayscaleAlgorithm.MaximumDecomposition:return Math.max(this._rgba[0],this._rgba[1],this._rgba[2]);case e.GrayscaleAlgorithm.LinearLuminance:default:return.2126*this._rgba[0]+.7152*this._rgba[1]+.0722*this._rgba[2]}},Object.defineProperty(e.prototype,"rgb",{get:function(){return[this._rgba[0],this._rgba[1],this._rgba[2]]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rgbUI8",{get:function(){var e=new Uint8Array(3);return e[0]=Math.round(255*this._rgba[0]),e[1]=Math.round(255*this._rgba[1]),e[2]=Math.round(255*this._rgba[2]),e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rgbF32",{get:function(){var e=new Float32Array(3);return e[0]=this._rgba[0],e[1]=this._rgba[1],e[2]=this._rgba[2],e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rgba",{get:function(){return this._rgba},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rgbaUI8",{get:function(){var e=new Uint8Array(4);return e[0]=Math.round(255*this._rgba[0]),e[1]=Math.round(255*this._rgba[1]),e[2]=Math.round(255*this._rgba[2]),e[3]=Math.round(255*this._rgba[3]),e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rgbaF32",{get:function(){return new Float32Array(this._rgba)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"r",{get:function(){return this._rgba[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"g",{get:function(){return this._rgba[1]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"b",{get:function(){return this._rgba[2]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"a",{get:function(){return this._rgba[3]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hexRGB",{get:function(){return e.rgb2hex(this.rgb)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hexRGBA",{get:function(){return e.rgba2hex(this._rgba)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hsl",{get:function(){return e.rgb2hsl(this.rgb)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hsla",{get:function(){var t=e.rgb2hsl(this.rgb);return[t[0],t[1],t[2],this._rgba[3]]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lab",{get:function(){return e.rgb2lab(this.rgb)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"laba",{get:function(){var t=e.rgb2lab(this.rgb);return[t[0],t[1],t[2],this._rgba[3]]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cmyk",{get:function(){return e.rgb2cmyk(this.rgb)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cmyka",{get:function(){var t=e.rgb2cmyk(this.rgb);return[t[0],t[1],t[2],t[3],this._rgba[3]]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"altered",{get:function(){return this._altered},set:function(e){this._altered=e},enumerable:!0,configurable:!0}),e.DEFAULT_ALPHA=1,e.HEX_FORMAT_REGEX=new RegExp(/^(#|0x)?(([0-9a-f]{3}){1,2}|([0-9a-f]{4}){1,2})$/i),e}();t.Color=a,function(e){!function(e){e[e.Average=0]="Average",e[e.LinearLuminance=1]="LinearLuminance",e[e.LeastSaturatedVariant=2]="LeastSaturatedVariant",e[e.MinimumDecomposition=3]="MinimumDecomposition",e[e.MaximumDecomposition=4]="MaximumDecomposition"}(e.GrayscaleAlgorithm||(e.GrayscaleAlgorithm={}))}(a=t.Color||(t.Color={})),t.Color=a},function(e,t,r){"use strict";var n;!function(e){e.WEBGL1_EXTENSIONS=["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_color_buffer_half_float","EXT_disjoint_timer_query","EXT_frag_depth","EXT_sRGB","EXT_shader_texture_lod","EXT_texture_filter_anisotropic","OES_element_index_uint","OES_standard_derivatives","OES_texture_float","OES_texture_float_linear","OES_texture_half_float","OES_texture_half_float_linear","OES_vertex_array_object","WEBGL_color_buffer_float","WEBGL_compressed_texture_astc","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_debug_renderer_info","WEBGL_debug_shaders","WEBGL_depth_texture","WEBGL_draw_buffers","WEBGL_lose_context"],e.WEBGL2_EXTENSIONS=["EXT_color_buffer_float","EXT_disjoint_timer_query_webgl2","EXT_texture_filter_anisotropic","OES_texture_float_linear","OES_texture_half_float_linear","WEBGL_compressed_texture_astc","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_debug_renderer_info","WEBGL_debug_shaders","WEBGL_lose_context"],e.WEBGL2_DEFAULT_EXTENSIONS=["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_frag_depth","EXT_sRGB","EXT_shader_texture_lod","OES_element_index_uint","OES_standard_derivatives","OES_texture_float","OES_texture_half_float","OES_vertex_array_object","WEBGL_depth_texture","WEBGL_draw_buffers"]}(n||(n={})),e.exports=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(34),o=function(){function e(){}return e.encode64=function(t){return n.assert(t>=0&&t<=63,"expected bitfield in range [ 0b000000, 0b111111 ], given "+t),e.BASE64_ALPHABET[t]},e.decode64=function(t){n.assert(1===t.length,"expected single base64 character, given '"+t+"'");var r=e.BASE64_ALPHABET.indexOf(t);return n.assert(r>-1,"unknown base64 character, given '"+t+"'"),r},e.encode=function(t,r){var i=e.LATEST_VERSION,o=e.EXTENSIONS_BY_VERSION.get(i),a=e.WEBGL_BACKENDS.indexOf(t);n.assert(a>-1,"expected valid backend "+e.WEBGL_BACKENDS+", given "+t+" ");var s=e.encode64(i<<3|a+1);if(0===r.length)return s;for(var u=0,c=0;c<o.length;++c)u|=r.indexOf(o[c])>-1?32>>c%6:0,c%6<5&&c<o.length-1||(s+=e.encode64(u),u=0);return s},e.decode=function(t){var r=e.decode64(t[0]),i=r>>3,o=(7&r)-1;n.assert(o<e.WEBGL_BACKENDS.length,"expected valid backend index, given "+o);var a=e.WEBGL_BACKENDS[o];n.assert(e.EXTENSIONS_BY_VERSION.has(i),"expected valid hash version, given "+i);var s=e.EXTENSIONS_BY_VERSION.get(i),u=Math.ceil(s.length/6)+1;n.assert(t.length===u,"expected hash of version "+i+" to have a length of "+u+", given "+t);for(var c=new Array,l=1;l<t.length;++l){var f=e.decode64(t[l]),h=6*(l-1);32&f&&c.push(s[h+0]),16&f&&c.push(s[h+1]),8&f&&c.push(s[h+2]),4&f&&c.push(s[h+3]),2&f&&c.push(s[h+4]),1&f&&c.push(s[h+5])}return[a,c]},e.complement=function(t,r){var i=e.WEBGL_BACKENDS.indexOf(t);return n.assert(i>-1,"expected valid backend "+e.WEBGL_BACKENDS+", given "+t+" "),e.WEBGL_EXTENSIONS_BY_BACKEND.get(i).filter(function(e){return r.indexOf(e)<0})},e.WEBGL_BACKENDS=["webgl1","webgl2"],e.WEBGL_EXTENSIONS_BY_BACKEND=new Map([[0,i.WEBGL1_EXTENSIONS],[1,i.WEBGL2_EXTENSIONS]]),e.EXTENSIONS_BY_VERSION=new Map([[0,["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_color_buffer_float","EXT_color_buffer_half_float","EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2","EXT_frag_depth","EXT_shader_texture_lod","EXT_sRGB","EXT_texture_filter_anisotropic","OES_element_index_uint","OES_standard_derivatives","OES_texture_float","OES_texture_float_linear","OES_texture_half_float","OES_texture_half_float_linear","OES_vertex_array_object","WEBGL_color_buffer_float","WEBGL_compressed_texture_astc","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_debug_renderer_info","WEBGL_debug_shaders","WEBGL_depth_texture","WEBGL_draw_buffers","WEBGL_lose_context"]]]),e.LATEST_VERSION=0,e.BASE64_ALPHABET="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ-+",e}();t.ExtensionsHash=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(35),o=function(){function e(){this._extensionsStrive=new Array,this._extensionsConceal=new Array,this._functionsUndefine=new Array}return e.fromHash=function(t){var r=new e,n=i.ExtensionsHash.decode(t);return r._backend=n[0],r._extensionsStrive=n[1],r._extensionsConceal=i.ExtensionsHash.complement(r._backend,r._extensionsStrive),r},e.fromPreset=function(t){for(var r,o=new e,a=new Array,s=0,u=e.presets();s<u.length;s++){var c=u[s];if(a.push(c.identifier),c.identifier===t){r=c;break}}if(n.assert(void 0!==r,"expected valid identifier, available ['"+a.join("', '")+"'], given '"+t+"'"),void 0!==(r=r).extensions_hash){var l=i.ExtensionsHash.decode(r.extensions_hash);o._backend=l[0],o._extensionsStrive=l[1]}else o._backend=r.backend,o._extensionsConceal=r.extensions_conceal,o._extensionsStrive=r.extensions_strive;return o._functionsUndefine=r.functions_undefine,n.assert(void 0!==o._backend,"expected backend to be included in preset"),void 0===o._extensionsStrive?o._extensionsStrive=[]:o._extensionsConceal=i.ExtensionsHash.complement(o._backend,o._extensionsStrive),void 0===o._extensionsConceal&&(o._extensionsConceal=[]),void 0===o._functionsUndefine&&(o._functionsUndefine=[]),o},e.fromGET=function(){var t=n.GETparameter("msqrd_h");if(void 0!==t)return e.fromHash(t);var r=n.GETparameter("msqrd_p");return void 0!==r?e.fromPreset(r):void 0},e.presets=function(){return this.MASQUERADE_JSON.presets},Object.defineProperty(e.prototype,"backend",{get:function(){return this._backend},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"extensionsStrive",{get:function(){return this._extensionsStrive},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"extensionsConceal",{get:function(){return this._extensionsConceal},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"functionsUndefine",{get:function(){return this._functionsUndefine},enumerable:!0,configurable:!0}),e.MASQUERADE_JSON=r(59),e}();t.ContextMasquerade=o},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),s=r(1),u=r(7),c=r(9),l=r(8),f=function(e){function t(t){var r=e.call(this)||this;return r._ndcTriangleShared=!1,r._context=t,r}return i(t,e),t.prototype.functionBlit=function(){var e=this._context.gl;this._target.bind(e.DRAW_FRAMEBUFFER),this._framebuffer.bind(e.READ_FRAMEBUFFER),e.readBuffer(this._readBuffer),e.drawBuffers([this._drawBuffer]),e.enable(e.SCISSOR_TEST),e.scissor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),e.disable(e.SCISSOR_TEST),e.blitFramebuffer(0,0,this._framebuffer.width,this._framebuffer.height,0,0,this._target.width,this._target.height,e.COLOR_BUFFER_BIT,e.NEAREST),this._framebuffer.unbind(e.READ_FRAMEBUFFER),this._target.unbind(e.DRAW_FRAMEBUFFER)},t.prototype.programBlit=function(){a.assert(this._ndcTriangle&&this._ndcTriangle.initialized,"expected an initialized ndc triangle");var e=this._context.gl;e.viewport(0,0,this._target.width,this._target.height),this._program.bind();var t=this._framebuffer.texture(this._readBuffer);t.bind(e.TEXTURE0);var r=this._context.isWebGL2?e.DRAW_FRAMEBUFFER:e.FRAMEBUFFER;this._target.bind(r),this._ndcTriangle.bind(),this._ndcTriangle.draw(),this._ndcTriangle.unbind(),this._target.unbind(r),t.unbind()},t.prototype.initialize=function(e){var t=this._context.gl,n=new l.Shader(this._context,t.VERTEX_SHADER,"ndcvertices.vert (blit)");n.initialize(r(13));var i=new l.Shader(this._context,t.FRAGMENT_SHADER,"blit.frag");if(i.initialize(r(47)),this._program=new c.Program(this._context,"BlitProgram"),this._program.initialize([n,i]),this._program.bind(),t.uniform1i(this._program.uniform("u_texture"),0),this._program.unbind(),void 0===e?this._ndcTriangle=new u.NdcFillingTriangle(this._context):(this._ndcTriangle=e,this._ndcTriangleShared=!0),this._ndcTriangle.initialized)this._program.attribute("a_vertex",this._ndcTriangle.aVertex);else{var o=this._program.attribute("a_vertex",0);this._ndcTriangle.initialize(o)}return!0},t.prototype.uninitialize=function(){!this._ndcTriangleShared&&this._ndcTriangle.initialized&&this._ndcTriangle.uninitialize(),this._program.uninitialize()},t.prototype.frame=function(){a.logIf(!this._target||!this._target.valid,a.LogLevel.Dev,"valid target expected, given "+this._target),a.logIf(!this._framebuffer||!this._framebuffer.valid,a.LogLevel.Dev,"valid framebuffer for blitting from expected, given "+this._framebuffer);var e=this._context.gl;switch(this._readBuffer){case e.DEPTH_ATTACHMENT:case e.STENCIL_ATTACHMENT:case e.DEPTH_STENCIL_ATTACHMENT:return this.programBlit()}if(this._context.supportsBlitFramebuffer)return this.functionBlit();this.programBlit()},Object.defineProperty(t.prototype,"framebuffer",{set:function(e){this.assertInitialized(),this._framebuffer=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"readBuffer",{set:function(e){this.assertInitialized(),this._readBuffer=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"drawBuffer",{set:function(e){this.assertInitialized(),this._drawBuffer=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"target",{set:function(e){this.assertInitialized(),this._target=e},enumerable:!0,configurable:!0}),o([s.Initializable.initialize()],t.prototype,"initialize",null),o([s.Initializable.uninitialize()],t.prototype,"uninitialize",null),o([s.Initializable.assert_initialized()],t.prototype,"frame",null),t}(s.Initializable);t.BlitPass=f},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),s=r(17),u=r(11),c=r(1),l=r(7),f=r(9),h=r(8),p=r(10),d=r(30),_=function(e){function t(t){var r=e.call(this)||this;return r._altered=Object.assign(new s.ChangeLookup,{any:!1,texture:!1,precision:!1,passThrough:!1}),r._precision="half",r._write=0,r._ndcTriangleShared=!1,r._context=t,r}return i(t,e),t.prototype.initialize=function(e){var t=this._context.gl;this._accumulationFBOs=[new u.Framebuffer(this._context,"AccumPingFBO"),new u.Framebuffer(this._context,"AccumPongFBO")],this._accumulationTextures=[new p.Texture2(this._context,"AccumPingTexture"),new p.Texture2(this._context,"AccumPongTexture")];var n=new h.Shader(this._context,t.VERTEX_SHADER,"ndcvertices.vert (accumulate)");n.initialize(r(13));var i=new h.Shader(this._context,t.FRAGMENT_SHADER,"accumulate.frag");if(i.initialize(r(48)),this._program=new f.Program(this._context,"AccumulateProgram"),this._program.initialize([n,i]),this._uWeight=this._program.uniform("u_weight"),this._program.bind(),t.uniform1f(this._uWeight,0),t.uniform1i(this._program.uniform("u_accumulationTexture"),0),t.uniform1i(this._program.uniform("u_currentFrameTexture"),1),this._program.unbind(),void 0===e?this._ndcTriangle=new l.NdcFillingTriangle(this._context):(this._ndcTriangle=e,this._ndcTriangleShared=!0),this._ndcTriangle.initialized)this._program.attribute("a_vertex",this._ndcTriangle.aVertex);else{var o=this._program.attribute("a_vertex",0);this._ndcTriangle.initialize(o)}return!0},t.prototype.uninitialize=function(){!this._ndcTriangleShared&&this._ndcTriangle.initialized&&this._ndcTriangle.uninitialize(),this._program.uninitialize(),this._accumulationFBOs[0].uninitialize(),this._accumulationFBOs[1].uninitialize(),this._accumulationTextures[0].uninitialize(),this._accumulationTextures[1].uninitialize(),this._write=0},t.prototype.update=function(){if(this._texture&&this._texture.valid){if(!this._passThrough){var e=this._altered.texture||this._accumulationTextures[0].width!==this._texture.width||this._accumulationTextures[0].height!==this._texture.height;if(this._altered.any||e){var t=this._context.gl,r=this._context.gl2facade,n=this._texture.size;if(this._accumulationTextures[0].initialized){if((this._altered.texture||e)&&(this._accumulationTextures[0].resize(this._texture.width,this._texture.height),this._accumulationTextures[1].resize(this._texture.width,this._texture.height)),this._altered.precision){i=d.Wizard.queryInternalTextureFormat(this._context,t.RGBA,this._precision);this._accumulationTextures[0].reformat(i[0],t.RGBA,i[1]),this._accumulationTextures[1].reformat(i[0],t.RGBA,i[1])}}else{var i=d.Wizard.queryInternalTextureFormat(this._context,t.RGBA,this._precision);this._accumulationTextures[0].initialize(n[0],n[1],i[0],t.RGBA,i[1]),this._accumulationTextures[1].initialize(n[0],n[1],i[0],t.RGBA,i[1])}this._accumulationFBOs[0].initialized||(this._accumulationFBOs[0].initialize([[r.COLOR_ATTACHMENT0,this._accumulationTextures[0]]]),this._accumulationFBOs[1].initialize([[r.COLOR_ATTACHMENT0,this._accumulationTextures[1]]])),a.assert(this._accumulationFBOs[0].valid&&this._accumulationFBOs[1].valid,"valid accumulation framebuffers expected"),this._altered.reset()}else a.assert(this._accumulationFBOs[0].valid&&this._accumulationFBOs[1].valid,"valid accumulation framebuffers expected")}}else a.log(a.LogLevel.Dev,"valid texture for accumulation update expected, given "+this._texture)},t.prototype.frame=function(e,t){if(a.assert(this._accumulationFBOs[0].valid&&this._accumulationFBOs[1].valid,"valid framebuffer objects for accumulation expected (initialize or update was probably not be called"),!this._passThrough&&void 0!==this._texture){a.logIf(!this._texture||!this._texture.valid,a.LogLevel.Dev,"valid texture for accumulation frame expected, given "+this._texture);var r=this._context.gl;void 0!==t&&r.viewport(0,0,t[0],t[1]);var n=e%2,i=this._write=1-n,o=this._accumulationTextures[n],s=this._texture;o.bind(r.TEXTURE0),s.bind(r.TEXTURE1),this._program.bind(),r.uniform1f(this._uWeight,1/(e+1)),this._accumulationFBOs[i].bind(r.DRAW_FRAMEBUFFER),this._ndcTriangle.bind(),this._ndcTriangle.draw(),this._ndcTriangle.unbind(),this._accumulationFBOs[i].unbind(r.DRAW_FRAMEBUFFER),o.unbind(r.TEXTURE0),s.unbind(r.TEXTURE1)}},Object.defineProperty(t.prototype,"texture",{set:function(e){this.assertInitialized(),this._texture!==e&&(this._texture=e,this._altered.alter("texture"))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"precision",{set:function(e){this.assertInitialized(),this._precision!==e&&(this._precision=e,this._altered.alter("precision"))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"passThrough",{set:function(e){this.assertInitialized(),this._passThrough!==e&&(this._passThrough&&this._accumulationTextures[0].initialized&&(this._accumulationTextures[0].uninitialize(),this._accumulationTextures[1].uninitialize()),this._passThrough&&this._accumulationFBOs[0].initialized&&(this._accumulationFBOs[0].uninitialize(),this._accumulationFBOs[1].uninitialize()),this._passThrough=e,this._altered.alter("passThrough"))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"framebuffer",{get:function(){return this._passThrough?void 0:this._accumulationFBOs[this._write]},enumerable:!0,configurable:!0}),o([c.Initializable.initialize()],t.prototype,"initialize",null),o([c.Initializable.uninitialize()],t.prototype,"uninitialize",null),o([c.Initializable.assert_initialized()],t.prototype,"update",null),o([c.Initializable.assert_initialized()],t.prototype,"frame",null),t}(c.Initializable);t.AccumulatePass=_},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),Object.defineProperty(t.prototype,"width",{get:function(){return this._width},set:function(e){if(this._width!==e)switch(this._width=e,this._width){case 8:this.fromJSON(r(50));break;case 64:this.fromJSON(r(49));break;default:this.resize(),this.generate()}},enumerable:!0,configurable:!0}),t}(r(25).RandomSquareKernel);t.AntiAliasingKernel=o},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0});var a=r(6),s=r(2),u=r(0),c=r(3),l=r(17),f=r(1),h=r(12),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._altered=Object.assign(new l.ChangeLookup,{any:!1,multiFrameNumber:!1,frameSize:!1,canvasSize:!1,framePrecision:!1,clearColor:!1,debugTexture:!1}),t._frameSize=[0,0],t._canvasSize=[0,0],t._framePrecision="half",t._clearColor=[0,0,0,1],t._debugTextures=new Array,t._debugTextureSubject=new a.ReplaySubject(1),t}return i(t,e),t.prototype.invalidate=function(e){void 0===e&&(e=!1),this._invalidate(e)},t.prototype.debugTextureNext=function(){this._debugTextureSubject.next(this._debugTexture)},Object.defineProperty(t.prototype,"context",{get:function(){return this.assertInitialized(),this._context},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canvasSize",{get:function(){return this.assertInitialized(),this._canvasSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"altered",{get:function(){return this._altered.any},enumerable:!0,configurable:!0}),t.prototype.initialize=function(e,t,r){return u.assert(void 0!==e,"valid webgl context required"),this._context=e,u.assert(void 0!==t,"valid multi-frame update callback required"),this._invalidate=t,this.onInitialize(e,t,r)},t.prototype.uninitialize=function(){this.onUninitialize()},t.prototype.update=function(e){return this._canvasSize[0]===this._context.gl.canvas.width&&this._canvasSize[1]===this._context.gl.canvas.height||(this._canvasSize[0]=this._context.gl.canvas.width,this._canvasSize[1]=this._context.gl.canvas.height,this._altered.alter("canvasSize")),this._multiFrameNumber!==e&&(this._multiFrameNumber=e,this._altered.alter("multiFrameNumber")),this.onUpdate()||this._altered.any},t.prototype.prepare=function(){this.onPrepare()},t.prototype.frame=function(e){this.onFrame(e)},t.prototype.swap=function(){this.onSwap()},t.prototype.frameCoords=function(e,t){var r=s.vec2.divide(c.v2(),this._frameSize,this.canvasSize);return s.vec2.floor(r,s.vec2.multiply(r,[e+.5,t+.5],r)),s.vec2.add(r,r,[.5,.5]),h.tuple2(r)},Object.defineProperty(t.prototype,"frameSize",{set:function(e){this.assertInitialized(),s.vec2.equals(this._frameSize,e)||(Object.assign(this._frameSize,e),this._altered.alter("frameSize"),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"framePrecision",{set:function(e){this.assertInitialized(),this._framePrecision!==e&&(this._framePrecision=e,this._altered.alter("framePrecision"),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"clearColor",{set:function(e){this.assertInitialized(),s.vec4.equals(this._clearColor,e)||(Object.assign(this._clearColor,e),this._altered.alter("clearColor"),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"debugTextures",{get:function(){return this.assertInitialized(),this._debugTextures},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"debugTexture",{get:function(){return this.assertInitialized(),this._debugTexture},set:function(e){this.assertInitialized(),this._debugTexture!==e&&(u.logIf(e>=this._debugTextures.length,u.LogLevel.Dev,"invalid texture index, debug texture disabled (index set to -1) | "+e+" not in [-1,+"+(this._debugTextures.length-1)+"]"),this._debugTexture=e<this._debugTextures.length?c.clamp(e,-1,this._debugTextures.length-1):-1,this._altered.alter("debugTexture"),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"debugTextureObservable",{get:function(){return this._debugTextureSubject.asObservable()},enumerable:!0,configurable:!0}),o([f.Initializable.assert_initialized()],t.prototype,"invalidate",null),o([f.Initializable.initialize()],t.prototype,"initialize",null),o([f.Initializable.uninitialize()],t.prototype,"uninitialize",null),o([f.Initializable.assert_initialized()],t.prototype,"update",null),o([f.Initializable.assert_initialized()],t.prototype,"prepare",null),o([f.Initializable.assert_initialized()],t.prototype,"frame",null),o([f.Initializable.assert_initialized()],t.prototype,"swap",null),t}(f.Initializable);t.Renderer=p},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),s=r(11),u=r(1),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.create=function(){return this._object=s.Framebuffer.DEFAULT_FRAMEBUFFER,this._valid=!0,this._clearColors=new Array(1),this._clearDepth=1,this._clearStencil=0,this.clear=this.es2Clear,this._object},t.prototype.delete=function(){this._object=void 0,this._valid=!1},t.prototype.hasAttachment=function(e){return!1},t.prototype.bind=function(e){void 0===e&&(e=this.context.gl.FRAMEBUFFER),this.context.gl.bindFramebuffer(e,this._object)},t.prototype.clearColor=function(t){e.prototype.clearColor.call(this,t)},t.prototype.resize=function(){a.assert(!1,"the default framebuffer cannot be resized directly")},Object.defineProperty(t.prototype,"width",{get:function(){return this.context.gl.canvas.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.context.gl.canvas.height},enumerable:!0,configurable:!0}),o([u.Initializable.assert_initialized()],t.prototype,"bind",null),t}(s.Framebuffer);t.DefaultFramebuffer=c},function(e,t,r){var n=r(43),i=r(21);function o(e,t){this.id=e,this.ref=t}e.exports.SchemaScanResult=o,e.exports.scan=function(e,t){function r(e,t){if(t&&"object"==typeof t)if(t.$ref){var o=n.resolve(e,t.$ref);c[o]=c[o]?c[o]+1:0}else{var l=t.id?n.resolve(e,t.id):e;if(l){if(l.indexOf("#")<0&&(l+="#"),u[l]){if(!i.deepCompareStrict(u[l],t))throw new Error("Schema <"+t+"> already exists with different definition");return u[l]}u[l]=t,"#"==l[l.length-1]&&(u[l.substring(0,l.length-1)]=t)}a(l+"/items",t.items instanceof Array?t.items:[t.items]),a(l+"/extends",t.extends instanceof Array?t.extends:[t.extends]),r(l+"/additionalItems",t.additionalItems),s(l+"/properties",t.properties),r(l+"/additionalProperties",t.additionalProperties),s(l+"/definitions",t.definitions),s(l+"/patternProperties",t.patternProperties),s(l+"/dependencies",t.dependencies),a(l+"/disallow",t.disallow),a(l+"/allOf",t.allOf),a(l+"/anyOf",t.anyOf),a(l+"/oneOf",t.oneOf),r(l+"/not",t.not)}}function a(e,t){if(t instanceof Array)for(var n=0;n<t.length;n++)r(e+"/"+n,t[n])}function s(e,t){if(t&&"object"==typeof t)for(var n in t)r(e+"/"+n,t[n])}var u={},c={};return r(e,t),new o(u,c)}},function(e,t,r){"use strict";var n=r(79),i=r(76);function o(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}t.parse=g,t.resolve=function(e,t){return g(e,!1,!0).resolve(t)},t.resolveObject=function(e,t){return e?g(e,!1,!0).resolveObject(t):t},t.format=function(e){i.isString(e)&&(e=g(e));return e instanceof o?e.format():o.prototype.format.call(e)},t.Url=o;var a=/^([a-z0-9.+-]+:)/i,s=/:[0-9]*$/,u=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,c=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),l=["'"].concat(c),f=["%","/","?",";","#"].concat(l),h=["/","?","#"],p=/^[+a-z0-9A-Z_-]{0,63}$/,d=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,_={javascript:!0,"javascript:":!0},b={javascript:!0,"javascript:":!0},m={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},v=r(75);function g(e,t,r){if(e&&i.isObject(e)&&e instanceof o)return e;var n=new o;return n.parse(e,t,r),n}o.prototype.parse=function(e,t,r){if(!i.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var o=e.indexOf("?"),s=-1!==o&&o<e.indexOf("#")?"?":"#",c=e.split(s);c[0]=c[0].replace(/\\/g,"/");var g=e=c.join(s);if(g=g.trim(),!r&&1===e.split("#").length){var y=u.exec(g);if(y)return this.path=g,this.href=g,this.pathname=y[1],y[2]?(this.search=y[2],this.query=t?v.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var x=a.exec(g);if(x){var E=(x=x[0]).toLowerCase();this.protocol=E,g=g.substr(x.length)}if(r||x||g.match(/^\/\/[^@\/]+@[^@\/]+/)){var T="//"===g.substr(0,2);!T||x&&b[x]||(g=g.substr(2),this.slashes=!0)}if(!b[x]&&(T||x&&!m[x])){for(var O,M,A=-1,P=0;P<h.length;P++){-1!==(j=g.indexOf(h[P]))&&(-1===A||j<A)&&(A=j)}-1!==(M=-1===A?g.lastIndexOf("@"):g.lastIndexOf("@",A))&&(O=g.slice(0,M),g=g.slice(M+1),this.auth=decodeURIComponent(O)),A=-1;for(P=0;P<f.length;P++){var j;-1!==(j=g.indexOf(f[P]))&&(-1===A||j<A)&&(A=j)}-1===A&&(A=g.length),this.host=g.slice(0,A),g=g.slice(A),this.parseHost(),this.hostname=this.hostname||"";var w="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!w)for(var R=this.hostname.split(/\./),L=(P=0,R.length);P<L;P++){var F=R[P];if(F&&!F.match(p)){for(var S="",B=0,I=F.length;B<I;B++)F.charCodeAt(B)>127?S+="x":S+=F[B];if(!S.match(p)){var z=R.slice(0,P),N=R.slice(P+1),C=F.match(d);C&&(z.push(C[1]),N.unshift(C[2])),N.length&&(g="/"+N.join(".")+g),this.hostname=z.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),w||(this.hostname=n.toASCII(this.hostname));var G=this.port?":"+this.port:"",U=this.hostname||"";this.host=U+G,this.href+=this.host,w&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==g[0]&&(g="/"+g))}if(!_[E])for(P=0,L=l.length;P<L;P++){var D=l[P];if(-1!==g.indexOf(D)){var k=encodeURIComponent(D);k===D&&(k=escape(D)),g=g.split(D).join(k)}}var W=g.indexOf("#");-1!==W&&(this.hash=g.substr(W),g=g.slice(0,W));var q=g.indexOf("?");if(-1!==q?(this.search=g.substr(q),this.query=g.substr(q+1),t&&(this.query=v.parse(this.query)),g=g.slice(0,q)):t&&(this.search="",this.query={}),g&&(this.pathname=g),m[E]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){G=this.pathname||"";var X=this.search||"";this.path=G+X}return this.href=this.format(),this},o.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",r=this.pathname||"",n=this.hash||"",o=!1,a="";this.host?o=e+this.host:this.hostname&&(o=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&i.isObject(this.query)&&Object.keys(this.query).length&&(a=v.stringify(this.query));var s=this.search||a&&"?"+a||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||m[t])&&!1!==o?(o="//"+(o||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):o||(o=""),n&&"#"!==n.charAt(0)&&(n="#"+n),s&&"?"!==s.charAt(0)&&(s="?"+s),t+o+(r=r.replace(/[?#]/g,function(e){return encodeURIComponent(e)}))+(s=s.replace("#","%23"))+n},o.prototype.resolve=function(e){return this.resolveObject(g(e,!1,!0)).format()},o.prototype.resolveObject=function(e){if(i.isString(e)){var t=new o;t.parse(e,!1,!0),e=t}for(var r=new o,n=Object.keys(this),a=0;a<n.length;a++){var s=n[a];r[s]=this[s]}if(r.hash=e.hash,""===e.href)return r.href=r.format(),r;if(e.slashes&&!e.protocol){for(var u=Object.keys(e),c=0;c<u.length;c++){var l=u[c];"protocol"!==l&&(r[l]=e[l])}return m[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}if(e.protocol&&e.protocol!==r.protocol){if(!m[e.protocol]){for(var f=Object.keys(e),h=0;h<f.length;h++){var p=f[h];r[p]=e[p]}return r.href=r.format(),r}if(r.protocol=e.protocol,e.host||b[e.protocol])r.pathname=e.pathname;else{for(var d=(e.pathname||"").split("/");d.length&&!(e.host=d.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==d[0]&&d.unshift(""),d.length<2&&d.unshift(""),r.pathname=d.join("/")}if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var _=r.pathname||"",v=r.search||"";r.path=_+v}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var g=r.pathname&&"/"===r.pathname.charAt(0),y=e.host||e.pathname&&"/"===e.pathname.charAt(0),x=y||g||r.host&&e.pathname,E=x,T=r.pathname&&r.pathname.split("/")||[],O=(d=e.pathname&&e.pathname.split("/")||[],r.protocol&&!m[r.protocol]);if(O&&(r.hostname="",r.port=null,r.host&&(""===T[0]?T[0]=r.host:T.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===d[0]?d[0]=e.host:d.unshift(e.host)),e.host=null),x=x&&(""===d[0]||""===T[0])),y)r.host=e.host||""===e.host?e.host:r.host,r.hostname=e.hostname||""===e.hostname?e.hostname:r.hostname,r.search=e.search,r.query=e.query,T=d;else if(d.length)T||(T=[]),T.pop(),T=T.concat(d),r.search=e.search,r.query=e.query;else if(!i.isNullOrUndefined(e.search)){if(O)r.hostname=r.host=T.shift(),(w=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=w.shift(),r.host=r.hostname=w.shift());return r.search=e.search,r.query=e.query,i.isNull(r.pathname)&&i.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!T.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var M=T.slice(-1)[0],A=(r.host||e.host||T.length>1)&&("."===M||".."===M)||""===M,P=0,j=T.length;j>=0;j--)"."===(M=T[j])?T.splice(j,1):".."===M?(T.splice(j,1),P++):P&&(T.splice(j,1),P--);if(!x&&!E)for(;P--;P)T.unshift("..");!x||""===T[0]||T[0]&&"/"===T[0].charAt(0)||T.unshift(""),A&&"/"!==T.join("/").substr(-1)&&T.push("");var w,R=""===T[0]||T[0]&&"/"===T[0].charAt(0);O&&(r.hostname=r.host=R?"":T.length?T.shift():"",(w=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=w.shift(),r.host=r.hostname=w.shift()));return(x=x||r.host&&T.length)&&!R&&T.unshift(""),T.length?r.pathname=T.join("/"):(r.pathname=null,r.path=null),i.isNull(r.pathname)&&i.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},o.prototype.parseHost=function(){var e=this.host,t=s.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},function(e,t,r){"use strict";var n,i=r(2),o=r(3),a=r(0);!function(e){function t(e,t,r){void 0===r&&(r=1);var n=i.vec2.subtract(o.v2(),t,e);if(!i.vec2.equals(n,i.vec2.fromValues(0,0))){var a=i.vec2.squaredLength(n),s=2*i.vec2.dot(n,e),u=s*s-4*a*(i.vec2.squaredLength(e)-r*r);if(!(u<0)){var c=Math.sqrt(u),l=Math.min((-s+c)/(2*a),(-s-c)/(2*a)),f=i.vec2.scale(o.v2(),n,l);return i.vec2.add(f,f,e)}}}function r(e,t,r,n){var a=e,s=i.vec2.sub(o.v2(),t,e),u=r,c=i.vec2.sub(o.v2(),n,r),l=i.vec2.cross(o.v3(),s,c)[2];if(0!==l){var f=i.vec2.sub(o.v2(),u,a),h=i.vec2.cross(o.v3(),f,i.vec2.scale(o.v2(),s,1/l))[2],p=i.vec2.cross(o.v3(),f,i.vec2.scale(o.v2(),c,1/l))[2];if(!(h<0||h>1||p<0))return[i.vec2.add(o.v2(),u,i.vec2.scale(o.v2(),c,h)),p]}}function n(e,t,r,n){void 0===r&&(r=[0,0,0]),void 0===n&&(n=[0,1,0]);var a=i.vec3.normalize(o.v3(),i.vec3.subtract(o.v3(),t,e)),s=i.vec3.dot(a,n);if(!(i.vec3.equals(a,[0,0,0])||s>=0)){var u=i.vec3.dot(i.vec3.subtract(o.v3(),r,e),n)/s;return i.vec3.add(o.v3(),i.vec3.scale(o.v3(),a,u),e)}}function s(e,t,r){var n=i.vec3.subtract(o.v3(),t,e),a=i.vec3.squaredLength(n);if(0===a)return 0;var s=i.vec3.subtract(o.v3(),r,e);return i.vec3.dot(s,n)/a}e.rayCircleIntersection=t,e.pointSquareIntersection=function(e,t){void 0===t&&(t=1);var r=o.abs2(o.v2(),e);return r[0]>=r[1]?i.vec2.fromValues(o.sign(e[0])*t,e[1]/r[0]*t):i.vec2.fromValues(e[0]/r[1]*t,o.sign(e[1])*t)},e.raySquareIntersection=function(e,t,n){void 0===n&&(n=1);for(var o=[i.vec2.fromValues(-n,+n),i.vec2.fromValues(-n,-n),i.vec2.fromValues(+n,-n),i.vec2.fromValues(+n,+n)],a=new Array,s=0;s<4;++s){var u=r(e,t,o[s],o[(s+1)%4]);u&&a.push(u[1])}return a},e.rayLineIntersection=r,e.rayPlaneIntersection=n,e.raySphereIntersection=function(e,t,r,n){void 0===r&&(r=i.vec3.fromValues(0,0,0)),void 0===n&&(n=1);var a=i.vec3.subtract(o.v3(),e,r),s=i.vec3.normalize(o.v3(),i.vec3.subtract(o.v3(),t,e)),u=i.vec3.dot(s,a),c=u*u-i.vec3.squaredLength(a)+n*n;if(!(c<=0))return i.vec3.add(o.v3(),e,i.vec3.scale(o.v3(),s,-u-Math.sqrt(c)))},e.rayPlaneIntersection_tube=function(e,r,o){void 0===o&&(o=1);var a=n(e,r);if(void 0!==a&&i.vec3.length(a)<o)return a;var s=t(i.vec2.fromValues(e[0],e[2]),i.vec2.fromValues(r[0],r[2]),o);return s?i.vec3.fromValues(s[0],0,s[1]):void 0},e.isPointWithinSquare=function(e,t){void 0===t&&(t=1);var r=o.abs2(o.v2(),e);return r[0]<=t&&r[1]<=t},e.isPointWithinNDC=function(e,t){var r=i.vec3.transformMat4(o.v3(),t,e),n=o.abs3(o.v3(),r);return n[0]<=1&&n[1]<=1&&r[2]>=0&&r[2]<=1},e.distancePointToRay=s,e.eyeWithPointInView=function(e,t){var r=i.vec3.subtract(o.v3(),e.center,e.eye),n=i.vec3.normalize(o.v3(),r),u=i.vec3.normalize(o.v3(),i.vec3.cross(o.v3(),n,e.up)),c=i.vec3.normalize(o.v3(),i.vec3.cross(o.v3(),u,n)),l=s(e.eye,e.center,t),f=i.vec3.add(o.v3(),e.eye,i.vec3.scale(o.v3(),r,l)),h=i.vec3.subtract(o.v3(),t,f),p=Math.abs(i.vec3.dot(h,u))/e.aspect,d=Math.abs(i.vec3.dot(h,c)),_=Math.max(p,d)/Math.tan(e.fovy*a.DEG2RAD*.5);return i.vec3.subtract(o.v3(),f,i.vec3.scale(o.v3(),n,_))}}(n||(n={})),e.exports=n},function(e,t){e.exports="\r\nprecision highp float;\r\n\r\n\r\n#if __VERSION__ == 100\r\n    #define texture(sampler, coord) texture2D(sampler, coord)\r\n#else \r\n    #define varying in\r\n#endif\r\n\r\n\r\nconst float one255ths = 1.0 / 255.0;\r\n\r\nvec3 float24x1_to_uint8x3(const in float f) {\r\n    vec3 uint8x3 = vec3(f, fract(f * 256.0), fract(f * 65536.0));\r\n    return floor(uint8x3 * 256.0) * one255ths;\r\n}\r\n\r\nvec4 float24x1_to_uint8x4(const in float f) {\r\n    vec4 uint8x4 = vec4(f, fract(f * 256.0), fract(f * 65536.0), fract(f * 16777216.0));\r\n    return floor(uint8x4 * 256.0) * one255ths;\r\n}\r\n\r\nconst vec3 premultUint8x3 = vec3(255.0 / 256.0, 255.0 / 65536.0, 255.0 / 16777216.0);\r\nfloat uint8x3_to_float24x1(const in vec3 v) {\r\n    return dot(v, premultUint8x3); // a1 * b1 + a2 * b2 + a3 * b3  ;)\r\n}\r\n\r\nconst vec4 premultUint8x4 = vec4(255.0 / 256.0, 255.0 / 65536.0, 255.0 / 16777216.0, 255.0 / 4294967296.0);\r\nfloat uint8x4_to_float24x1(const in vec4 v) {\r\n    return dot(v, premultUint8x4); // a1 * b1 + a2 * b2 + a3 * b3 + a4 * b4  ;)\r\n}\r\n\r\n\r\n\r\n#if __VERSION__ == 100\r\n    #define fragDepth gl_FragColor\r\n#else \r\n    layout(location = 0) out vec4 fragDepth;\r\n#endif\r\n\r\n\r\nuniform sampler2D u_texture;\r\nuniform vec2 u_offset;\r\nuniform vec2 u_scale;\r\n\r\nvarying vec2 v_uv;\r\n\r\n\r\n\r\nvoid main(void)\r\n{\r\n    vec2 uv = vec2(v_uv.x, 1.0 - v_uv.y) * u_scale + u_offset;\r\n    float depth = texture(u_texture, uv).r;\r\n\r\n    fragDepth = vec4(float24x1_to_uint8x3(depth), 1.0);\r\n}\r\n"},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0});var a=r(2),s=r(0),u=r(3),c=r(11),l=r(1),f=r(7),h=r(9),p=r(8),d=r(10),_=function(e){function t(t){var r=e.call(this)||this;return r._cache=!1,r._depthAttachment=0,r._cachedDepths=new Map,r._cachedIDs=new Map,r._buffer=new Uint8Array(4),r._ndcTriangleShared=!1,r._context=t,r}return i(t,e),t.prototype.onFrame=function(){this._cachedDepths.clear(),this._cachedIDs.clear()},t.prototype.hash=function(e,t){return 65535*t+e},t.prototype.directReadDepthAt=function(e,t){var r=this.hash(e,t);if(this._cache&&this._cachedDepths.has(r))return this._cachedDepths.get(r);s.assert(void 0!==this._depthFBO&&this._depthFBO.valid,"valid depth FBO expected for reading back depth");var n=this._depthFBO.texture(this._depthAttachment),i=this._context.gl,o=n.size;this._depthFBO.bind(),(this._context.isWebGL2||this._context.supportsDrawBuffers)&&i.readBuffer(this._depthAttachment),i.readPixels(e,o[1]-(t+.5),1,1,i.RGBA,i.UNSIGNED_BYTE,this._buffer);var c=u.decode_float24x1_from_uint8x3(a.vec3.fromValues(this._buffer[0],this._buffer[1],this._buffer[2]));return c=c>.996?void 0:c,this._cache&&this._cachedDepths.set(r,c),c},t.prototype.renderThenReadDepthAt=function(e,t){var r=this.hash(e,t);if(this._cache&&this._cachedDepths.has(r))return this._cachedDepths.get(r);s.assert(void 0!==this._depthFBO&&this._depthFBO.valid,"valid depth FBO expected for reading back depth");var n=this._depthFBO.texture(this._depthAttachment),i=this._context.gl,o=n.size;i.viewport(0,0,1,1),this._program.bind(),i.uniform2f(this._uOffset,e/o[0],(o[1]-t)/o[1]),i.uniform2f(this._uScale,1/o[0],1/o[1]),n.bind(i.TEXTURE0),this._framebuffer.bind(),this._ndcTriangle.bind(),this._ndcTriangle.draw(),this._ndcTriangle.unbind(),n.unbind(),(this._context.isWebGL2||this._context.supportsDrawBuffers)&&i.readBuffer&&i.readBuffer(i.COLOR_ATTACHMENT0),i.readPixels(0,0,1,1,i.RGBA,i.UNSIGNED_BYTE,this._buffer),this._framebuffer.unbind();var c=u.decode_float24x1_from_uint8x3(a.vec3.fromValues(this._buffer[0],this._buffer[1],this._buffer[2]));return c=c>.996?void 0:c,this._cache&&this._cachedDepths.set(r,c),c},t.prototype.initialize=function(e){var t=this._context.gl,n=this._context.gl2facade;if(this._context.isWebGL1&&!this._context.supportsDepthTexture)return this.depthAt=this.directReadDepthAt,!0;this.depthAt=this.renderThenReadDepthAt;var i=new p.Shader(this._context,t.VERTEX_SHADER,"ndcvertices.vert (readback)");i.initialize(r(13));var o=new p.Shader(this._context,t.FRAGMENT_SHADER,"readbackdepth.frag");if(o.initialize(r(45)),this._program=new h.Program(this._context,"ReadbackDepthProgram"),this._program.initialize([i,o]),this._uOffset=this._program.uniform("u_offset"),this._program.bind(),t.uniform1i(this._program.uniform("u_texture"),0),this._program.unbind(),this._texture=new d.Texture2(this._context,"ReadbackRenderTexture"),this._texture.initialize(1,1,t.RGBA,t.RGBA,t.UNSIGNED_BYTE),this._framebuffer=new c.Framebuffer(this._context,"ReadbackFBO"),this._framebuffer.initialize([[n.COLOR_ATTACHMENT0,this._texture]]),void 0===e?this._ndcTriangle=new f.NdcFillingTriangle(this._context):(this._ndcTriangle=e,this._ndcTriangleShared=!0),this._ndcTriangle.initialized)this._program.attribute("a_vertex",this._ndcTriangle.aVertex);else{var a=this._program.attribute("a_vertex",0);this._ndcTriangle.initialize(a)}return!0},t.prototype.uninitialize=function(){this._context.isWebGL1&&!this._context.supportsDepthTexture||(!this._ndcTriangleShared&&this._ndcTriangle.initialized&&this._ndcTriangle.uninitialize(),this._program.uninitialize(),this._texture.uninitialize(),this._framebuffer.uninitialize())},t.prototype.coordsAt=function(e,t,r,n){var i=this._depthFBO.texture(this._depthAttachment).size,o=void 0===r?this.depthAt(e,t):r;if(void 0!==o){var s=a.vec3.fromValues(2*e/i[0]-1,1-2*t/i[1],2*o-1);return a.vec3.transformMat4(a.vec3.create(),s,n)}},t.prototype.idAt=function(e,t){var r=this.hash(e,t);if(this._cache&&this._cachedIDs.has(r))return this._cachedIDs.get(r);var n=this._context.gl,i=this._idFBO.texture(this._idAttachment).size;this._idFBO.bind(),(this._context.isWebGL2||this._context.supportsDrawBuffers)&&n.readBuffer&&n.readBuffer(this._idAttachment),n.readPixels(e,i[1]-(t+.5),1,1,n.RGBA,n.UNSIGNED_BYTE,this._buffer);var o=u.decode_uint32_from_rgba8(a.vec4.fromValues(this._buffer[0],this._buffer[1],this._buffer[2],this._buffer[3]));return this._cache&&this._cachedIDs.set(r,o),o},Object.defineProperty(t.prototype,"cache",{set:function(e){this._cache=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"depthFBO",{set:function(e){this._depthFBO=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"depthAttachment",{set:function(e){this._depthAttachment=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"idFBO",{set:function(e){this._idFBO=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"idAttachment",{set:function(e){this._idAttachment=e},enumerable:!0,configurable:!0}),o([l.Initializable.assert_initialized()],t.prototype,"directReadDepthAt",null),o([l.Initializable.assert_initialized()],t.prototype,"renderThenReadDepthAt",null),o([l.Initializable.initialize()],t.prototype,"initialize",null),o([l.Initializable.uninitialize()],t.prototype,"uninitialize",null),o([l.Initializable.assert_initialized()],t.prototype,"coordsAt",null),o([l.Initializable.assert_initialized()],t.prototype,"idAt",null),t}(l.Initializable);t.ReadbackPass=_},function(e,t){e.exports="\r\nprecision lowp float;\r\n\r\n\r\n#if __VERSION__ == 100\r\n    #define texture(sampler, coord) texture2D(sampler, coord)\r\n#else \r\n    #define varying in\r\n#endif\r\n\r\n\r\n\r\n#if __VERSION__ == 100\r\n    #define fragColor gl_FragColor\r\n#else \r\n    layout(location = 0) out vec4 fragColor;\r\n#endif\r\n\r\n\r\nuniform sampler2D u_texture;\r\n\r\nvarying vec2 v_uv;\r\n\r\n\r\nvoid main(void)\r\n{\r\n    fragColor = texture(u_texture, v_uv);\r\n}\r\n"},function(e,t){e.exports="\r\nprecision lowp float;\r\n\r\n\r\n#if __VERSION__ == 100\r\n    #define texture(sampler, coord) texture2D(sampler, coord)\r\n#else \r\n    #define varying in\r\n#endif\r\n\r\n\r\n\r\n#if __VERSION__ == 100\r\n    #define fragColor gl_FragColor\r\n#else\r\n    layout(location = 0) out vec4 fragColor;\r\n#endif\r\n\r\n\r\nuniform float u_weight;\r\nuniform sampler2D u_accumulationTexture;\r\nuniform sampler2D u_currentFrameTexture;\r\n\r\nvarying vec2 v_uv;\r\n\r\n\r\nvoid main(void)\r\n{\r\n    vec4 accumulationColor = texture(u_accumulationTexture, v_uv);\r\n    vec4 currentFrameColor = texture(u_currentFrameTexture, v_uv);\r\n    fragColor = mix(accumulationColor, currentFrameColor, u_weight);\r\n}\r\n"},function(e){e.exports={kernel:[[[[-.49667,.0980561],[-.0589763,.0210422],[.370588,-.29204],[.259132,.381722],[.447602,-.20187],[-.449072,-.0478419],[.0656358,-.0346857],[-.31633,-.485536],[.13452,.43745],[.301704,.235824],[.190248,-.0904137],[.245976,-.236312],[-.247446,-.0133998],[.100078,.201382],[-.350772,.278396],[-.0245342,.25711],[.357432,.0899264],[.31486,-.146142],[.168962,-.326482],[-.358902,-.339638],[-.4065,-.19374],[.482044,.0341984],[.121364,-.180584],[.22469,.145654],[-.427786,.188226],[-.22616,-.395366],[.336146,.471892],[-.157276,-.305196],[.0311937,-.270754],[-.191718,.458736],[.155806,.0554843],[.211534,-.47238],[-.011378,-.124856],[.078792,-.416652],[-.260602,.368566],[-.337616,-.10357],[-.0458201,-.360924],[-.213004,.222668],[-.0802622,-.215026],[-.204874,-.159298],[-.101548,.16694],[-.393344,.424294],[.426316,.180096],[-.170432,.0767702],[-.372058,.0423281],[-.483514,-.28391],[-.114704,-.451094],[-.122834,-.0691278],[-.067106,.403008],[-.13599,.312838],[-.303174,.132498],[.177092,.291552],[-.462228,.334124],[.460758,.416164],[-.281888,-.249468],[.267262,-243664e-9],[.00990784,.493178],[.0443499,.34728],[.41316,-.437938],[.40503,-.0559716],[.391874,.325994],[-.440942,-.429808],[.023064,.111212],[.280418,-.38221]]]],size:{depth:1,height:1,width:64}}},function(e){e.exports={kernel:[[[[-.41692,-.0735727],[.201114,.0165974],[-.0906823,-.219471],[.437182,.252665],[-.180852,.162495],[.291284,-.365369],[.0552157,.398563],[-.32675,-.455539]]]],size:{depth:1,height:1,width:8}}},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),s=r(16),u=r(14),c=r(1),l=function(e){function t(t,r){var n=e.call(this,t,r)||this;r=void 0!==r&&""!==r?r:n.constructor.name;var i=new s.Buffer(t,r+"VBO");return n._buffers.push(i),n}return i(t,e),t.prototype.bindBuffers=function(e){this._buffers[0].attribEnable(e[0],2,this.context.gl.FLOAT,!1,0,0,!0,!1)},t.prototype.unbindBuffers=function(e){this._buffers[0].attribDisable(e[0],!0,!0)},t.prototype.initialize=function(r){var n=this.context.gl,i=e.prototype.initialize.call(this,[n.ARRAY_BUFFER],[r]);return a.assert(void 0!==this._buffers[0]&&this._buffers[0].object instanceof WebGLBuffer,"expected valid WebGLBuffer"),this._buffers[0].data(t.VERTICES,n.STATIC_DRAW),i},t.prototype.draw=function(){var e=this.context.gl;e.drawArrays(e.TRIANGLE_STRIP,0,4)},t.VERTICES=new Float32Array([-1,-1,1,-1,-1,1,1,1]),o([c.Initializable.assert_initialized()],t.prototype,"draw",null),t}(u.Geometry);t.NdcFillingRectangle=l},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.update=function(){},t}(r(5).CameraModifier);t.ZoomModifier=o},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.update=function(){},t}(r(5).CameraModifier);t.PanModifier=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=r(23),o=r(18),a=r(28),s=r(27),u=r(26),c=function(){function e(t,r){var n=this;this._alwaysRotateOnMove=!1,this._invalidate=t,this._eventHandler=new i.EventHandler(t,r),this._eventHandler.pushMouseDownHandler(function(e,t){return n.onMouseDown(e,t)}),this._eventHandler.pushMouseUpHandler(function(e,t){return n.onMouseUp(e,t)}),this._eventHandler.pushMouseMoveHandler(function(e,t){return n.onMouseMove(e,t)}),this._eventHandler.pushClickHandler(function(e,t){return n.onClick(e,t)}),this.metaphor=e.Metaphor.Turntable}return e.prototype.mode=function(t){var r=1&t.buttons,n="mousedown"===t.type,i="mousemove"===t.type;if(o.PointerLock.active()&&this._alwaysRotateOnMove||(n||i)&&r)return e.Modes.Rotate},e.prototype.rotate=function(t,r){var i=this._eventHandler.offsets(t)[0];switch(this._metaphor){case e.Metaphor.FirstPerson:var a=this._firstPerson,s=void 0;o.PointerLock.active()&&t instanceof MouseEvent&&(s=n.vec2.fromValues(t.movementX,t.movementY)),r?a.initiate(i):a.process(i,s),t.preventDefault();break;case e.Metaphor.Trackball:var u=this._trackball;r?u.initiate(i):u.process(i),t.preventDefault();break;case e.Metaphor.Turntable:var c=this._turntable;r?c.initiate(i):c.process(i),t.preventDefault()}},e.prototype.onMouseDown=function(t,r){var n=t[t.length-1];switch(this._mode=this.mode(n),this._mode){case e.Modes.Zoom:break;case e.Modes.Rotate:this.rotate(n,!0)}},e.prototype.onMouseUp=function(e,t){var r=e[e.length-1];void 0!==this._mode&&r.preventDefault()},e.prototype.onMouseMove=function(t,r){var n=t[t.length-1],i=void 0===this._mode;switch(this._mode=this.mode(n),this._mode){case e.Modes.Rotate:this.rotate(n,i)}},e.prototype.onClick=function(e,t){},e.prototype.update=function(){this._eventHandler.update()},Object.defineProperty(e.prototype,"camera",{set:function(e){this._camera=e,this._firstPerson&&(this._firstPerson.camera=e),this._trackball&&(this._trackball.camera=e),this._turntable&&(this._turntable.camera=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"metaphor",{get:function(){return this._metaphor},set:function(t){if(this._metaphor!==t){switch(this._firstPerson=void 0,this._trackball=void 0,this._turntable=void 0,this._eventHandler.exitPointerLock(),this._alwaysRotateOnMove=!1,this._metaphor=t,this._metaphor){case e.Metaphor.FirstPerson:this._eventHandler.requestPointerLock(),this._alwaysRotateOnMove=!0,this._firstPerson=new a.FirstPersonModifier,this._firstPerson.camera=this._camera;break;case e.Metaphor.Trackball:this._trackball=new s.TrackballModifier,this._trackball.camera=this._camera;break;case e.Metaphor.Turntable:this._turntable=new u.TurntableModifier,this._turntable.camera=this._camera}this._invalidate(!0)}},enumerable:!0,configurable:!0}),e}();t.Navigation=c,function(e){!function(e){e[e.Move=0]="Move",e[e.Pan=1]="Pan",e[e.Rotate=2]="Rotate",e[e.Zoom=3]="Zoom",e[e.ZoomStep=4]="ZoomStep"}(e.Modes||(e.Modes={})),function(e){e.FirstPerson="firstperson",e.Flight="flight",e.Trackball="trackball",e.Turntable="turntable"}(e.Metaphor||(e.Metaphor={}))}(c=t.Navigation||(t.Navigation={})),t.Navigation=c},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0});var a=r(0),s=r(15),u=r(1),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._size=0,t._internalFormat=0,t._format=0,t._type=0,t._bytes=[0,0,0,0,0,0],t}return i(t,e),t.prototype.faceID=function(e){var t=this._context.gl;switch(e){case t.TEXTURE_CUBE_MAP_POSITIVE_X:return 0;case t.TEXTURE_CUBE_MAP_NEGATIVE_X:return 1;case t.TEXTURE_CUBE_MAP_POSITIVE_Y:return 2;case t.TEXTURE_CUBE_MAP_NEGATIVE_Y:return 3;case t.TEXTURE_CUBE_MAP_POSITIVE_Z:return 4;case t.TEXTURE_CUBE_MAP_NEGATIVE_Z:return 5;default:return a.assert(!1,"expected texture cube map identifier ("+t.TEXTURE_CUBE_MAP_POSITIVE_X+", "+t.TEXTURE_CUBE_MAP_NEGATIVE_X+", "+t.TEXTURE_CUBE_MAP_POSITIVE_Y+", "+t.TEXTURE_CUBE_MAP_NEGATIVE_Y+", "+t.TEXTURE_CUBE_MAP_POSITIVE_Z+", or"+t.TEXTURE_CUBE_MAP_NEGATIVE_Z+"), given "+e),-1}},t.prototype.create=function(e,r,n,i){a.assert(e>0,"texture cube requires valid size (width/height) of greater than zero");var o=this._context.gl,s=this._context.gl2facade;return this._object=o.createTexture(),this._size=e,this._internalFormat=r,this._format=n,this._type=i,o.bindTexture(o.TEXTURE_CUBE_MAP,this._object),o.texParameteri(o.TEXTURE_CUBE_MAP,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_CUBE_MAP,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_CUBE_MAP,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_CUBE_MAP,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),s.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_X,0,this._internalFormat,this._size,this._size,0,this._format,this._type),s.texImage2D(o.TEXTURE_CUBE_MAP_NEGATIVE_X,0,this._internalFormat,this._size,this._size,0,this._format,this._type),s.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_Y,0,this._internalFormat,this._size,this._size,0,this._format,this._type),s.texImage2D(o.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,this._internalFormat,this._size,this._size,0,this._format,this._type),s.texImage2D(o.TEXTURE_CUBE_MAP_POSITIVE_Z,0,this._internalFormat,this._size,this._size,0,this._format,this._type),s.texImage2D(o.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,this._internalFormat,this._size,this._size,0,this._format,this._type),o.bindTexture(o.TEXTURE_CUBE_MAP,t.DEFAULT_TEXTURE),this._valid=o.isTexture(this._object),this.context.allocationRegister.reallocate(this._identifier,0),this._object},t.prototype.delete=function(){a.assert(this._object instanceof WebGLTexture,"expected WebGLTexture object"),this._context.gl.deleteTexture(this._object),this._object=void 0,this._valid=!1,this._internalFormat=0,this._format=0,this._type=0,this._size=0},t.prototype.bind=function(e){var t=this.context.gl;e&&t.activeTexture(e),t.bindTexture(t.TEXTURE_CUBE_MAP,this._object)},t.prototype.unbind=function(e){var r=this.context.gl;e&&r.activeTexture(e),r.bindTexture(r.TEXTURE_CUBE_MAP,t.DEFAULT_TEXTURE)},t.prototype.load=function(e,t){var r=this;void 0===t&&(t=!1);var n=this.context.gl;return new Promise(function(i,o){var s=new Array;e.positiveX&&s.push([n.TEXTURE_CUBE_MAP_POSITIVE_X,e.positiveX]),e.negativeX&&s.push([n.TEXTURE_CUBE_MAP_NEGATIVE_X,e.negativeX]),e.positiveY&&s.push([n.TEXTURE_CUBE_MAP_POSITIVE_Y,e.positiveY]),e.negativeY&&s.push([n.TEXTURE_CUBE_MAP_NEGATIVE_Y,e.negativeY]),e.positiveZ&&s.push([n.TEXTURE_CUBE_MAP_POSITIVE_Z,e.positiveZ]),e.negativeZ&&s.push([n.TEXTURE_CUBE_MAP_NEGATIVE_Z,e.negativeZ]);for(var u=s.length,c=function(e){var n=new Image;n.onerror=function(){return o()},n.onload=function(){n.width===n.height?n.width===r._size?(r.data([e[0],n]),0===(u-=1)&&i()):a.log(a.LogLevel.Dev,"image ignored, width and height expected to match this texture's size "+r._size+", given "+n.width):a.log(a.LogLevel.Dev,"image ignored, width and height expected to be equal (square image)")},t&&(n.crossOrigin="anonymous"),n.src=e[1]},l=0,f=s;l<f.length;l++){c(f[l])}})},t.prototype.data=function(e,t,r){void 0===t&&(t=!0),void 0===r&&(r=!0);var n=this.context.gl,i=this.context.gl2facade,o=this._size*this._size*s.byteSizeOfFormat(this.context,this._internalFormat);if(this._type===this.context.gl2facade.HALF_FLOAT&&this._internalFormat!==this.context.gl.RGBA16F?o*=2:this._type===this.context.gl.FLOAT&&this._internalFormat!==this.context.gl.RGBA16F&&(o*=4),t&&this.bind(),e instanceof Array&&2===e.length){i.texImage2D(e[0],0,this._internalFormat,this._size,this._size,0,this._format,this._type,e[1]);var a=this.faceID(e[0]);this.context.allocationRegister.deallocate(this._identifier,this._bytes[a]),this.context.allocationRegister.allocate(this._identifier,o),this._bytes[a]=o}else{var u=e;void 0!==u.positiveX&&(i.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X,0,this._internalFormat,this._size,this._size,0,this._format,this._type,u.positiveX),this.context.allocationRegister.deallocate(this._identifier,this._bytes[0]),this.context.allocationRegister.allocate(this._identifier,o),this._bytes[0]=o),void 0!==u.negativeX&&(i.texImage2D(n.TEXTURE_CUBE_MAP_NEGATIVE_X,0,this._internalFormat,this._size,this._size,0,this._format,this._type,u.negativeX),this.context.allocationRegister.deallocate(this._identifier,this._bytes[1]),this.context.allocationRegister.allocate(this._identifier,o),this._bytes[1]=o),void 0!==u.positiveY&&(i.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_Y,0,this._internalFormat,this._size,this._size,0,this._format,this._type,u.positiveY),this.context.allocationRegister.deallocate(this._identifier,this._bytes[2]),this.context.allocationRegister.allocate(this._identifier,o),this._bytes[2]=o),void 0!==u.negativeY&&(i.texImage2D(n.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,this._internalFormat,this._size,this._size,0,this._format,this._type,u.negativeY),this.context.allocationRegister.deallocate(this._identifier,this._bytes[3]),this.context.allocationRegister.allocate(this._identifier,o),this._bytes[3]=o),void 0!==u.positiveZ&&(i.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_Z,0,this._internalFormat,this._size,this._size,0,this._format,this._type,u.positiveZ),this.context.allocationRegister.deallocate(this._identifier,this._bytes[4]),this.context.allocationRegister.allocate(this._identifier,o),this._bytes[4]=o),void 0!==u.negativeZ&&(i.texImage2D(n.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,this._internalFormat,this._size,this._size,0,this._format,this._type,u.negativeZ),this.context.allocationRegister.deallocate(this._identifier,this._bytes[5]),this.context.allocationRegister.allocate(this._identifier,o),this._bytes[5]=o)}r&&this.unbind()},t.prototype.filter=function(e,t,r,n){void 0===r&&(r=!0),void 0===n&&(n=!0);var i=this.context.gl;r&&this.bind(),i.texParameteri(i.TEXTURE_CUBE_MAP,i.TEXTURE_MAG_FILTER,e),i.texParameteri(i.TEXTURE_CUBE_MAP,i.TEXTURE_MIN_FILTER,t),n&&this.unbind()},t.prototype.wrap=function(e,t,r,n){void 0===r&&(r=!0),void 0===n&&(n=!0);var i=this.context.gl;r&&this.bind(),i.texParameteri(i.TEXTURE_CUBE_MAP,i.TEXTURE_WRAP_S,e),i.texParameteri(i.TEXTURE_CUBE_MAP,i.TEXTURE_WRAP_T,t),n&&this.unbind()},t.prototype.reformat=function(e,t,r,n,i){void 0===n&&(n=!0),void 0===i&&(i=!0),(e!==this._internalFormat||void 0!==t&&t!==this._format||void 0!==r&&r!==this._type)&&(a.assert(void 0!==e,"valid internal format expected"),this._internalFormat=e,t&&(this._format=t),r&&(this._type=r),this.data({clearOnUndefined:!0},n,i))},t.prototype.resize=function(e,t,r){void 0===t&&(t=!0),void 0===r&&(r=!0),e!==this._size&&(this._size=e,this.data({clearOnUndefined:!0},t,r))},Object.defineProperty(t.prototype,"bytes",{get:function(){return this.assertInitialized(),this.context.allocationRegister.allocated(this._identifier)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"internalFormat",{get:function(){return this.assertInitialized(),this._internalFormat},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"format",{get:function(){return this.assertInitialized(),this._format},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this.assertInitialized(),this._type},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.assertInitialized(),this._size},enumerable:!0,configurable:!0}),t.DEFAULT_TEXTURE=void 0,o([u.Initializable.assert_initialized()],t.prototype,"bind",null),o([u.Initializable.assert_initialized()],t.prototype,"unbind",null),o([u.Initializable.assert_initialized()],t.prototype,"load",null),o([u.Initializable.assert_initialized()],t.prototype,"data",null),o([u.Initializable.assert_initialized()],t.prototype,"filter",null),o([u.Initializable.assert_initialized()],t.prototype,"wrap",null),o([u.Initializable.assert_initialized()],t.prototype,"reformat",null),o([u.Initializable.assert_initialized()],t.prototype,"resize",null),t}(r(4).AbstractObject);t.TextureCube=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=function(){function e(){if(this._resizeEventListener=function(){return e.resize()},0===e.instances.length){var t="on"+e.EVENT_IDENTIFIER;e.eventSupported=document&&(t in document.documentElement||t in document.body),n.logIf(!e.eventSupported,n.LogLevel.Dev,"resize event not supported")}0===e.instances.length&&e.eventSupported&&window.addEventListener(e.EVENT_IDENTIFIER,this._resizeEventListener),e.instances.push(this)}return e.resize=function(){n.assert(e.instances.length>0,"resize event received without a single resizable registered"),e.instances.forEach(function(e){return e.onResize()})},e.elementSize=function(e){if(void 0===e||void 0===window||"number"!=typeof window.devicePixelRatio)return[0,0];var t=window.devicePixelRatio,r=getComputedStyle(e),n=[parseInt(r.width,10),parseInt(r.height,10)];return n[0]=Math.round(n[0]*t),n[1]=Math.round(n[1]*t),n},e.prototype.dispose=function(){var t=e.instances.indexOf(this);n.assert(-1!==t,"invalid reference counting of resizable instances"),e.instances.splice(t,1),0===e.instances.length&&e.eventSupported&&window.removeEventListener(e.EVENT_IDENTIFIER,this._resizeEventListener)},e.EVENT_IDENTIFIER="resize",e.instances=[],e.eventSupported=!1,e}();t.Resizable=i},function(e,t,r){"use strict";var n,i=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var o=r(6),a=r(2),s=r(3),u=r(0),c=r(12),l=r(33),f=r(20),h=r(32),p=r(19),d=r(56),_=function(e){function t(r){var n=e.call(this)||this;n._framePrecisionSubject=new o.ReplaySubject(1),n._size=[1,1],n._sizeSubject=new o.ReplaySubject(1),n._frameScaleSubject=new o.ReplaySubject(1),n._frameSizeSubject=new o.ReplaySubject(1),n._element=r instanceof HTMLCanvasElement?r:document.getElementById(r),n._mouseEventProvider=new p.MouseEventProvider(n._element,200);var i,a=n._element.dataset;n._context=f.Context.request(n._element),n.configureController(a),n.configureSizeAndScale(a),a.clearColor&&(i=s.parseVec4(a.clearColor),u.logIf(void 0===i,u.LogLevel.Dev,"data-clear-color could not be parsed, given '"+a.clearColor+"'")),n._clearColor=i?new l.Color(c.tuple4(i)):t.DEFAULT_CLEAR_COLOR;var h=a.accumulationFormat;return n._framePrecision=h||t.DEFAULT_FRAME_PRECISION,n.framePrecisionNext(),n}return i(t,e),t.prototype.configureController=function(e){var r,n;this._controller=new h.Controller,this._controller.block(),e.multiFrameNumber&&(r=parseInt(e.multiFrameNumber,10),u.logIf(isNaN(r),u.LogLevel.Dev,"data-multi-frame-number could not be parsed, given '"+e.multiFrameNumber+"'")),e.debugFrameNumber&&(n=parseInt(e.debugFrameNumber,10),u.logIf(isNaN(n),u.LogLevel.Dev,"data-debug-frame-number could not be parsed, given '"+e.debugFrameNumber+"'")),this._controller.multiFrameNumber=r||t.DEFAULT_MULTI_FRAME_NUMBER,this._controller.debugFrameNumber=n||0;var i=!!r&&r!==this._controller.multiFrameNumber;u.logIf(i,u.LogLevel.Dev,"data-multi-frame-number changed to "+this._controller.multiFrameNumber+", given '"+e.multiFrameNumber+"'");var o=!!n&&n!==this._controller.debugFrameNumber;u.logIf(o,u.LogLevel.Dev,"data-debug-frame-number changed to "+this._controller.debugFrameNumber+", given '"+e.debugFrameNumber+"'")},t.prototype.configureSizeAndScale=function(e){var t,r;e.frameScale&&(t=s.parseVec2(e.frameScale),u.logIf(void 0!==e.frameScale&&void 0===t,u.LogLevel.Dev,"data-frame-scale could not be parsed, given '"+e.frameScale+"'")),this._frameScale=t?c.tuple2(t):[1,1],e.frameSize&&(r=s.parseVec2(e.frameSize),u.logIf(void 0!==e.frameSize&&void 0===r,u.LogLevel.Dev,"data-frame-size could not be parsed, given '"+e.frameSize+"'")),this._favorSizeOverScale=void 0!==r,this._frameSize=r?c.tuple2(r):[this._size[0],this._size[1]],this.onResize()},t.prototype.retrieveSize=function(){var e=d.Resizable.elementSize(this._element);this._size=[e[0],e[1]],this.sizeNext()},t.prototype.onResize=function(){this.retrieveSize(),this._element.width=this._size[0],this._element.height=this._size[1],this._renderer&&this._controller.block(),this._favorSizeOverScale?this.frameSize=this._frameSize:this.frameScale=this._frameScale,this._renderer&&this._controller.unblock()},t.prototype.framePrecisionNext=function(){this._framePrecisionSubject.next(this._framePrecision)},t.prototype.sizeNext=function(){this._sizeSubject.next(this._size)},t.prototype.frameScaleNext=function(){this._frameScaleSubject.next(this._frameScale)},t.prototype.frameSizeNext=function(){this._frameSizeSubject.next(this._frameSize)},t.prototype.bind=function(e){var t=this;this._renderer!==e&&(this.unbind(),void 0!==e&&(u.assert(this._controller.blocked,"expected controller to be blocked"),this._renderer=e,this._renderer.initialize(this.context,function(e){return t._controller.update(e)},this._mouseEventProvider),this._renderer.frameSize=this._frameSize,this._renderer.clearColor=this._clearColor.rgba,this._renderer.framePrecision=this._framePrecision,this._renderer.debugTexture=-1,this._controller.controllable=this._renderer,this._controller.unblock()))},t.prototype.unbind=function(){void 0!==this._renderer&&(this._controller.block(),this._controller.controllable=void 0,this._renderer=void 0)},t.prototype.dispose=function(){e.prototype.dispose.call(this),this._renderer&&(this._renderer.uninitialize(),this.unbind())},t.prototype.resize=function(){this.onResize()},Object.defineProperty(t.prototype,"controller",{get:function(){return this._controller},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderer",{get:function(){return this._renderer},set:function(e){this.bind(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"frameScale",{get:function(){return this._frameScale},set:function(e){u.logIf(e[0]<0||e[0]>1,u.LogLevel.Dev,"frame width scale clamped to [0.0,1.0], given "+e[0]),u.logIf(e[1]<0||e[1]>1,u.LogLevel.Dev,"frame height scale clamped to [0.0,1.0], given "+e[0]);var t=a.vec2.create();s.clamp2(t,e,[0,0],[1,1]);var r=a.vec2.create();a.vec2.mul(r,this._size,t),a.vec2.max(r,[1,1],r),a.vec2.round(r,r),a.vec2.div(t,r,this._size),u.logIf(!a.vec2.exactEquals(t,e),2,"frame scale was adjusted to "+t.toString()+", given "+e.toString()),this._frameScale=c.tuple2(t),this._frameSize=c.tuple2(r),this._favorSizeOverScale=!1,this.frameScaleNext(),this.frameSizeNext(),this._renderer&&(this._renderer.frameSize=this._frameSize)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"frameScaleObservable",{get:function(){return this._frameScaleSubject.asObservable()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"frameSize",{get:function(){return this._frameSize},set:function(e){u.logIf(e[0]<1||e[0]>this._size[0],u.LogLevel.Dev,"frame width scale clamped to [1,"+this._size[0]+"], given "+e[0]),u.logIf(e[1]<1||e[1]>this._size[1],u.LogLevel.Dev,"frame height scale clamped to [1, "+this._size[1]+"], given "+e[1]);var t=a.vec2.create();s.clamp2(t,e,[1,1],this._size),a.vec2.round(t,t),u.logIf(!a.vec2.exactEquals(t,e),u.LogLevel.ModuleDev,"frame size was adjusted to "+t.toString()+", given "+e.toString());var r=a.vec2.create();a.vec2.div(r,t,this._size),this._frameScale=c.tuple2(r),this._frameSize=c.tuple2(t),this._favorSizeOverScale=!a.vec2.exactEquals(this._frameSize,this._size),this.frameScaleNext(),this.frameSizeNext(),this._renderer&&(this._renderer.frameSize=this._frameSize)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"frameSizeObservable",{get:function(){return this._frameSizeSubject.asObservable()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"clearColor",{get:function(){return this._clearColor},set:function(e){this._clearColor=e,this._renderer&&(this._renderer.clearColor=this._clearColor.rgba)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"framePrecision",{get:function(){return this._framePrecision},set:function(e){this._framePrecision=e,this._renderer&&(this._renderer.framePrecision=this._framePrecision,this._framePrecision=this._renderer.framePrecision),this.framePrecisionNext()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"framePrecisionObservable",{get:function(){return this._framePrecisionSubject.asObservable()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"context",{get:function(){return this._context},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"backend",{get:function(){return this._context.backendString},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sizeObservable",{get:function(){return this._sizeSubject.asObservable()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._size[0]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._size[1]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"element",{get:function(){return this._element},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mouseEventProvider",{get:function(){return this._mouseEventProvider},enumerable:!0,configurable:!0}),t.DEFAULT_CLEAR_COLOR=new l.Color([.203,.227,.25,1]),t.DEFAULT_FRAME_PRECISION="auto",t.DEFAULT_MULTI_FRAME_NUMBER=0,t}(d.Resizable);t.Canvas=_},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(20),o=function(){function e(e){this.drawBuffers=void 0,n.assert(void 0!==e,"gl2 facade expects a valid WebGL context"),this.queryHalfFloatSupport(e),this.queryColorAttachments(e),this.queryInstancedArraySupport(e),this.queryDrawBuffersSupport(e),this.queryVertexArrayObjectSupport(e),this.queryMaxUniformVec3Components(e),this.queryTexImageInterface(e)}return Object.defineProperty(e.prototype,"HALF_FLOAT",{get:function(){return this._halfFloat},enumerable:!0,configurable:!0}),e.prototype.queryHalfFloatSupport=function(e){switch(e.backend){case i.BackendType.WebGL1:this._halfFloat=e.supportsTextureHalfFloat&&e.textureHalfFloat?e.textureHalfFloat.HALF_FLOAT_OES:void 0;break;case i.BackendType.WebGL2:default:this._halfFloat=e.gl.HALF_FLOAT}},Object.defineProperty(e.prototype,"COLOR_ATTACHMENT_MIN",{get:function(){return this._colorAttachmentMin},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"COLOR_ATTACHMENT_MAX",{get:function(){return this._colorAttachmentMax},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"COLOR_ATTACHMENT0",{get:function(){return this._colorAttachments[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"COLOR_ATTACHMENT1",{get:function(){return this._colorAttachments[1]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"COLOR_ATTACHMENT2",{get:function(){return this._colorAttachments[2]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"COLOR_ATTACHMENT3",{get:function(){return this._colorAttachments[3]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"COLOR_ATTACHMENT4",{get:function(){return this._colorAttachments[4]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"COLOR_ATTACHMENT5",{get:function(){return this._colorAttachments[5]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"COLOR_ATTACHMENT6",{get:function(){return this._colorAttachments[6]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"COLOR_ATTACHMENT7",{get:function(){return this._colorAttachments[7]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"COLOR_ATTACHMENT8",{get:function(){return this._colorAttachments[8]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"COLOR_ATTACHMENT9",{get:function(){return this._colorAttachments[9]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"COLOR_ATTACHMENT10",{get:function(){return this._colorAttachments[10]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"COLOR_ATTACHMENT11",{get:function(){return this._colorAttachments[11]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"COLOR_ATTACHMENT12",{get:function(){return this._colorAttachments[12]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"COLOR_ATTACHMENT13",{get:function(){return this._colorAttachments[13]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"COLOR_ATTACHMENT14",{get:function(){return this._colorAttachments[14]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"COLOR_ATTACHMENT15",{get:function(){return this._colorAttachments[15]},enumerable:!0,configurable:!0}),e.prototype.queryColorAttachments=function(e){var t=e.gl;switch(this._colorAttachments=new Array(16),this._colorAttachments[0]=t.COLOR_ATTACHMENT0,e.backend){case i.BackendType.WebGL1:var r=e.supportsDrawBuffers?e.drawBuffers:void 0;if(this._colorAttachmentMin=this._colorAttachments[0],this._colorAttachmentMax=this._colorAttachmentMin+(r?t.getParameter(r.MAX_COLOR_ATTACHMENTS_WEBGL):0),this._colorAttachments[0]=r?r.COLOR_ATTACHMENT0_WEBGL:t.COLOR_ATTACHMENT0,!r)break;for(var n=1;n<16;++n)this._colorAttachments[n]=r.COLOR_ATTACHMENT0_WEBGL+n;break;case i.BackendType.WebGL2:default:this._colorAttachmentMin=e.gl.COLOR_ATTACHMENT0,this._colorAttachmentMax=e.gl.COLOR_ATTACHMENT0+t.getParameter(t.MAX_COLOR_ATTACHMENTS);for(n=0;n<16;++n)this._colorAttachments[n]=t.COLOR_ATTACHMENT0+n}},e.prototype.queryInstancedArraySupport=function(e){(e.isWebGL2||e.supportsInstancedArrays)&&(this.drawArraysInstanced=e.isWebGL2?function(t,r,n,i){return e.gl.drawArraysInstanced(t,r,n,i)}:function(t,r,n,i){return e.instancedArrays.drawArraysInstancedANGLE(t,r,n,i)},this.drawElementsInstanced=e.isWebGL2?function(t,r,n,i,o){return e.gl.drawElementsInstanced(t,r,n,i,o)}:function(t,r,n,i,o){return e.instancedArrays.drawElementsInstancedANGLE(t,r,n,i,o)},this.vertexAttribDivisor=e.isWebGL2?function(t,r){return e.gl.vertexAttribDivisor(t,r)}:function(t,r){return e.instancedArrays.vertexAttribDivisorANGLE(t,r)})},e.prototype.queryDrawBuffersSupport=function(e){(e.isWebGL2||e.supportsDrawBuffers)&&(this.drawBuffers=e.isWebGL2?function(t){return e.gl.drawBuffers(t)}:function(t){return e.drawBuffers.drawBuffersWEBGL(t)})},e.prototype.queryVertexArrayObjectSupport=function(e){(e.isWebGL2||e.supportsVertexArrayObject)&&(this.createVertexArray=e.isWebGL2?function(){return e.gl.createVertexArray()}:function(){return e.vertexArrayObject.createVertexArrayOES()},this.deleteVertexArray=e.isWebGL2?function(t){return e.gl.deleteVertexArray(t)}:function(t){return e.vertexArrayObject.deleteVertexArrayOES(t)},this.isVertexArray=e.isWebGL2?function(t){return e.gl.isVertexArray(t)}:function(t){return e.vertexArrayObject.isVertexArrayOES(t)},this.bindVertexArray=e.isWebGL2?function(t){return e.gl.bindVertexArray(t)}:function(t){return e.vertexArrayObject.bindVertexArrayOES(t)})},Object.defineProperty(e.prototype,"maxUniformVec3Components",{get:function(){return this._maxUniformVec3Components},enumerable:!0,configurable:!0}),e.prototype.queryMaxUniformVec3Components=function(e){var t=e.gl;this._maxUniformVec3Components=e.isWebGL2?t.getParameter(t.MAX_VERTEX_UNIFORM_COMPONENTS):3*t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS)},e.prototype.queryTexImageInterface=function(e){var t=e.gl;e.isWebGL2?this.texImage2D=function(e,r,i,o,a,s,u,c,l,f){return l instanceof ArrayBuffer?t.texImage2D(e,r,i,o,a,s,u,c,void 0===l?null:l,f):(n.assert(void 0===f,"offset expected to be undefined for non ArrayBuffer source"),t.texImage2D(e,r,i,o,a,s,u,c,void 0===l?null:l))}:this.texImage2D=function(e,r,n,i,o,a,s,u,c,l){return void 0===c?t.texImage2D(e,r,n,i,o,a,s,u,null):c instanceof Int8Array||c instanceof Uint8Array||c instanceof Uint8ClampedArray||c instanceof Int16Array||c instanceof Uint16Array||c instanceof Int32Array||c instanceof Uint32Array||c instanceof Float32Array||c instanceof Float64Array||c instanceof DataView?t.texImage2D(e,r,n,i,o,a,s,u,c):t.texImage2D(e,r,n,s,u,c)}},e}();t.GL2Facade=o},function(e){e.exports={presets:[{identifier:"chrome-63",backend:"webgl2",extensions_strive:["EXT_color_buffer_float","EXT_disjoint_timer_query_webgl2","EXT_texture_filter_anisotropic","OES_texture_float_linear","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_debug_renderer_info","WEBGL_debug_shaders","WEBGL_lose_context"]},{identifier:"edge-41",backend:"webgl1",extensions_strive:["ANGLE_instanced_arrays","EXT_frag_depth","EXT_texture_filter_anisotropic","OES_texture_float","OES_texture_float_linear","OES_standard_derivatives","OES_element_index_uint","OES_texture_half_float","OES_texture_half_float_linear","WEBGL_compressed_texture_s3tc","WEBGL_debug_renderer_info","WEBGL_depth_texture"]},{identifier:"ie-11",backend:"webgl1",extensions_strive:["ANGLE_instanced_arrays","EXT_texture_filter_anisotropic","OES_texture_float","OES_texture_float_linear","OES_standard_derivatives","OES_element_index_uint","WEBGL_compressed_texture_s3tc","WEBGL_debug_renderer_info"]},{identifier:"firefox-57",backend:"webgl2",extensions_strive:["EXT_color_buffer_float","EXT_texture_filter_anisotropic","EXT_disjoint_timer_query","OES_texture_float_linear","WEBGL_compressed_texture_s3tc","WEBGL_debug_renderer_info","WEBGL_debug_shaders","WEBGL_lose_context","MOZ_WEBGL_lose_context","MOZ_WEBGL_compressed_texture_s3tc"]},{identifier:"safari-10.1",backend:"webgl1",extensions_strive:["compressed_texture_pvrtc","compressed_texture_s3tc","debug_renderer_info","disjoint_timer_query","draw_buffers","element_index_uint","frag_depth","instanced_arrays","lose_context","sRGB","shader_texture_lod","standard_derivatives","texture_filter_anisotropic","texture_float","texture_float_linear","texture_half_float","texture_half_float_linear","vertex_array_object"],functions_undefine:["readBuffer"]},{identifier:"no-WEBGL_draw_buffers",backend:"webgl1",extensions_conceal:["WEBGL_draw_buffers"]},{identifier:"no-readBuffer",extensions_hash:"100000",functions_undefine:["readBuffer"]},{identifier:"webgl1",extensions_hash:"1+++++"},{identifier:"webgl2",extensions_hash:"2+++++"}]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(6),i=r(0),o=function(){function e(){this._bytesByIdentifier=new Map,this._bytes=0,this._bytesSubject=new n.ReplaySubject(1)}return e.prototype.bytesNext=function(){this._bytesSubject.next([this._bytes,this.bytesToString()])},e.prototype.assertIdentifier=function(e){i.assert(this._bytesByIdentifier.has(e),"allocation identifier unknown")},e.prototype.createUniqueIdentifier=function(e){for(var t=e,r=2;this._bytesByIdentifier.has(t);)t=e+"-"+r,++r;return this._bytesByIdentifier.set(t,0),t},e.prototype.deleteUniqueIdentifier=function(e){i.assert(this._bytesByIdentifier.has(e),"identifier expected to be known for allocation registration"),this._bytesByIdentifier.delete(e)},e.prototype.allocate=function(e,t){if(this.assertIdentifier(e),i.assert(t>=0,"positive number of bytes expected for allocation, given "+t),0!==t){var r=this._bytesByIdentifier.get(e)+t;this._bytesByIdentifier.set(e,r),this._bytes=this._bytes+t,this.bytesNext()}},e.prototype.deallocate=function(e,t){this.assertIdentifier(e);var r=this._bytesByIdentifier.get(e);i.assert(t>=0,"positive number of bytes expected for deallocation, given "+t),i.assert(t<=r,"deallocation cannot exceed previous allocations of "+r+", given "+t),0!==t&&(this._bytesByIdentifier.set(e,r-t),this._bytes=this._bytes-t,this.bytesNext())},e.prototype.reallocate=function(e,t){this.assertIdentifier(e),i.assert(t>=0,"positive number of bytes expected for reallocation, given "+t);var r=this._bytesByIdentifier.get(e);r!==t&&(this._bytes=this._bytes-r,this._bytesByIdentifier.set(e,t),this._bytes=this._bytes+t,this.bytesNext())},e.prototype.allocated=function(e){return void 0===e?this._bytes:(this.assertIdentifier(e),this._bytesByIdentifier.get(e))},e.prototype.toString=function(){var e=new Array;return this._bytesByIdentifier.forEach(function(t,r){e.push(r+": "+i.prettyPrintBytes(t))}),e.join(", ")},e.prototype.bytesToString=function(e){return i.prettyPrintBytes(this.allocated(e))},Object.defineProperty(e.prototype,"bytes",{get:function(){return this._bytes},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bytesObservable",{get:function(){return this._bytesSubject.asObservable()},enumerable:!0,configurable:!0}),e}();t.AllocationRegister=o},function(e,t,r){"use strict";var n=new RegExp("%[a-f0-9]{2}","gi"),i=new RegExp("(%[a-f0-9]{2})+","gi");function o(e,t){try{return decodeURIComponent(e.join(""))}catch(e){}if(1===e.length)return e;t=t||1;var r=e.slice(0,t),n=e.slice(t);return Array.prototype.concat.call([],o(r),o(n))}function a(e){try{return decodeURIComponent(e)}catch(i){for(var t=e.match(n),r=1;r<t.length;r++)t=(e=o(t,r).join("")).match(n);return e}}e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"","%FF%FE":""},r=i.exec(e);r;){try{t[r[0]]=decodeURIComponent(r[0])}catch(e){var n=a(r[0]);n!==r[0]&&(t[r[0]]=n)}r=i.exec(e)}t["%C2"]="";for(var o=Object.keys(t),s=0;s<o.length;s++){var u=o[s];e=e.replace(new RegExp(u,"g"),t[u])}return e}(e)}}},function(e,t,r){"use strict";e.exports=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}},function(e,t,r){"use strict";const n=r(62),i=r(61);function o(e,t){return t.encode?t.strict?n(e):encodeURIComponent(e):e}function a(e){const t=e.indexOf("?");return-1===t?"":e.slice(t+1)}function s(e,t){const r=function(e){let t;switch(e.arrayFormat){case"index":return(e,r,n)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===n[e]&&(n[e]={}),n[e][t[1]]=r):n[e]=r};case"bracket":return(e,r,n)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==n[e]?n[e]=[].concat(n[e],r):n[e]=[r]:n[e]=r};default:return(e,t,r)=>{void 0!==r[e]?r[e]=[].concat(r[e],t):r[e]=t}}}(t=Object.assign({arrayFormat:"none"},t)),n=Object.create(null);if("string"!=typeof e)return n;if(!(e=e.trim().replace(/^[?#&]/,"")))return n;for(const t of e.split("&")){let[e,o]=t.replace(/\+/g," ").split("=");o=void 0===o?null:i(o),r(i(e),o,n)}return Object.keys(n).sort().reduce((e,t)=>{const r=n[t];return Boolean(r)&&"object"==typeof r&&!Array.isArray(r)?e[t]=function e(t){return Array.isArray(t)?t.sort():"object"==typeof t?e(Object.keys(t)).sort((e,t)=>Number(e)-Number(t)).map(e=>t[e]):t}(r):e[t]=r,e},Object.create(null))}t.extract=a,t.parse=s,t.stringify=((e,t)=>{!1===(t=Object.assign({encode:!0,strict:!0,arrayFormat:"none"},t)).sort&&(t.sort=(()=>{}));const r=function(e){switch(e.arrayFormat){case"index":return(t,r,n)=>null===r?[o(t,e),"[",n,"]"].join(""):[o(t,e),"[",o(n,e),"]=",o(r,e)].join("");case"bracket":return(t,r)=>null===r?o(t,e):[o(t,e),"[]=",o(r,e)].join("");default:return(t,r)=>null===r?o(t,e):[o(t,e),"=",o(r,e)].join("")}}(t);return e?Object.keys(e).sort(t.sort).map(n=>{const i=e[n];if(void 0===i)return"";if(null===i)return o(n,t);if(Array.isArray(i)){const e=[];for(const t of i.slice())void 0!==t&&e.push(r(n,t,e.length));return e.join("&")}return o(n,t)+"="+o(i,t)}).filter(e=>e.length>0).join("&"):""}),t.parseUrl=((e,t)=>({url:e.split("?")[0]||"",query:s(a(e),t)}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(20);t.Context=n.Context;var i=r(57);t.Canvas=i.Canvas;var o=r(32);t.Controller=o.Controller;var a=r(36);t.ContextMasquerade=a.ContextMasquerade;var s=r(35);t.ExtensionsHash=s.ExtensionsHash;var u=r(17);t.ChangeLookup=u.ChangeLookup;var c=r(19);t.MouseEventProvider=c.MouseEventProvider;var l=r(23);t.EventHandler=l.EventHandler;var f=r(16);t.Buffer=f.Buffer;var h=r(33);t.Color=h.Color;var p=r(41);t.DefaultFramebuffer=p.DefaultFramebuffer;var d=r(11);t.Framebuffer=d.Framebuffer;var _=r(14);t.Geometry=_.Geometry;var b=r(9);t.Program=b.Program;var m=r(22);t.Renderbuffer=m.Renderbuffer;var v=r(40);t.Renderer=v.Renderer;var g=r(8);t.Shader=g.Shader;var y=r(10);t.Texture2=y.Texture2;var x=r(55);t.TextureCube=x.TextureCube;var E=r(31);t.VertexArray=E.VertexArray;var T=r(30);t.Wizard=T.Wizard;var O=r(29);t.Camera=O.Camera;var M=r(5);t.CameraModifier=M.CameraModifier;var A=r(54);t.Navigation=A.Navigation;var P=r(28);t.FirstPersonModifier=P.FirstPersonModifier;var j=r(53);t.PanModifier=j.PanModifier;var w=r(18);t.PointerLock=w.PointerLock;var R=r(27);t.TrackballModifier=R.TrackballModifier;var L=r(26);t.TurntableModifier=L.TurntableModifier;var F=r(52);t.ZoomModifier=F.ZoomModifier;var S=r(51);t.NdcFillingRectangle=S.NdcFillingRectangle;var B=r(7);t.NdcFillingTriangle=B.NdcFillingTriangle;var I=r(39);t.AntiAliasingKernel=I.AntiAliasingKernel;var z=r(25);t.RandomSquareKernel=z.RandomSquareKernel;var N=r(24);t.KernelF32=N.KernelF32,t.KernelI32=N.KernelI32,t.KernelI8=N.KernelI8,t.KernelUI32=N.KernelUI32,t.KernelUI8=N.KernelUI8;var C=r(38);t.AccumulatePass=C.AccumulatePass;var G=r(37);t.BlitPass=G.BlitPass;var U=r(46);t.ReadbackPass=U.ReadbackPass;var D=r(0);t.auxiliaries=D;var k=r(3);t.gl_matrix_extensions=k;var W=r(44);t.ray_math=W;var q=r(12);t.tuples=q},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(23),i=function(){function e(e,t){var r=this;this._altered=!1,this._eventHandler=new n.EventHandler(e,t),this._eventHandler.pushMouseEnterHandler(function(e,t){return r.onMouseEnter(e,t)}),this._eventHandler.pushMouseLeaveHandler(function(e,t){return r.onMouseLeave(e,t)})}return e.prototype.onMouseEnter=function(e,t){this._altered=!1},e.prototype.onMouseLeave=function(e,t){this._altered=!0},e.prototype.update=function(){this._eventHandler.update()},e.prototype.reset=function(){this._altered=!1},Object.defineProperty(e.prototype,"altered",{get:function(){return this._altered},enumerable:!0,configurable:!0}),e}();t.TestNavigation=i},,function(e,t,r){"use strict";var n,i=r(0);!function(e){var t=function(){function e(){}return e.queryAndCacheAPI=function(){if(void 0===e._exit){for(var t=window.document,r=[t.exitFullScreen,t.msExitFullscreen,t.mozCancelFullScreen,t.webkitExitFullscreen,void 0],n=0;n<r.length&&void 0===r[n];++n);switch(n){case 0:e._exit=function(){return t.exitFullScreen()},e._request=function(e){return e.requestFullscreen()},e._element=function(){return t.fullscreenElement},e._event="fullscreenchange";break;case 1:e._exit=function(){return t.msExitFullscreen()},e._request=function(e){return e.msRequestFullscreen()},e._element=function(){return t.msFullscreenElement},e._event="msfullscreenchange";break;case 2:e._exit=function(){return t.mozCancelFullScreen()},e._request=function(e){return e.mozRequestFullScreen()},e._element=function(){return t.mozFullScreenElement},e._event="mozfullscreenchange";break;case 3:e._exit=function(){return t.webkitExitFullscreen()},e._request=function(e){return e.webkitRequestFullscreen()},e._element=function(){return t.webkitFullscreenElement},e._event="webkitfullscreenchange";break;default:i.assert(!1,"none of the following fullscreen apis was found: native, ms, moz, or webkit")}}},e.active=function(){return void 0!==e._element()&&null!==e._element()},e.toggle=function(t,r){if(void 0!==t){e.queryAndCacheAPI();var n=e.active();if(!n){var i=getComputedStyle(t);e._size[0]=i.width,e._size[1]=i.height}r&&r(),n?(e._callback=void 0,window.removeEventListener(e._event,e.removeEventListener),t.style.width=e._size[0],t.style.height=e._size[1]):(e._callback=r,window.addEventListener(e._event,e.addEventListener)),n?e._exit():e._request(t)}},e._size=["0","0"],e.addEventListener=function(){window.removeEventListener(e._event,e.addEventListener),window.addEventListener(e._event,e.removeEventListener)},e.removeEventListener=function(){e._callback&&(e._callback(),e._callback=void 0),window.removeEventListener(e._event,e.removeEventListener)},e}();e.Fullscreen=t}(n||(n={})),e.exports=n},function(e,t,r){"use strict";var n;!function(e){var t=function(){function e(e,t){if(this._blockListenerByEvent=new Map,this._element=e,void 0!==t)for(var r=0,n=t;r<n.length;r++){var i=n[r];this.block(i)}}return e.prototype.block=function(e){this._blockListenerByEvent.has(e)||(this._blockListenerByEvent.set(e,function(e){return e.preventDefault(),e.stopPropagation(),!1}),this._element.addEventListener(e,this._blockListenerByEvent.get(e)))},e.prototype.unblock=function(e){this._blockListenerByEvent.has(e)&&(this._element.removeEventListener(e,this._blockListenerByEvent.get(e)),this._blockListenerByEvent.delete(e))},e}();e.EventBlocker=t}(n||(n={})),e.exports=n},function(e,t){e.exports="\r\nprecision lowp float;\r\n\r\n\r\n#if __VERSION__ == 100\r\n    #define texture(sampler, coord) texture2D(sampler, coord)\r\n#else \r\n    #define varying in\r\n#endif\r\n\r\n\r\n\r\n#if __VERSION__ == 100\r\n    #define fragColor gl_FragColor\r\n    #extension GL_OES_standard_derivatives : enable\r\n#else \r\n    layout(location = 0) out vec4 fragColor;\r\n#endif\r\n\r\nuniform int u_frameNumber;\r\n\r\nvarying vec2 v_uv;\r\n\r\n\r\nvoid main(void)\r\n{\r\n    vec3 color = vec3(28.0 / 255.0, 117.0 / 255.0, 188.0 / 255.0);\r\n    color += (vec3(0.0, v_uv) - 0.5) * 0.125;\r\n\r\n    vec2 awidth = fwidth(v_uv) * (sin(float(u_frameNumber) * 0.1) * 7.0 + 8.0);\r\n    vec2 cstep = abs(step(awidth, v_uv) - step(awidth, 1.0 - v_uv));\r\n    if(!any(bvec2(cstep))) {\r\n        discard;\r\n    }\r\n    fragColor = vec4(color, 1.0); \r\n}\r\n"},function(e,t){e.exports="\r\nprecision lowp float;\r\n\r\n\r\n#if __VERSION__ == 100\r\n#else \r\n    #define varying out\r\n#endif\r\n\r\n\r\nvoid ndcOffset(inout vec4 vertex, in vec2 offset) {\r\n    vertex.xy = offset * vec2(vertex.w) + vertex.xy;\r\n}\r\n\r\n\r\n\r\n#if __VERSION__ == 100\r\n    attribute vec2 a_vertex;\r\n#else \r\n    layout(location = 0) in vec2 a_vertex;\r\n#endif\r\n\r\nuniform vec2 u_ndcOffset;\r\n\r\nvarying vec2 v_uv;\r\n\r\n\r\nvoid main(void)\r\n{\r\n    v_uv = a_vertex.xy * 0.5 + 0.5;\r\n\r\n    vec4 vertex = vec4(a_vertex, 0.0, 1.0);\r\n    ndcOffset(vertex, u_ndcOffset);\r\n\r\n    gl_Position = vertex;\r\n}\r\n"},function(e,t,r){"use strict";var n,i,o=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),a=r(0),s=r(38),u=r(39),c=r(37),l=r(41),f=r(11),h=r(7),p=r(9),d=r(22),_=r(40),b=r(8),m=r(10),v=r(65);!function(e){var t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._extensions=!1,t}return o(t,e),t.prototype.onInitialize=function(e,t,n){var i=this,o=this._context.gl,_=this._context.gl2facade;!1===this._extensions&&this._context.isWebGL1&&(a.assert(this._context.supportsStandardDerivatives,"expected OES_standard_derivatives support"),this._context.standardDerivatives,this._extensions=!0);var g=new b.Shader(this._context,o.VERTEX_SHADER,"testrenderer.vert");g.initialize(r(70));var y=new b.Shader(this._context,o.FRAGMENT_SHADER,"testrenderer.frag");y.initialize(r(69)),this._program=new p.Program(this._context),this._program.initialize([g,y]),this._uNdcOffset=this._program.uniform("u_ndcOffset"),this._uFrameNumber=this._program.uniform("u_frameNumber"),this._ndcTriangle=new h.NdcFillingTriangle(this._context);var x=this._program.attribute("a_vertex",0);return this._ndcTriangle.initialize(x),this._ndcOffsetKernel=new u.AntiAliasingKernel(this._multiFrameNumber),this._defaultFBO=new l.DefaultFramebuffer(this._context,"DefaultFBO"),this._defaultFBO.initialize(),this._colorRenderTexture=new m.Texture2(this._context,"ColorRenderTexture"),this._depthRenderbuffer=new d.Renderbuffer(this._context,"DepthRenderbuffer"),this._intermediateFBO=new f.Framebuffer(this._context,"IntermediateFBO"),this._accumulate=new s.AccumulatePass(this._context),this._accumulate.initialize(this._ndcTriangle),this._accumulate.precision=this._framePrecision,this._accumulate.texture=this._colorRenderTexture,this._blit=new c.BlitPass(this._context),this._blit.initialize(this._ndcTriangle),this._blit.readBuffer=_.COLOR_ATTACHMENT0,this._blit.drawBuffer=o.BACK,this._blit.target=this._defaultFBO,this._testNavigation=new v.TestNavigation(function(){return i.invalidate()},n),!0},t.prototype.onUninitialize=function(){e.prototype.uninitialize.call(this),this._uNdcOffset=-1,this._uFrameNumber=-1,this._program.uninitialize(),this._ndcTriangle.uninitialize(),this._intermediateFBO.uninitialize(),this._defaultFBO.uninitialize(),this._colorRenderTexture.uninitialize(),this._depthRenderbuffer.uninitialize(),this._blit.uninitialize()},t.prototype.onUpdate=function(){this._testNavigation.update();var e=this._testNavigation.altered;return this._testNavigation.reset(),!(!e&&!this._altered.any)&&(this._altered.multiFrameNumber&&(this._ndcOffsetKernel.width=this._multiFrameNumber),e)},t.prototype.onPrepare=function(){var e=this._context.gl,t=this._context.gl2facade;this._intermediateFBO.initialized?this._altered.frameSize&&this._intermediateFBO.resize(this._frameSize[0],this._frameSize[1]):(this._colorRenderTexture.initialize(this._frameSize[0],this._frameSize[1],this._context.isWebGL2?e.RGBA8:e.RGBA,e.RGBA,e.UNSIGNED_BYTE),this._depthRenderbuffer.initialize(this._frameSize[0],this._frameSize[1],e.DEPTH_COMPONENT16),this._intermediateFBO.initialize([[t.COLOR_ATTACHMENT0,this._colorRenderTexture],[e.DEPTH_ATTACHMENT,this._depthRenderbuffer]])),this._altered.clearColor&&this._intermediateFBO.clearColor(this._clearColor),this._accumulate.update(),this._altered.reset()},t.prototype.onFrame=function(e){var t=this._context.gl;t.viewport(0,0,this._frameSize[0],this._frameSize[1]),this._program.bind();var r=this._ndcOffsetKernel.get(e);r[0]=2*r[0]/this._frameSize[0],r[1]=2*r[1]/this._frameSize[1],t.uniform2fv(this._uNdcOffset,r),t.uniform1i(this._uFrameNumber,e),this._intermediateFBO.clear(t.COLOR_BUFFER_BIT,!0,!1),this._ndcTriangle.bind(),this._ndcTriangle.draw(),this._intermediateFBO.unbind(),this._accumulate.frame(e)},t.prototype.onSwap=function(){this._blit.framebuffer=this._accumulate.framebuffer?this._accumulate.framebuffer:this._blit.framebuffer=this._intermediateFBO,this._blit.frame()},t}(_.Renderer);e.TestRenderer=t}(i||(i={})),e.exports=i},function(e,t,r){"use strict";var n=r(21),i=n.ValidatorResult,o=n.SchemaError,a={ignoreProperties:{id:!0,default:!0,description:!0,title:!0,exclusiveMinimum:!0,exclusiveMaximum:!0,additionalItems:!0,$schema:!0,$ref:!0,extends:!0}},s=a.validators={};function u(e,t,r,n,i){var o=t.throwError;t.throwError=!1;var a=this.validateSchema(e,i,t,r);return t.throwError=o,!a.valid&&n instanceof Function&&n(a),a.valid}function c(e,t,r,n,i,o){if(this.types.object(e)&&(!t.properties||void 0===t.properties[i]))if(!1===t.additionalProperties)o.addError({name:"additionalProperties",argument:i,message:"additionalProperty "+JSON.stringify(i)+" exists in instance when not allowed"});else{var a=t.additionalProperties||{};"function"==typeof r.preValidateProperty&&r.preValidateProperty(e,i,a,r,n);var s=this.validateSchema(e[i],a,r,n.makeChild(a,i));s.instance!==o.instance[i]&&(o.instance[i]=s.instance),o.importErrors(s)}}s.type=function(e,t,r,n){if(void 0===e)return null;var o=new i(e,t,r,n),a=Array.isArray(t.type)?t.type:[t.type];if(!a.some(this.testType.bind(this,e,t,r,n))){var s=a.map(function(e){return e.id&&"<"+e.id+">"||e+""});o.addError({name:"type",argument:s,message:"is not of a type(s) "+s})}return o},s.anyOf=function(e,t,r,n){if(void 0===e)return null;var a=new i(e,t,r,n),s=new i(e,t,r,n);if(!Array.isArray(t.anyOf))throw new o("anyOf must be an array");if(!t.anyOf.some(u.bind(this,e,r,n,function(e){s.importErrors(e)}))){var c=t.anyOf.map(function(e,t){return e.id&&"<"+e.id+">"||e.title&&JSON.stringify(e.title)||e.$ref&&"<"+e.$ref+">"||"[subschema "+t+"]"});r.nestedErrors&&a.importErrors(s),a.addError({name:"anyOf",argument:c,message:"is not any of "+c.join(",")})}return a},s.allOf=function(e,t,r,n){if(void 0===e)return null;if(!Array.isArray(t.allOf))throw new o("allOf must be an array");var a=new i(e,t,r,n),s=this;return t.allOf.forEach(function(t,i){var o=s.validateSchema(e,t,r,n);if(!o.valid){var u=t.id&&"<"+t.id+">"||t.title&&JSON.stringify(t.title)||t.$ref&&"<"+t.$ref+">"||"[subschema "+i+"]";a.addError({name:"allOf",argument:{id:u,length:o.errors.length,valid:o},message:"does not match allOf schema "+u+" with "+o.errors.length+" error[s]:"}),a.importErrors(o)}}),a},s.oneOf=function(e,t,r,n){if(void 0===e)return null;if(!Array.isArray(t.oneOf))throw new o("oneOf must be an array");var a=new i(e,t,r,n),s=new i(e,t,r,n),c=t.oneOf.filter(u.bind(this,e,r,n,function(e){s.importErrors(e)})).length,l=t.oneOf.map(function(e,t){return e.id&&"<"+e.id+">"||e.title&&JSON.stringify(e.title)||e.$ref&&"<"+e.$ref+">"||"[subschema "+t+"]"});return 1!==c&&(r.nestedErrors&&a.importErrors(s),a.addError({name:"oneOf",argument:l,message:"is not exactly one from "+l.join(",")})),a},s.properties=function(e,t,r,n){if(this.types.object(e)){var o=new i(e,t,r,n),a=t.properties||{};for(var s in a){"function"==typeof r.preValidateProperty&&r.preValidateProperty(e,s,a[s],r,n);var u=Object.hasOwnProperty.call(e,s)?e[s]:void 0,c=this.validateSchema(u,a[s],r,n.makeChild(a[s],s));c.instance!==o.instance[s]&&(o.instance[s]=c.instance),o.importErrors(c)}return o}},s.patternProperties=function(e,t,r,n){if(this.types.object(e)){var o=new i(e,t,r,n),a=t.patternProperties||{};for(var s in e){var u=!0;for(var l in a){if(new RegExp(l).test(s)){u=!1,"function"==typeof r.preValidateProperty&&r.preValidateProperty(e,s,a[l],r,n);var f=this.validateSchema(e[s],a[l],r,n.makeChild(a[l],s));f.instance!==o.instance[s]&&(o.instance[s]=f.instance),o.importErrors(f)}}u&&c.call(this,e,t,r,n,s,o)}return o}},s.additionalProperties=function(e,t,r,n){if(this.types.object(e)){if(t.patternProperties)return null;var o=new i(e,t,r,n);for(var a in e)c.call(this,e,t,r,n,a,o);return o}},s.minProperties=function(e,t,r,n){if(this.types.object(e)){var o=new i(e,t,r,n);return Object.keys(e).length>=t.minProperties||o.addError({name:"minProperties",argument:t.minProperties,message:"does not meet minimum property length of "+t.minProperties}),o}},s.maxProperties=function(e,t,r,n){if(this.types.object(e)){var o=new i(e,t,r,n);return Object.keys(e).length<=t.maxProperties||o.addError({name:"maxProperties",argument:t.maxProperties,message:"does not meet maximum property length of "+t.maxProperties}),o}},s.items=function(e,t,r,n){var o=this;if(this.types.array(e)&&t.items){var a=new i(e,t,r,n);return e.every(function(e,i){var s=Array.isArray(t.items)?t.items[i]||t.additionalItems:t.items;if(void 0===s)return!0;if(!1===s)return a.addError({name:"items",message:"additionalItems not permitted"}),!1;var u=o.validateSchema(e,s,r,n.makeChild(s,i));return u.instance!==a.instance[i]&&(a.instance[i]=u.instance),a.importErrors(u),!0}),a}},s.minimum=function(e,t,r,n){if(this.types.number(e)){var o=new i(e,t,r,n);return(t.exclusiveMinimum&&!0===t.exclusiveMinimum?e>t.minimum:e>=t.minimum)||o.addError({name:"minimum",argument:t.minimum,message:"must have a minimum value of "+t.minimum}),o}},s.maximum=function(e,t,r,n){if(this.types.number(e)){var o=new i(e,t,r,n);return(t.exclusiveMaximum&&!0===t.exclusiveMaximum?e<t.maximum:e<=t.maximum)||o.addError({name:"maximum",argument:t.maximum,message:"must have a maximum value of "+t.maximum}),o}};var l=function(e,t,r,a,s,u){if(this.types.number(e)){var c=t[s];if(0==c)throw new o(s+" cannot be zero");var l=new i(e,t,r,a),f=n.getDecimalPlaces(e),h=n.getDecimalPlaces(c),p=Math.max(f,h),d=Math.pow(10,p);return Math.round(e*d)%Math.round(c*d)!=0&&l.addError({name:s,argument:c,message:u+JSON.stringify(c)}),l}};function f(e,t,r){var i,o=r.length;for(i=t+1;i<o;i++)if(n.deepCompareStrict(e,r[i]))return!1;return!0}s.multipleOf=function(e,t,r,n){return l.call(this,e,t,r,n,"multipleOf","is not a multiple of (divisible by) ")},s.divisibleBy=function(e,t,r,n){return l.call(this,e,t,r,n,"divisibleBy","is not divisible by (multiple of) ")},s.required=function(e,t,r,n){var o=new i(e,t,r,n);return void 0===e&&!0===t.required?o.addError({name:"required",message:"is required"}):this.types.object(e)&&Array.isArray(t.required)&&t.required.forEach(function(t){void 0===e[t]&&o.addError({name:"required",argument:t,message:"requires property "+JSON.stringify(t)})}),o},s.pattern=function(e,t,r,n){if(this.types.string(e)){var o=new i(e,t,r,n);return e.match(t.pattern)||o.addError({name:"pattern",argument:t.pattern,message:"does not match pattern "+JSON.stringify(t.pattern)}),o}},s.format=function(e,t,r,o){if(void 0!==e){var a=new i(e,t,r,o);return a.disableFormat||n.isFormat(e,t.format,this)||a.addError({name:"format",argument:t.format,message:"does not conform to the "+JSON.stringify(t.format)+" format"}),a}},s.minLength=function(e,t,r,n){if(this.types.string(e)){var o=new i(e,t,r,n),a=e.match(/[\uDC00-\uDFFF]/g);return e.length-(a?a.length:0)>=t.minLength||o.addError({name:"minLength",argument:t.minLength,message:"does not meet minimum length of "+t.minLength}),o}},s.maxLength=function(e,t,r,n){if(this.types.string(e)){var o=new i(e,t,r,n),a=e.match(/[\uDC00-\uDFFF]/g);return e.length-(a?a.length:0)<=t.maxLength||o.addError({name:"maxLength",argument:t.maxLength,message:"does not meet maximum length of "+t.maxLength}),o}},s.minItems=function(e,t,r,n){if(this.types.array(e)){var o=new i(e,t,r,n);return e.length>=t.minItems||o.addError({name:"minItems",argument:t.minItems,message:"does not meet minimum length of "+t.minItems}),o}},s.maxItems=function(e,t,r,n){if(this.types.array(e)){var o=new i(e,t,r,n);return e.length<=t.maxItems||o.addError({name:"maxItems",argument:t.maxItems,message:"does not meet maximum length of "+t.maxItems}),o}},s.uniqueItems=function(e,t,r,o){if(this.types.array(e)){var a=new i(e,t,r,o);return e.every(function(e,t,r){for(var i=t+1;i<r.length;i++)if(n.deepCompareStrict(e,r[i]))return!1;return!0})||a.addError({name:"uniqueItems",message:"contains duplicate item"}),a}},s.uniqueItems=function(e,t,r,n){if(this.types.array(e)){var o=new i(e,t,r,n);return e.every(f)||o.addError({name:"uniqueItems",message:"contains duplicate item"}),o}},s.dependencies=function(e,t,r,n){if(this.types.object(e)){var o=new i(e,t,r,n);for(var a in t.dependencies)if(void 0!==e[a]){var s=t.dependencies[a],u=n.makeChild(s,a);if("string"==typeof s&&(s=[s]),Array.isArray(s))s.forEach(function(t){void 0===e[t]&&o.addError({name:"dependencies",argument:u.propertyPath,message:"property "+t+" not found, required by "+u.propertyPath})});else{var c=this.validateSchema(e,s,r,u);o.instance!==c.instance&&(o.instance=c.instance),c&&c.errors.length&&(o.addError({name:"dependencies",argument:u.propertyPath,message:"does not meet dependency required by "+u.propertyPath}),o.importErrors(c))}}return o}},s.enum=function(e,t,r,a){if(void 0===e)return null;if(!Array.isArray(t.enum))throw new o("enum expects an array",t);var s=new i(e,t,r,a);return t.enum.some(n.deepCompareStrict.bind(null,e))||s.addError({name:"enum",argument:t.enum,message:"is not one of enum values: "+t.enum.map(String).join(",")}),s},s.const=function(e,t,r,o){if(void 0===e)return null;var a=new i(e,t,r,o);return n.deepCompareStrict(t.const,e)||a.addError({name:"const",argument:t.const,message:"does not exactly match expected constant: "+t.const}),a},s.not=s.disallow=function(e,t,r,n){var o=this;if(void 0===e)return null;var a=new i(e,t,r,n),s=t.not||t.disallow;return s?(Array.isArray(s)||(s=[s]),s.forEach(function(i){if(o.testType(e,t,r,n,i)){var s=i&&i.id&&"<"+i.id+">"||i;a.addError({name:"not",argument:s,message:"is of prohibited type "+s})}}),a):null},e.exports=a},function(e,t,r){"use strict";var n=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,r,s){return t=t||"&",r=r||"=",null===e&&(e=void 0),"object"==typeof e?o(a(e),function(a){var s=encodeURIComponent(n(a))+r;return i(e[a])?o(e[a],function(e){return s+encodeURIComponent(n(e))}).join(t):s+encodeURIComponent(n(e[a]))}).join(t):s?encodeURIComponent(n(s))+r+encodeURIComponent(n(e)):""};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function o(e,t){if(e.map)return e.map(t);for(var r=[],n=0;n<e.length;n++)r.push(t(e[n],n));return r}var a=Object.keys||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t}},function(e,t,r){"use strict";function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,r,o){t=t||"&",r=r||"=";var a={};if("string"!=typeof e||0===e.length)return a;var s=/\+/g;e=e.split(t);var u=1e3;o&&"number"==typeof o.maxKeys&&(u=o.maxKeys);var c=e.length;u>0&&c>u&&(c=u);for(var l=0;l<c;++l){var f,h,p,d,_=e[l].replace(s,"%20"),b=_.indexOf(r);b>=0?(f=_.substr(0,b),h=_.substr(b+1)):(f=_,h=""),p=decodeURIComponent(f),d=decodeURIComponent(h),n(a,p)?i(a[p])?a[p].push(d):a[p]=[a[p],d]:a[p]=d}return a};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,r){"use strict";t.decode=t.parse=r(74),t.encode=t.stringify=r(73)},function(e,t,r){"use strict";e.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,r){(function(e,n){var i;/*! https://mths.be/punycode v1.4.1 by @mathias */!function(o){"object"==typeof t&&t&&t.nodeType,"object"==typeof e&&e&&e.nodeType;var a="object"==typeof n&&n;a.global!==a&&a.window!==a&&a.self;var s,u=2147483647,c=36,l=1,f=26,h=38,p=700,d=72,_=128,b="-",m=/^xn--/,v=/[^\x20-\x7E]/,g=/[\x2E\u3002\uFF0E\uFF61]/g,y={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},x=c-l,E=Math.floor,T=String.fromCharCode;function O(e){throw new RangeError(y[e])}function M(e,t){for(var r=e.length,n=[];r--;)n[r]=t(e[r]);return n}function A(e,t){var r=e.split("@"),n="";return r.length>1&&(n=r[0]+"@",e=r[1]),n+M((e=e.replace(g,".")).split("."),t).join(".")}function P(e){for(var t,r,n=[],i=0,o=e.length;i<o;)(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<o?56320==(64512&(r=e.charCodeAt(i++)))?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),i--):n.push(t);return n}function j(e){return M(e,function(e){var t="";return e>65535&&(t+=T((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=T(e)}).join("")}function w(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function R(e,t,r){var n=0;for(e=r?E(e/p):e>>1,e+=E(e/t);e>x*f>>1;n+=c)e=E(e/x);return E(n+(x+1)*e/(e+h))}function L(e){var t,r,n,i,o,a,s,h,p,m,v,g=[],y=e.length,x=0,T=_,M=d;for((r=e.lastIndexOf(b))<0&&(r=0),n=0;n<r;++n)e.charCodeAt(n)>=128&&O("not-basic"),g.push(e.charCodeAt(n));for(i=r>0?r+1:0;i<y;){for(o=x,a=1,s=c;i>=y&&O("invalid-input"),((h=(v=e.charCodeAt(i++))-48<10?v-22:v-65<26?v-65:v-97<26?v-97:c)>=c||h>E((u-x)/a))&&O("overflow"),x+=h*a,!(h<(p=s<=M?l:s>=M+f?f:s-M));s+=c)a>E(u/(m=c-p))&&O("overflow"),a*=m;M=R(x-o,t=g.length+1,0==o),E(x/t)>u-T&&O("overflow"),T+=E(x/t),x%=t,g.splice(x++,0,T)}return j(g)}function F(e){var t,r,n,i,o,a,s,h,p,m,v,g,y,x,M,A=[];for(g=(e=P(e)).length,t=_,r=0,o=d,a=0;a<g;++a)(v=e[a])<128&&A.push(T(v));for(n=i=A.length,i&&A.push(b);n<g;){for(s=u,a=0;a<g;++a)(v=e[a])>=t&&v<s&&(s=v);for(s-t>E((u-r)/(y=n+1))&&O("overflow"),r+=(s-t)*y,t=s,a=0;a<g;++a)if((v=e[a])<t&&++r>u&&O("overflow"),v==t){for(h=r,p=c;!(h<(m=p<=o?l:p>=o+f?f:p-o));p+=c)M=h-m,x=c-m,A.push(T(w(m+M%x,0))),h=E(M/x);A.push(T(w(h,0))),o=R(r,y,n==i),r=0,++n}++r,++t}return A.join("")}s={version:"1.4.1",ucs2:{decode:P,encode:j},decode:L,encode:F,toASCII:function(e){return A(e,function(e){return v.test(e)?"xn--"+F(e):e})},toUnicode:function(e){return A(e,function(e){return m.test(e)?L(e.slice(4).toLowerCase()):e})}},void 0===(i=function(){return s}.call(t,r,t,e))||(e.exports=i)}()}).call(this,r(78)(e),r(77))},function(e,t,r){"use strict";var n=r(43),i=r(72),o=r(21),a=r(42).scan,s=o.ValidatorResult,u=o.SchemaError,c=o.SchemaContext,l=function e(){this.customFormats=Object.create(e.prototype.customFormats),this.schemas={},this.unresolvedRefs=[],this.types=Object.create(h),this.attributes=Object.create(i.validators)};function f(e){var t="string"==typeof e?e:e.$ref;return"string"==typeof t&&t}l.prototype.customFormats={},l.prototype.schemas=null,l.prototype.types=null,l.prototype.attributes=null,l.prototype.unresolvedRefs=null,l.prototype.addSchema=function(e,t){var r=this;if(!e)return null;var n=a(t||"/",e),i=t||e.id;for(var o in n.id)this.schemas[o]=n.id[o];for(var o in n.ref)this.unresolvedRefs.push(o);return this.unresolvedRefs=this.unresolvedRefs.filter(function(e){return void 0===r.schemas[e]}),this.schemas[i]},l.prototype.addSubSchemaArray=function(e,t){if(t instanceof Array)for(var r=0;r<t.length;r++)this.addSubSchema(e,t[r])},l.prototype.addSubSchemaObject=function(e,t){if(t&&"object"==typeof t)for(var r in t)this.addSubSchema(e,t[r])},l.prototype.setSchemas=function(e){this.schemas=e},l.prototype.getSchema=function(e){return this.schemas[e]},l.prototype.validate=function(e,t,r,i){r||(r={});var o=r.propertyName||"instance",s=n.resolve(r.base||"/",t.id||"");if(!i){(i=new c(t,r,o,s,Object.create(this.schemas))).schemas[s]||(i.schemas[s]=t);var l=a(s,t);for(var f in l.id){var h=l.id[f];i.schemas[f]=h}}if(t){var p=this.validateSchema(e,t,r,i);if(!p)throw new Error("Result undefined");return p}throw new u("no schema specified",t)},l.prototype.validateSchema=function(e,t,r,n){var a,l=new s(e,t,r,n);if("boolean"==typeof t)!0===t?t={}:!1===t&&(t={type:[]});else if(!t)throw new Error("schema is undefined");if(t.extends)if(t.extends instanceof Array){var h={schema:t,ctx:n};t.extends.forEach(this.schemaTraverser.bind(this,h)),t=h.schema,h.schema=null,h.ctx=null,h=null}else t=o.deepMerge(t,this.superResolve(t.extends,n));if(a=f(t)){var p=this.resolve(t,a,n),d=new c(p.subschema,r,n.propertyPath,p.switchSchema,n.schemas);return this.validateSchema(e,p.subschema,r,d)}var _=r&&r.skipAttributes||[];for(var b in t)if(!i.ignoreProperties[b]&&_.indexOf(b)<0){var m=null,v=this.attributes[b];if(v)m=v.call(this,e,t,r,n);else if(!1===r.allowUnknownAttributes)throw new u("Unsupported attribute: "+b,t);m&&l.importErrors(m)}if("function"==typeof r.rewrite){var g=r.rewrite.call(this,e,t,r,n);l.instance=g}return l},l.prototype.schemaTraverser=function(e,t){e.schema=o.deepMerge(e.schema,this.superResolve(t,e.ctx))},l.prototype.superResolve=function(e,t){var r;return(r=f(e))?this.resolve(e,r,t).subschema:e},l.prototype.resolve=function(e,t,r){if(t=r.resolve(t),r.schemas[t])return{subschema:r.schemas[t],switchSchema:t};var i=n.parse(t),a=i&&i.hash,s=a&&a.length&&t.substr(0,t.length-a.length);if(!s||!r.schemas[s])throw new u("no such schema <"+t+">",e);var c=o.objectGetPath(r.schemas[s],a.substr(1));if(void 0===c)throw new u("no such schema "+a+" located in <"+s+">",e);return{subschema:c,switchSchema:t}},l.prototype.testType=function(e,t,r,n,i){if("function"==typeof this.types[i])return this.types[i].call(this,e);if(i&&"object"==typeof i){var o=this.validateSchema(e,i,r,n);return void 0===o||!(o&&o.errors.length)}return!0};var h=l.prototype.types={};h.string=function(e){return"string"==typeof e},h.number=function(e){return"number"==typeof e&&isFinite(e)},h.integer=function(e){return"number"==typeof e&&e%1==0},h.boolean=function(e){return"boolean"==typeof e},h.array=function(e){return Array.isArray(e)},h.null=function(e){return null===e},h.date=function(e){return e instanceof Date},h.any=function(e){return!0},h.object=function(e){return e&&"object"==typeof e&&!(e instanceof Array)&&!(e instanceof Date)},e.exports=l},function(e,t,r){"use strict";var n=e.exports.Validator=r(80);e.exports.ValidatorResult=r(21).ValidatorResult,e.exports.ValidationError=r(21).ValidationError,e.exports.SchemaError=r(21).SchemaError,e.exports.SchemaScanResult=r(42).SchemaScanResult,e.exports.scan=r(42).scan,e.exports.validate=function(e,t,r){return(new n).validate(e,t,r)}},function(e,t,r){"use strict";var n,i=r(81),o=r(0);!function(e){e.validate=function(e,t,r){var n=new i.Validator;if(void 0!==r)for(var a=0,s=r;a<s.length;a++){var u=s[a];n.addSchema(u[0],u[1])}var c=n.validate(e,t);return o.logIf(!c.valid,o.LogLevel.Dev,"schema conformance issue (setter ignored):\n"+c.toString()),c.valid},e.complement=function e(t,r){if(void 0!==t)switch(o.assert(r.hasOwnProperty("properties")&&"object"===r.type||r.hasOwnProperty("items")&&"array"===r.type,"expected schema to have 'properties' or 'items', given "+r),r.type){case"object":for(var n=r.properties,i=0,a=Object.getOwnPropertyNames(n);i<a.length;i++){var s=a[i],u=n[s],c="object"===u.type,l=t.hasOwnProperty(s),f=u.hasOwnProperty("properties"),h=u.hasOwnProperty("default");o.assert(f&&c||!f&&!c,"expected property '"+s+"' to be of type 'object', given '"+u.type+"'"),l&&f?e(t[s],u):f?(Object.defineProperty(t,s,{value:{}}),e(t[s],u)):!l&&h&&Object.defineProperty(t,s,{value:u.default})}break;case"array":var p=r.items;if("object"!==p.type)break;for(var d=0,_=Object.getOwnPropertyNames(t);d<_.length;d++){var b=_[d];"length"!==b&&e(t[b],p)}}},e.compare=function e(t,r,n,i){void 0===i&&(i="");var a=void 0!==n;if(o.assert(!a||n.hasOwnProperty("any"),"expected allocation lookup object to have 'any' key"),void 0===t&&void 0!==r||void 0!==t&&void 0===r)return a&&n.alter(i),!0;var s=!0,u=[typeof t,typeof r],c=[t instanceof Array,r instanceof Array];if(!(c[0]&&c[1]||"object"===u[0]&&"object"===u[1]))return!(s=t===r)&&a&&n.alter(""+i),!s;for(var l=0,f=Array.from(new Set(Array().concat(Object.getOwnPropertyNames(t),Object.getOwnPropertyNames(r))).values());l<f.length;l++){var h=f[l];if("length"!==h){var p=[t[h],r[h]];u=[typeof p[0],typeof p[1]];var d=i+(i.length>0&&!c[0]?".":"")+(c[0]?"":h);if(p[0]instanceof Array&&p[1]instanceof Array||"object"===u[0]&&"object"===u[1])s=s&&!e(p[0],p[1],n,d);else{if(u[0]===u[1]&&p[0]===p[1])continue;s=!1,a&&n.alter(d)}}}return!s}}(n||(n={})),e.exports=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(r(64));var n=r(82);t.properties=n;var i=r(65),o=r(71);!function(e){e.TestRenderer=o.TestRenderer,e.TestNavigation=i.TestNavigation}(t.debug||(t.debug={}));var a=r(68),s=r(67);!function(e){e.EventBlocker=a.EventBlocker,e.Fullscreen=s.Fullscreen}(t.viewer||(t.viewer={}))},function(e,t,r){e.exports=r(83)}])});
//# sourceMappingURL=webgl-operate.js.map