!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("rxjs")):"function"==typeof define&&define.amd?define(["rxjs"],t):"object"==typeof exports?exports.gloperate=t(require("rxjs")):e.gloperate=t(e.rxjs)}(window,function(e){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=84)}([function(e,t,r){"use strict";var n,i=r(3);!function(e){var t,r=2;e.logVerbosity=function(e){return void 0!==e&&(r=Math.max(-1,e)),r},function(e){e[e.Debug=3]="Debug",e[e.Info=2]="Info",e[e.Warning=1]="Warning",e[e.Error=0]="Error"}(t=e.LogLevel||(e.LogLevel={}));var n=function(e,t){if(!e)throw new EvalError(t)},o=function(e,t){};function a(e,t){e>r||console.log("["+e+"] "+t)}function s(t){var r=t+"-start";e.assert(0===performance.getEntriesByName(t).length,"expected mark identifier to not already exists, given "+t),e.assert(0===performance.getEntriesByName(r).length,"expected mark identifier to not already exists, given "+r),performance.mark(r)}function u(r,n,i){void 0===i&&(i=0);var o=r+"-start",s=r+"-end";e.assert(0===performance.getEntriesByName(r).length,"expected mark identifier to not already exists, given "+r),e.assert(0===performance.getEntriesByName(s).length,"expected mark identifier to not already exists, given "+s),performance.mark(s),performance.measure(r,o,s);var u=performance.getEntriesByName(r)[0];performance.clearMarks(o),performance.clearMarks(s),performance.clearMeasures(r);var c=void 0===n||0===n.length?0:2,f=Math.max(c,i-r.length-(n?n.length:0)-1),l=h(u.duration);a(t.Debug,""+r+" ".repeat(f)+(n||"")+" | "+l)}e.assert=n,e.assertions=function(t){return void 0!==t&&(e.assert=t?n:o),e.assert!==o},e.log=a,e.logIf=function(e,t,r){e&&a(t,r)},e.logPerformanceStart=s,e.logPerformanceStartIf=function(e,t){e&&s(t)},e.logPerformanceStop=u,e.logPerformanceStopIf=function(e,t,r,n){void 0===n&&(n=0),e&&u(t,r,n)},e.rand=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=1),Math.random()*(t-e)+e};var c=["","Ki","Mi","Gi","Ti","Pi","Ei","Zi","Yi"];e.prettyPrintBytes=function(e){var t=e>0?Math.floor(Math.log(e)/Math.log(1024)):0,r=e/Math.pow(1024,t);return""+(t>0?r.toFixed(3):r)+c[t]+"B"};var f=["ms","ns","Î¼s","ms","s"],l=[0,1e6,1e3,1,.001];function h(e){var t=e>0?Math.max(1,Math.floor(Math.log(10*e)/Math.log(1e3))+3):0;return t=i.clamp(t,0,4),""+(e*l[t]).toFixed(3)+f[t]}e.prettyPrintMilliseconds=h,e.bitInBitfield=function(e,t){return void 0!==t&&(e&t)===t},e.RAD2DEG=57.29577951308232,e.DEG2RAD=.017453292519943295,e.GETsearch=function(){return document.location.search},e.GETparameter=function(e){var t=new RegExp(e+"=([^&]+)"),r=document.location.search.match(t);if(r)return r[1]}}(n||(n={})),e.exports=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=function(){function e(){var t=this;this._initialized=!1,this.assertInitialized=function(){return e.assertInitializedFalse(t)},this.assertUninitialized=function(){}}return e.initialize=function(){return function(t,r,i){var o=i.value;return i.value=function(){var t=this;return n.assert(!1===this._initialized,"re-initialization of initialized object not anticipated"),this._initialized=o.apply(this,arguments),this._initialized?(this.assertInitialized=function(){},this.assertUninitialized=function(){return e.assertUninitializedFalse(t)}):(this.assertUninitialized=function(){},this.assertInitialized=function(){return e.assertInitializedFalse(t)}),this._initialized},i}},e.uninitialize=function(){return function(t,r,i){var o=i.value;return i.value=function(){var t=this;n.assert(!0===this._initialized,"expected object to be initialized in order to uninitialize"),o.apply(this),this._initialized=!1,this.assertUninitialized=function(){},this.assertInitialized=function(){return e.assertInitializedFalse(t)}},i}},e.assert_initialized=function(){return function(e,t,r){var n=r.value;return r.value=function(){return this.assertInitialized(),n.apply(this,arguments)},r}},e.assert_uninitialized=function(){return function(e,t,r){var n=r.value;return r.value=function(){this.assertUninitialized(),n.apply(this,arguments)},r}},Object.defineProperty(e.prototype,"initialized",{get:function(){return this._initialized},enumerable:!0,configurable:!0}),e.assertInitializedFalse=function(e){return n.assert(!1,"instance of "+e.constructor.name+" expected to be initialized")},e.assertUninitializedFalse=function(e){return n.assert(!1,"instance of "+e.constructor.name+" not expected to be initialized")},e}();t.Initializable=i},function(e,t,r){"use strict";r.r(t);var n={};r.r(n),r.d(n,"EPSILON",function(){return p}),r.d(n,"ARRAY_TYPE",function(){return _}),r.d(n,"RANDOM",function(){return d}),r.d(n,"setMatrixArrayType",function(){return b}),r.d(n,"toRadian",function(){return v}),r.d(n,"equals",function(){return g});var i={};r.r(i),r.d(i,"create",function(){return y}),r.d(i,"clone",function(){return E}),r.d(i,"copy",function(){return x}),r.d(i,"identity",function(){return T}),r.d(i,"fromValues",function(){return M}),r.d(i,"set",function(){return O}),r.d(i,"transpose",function(){return A}),r.d(i,"invert",function(){return P}),r.d(i,"adjoint",function(){return R}),r.d(i,"determinant",function(){return w}),r.d(i,"multiply",function(){return S}),r.d(i,"rotate",function(){return j}),r.d(i,"scale",function(){return L}),r.d(i,"fromRotation",function(){return F}),r.d(i,"fromScaling",function(){return I}),r.d(i,"str",function(){return B}),r.d(i,"frob",function(){return N}),r.d(i,"LDU",function(){return z}),r.d(i,"add",function(){return C}),r.d(i,"subtract",function(){return G}),r.d(i,"exactEquals",function(){return U}),r.d(i,"equals",function(){return D}),r.d(i,"multiplyScalar",function(){return k}),r.d(i,"multiplyScalarAndAdd",function(){return X}),r.d(i,"mul",function(){return W}),r.d(i,"sub",function(){return q});var o={};r.r(o),r.d(o,"create",function(){return V}),r.d(o,"clone",function(){return H}),r.d(o,"copy",function(){return Y}),r.d(o,"identity",function(){return K}),r.d(o,"fromValues",function(){return Z}),r.d(o,"set",function(){return $}),r.d(o,"invert",function(){return J}),r.d(o,"determinant",function(){return Q}),r.d(o,"multiply",function(){return ee}),r.d(o,"rotate",function(){return te}),r.d(o,"scale",function(){return re}),r.d(o,"translate",function(){return ne}),r.d(o,"fromRotation",function(){return ie}),r.d(o,"fromScaling",function(){return oe}),r.d(o,"fromTranslation",function(){return ae}),r.d(o,"str",function(){return se}),r.d(o,"frob",function(){return ue}),r.d(o,"add",function(){return ce}),r.d(o,"subtract",function(){return fe}),r.d(o,"multiplyScalar",function(){return le}),r.d(o,"multiplyScalarAndAdd",function(){return he}),r.d(o,"exactEquals",function(){return pe}),r.d(o,"equals",function(){return _e}),r.d(o,"mul",function(){return de}),r.d(o,"sub",function(){return be});var a={};r.r(a),r.d(a,"create",function(){return me}),r.d(a,"fromMat4",function(){return ve}),r.d(a,"clone",function(){return ge}),r.d(a,"copy",function(){return ye}),r.d(a,"fromValues",function(){return Ee}),r.d(a,"set",function(){return xe}),r.d(a,"identity",function(){return Te}),r.d(a,"transpose",function(){return Me}),r.d(a,"invert",function(){return Oe}),r.d(a,"adjoint",function(){return Ae}),r.d(a,"determinant",function(){return Pe}),r.d(a,"multiply",function(){return Re}),r.d(a,"translate",function(){return we}),r.d(a,"rotate",function(){return Se}),r.d(a,"scale",function(){return je}),r.d(a,"fromTranslation",function(){return Le}),r.d(a,"fromRotation",function(){return Fe}),r.d(a,"fromScaling",function(){return Ie}),r.d(a,"fromMat2d",function(){return Be}),r.d(a,"fromQuat",function(){return Ne}),r.d(a,"normalFromMat4",function(){return ze}),r.d(a,"projection",function(){return Ce}),r.d(a,"str",function(){return Ge}),r.d(a,"frob",function(){return Ue}),r.d(a,"add",function(){return De}),r.d(a,"subtract",function(){return ke}),r.d(a,"multiplyScalar",function(){return Xe}),r.d(a,"multiplyScalarAndAdd",function(){return We}),r.d(a,"exactEquals",function(){return qe}),r.d(a,"equals",function(){return Ve}),r.d(a,"mul",function(){return He}),r.d(a,"sub",function(){return Ye});var s={};r.r(s),r.d(s,"create",function(){return Ke}),r.d(s,"clone",function(){return Ze}),r.d(s,"copy",function(){return $e}),r.d(s,"fromValues",function(){return Je}),r.d(s,"set",function(){return Qe}),r.d(s,"identity",function(){return et}),r.d(s,"transpose",function(){return tt}),r.d(s,"invert",function(){return rt}),r.d(s,"adjoint",function(){return nt}),r.d(s,"determinant",function(){return it}),r.d(s,"multiply",function(){return ot}),r.d(s,"translate",function(){return at}),r.d(s,"scale",function(){return st}),r.d(s,"rotate",function(){return ut}),r.d(s,"rotateX",function(){return ct}),r.d(s,"rotateY",function(){return ft}),r.d(s,"rotateZ",function(){return lt}),r.d(s,"fromTranslation",function(){return ht}),r.d(s,"fromScaling",function(){return pt}),r.d(s,"fromRotation",function(){return _t}),r.d(s,"fromXRotation",function(){return dt}),r.d(s,"fromYRotation",function(){return bt}),r.d(s,"fromZRotation",function(){return mt}),r.d(s,"fromRotationTranslation",function(){return vt}),r.d(s,"fromQuat2",function(){return gt}),r.d(s,"getTranslation",function(){return yt}),r.d(s,"getScaling",function(){return Et}),r.d(s,"getRotation",function(){return xt}),r.d(s,"fromRotationTranslationScale",function(){return Tt}),r.d(s,"fromRotationTranslationScaleOrigin",function(){return Mt}),r.d(s,"fromQuat",function(){return Ot}),r.d(s,"frustum",function(){return At}),r.d(s,"perspective",function(){return Pt}),r.d(s,"perspectiveFromFieldOfView",function(){return Rt}),r.d(s,"ortho",function(){return wt}),r.d(s,"lookAt",function(){return St}),r.d(s,"targetTo",function(){return jt}),r.d(s,"str",function(){return Lt}),r.d(s,"frob",function(){return Ft}),r.d(s,"add",function(){return It}),r.d(s,"subtract",function(){return Bt}),r.d(s,"multiplyScalar",function(){return Nt}),r.d(s,"multiplyScalarAndAdd",function(){return zt}),r.d(s,"exactEquals",function(){return Ct}),r.d(s,"equals",function(){return Gt}),r.d(s,"mul",function(){return Ut}),r.d(s,"sub",function(){return Dt});var u={};r.r(u),r.d(u,"create",function(){return kt}),r.d(u,"clone",function(){return Xt}),r.d(u,"length",function(){return Wt}),r.d(u,"fromValues",function(){return qt}),r.d(u,"copy",function(){return Vt}),r.d(u,"set",function(){return Ht}),r.d(u,"add",function(){return Yt}),r.d(u,"subtract",function(){return Kt}),r.d(u,"multiply",function(){return Zt}),r.d(u,"divide",function(){return $t}),r.d(u,"ceil",function(){return Jt}),r.d(u,"floor",function(){return Qt}),r.d(u,"min",function(){return er}),r.d(u,"max",function(){return tr}),r.d(u,"round",function(){return rr}),r.d(u,"scale",function(){return nr}),r.d(u,"scaleAndAdd",function(){return ir}),r.d(u,"distance",function(){return or}),r.d(u,"squaredDistance",function(){return ar}),r.d(u,"squaredLength",function(){return sr}),r.d(u,"negate",function(){return ur}),r.d(u,"inverse",function(){return cr}),r.d(u,"normalize",function(){return fr}),r.d(u,"dot",function(){return lr}),r.d(u,"cross",function(){return hr}),r.d(u,"lerp",function(){return pr}),r.d(u,"hermite",function(){return _r}),r.d(u,"bezier",function(){return dr}),r.d(u,"random",function(){return br}),r.d(u,"transformMat4",function(){return mr}),r.d(u,"transformMat3",function(){return vr}),r.d(u,"transformQuat",function(){return gr}),r.d(u,"rotateX",function(){return yr}),r.d(u,"rotateY",function(){return Er}),r.d(u,"rotateZ",function(){return xr}),r.d(u,"angle",function(){return Tr}),r.d(u,"str",function(){return Mr}),r.d(u,"exactEquals",function(){return Or}),r.d(u,"equals",function(){return Ar}),r.d(u,"sub",function(){return Pr}),r.d(u,"mul",function(){return Rr}),r.d(u,"div",function(){return wr}),r.d(u,"dist",function(){return Sr}),r.d(u,"sqrDist",function(){return jr}),r.d(u,"len",function(){return Lr}),r.d(u,"sqrLen",function(){return Fr}),r.d(u,"forEach",function(){return Ir});var c={};r.r(c),r.d(c,"create",function(){return Br}),r.d(c,"clone",function(){return Nr}),r.d(c,"fromValues",function(){return zr}),r.d(c,"copy",function(){return Cr}),r.d(c,"set",function(){return Gr}),r.d(c,"add",function(){return Ur}),r.d(c,"subtract",function(){return Dr}),r.d(c,"multiply",function(){return kr}),r.d(c,"divide",function(){return Xr}),r.d(c,"ceil",function(){return Wr}),r.d(c,"floor",function(){return qr}),r.d(c,"min",function(){return Vr}),r.d(c,"max",function(){return Hr}),r.d(c,"round",function(){return Yr}),r.d(c,"scale",function(){return Kr}),r.d(c,"scaleAndAdd",function(){return Zr}),r.d(c,"distance",function(){return $r}),r.d(c,"squaredDistance",function(){return Jr}),r.d(c,"length",function(){return Qr}),r.d(c,"squaredLength",function(){return en}),r.d(c,"negate",function(){return tn}),r.d(c,"inverse",function(){return rn}),r.d(c,"normalize",function(){return nn}),r.d(c,"dot",function(){return on}),r.d(c,"lerp",function(){return an}),r.d(c,"random",function(){return sn}),r.d(c,"transformMat4",function(){return un}),r.d(c,"transformQuat",function(){return cn}),r.d(c,"str",function(){return fn}),r.d(c,"exactEquals",function(){return ln}),r.d(c,"equals",function(){return hn}),r.d(c,"sub",function(){return pn}),r.d(c,"mul",function(){return _n}),r.d(c,"div",function(){return dn}),r.d(c,"dist",function(){return bn}),r.d(c,"sqrDist",function(){return mn}),r.d(c,"len",function(){return vn}),r.d(c,"sqrLen",function(){return gn}),r.d(c,"forEach",function(){return yn});var f={};r.r(f),r.d(f,"create",function(){return En}),r.d(f,"identity",function(){return xn}),r.d(f,"setAxisAngle",function(){return Tn}),r.d(f,"getAxisAngle",function(){return Mn}),r.d(f,"multiply",function(){return On}),r.d(f,"rotateX",function(){return An}),r.d(f,"rotateY",function(){return Pn}),r.d(f,"rotateZ",function(){return Rn}),r.d(f,"calculateW",function(){return wn}),r.d(f,"slerp",function(){return Sn}),r.d(f,"random",function(){return jn}),r.d(f,"invert",function(){return Ln}),r.d(f,"conjugate",function(){return Fn}),r.d(f,"fromMat3",function(){return In}),r.d(f,"fromEuler",function(){return Bn}),r.d(f,"str",function(){return Nn}),r.d(f,"clone",function(){return zn}),r.d(f,"fromValues",function(){return Cn}),r.d(f,"copy",function(){return Gn}),r.d(f,"set",function(){return Un}),r.d(f,"add",function(){return Dn}),r.d(f,"mul",function(){return kn}),r.d(f,"scale",function(){return Xn}),r.d(f,"dot",function(){return Wn}),r.d(f,"lerp",function(){return qn}),r.d(f,"length",function(){return Vn}),r.d(f,"len",function(){return Hn}),r.d(f,"squaredLength",function(){return Yn}),r.d(f,"sqrLen",function(){return Kn}),r.d(f,"normalize",function(){return Zn}),r.d(f,"exactEquals",function(){return $n}),r.d(f,"equals",function(){return Jn}),r.d(f,"rotationTo",function(){return Qn}),r.d(f,"sqlerp",function(){return ei}),r.d(f,"setAxes",function(){return ti});var l={};r.r(l),r.d(l,"create",function(){return ri}),r.d(l,"clone",function(){return ni}),r.d(l,"fromValues",function(){return ii}),r.d(l,"fromRotationTranslationValues",function(){return oi}),r.d(l,"fromRotationTranslation",function(){return ai}),r.d(l,"fromTranslation",function(){return si}),r.d(l,"fromRotation",function(){return ui}),r.d(l,"fromMat4",function(){return ci}),r.d(l,"copy",function(){return fi}),r.d(l,"identity",function(){return li}),r.d(l,"set",function(){return hi}),r.d(l,"getReal",function(){return pi}),r.d(l,"getDual",function(){return _i}),r.d(l,"setReal",function(){return di}),r.d(l,"setDual",function(){return bi}),r.d(l,"getTranslation",function(){return mi}),r.d(l,"translate",function(){return vi}),r.d(l,"rotateX",function(){return gi}),r.d(l,"rotateY",function(){return yi}),r.d(l,"rotateZ",function(){return Ei}),r.d(l,"rotateByQuatAppend",function(){return xi}),r.d(l,"rotateByQuatPrepend",function(){return Ti}),r.d(l,"rotateAroundAxis",function(){return Mi}),r.d(l,"add",function(){return Oi}),r.d(l,"multiply",function(){return Ai}),r.d(l,"mul",function(){return Pi}),r.d(l,"scale",function(){return Ri}),r.d(l,"dot",function(){return wi}),r.d(l,"lerp",function(){return Si}),r.d(l,"invert",function(){return ji}),r.d(l,"conjugate",function(){return Li}),r.d(l,"length",function(){return Fi}),r.d(l,"len",function(){return Ii}),r.d(l,"squaredLength",function(){return Bi}),r.d(l,"sqrLen",function(){return Ni}),r.d(l,"normalize",function(){return zi}),r.d(l,"str",function(){return Ci}),r.d(l,"exactEquals",function(){return Gi}),r.d(l,"equals",function(){return Ui});var h={};r.r(h),r.d(h,"create",function(){return Di}),r.d(h,"clone",function(){return ki}),r.d(h,"fromValues",function(){return Xi}),r.d(h,"copy",function(){return Wi}),r.d(h,"set",function(){return qi}),r.d(h,"add",function(){return Vi}),r.d(h,"subtract",function(){return Hi}),r.d(h,"multiply",function(){return Yi}),r.d(h,"divide",function(){return Ki}),r.d(h,"ceil",function(){return Zi}),r.d(h,"floor",function(){return $i}),r.d(h,"min",function(){return Ji}),r.d(h,"max",function(){return Qi}),r.d(h,"round",function(){return eo}),r.d(h,"scale",function(){return to}),r.d(h,"scaleAndAdd",function(){return ro}),r.d(h,"distance",function(){return no}),r.d(h,"squaredDistance",function(){return io}),r.d(h,"length",function(){return oo}),r.d(h,"squaredLength",function(){return ao}),r.d(h,"negate",function(){return so}),r.d(h,"inverse",function(){return uo}),r.d(h,"normalize",function(){return co}),r.d(h,"dot",function(){return fo}),r.d(h,"cross",function(){return lo}),r.d(h,"lerp",function(){return ho}),r.d(h,"random",function(){return po}),r.d(h,"transformMat2",function(){return _o}),r.d(h,"transformMat2d",function(){return bo}),r.d(h,"transformMat3",function(){return mo}),r.d(h,"transformMat4",function(){return vo}),r.d(h,"rotate",function(){return go}),r.d(h,"angle",function(){return yo}),r.d(h,"str",function(){return Eo}),r.d(h,"exactEquals",function(){return xo}),r.d(h,"equals",function(){return To}),r.d(h,"len",function(){return Mo}),r.d(h,"sub",function(){return Oo}),r.d(h,"mul",function(){return Ao}),r.d(h,"div",function(){return Po}),r.d(h,"dist",function(){return Ro}),r.d(h,"sqrDist",function(){return wo}),r.d(h,"sqrLen",function(){return So}),r.d(h,"forEach",function(){return jo});const p=1e-6;let _="undefined"!=typeof Float32Array?Float32Array:Array;const d=Math.random;function b(e){_=e}const m=Math.PI/180;function v(e){return e*m}function g(e,t){return Math.abs(e-t)<=p*Math.max(1,Math.abs(e),Math.abs(t))}function y(){let e=new _(4);return _!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e}function E(e){let t=new _(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function x(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function T(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e}function M(e,t,r,n){let i=new _(4);return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i}function O(e,t,r,n,i){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e}function A(e,t){if(e===t){let r=t[1];e[1]=t[2],e[2]=r}else e[0]=t[0],e[1]=t[2],e[2]=t[1],e[3]=t[3];return e}function P(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],a=r*o-i*n;return a?(a=1/a,e[0]=o*a,e[1]=-n*a,e[2]=-i*a,e[3]=r*a,e):null}function R(e,t){let r=t[0];return e[0]=t[3],e[1]=-t[1],e[2]=-t[2],e[3]=r,e}function w(e){return e[0]*e[3]-e[2]*e[1]}function S(e,t,r){let n=t[0],i=t[1],o=t[2],a=t[3],s=r[0],u=r[1],c=r[2],f=r[3];return e[0]=n*s+o*u,e[1]=i*s+a*u,e[2]=n*c+o*f,e[3]=i*c+a*f,e}function j(e,t,r){let n=t[0],i=t[1],o=t[2],a=t[3],s=Math.sin(r),u=Math.cos(r);return e[0]=n*u+o*s,e[1]=i*u+a*s,e[2]=n*-s+o*u,e[3]=i*-s+a*u,e}function L(e,t,r){let n=t[0],i=t[1],o=t[2],a=t[3],s=r[0],u=r[1];return e[0]=n*s,e[1]=i*s,e[2]=o*u,e[3]=a*u,e}function F(e,t){let r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=-r,e[3]=n,e}function I(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e}function B(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function N(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2))}function z(e,t,r,n){return e[2]=n[2]/n[0],r[0]=n[0],r[1]=n[1],r[3]=n[3]-e[2]*r[1],[e,t,r]}function C(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e}function G(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}function U(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function D(e,t){let r=e[0],n=e[1],i=e[2],o=e[3],a=t[0],s=t[1],u=t[2],c=t[3];return Math.abs(r-a)<=p*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-s)<=p*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-u)<=p*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-c)<=p*Math.max(1,Math.abs(o),Math.abs(c))}function k(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function X(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e}const W=S,q=G;function V(){let e=new _(6);return _!=Float32Array&&(e[1]=0,e[2]=0,e[4]=0,e[5]=0),e[0]=1,e[3]=1,e}function H(e){let t=new _(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function Y(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function K(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e}function Z(e,t,r,n,i,o){let a=new _(6);return a[0]=e,a[1]=t,a[2]=r,a[3]=n,a[4]=i,a[5]=o,a}function $(e,t,r,n,i,o,a){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=o,e[5]=a,e}function J(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=r*o-n*i;return u?(u=1/u,e[0]=o*u,e[1]=-n*u,e[2]=-i*u,e[3]=r*u,e[4]=(i*s-o*a)*u,e[5]=(n*a-r*s)*u,e):null}function Q(e){return e[0]*e[3]-e[1]*e[2]}function ee(e,t,r){let n=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=r[0],f=r[1],l=r[2],h=r[3],p=r[4],_=r[5];return e[0]=n*c+o*f,e[1]=i*c+a*f,e[2]=n*l+o*h,e[3]=i*l+a*h,e[4]=n*p+o*_+s,e[5]=i*p+a*_+u,e}function te(e,t,r){let n=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=Math.sin(r),f=Math.cos(r);return e[0]=n*f+o*c,e[1]=i*f+a*c,e[2]=n*-c+o*f,e[3]=i*-c+a*f,e[4]=s,e[5]=u,e}function re(e,t,r){let n=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=r[0],f=r[1];return e[0]=n*c,e[1]=i*c,e[2]=o*f,e[3]=a*f,e[4]=s,e[5]=u,e}function ne(e,t,r){let n=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=r[0],f=r[1];return e[0]=n,e[1]=i,e[2]=o,e[3]=a,e[4]=n*c+o*f+s,e[5]=i*c+a*f+u,e}function ie(e,t){let r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=-r,e[3]=n,e[4]=0,e[5]=0,e}function oe(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e[4]=0,e[5]=0,e}function ae(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0],e[5]=t[1],e}function se(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"}function ue(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+1)}function ce(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e}function fe(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e}function le(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e}function he(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e}function pe(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]}function _e(e,t){let r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=t[0],c=t[1],f=t[2],l=t[3],h=t[4],_=t[5];return Math.abs(r-u)<=p*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(n-c)<=p*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(i-f)<=p*Math.max(1,Math.abs(i),Math.abs(f))&&Math.abs(o-l)<=p*Math.max(1,Math.abs(o),Math.abs(l))&&Math.abs(a-h)<=p*Math.max(1,Math.abs(a),Math.abs(h))&&Math.abs(s-_)<=p*Math.max(1,Math.abs(s),Math.abs(_))}const de=ee,be=fe;function me(){let e=new _(9);return _!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function ve(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}function ge(e){let t=new _(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function ye(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function Ee(e,t,r,n,i,o,a,s,u){let c=new _(9);return c[0]=e,c[1]=t,c[2]=r,c[3]=n,c[4]=i,c[5]=o,c[6]=a,c[7]=s,c[8]=u,c}function xe(e,t,r,n,i,o,a,s,u,c){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=o,e[5]=a,e[6]=s,e[7]=u,e[8]=c,e}function Te(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Me(e,t){if(e===t){let r=t[1],n=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=r,e[5]=t[7],e[6]=n,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function Oe(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],f=t[8],l=f*a-s*c,h=-f*o+s*u,p=c*o-a*u,_=r*l+n*h+i*p;return _?(_=1/_,e[0]=l*_,e[1]=(-f*n+i*c)*_,e[2]=(s*n-i*a)*_,e[3]=h*_,e[4]=(f*r-i*u)*_,e[5]=(-s*r+i*o)*_,e[6]=p*_,e[7]=(-c*r+n*u)*_,e[8]=(a*r-n*o)*_,e):null}function Ae(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],f=t[8];return e[0]=a*f-s*c,e[1]=i*c-n*f,e[2]=n*s-i*a,e[3]=s*u-o*f,e[4]=r*f-i*u,e[5]=i*o-r*s,e[6]=o*c-a*u,e[7]=n*u-r*c,e[8]=r*a-n*o,e}function Pe(e){let t=e[0],r=e[1],n=e[2],i=e[3],o=e[4],a=e[5],s=e[6],u=e[7],c=e[8];return t*(c*o-a*u)+r*(-c*i+a*s)+n*(u*i-o*s)}function Re(e,t,r){let n=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],f=t[7],l=t[8],h=r[0],p=r[1],_=r[2],d=r[3],b=r[4],m=r[5],v=r[6],g=r[7],y=r[8];return e[0]=h*n+p*a+_*c,e[1]=h*i+p*s+_*f,e[2]=h*o+p*u+_*l,e[3]=d*n+b*a+m*c,e[4]=d*i+b*s+m*f,e[5]=d*o+b*u+m*l,e[6]=v*n+g*a+y*c,e[7]=v*i+g*s+y*f,e[8]=v*o+g*u+y*l,e}function we(e,t,r){let n=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],f=t[7],l=t[8],h=r[0],p=r[1];return e[0]=n,e[1]=i,e[2]=o,e[3]=a,e[4]=s,e[5]=u,e[6]=h*n+p*a+c,e[7]=h*i+p*s+f,e[8]=h*o+p*u+l,e}function Se(e,t,r){let n=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],f=t[7],l=t[8],h=Math.sin(r),p=Math.cos(r);return e[0]=p*n+h*a,e[1]=p*i+h*s,e[2]=p*o+h*u,e[3]=p*a-h*n,e[4]=p*s-h*i,e[5]=p*u-h*o,e[6]=c,e[7]=f,e[8]=l,e}function je(e,t,r){let n=r[0],i=r[1];return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function Le(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e}function Fe(e,t){let r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=-r,e[4]=n,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Ie(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function Be(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e}function Ne(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],a=r+r,s=n+n,u=i+i,c=r*a,f=n*a,l=n*s,h=i*a,p=i*s,_=i*u,d=o*a,b=o*s,m=o*u;return e[0]=1-l-_,e[3]=f-m,e[6]=h+b,e[1]=f+m,e[4]=1-c-_,e[7]=p-d,e[2]=h-b,e[5]=p+d,e[8]=1-c-l,e}function ze(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],f=t[8],l=t[9],h=t[10],p=t[11],_=t[12],d=t[13],b=t[14],m=t[15],v=r*s-n*a,g=r*u-i*a,y=r*c-o*a,E=n*u-i*s,x=n*c-o*s,T=i*c-o*u,M=f*d-l*_,O=f*b-h*_,A=f*m-p*_,P=l*b-h*d,R=l*m-p*d,w=h*m-p*b,S=v*w-g*R+y*P+E*A-x*O+T*M;return S?(S=1/S,e[0]=(s*w-u*R+c*P)*S,e[1]=(u*A-a*w-c*O)*S,e[2]=(a*R-s*A+c*M)*S,e[3]=(i*R-n*w-o*P)*S,e[4]=(r*w-i*A+o*O)*S,e[5]=(n*A-r*R-o*M)*S,e[6]=(d*T-b*x+m*E)*S,e[7]=(b*y-_*T-m*g)*S,e[8]=(_*x-d*y+m*v)*S,e):null}function Ce(e,t,r){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/r,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e}function Ge(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"}function Ue(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2))}function De(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e}function ke(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e}function Xe(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e}function We(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e[6]=t[6]+r[6]*n,e[7]=t[7]+r[7]*n,e[8]=t[8]+r[8]*n,e}function qe(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]}function Ve(e,t){let r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],f=e[8],l=t[0],h=t[1],_=t[2],d=t[3],b=t[4],m=t[5],v=t[6],g=t[7],y=t[8];return Math.abs(r-l)<=p*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(n-h)<=p*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(i-_)<=p*Math.max(1,Math.abs(i),Math.abs(_))&&Math.abs(o-d)<=p*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(a-b)<=p*Math.max(1,Math.abs(a),Math.abs(b))&&Math.abs(s-m)<=p*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(u-v)<=p*Math.max(1,Math.abs(u),Math.abs(v))&&Math.abs(c-g)<=p*Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(f-y)<=p*Math.max(1,Math.abs(f),Math.abs(y))}const He=Re,Ye=ke;function Ke(){let e=new _(16);return _!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function Ze(e){let t=new _(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function $e(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Je(e,t,r,n,i,o,a,s,u,c,f,l,h,p,d,b){let m=new _(16);return m[0]=e,m[1]=t,m[2]=r,m[3]=n,m[4]=i,m[5]=o,m[6]=a,m[7]=s,m[8]=u,m[9]=c,m[10]=f,m[11]=l,m[12]=h,m[13]=p,m[14]=d,m[15]=b,m}function Qe(e,t,r,n,i,o,a,s,u,c,f,l,h,p,_,d,b){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=o,e[5]=a,e[6]=s,e[7]=u,e[8]=c,e[9]=f,e[10]=l,e[11]=h,e[12]=p,e[13]=_,e[14]=d,e[15]=b,e}function et(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function tt(e,t){if(e===t){let r=t[1],n=t[2],i=t[3],o=t[6],a=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=n,e[9]=o,e[11]=t[14],e[12]=i,e[13]=a,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function rt(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],f=t[8],l=t[9],h=t[10],p=t[11],_=t[12],d=t[13],b=t[14],m=t[15],v=r*s-n*a,g=r*u-i*a,y=r*c-o*a,E=n*u-i*s,x=n*c-o*s,T=i*c-o*u,M=f*d-l*_,O=f*b-h*_,A=f*m-p*_,P=l*b-h*d,R=l*m-p*d,w=h*m-p*b,S=v*w-g*R+y*P+E*A-x*O+T*M;return S?(S=1/S,e[0]=(s*w-u*R+c*P)*S,e[1]=(i*R-n*w-o*P)*S,e[2]=(d*T-b*x+m*E)*S,e[3]=(h*x-l*T-p*E)*S,e[4]=(u*A-a*w-c*O)*S,e[5]=(r*w-i*A+o*O)*S,e[6]=(b*y-_*T-m*g)*S,e[7]=(f*T-h*y+p*g)*S,e[8]=(a*R-s*A+c*M)*S,e[9]=(n*A-r*R-o*M)*S,e[10]=(_*x-d*y+m*v)*S,e[11]=(l*y-f*x-p*v)*S,e[12]=(s*O-a*P-u*M)*S,e[13]=(r*P-n*O+i*M)*S,e[14]=(d*g-_*E-b*v)*S,e[15]=(f*E-l*g+h*v)*S,e):null}function nt(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],f=t[8],l=t[9],h=t[10],p=t[11],_=t[12],d=t[13],b=t[14],m=t[15];return e[0]=s*(h*m-p*b)-l*(u*m-c*b)+d*(u*p-c*h),e[1]=-(n*(h*m-p*b)-l*(i*m-o*b)+d*(i*p-o*h)),e[2]=n*(u*m-c*b)-s*(i*m-o*b)+d*(i*c-o*u),e[3]=-(n*(u*p-c*h)-s*(i*p-o*h)+l*(i*c-o*u)),e[4]=-(a*(h*m-p*b)-f*(u*m-c*b)+_*(u*p-c*h)),e[5]=r*(h*m-p*b)-f*(i*m-o*b)+_*(i*p-o*h),e[6]=-(r*(u*m-c*b)-a*(i*m-o*b)+_*(i*c-o*u)),e[7]=r*(u*p-c*h)-a*(i*p-o*h)+f*(i*c-o*u),e[8]=a*(l*m-p*d)-f*(s*m-c*d)+_*(s*p-c*l),e[9]=-(r*(l*m-p*d)-f*(n*m-o*d)+_*(n*p-o*l)),e[10]=r*(s*m-c*d)-a*(n*m-o*d)+_*(n*c-o*s),e[11]=-(r*(s*p-c*l)-a*(n*p-o*l)+f*(n*c-o*s)),e[12]=-(a*(l*b-h*d)-f*(s*b-u*d)+_*(s*h-u*l)),e[13]=r*(l*b-h*d)-f*(n*b-i*d)+_*(n*h-i*l),e[14]=-(r*(s*b-u*d)-a*(n*b-i*d)+_*(n*u-i*s)),e[15]=r*(s*h-u*l)-a*(n*h-i*l)+f*(n*u-i*s),e}function it(e){let t=e[0],r=e[1],n=e[2],i=e[3],o=e[4],a=e[5],s=e[6],u=e[7],c=e[8],f=e[9],l=e[10],h=e[11],p=e[12],_=e[13],d=e[14],b=e[15];return(t*a-r*o)*(l*b-h*d)-(t*s-n*o)*(f*b-h*_)+(t*u-i*o)*(f*d-l*_)+(r*s-n*a)*(c*b-h*p)-(r*u-i*a)*(c*d-l*p)+(n*u-i*s)*(c*_-f*p)}function ot(e,t,r){let n=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],f=t[7],l=t[8],h=t[9],p=t[10],_=t[11],d=t[12],b=t[13],m=t[14],v=t[15],g=r[0],y=r[1],E=r[2],x=r[3];return e[0]=g*n+y*s+E*l+x*d,e[1]=g*i+y*u+E*h+x*b,e[2]=g*o+y*c+E*p+x*m,e[3]=g*a+y*f+E*_+x*v,g=r[4],y=r[5],E=r[6],x=r[7],e[4]=g*n+y*s+E*l+x*d,e[5]=g*i+y*u+E*h+x*b,e[6]=g*o+y*c+E*p+x*m,e[7]=g*a+y*f+E*_+x*v,g=r[8],y=r[9],E=r[10],x=r[11],e[8]=g*n+y*s+E*l+x*d,e[9]=g*i+y*u+E*h+x*b,e[10]=g*o+y*c+E*p+x*m,e[11]=g*a+y*f+E*_+x*v,g=r[12],y=r[13],E=r[14],x=r[15],e[12]=g*n+y*s+E*l+x*d,e[13]=g*i+y*u+E*h+x*b,e[14]=g*o+y*c+E*p+x*m,e[15]=g*a+y*f+E*_+x*v,e}function at(e,t,r){let n,i,o,a,s,u,c,f,l,h,p,_,d=r[0],b=r[1],m=r[2];return t===e?(e[12]=t[0]*d+t[4]*b+t[8]*m+t[12],e[13]=t[1]*d+t[5]*b+t[9]*m+t[13],e[14]=t[2]*d+t[6]*b+t[10]*m+t[14],e[15]=t[3]*d+t[7]*b+t[11]*m+t[15]):(n=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],f=t[7],l=t[8],h=t[9],p=t[10],_=t[11],e[0]=n,e[1]=i,e[2]=o,e[3]=a,e[4]=s,e[5]=u,e[6]=c,e[7]=f,e[8]=l,e[9]=h,e[10]=p,e[11]=_,e[12]=n*d+s*b+l*m+t[12],e[13]=i*d+u*b+h*m+t[13],e[14]=o*d+c*b+p*m+t[14],e[15]=a*d+f*b+_*m+t[15]),e}function st(e,t,r){let n=r[0],i=r[1],o=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function ut(e,t,r,n){let i,o,a,s,u,c,f,l,h,_,d,b,m,v,g,y,E,x,T,M,O,A,P,R,w=n[0],S=n[1],j=n[2],L=Math.sqrt(w*w+S*S+j*j);return L<p?null:(w*=L=1/L,S*=L,j*=L,i=Math.sin(r),a=1-(o=Math.cos(r)),s=t[0],u=t[1],c=t[2],f=t[3],l=t[4],h=t[5],_=t[6],d=t[7],b=t[8],m=t[9],v=t[10],g=t[11],y=w*w*a+o,E=S*w*a+j*i,x=j*w*a-S*i,T=w*S*a-j*i,M=S*S*a+o,O=j*S*a+w*i,A=w*j*a+S*i,P=S*j*a-w*i,R=j*j*a+o,e[0]=s*y+l*E+b*x,e[1]=u*y+h*E+m*x,e[2]=c*y+_*E+v*x,e[3]=f*y+d*E+g*x,e[4]=s*T+l*M+b*O,e[5]=u*T+h*M+m*O,e[6]=c*T+_*M+v*O,e[7]=f*T+d*M+g*O,e[8]=s*A+l*P+b*R,e[9]=u*A+h*P+m*R,e[10]=c*A+_*P+v*R,e[11]=f*A+d*P+g*R,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function ct(e,t,r){let n=Math.sin(r),i=Math.cos(r),o=t[4],a=t[5],s=t[6],u=t[7],c=t[8],f=t[9],l=t[10],h=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*i+c*n,e[5]=a*i+f*n,e[6]=s*i+l*n,e[7]=u*i+h*n,e[8]=c*i-o*n,e[9]=f*i-a*n,e[10]=l*i-s*n,e[11]=h*i-u*n,e}function ft(e,t,r){let n=Math.sin(r),i=Math.cos(r),o=t[0],a=t[1],s=t[2],u=t[3],c=t[8],f=t[9],l=t[10],h=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i-c*n,e[1]=a*i-f*n,e[2]=s*i-l*n,e[3]=u*i-h*n,e[8]=o*n+c*i,e[9]=a*n+f*i,e[10]=s*n+l*i,e[11]=u*n+h*i,e}function lt(e,t,r){let n=Math.sin(r),i=Math.cos(r),o=t[0],a=t[1],s=t[2],u=t[3],c=t[4],f=t[5],l=t[6],h=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i+c*n,e[1]=a*i+f*n,e[2]=s*i+l*n,e[3]=u*i+h*n,e[4]=c*i-o*n,e[5]=f*i-a*n,e[6]=l*i-s*n,e[7]=h*i-u*n,e}function ht(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function pt(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function _t(e,t,r){let n,i,o,a=r[0],s=r[1],u=r[2],c=Math.sqrt(a*a+s*s+u*u);return c<p?null:(a*=c=1/c,s*=c,u*=c,n=Math.sin(t),o=1-(i=Math.cos(t)),e[0]=a*a*o+i,e[1]=s*a*o+u*n,e[2]=u*a*o-s*n,e[3]=0,e[4]=a*s*o-u*n,e[5]=s*s*o+i,e[6]=u*s*o+a*n,e[7]=0,e[8]=a*u*o+s*n,e[9]=s*u*o-a*n,e[10]=u*u*o+i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function dt(e,t){let r=Math.sin(t),n=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function bt(e,t){let r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function mt(e,t){let r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function vt(e,t,r){let n=t[0],i=t[1],o=t[2],a=t[3],s=n+n,u=i+i,c=o+o,f=n*s,l=n*u,h=n*c,p=i*u,_=i*c,d=o*c,b=a*s,m=a*u,v=a*c;return e[0]=1-(p+d),e[1]=l+v,e[2]=h-m,e[3]=0,e[4]=l-v,e[5]=1-(f+d),e[6]=_+b,e[7]=0,e[8]=h+m,e[9]=_-b,e[10]=1-(f+p),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function gt(e,t){let r=new _(3),n=-t[0],i=-t[1],o=-t[2],a=t[3],s=t[4],u=t[5],c=t[6],f=t[7],l=n*n+i*i+o*o+a*a;return l>0?(r[0]=2*(s*a+f*n+u*o-c*i)/l,r[1]=2*(u*a+f*i+c*n-s*o)/l,r[2]=2*(c*a+f*o+s*i-u*n)/l):(r[0]=2*(s*a+f*n+u*o-c*i),r[1]=2*(u*a+f*i+c*n-s*o),r[2]=2*(c*a+f*o+s*i-u*n)),vt(e,t,r),e}function yt(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function Et(e,t){let r=t[0],n=t[1],i=t[2],o=t[4],a=t[5],s=t[6],u=t[8],c=t[9],f=t[10];return e[0]=Math.sqrt(r*r+n*n+i*i),e[1]=Math.sqrt(o*o+a*a+s*s),e[2]=Math.sqrt(u*u+c*c+f*f),e}function xt(e,t){let r=t[0]+t[5]+t[10],n=0;return r>0?(n=2*Math.sqrt(r+1),e[3]=.25*n,e[0]=(t[6]-t[9])/n,e[1]=(t[8]-t[2])/n,e[2]=(t[1]-t[4])/n):t[0]>t[5]&&t[0]>t[10]?(n=2*Math.sqrt(1+t[0]-t[5]-t[10]),e[3]=(t[6]-t[9])/n,e[0]=.25*n,e[1]=(t[1]+t[4])/n,e[2]=(t[8]+t[2])/n):t[5]>t[10]?(n=2*Math.sqrt(1+t[5]-t[0]-t[10]),e[3]=(t[8]-t[2])/n,e[0]=(t[1]+t[4])/n,e[1]=.25*n,e[2]=(t[6]+t[9])/n):(n=2*Math.sqrt(1+t[10]-t[0]-t[5]),e[3]=(t[1]-t[4])/n,e[0]=(t[8]+t[2])/n,e[1]=(t[6]+t[9])/n,e[2]=.25*n),e}function Tt(e,t,r,n){let i=t[0],o=t[1],a=t[2],s=t[3],u=i+i,c=o+o,f=a+a,l=i*u,h=i*c,p=i*f,_=o*c,d=o*f,b=a*f,m=s*u,v=s*c,g=s*f,y=n[0],E=n[1],x=n[2];return e[0]=(1-(_+b))*y,e[1]=(h+g)*y,e[2]=(p-v)*y,e[3]=0,e[4]=(h-g)*E,e[5]=(1-(l+b))*E,e[6]=(d+m)*E,e[7]=0,e[8]=(p+v)*x,e[9]=(d-m)*x,e[10]=(1-(l+_))*x,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function Mt(e,t,r,n,i){let o=t[0],a=t[1],s=t[2],u=t[3],c=o+o,f=a+a,l=s+s,h=o*c,p=o*f,_=o*l,d=a*f,b=a*l,m=s*l,v=u*c,g=u*f,y=u*l,E=n[0],x=n[1],T=n[2],M=i[0],O=i[1],A=i[2],P=(1-(d+m))*E,R=(p+y)*E,w=(_-g)*E,S=(p-y)*x,j=(1-(h+m))*x,L=(b+v)*x,F=(_+g)*T,I=(b-v)*T,B=(1-(h+d))*T;return e[0]=P,e[1]=R,e[2]=w,e[3]=0,e[4]=S,e[5]=j,e[6]=L,e[7]=0,e[8]=F,e[9]=I,e[10]=B,e[11]=0,e[12]=r[0]+M-(P*M+S*O+F*A),e[13]=r[1]+O-(R*M+j*O+I*A),e[14]=r[2]+A-(w*M+L*O+B*A),e[15]=1,e}function Ot(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],a=r+r,s=n+n,u=i+i,c=r*a,f=n*a,l=n*s,h=i*a,p=i*s,_=i*u,d=o*a,b=o*s,m=o*u;return e[0]=1-l-_,e[1]=f+m,e[2]=h-b,e[3]=0,e[4]=f-m,e[5]=1-c-_,e[6]=p+d,e[7]=0,e[8]=h+b,e[9]=p-d,e[10]=1-c-l,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function At(e,t,r,n,i,o,a){let s=1/(r-t),u=1/(i-n),c=1/(o-a);return e[0]=2*o*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*o*u,e[6]=0,e[7]=0,e[8]=(r+t)*s,e[9]=(i+n)*u,e[10]=(a+o)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*o*2*c,e[15]=0,e}function Pt(e,t,r,n,i){let o,a=1/Math.tan(t/2);return e[0]=a/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=i&&i!==1/0?(o=1/(n-i),e[10]=(i+n)*o,e[14]=2*i*n*o):(e[10]=-1,e[14]=-2*n),e}function Rt(e,t,r,n){let i=Math.tan(t.upDegrees*Math.PI/180),o=Math.tan(t.downDegrees*Math.PI/180),a=Math.tan(t.leftDegrees*Math.PI/180),s=Math.tan(t.rightDegrees*Math.PI/180),u=2/(a+s),c=2/(i+o);return e[0]=u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c,e[6]=0,e[7]=0,e[8]=-(a-s)*u*.5,e[9]=(i-o)*c*.5,e[10]=n/(r-n),e[11]=-1,e[12]=0,e[13]=0,e[14]=n*r/(r-n),e[15]=0,e}function wt(e,t,r,n,i,o,a){let s=1/(t-r),u=1/(n-i),c=1/(o-a);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+r)*s,e[13]=(i+n)*u,e[14]=(a+o)*c,e[15]=1,e}function St(e,t,r,n){let i,o,a,s,u,c,f,l,h,_,d=t[0],b=t[1],m=t[2],v=n[0],g=n[1],y=n[2],E=r[0],x=r[1],T=r[2];return Math.abs(d-E)<p&&Math.abs(b-x)<p&&Math.abs(m-T)<p?et(e):(f=d-E,l=b-x,h=m-T,i=g*(h*=_=1/Math.sqrt(f*f+l*l+h*h))-y*(l*=_),o=y*(f*=_)-v*h,a=v*l-g*f,(_=Math.sqrt(i*i+o*o+a*a))?(i*=_=1/_,o*=_,a*=_):(i=0,o=0,a=0),s=l*a-h*o,u=h*i-f*a,c=f*o-l*i,(_=Math.sqrt(s*s+u*u+c*c))?(s*=_=1/_,u*=_,c*=_):(s=0,u=0,c=0),e[0]=i,e[1]=s,e[2]=f,e[3]=0,e[4]=o,e[5]=u,e[6]=l,e[7]=0,e[8]=a,e[9]=c,e[10]=h,e[11]=0,e[12]=-(i*d+o*b+a*m),e[13]=-(s*d+u*b+c*m),e[14]=-(f*d+l*b+h*m),e[15]=1,e)}function jt(e,t,r,n){let i=t[0],o=t[1],a=t[2],s=n[0],u=n[1],c=n[2],f=i-r[0],l=o-r[1],h=a-r[2],p=f*f+l*l+h*h;p>0&&(f*=p=1/Math.sqrt(p),l*=p,h*=p);let _=u*h-c*l,d=c*f-s*h,b=s*l-u*f;return(p=_*_+d*d+b*b)>0&&(_*=p=1/Math.sqrt(p),d*=p,b*=p),e[0]=_,e[1]=d,e[2]=b,e[3]=0,e[4]=l*b-h*d,e[5]=h*_-f*b,e[6]=f*d-l*_,e[7]=0,e[8]=f,e[9]=l,e[10]=h,e[11]=0,e[12]=i,e[13]=o,e[14]=a,e[15]=1,e}function Lt(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function Ft(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))}function It(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e[9]=t[9]+r[9],e[10]=t[10]+r[10],e[11]=t[11]+r[11],e[12]=t[12]+r[12],e[13]=t[13]+r[13],e[14]=t[14]+r[14],e[15]=t[15]+r[15],e}function Bt(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e[9]=t[9]-r[9],e[10]=t[10]-r[10],e[11]=t[11]-r[11],e[12]=t[12]-r[12],e[13]=t[13]-r[13],e[14]=t[14]-r[14],e[15]=t[15]-r[15],e}function Nt(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12]*r,e[13]=t[13]*r,e[14]=t[14]*r,e[15]=t[15]*r,e}function zt(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e[6]=t[6]+r[6]*n,e[7]=t[7]+r[7]*n,e[8]=t[8]+r[8]*n,e[9]=t[9]+r[9]*n,e[10]=t[10]+r[10]*n,e[11]=t[11]+r[11]*n,e[12]=t[12]+r[12]*n,e[13]=t[13]+r[13]*n,e[14]=t[14]+r[14]*n,e[15]=t[15]+r[15]*n,e}function Ct(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function Gt(e,t){let r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],f=e[8],l=e[9],h=e[10],_=e[11],d=e[12],b=e[13],m=e[14],v=e[15],g=t[0],y=t[1],E=t[2],x=t[3],T=t[4],M=t[5],O=t[6],A=t[7],P=t[8],R=t[9],w=t[10],S=t[11],j=t[12],L=t[13],F=t[14],I=t[15];return Math.abs(r-g)<=p*Math.max(1,Math.abs(r),Math.abs(g))&&Math.abs(n-y)<=p*Math.max(1,Math.abs(n),Math.abs(y))&&Math.abs(i-E)<=p*Math.max(1,Math.abs(i),Math.abs(E))&&Math.abs(o-x)<=p*Math.max(1,Math.abs(o),Math.abs(x))&&Math.abs(a-T)<=p*Math.max(1,Math.abs(a),Math.abs(T))&&Math.abs(s-M)<=p*Math.max(1,Math.abs(s),Math.abs(M))&&Math.abs(u-O)<=p*Math.max(1,Math.abs(u),Math.abs(O))&&Math.abs(c-A)<=p*Math.max(1,Math.abs(c),Math.abs(A))&&Math.abs(f-P)<=p*Math.max(1,Math.abs(f),Math.abs(P))&&Math.abs(l-R)<=p*Math.max(1,Math.abs(l),Math.abs(R))&&Math.abs(h-w)<=p*Math.max(1,Math.abs(h),Math.abs(w))&&Math.abs(_-S)<=p*Math.max(1,Math.abs(_),Math.abs(S))&&Math.abs(d-j)<=p*Math.max(1,Math.abs(d),Math.abs(j))&&Math.abs(b-L)<=p*Math.max(1,Math.abs(b),Math.abs(L))&&Math.abs(m-F)<=p*Math.max(1,Math.abs(m),Math.abs(F))&&Math.abs(v-I)<=p*Math.max(1,Math.abs(v),Math.abs(I))}const Ut=ot,Dt=Bt;function kt(){let e=new _(3);return _!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function Xt(e){var t=new _(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Wt(e){let t=e[0],r=e[1],n=e[2];return Math.sqrt(t*t+r*r+n*n)}function qt(e,t,r){let n=new _(3);return n[0]=e,n[1]=t,n[2]=r,n}function Vt(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Ht(e,t,r,n){return e[0]=t,e[1]=r,e[2]=n,e}function Yt(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e}function Kt(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e}function Zt(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e}function $t(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e}function Jt(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}function Qt(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}function er(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e}function tr(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e}function rr(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e}function nr(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e}function ir(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e}function or(e,t){let r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return Math.sqrt(r*r+n*n+i*i)}function ar(e,t){let r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return r*r+n*n+i*i}function sr(e){let t=e[0],r=e[1],n=e[2];return t*t+r*r+n*n}function ur(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function cr(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}function fr(e,t){let r=t[0],n=t[1],i=t[2],o=r*r+n*n+i*i;return o>0&&(o=1/Math.sqrt(o),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o),e}function lr(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function hr(e,t,r){let n=t[0],i=t[1],o=t[2],a=r[0],s=r[1],u=r[2];return e[0]=i*u-o*s,e[1]=o*a-n*u,e[2]=n*s-i*a,e}function pr(e,t,r,n){let i=t[0],o=t[1],a=t[2];return e[0]=i+n*(r[0]-i),e[1]=o+n*(r[1]-o),e[2]=a+n*(r[2]-a),e}function _r(e,t,r,n,i,o){let a=o*o,s=a*(2*o-3)+1,u=a*(o-2)+o,c=a*(o-1),f=a*(3-2*o);return e[0]=t[0]*s+r[0]*u+n[0]*c+i[0]*f,e[1]=t[1]*s+r[1]*u+n[1]*c+i[1]*f,e[2]=t[2]*s+r[2]*u+n[2]*c+i[2]*f,e}function dr(e,t,r,n,i,o){let a=1-o,s=a*a,u=o*o,c=s*a,f=3*o*s,l=3*u*a,h=u*o;return e[0]=t[0]*c+r[0]*f+n[0]*l+i[0]*h,e[1]=t[1]*c+r[1]*f+n[1]*l+i[1]*h,e[2]=t[2]*c+r[2]*f+n[2]*l+i[2]*h,e}function br(e,t){t=t||1;let r=2*d()*Math.PI,n=2*d()-1,i=Math.sqrt(1-n*n)*t;return e[0]=Math.cos(r)*i,e[1]=Math.sin(r)*i,e[2]=n*t,e}function mr(e,t,r){let n=t[0],i=t[1],o=t[2],a=r[3]*n+r[7]*i+r[11]*o+r[15];return a=a||1,e[0]=(r[0]*n+r[4]*i+r[8]*o+r[12])/a,e[1]=(r[1]*n+r[5]*i+r[9]*o+r[13])/a,e[2]=(r[2]*n+r[6]*i+r[10]*o+r[14])/a,e}function vr(e,t,r){let n=t[0],i=t[1],o=t[2];return e[0]=n*r[0]+i*r[3]+o*r[6],e[1]=n*r[1]+i*r[4]+o*r[7],e[2]=n*r[2]+i*r[5]+o*r[8],e}function gr(e,t,r){let n=r[0],i=r[1],o=r[2],a=r[3],s=t[0],u=t[1],c=t[2],f=i*c-o*u,l=o*s-n*c,h=n*u-i*s,p=i*h-o*l,_=o*f-n*h,d=n*l-i*f,b=2*a;return f*=b,l*=b,h*=b,p*=2,_*=2,d*=2,e[0]=s+f+p,e[1]=u+l+_,e[2]=c+h+d,e}function yr(e,t,r,n){let i=[],o=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],o[0]=i[0],o[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),o[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),e[0]=o[0]+r[0],e[1]=o[1]+r[1],e[2]=o[2]+r[2],e}function Er(e,t,r,n){let i=[],o=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],o[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),o[1]=i[1],o[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),e[0]=o[0]+r[0],e[1]=o[1]+r[1],e[2]=o[2]+r[2],e}function xr(e,t,r,n){let i=[],o=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],o[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),o[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),o[2]=i[2],e[0]=o[0]+r[0],e[1]=o[1]+r[1],e[2]=o[2]+r[2],e}function Tr(e,t){let r=qt(e[0],e[1],e[2]),n=qt(t[0],t[1],t[2]);fr(r,r),fr(n,n);let i=lr(r,n);return i>1?0:i<-1?Math.PI:Math.acos(i)}function Mr(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function Or(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function Ar(e,t){let r=e[0],n=e[1],i=e[2],o=t[0],a=t[1],s=t[2];return Math.abs(r-o)<=p*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-a)<=p*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(i-s)<=p*Math.max(1,Math.abs(i),Math.abs(s))}const Pr=Kt,Rr=Zt,wr=$t,Sr=or,jr=ar,Lr=Wt,Fr=sr,Ir=function(){let e=kt();return function(t,r,n,i,o,a){let s,u;for(r||(r=3),n||(n=0),u=i?Math.min(i*r+n,t.length):t.length,s=n;s<u;s+=r)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],o(e,e,a),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2];return t}}();function Br(){let e=new _(4);return _!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function Nr(e){let t=new _(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function zr(e,t,r,n){let i=new _(4);return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i}function Cr(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function Gr(e,t,r,n,i){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e}function Ur(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e}function Dr(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}function kr(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e}function Xr(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e[3]=t[3]/r[3],e}function Wr(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e}function qr(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e}function Vr(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e[3]=Math.min(t[3],r[3]),e}function Hr(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e[3]=Math.max(t[3],r[3]),e}function Yr(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e}function Kr(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function Zr(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e}function $r(e,t){let r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],o=t[3]-e[3];return Math.sqrt(r*r+n*n+i*i+o*o)}function Jr(e,t){let r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],o=t[3]-e[3];return r*r+n*n+i*i+o*o}function Qr(e){let t=e[0],r=e[1],n=e[2],i=e[3];return Math.sqrt(t*t+r*r+n*n+i*i)}function en(e){let t=e[0],r=e[1],n=e[2],i=e[3];return t*t+r*r+n*n+i*i}function tn(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}function rn(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e}function nn(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],a=r*r+n*n+i*i+o*o;return a>0&&(a=1/Math.sqrt(a),e[0]=r*a,e[1]=n*a,e[2]=i*a,e[3]=o*a),e}function on(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function an(e,t,r,n){let i=t[0],o=t[1],a=t[2],s=t[3];return e[0]=i+n*(r[0]-i),e[1]=o+n*(r[1]-o),e[2]=a+n*(r[2]-a),e[3]=s+n*(r[3]-s),e}function sn(e,t){var r,n,i,o,a,s;t=t||1;do{a=(r=2*d()-1)*r+(n=2*d()-1)*n}while(a>=1);do{s=(i=2*d()-1)*i+(o=2*d()-1)*o}while(s>=1);var u=Math.sqrt((1-a)/s);return e[0]=t*r,e[1]=t*n,e[2]=t*i*u,e[3]=t*o*u,e}function un(e,t,r){let n=t[0],i=t[1],o=t[2],a=t[3];return e[0]=r[0]*n+r[4]*i+r[8]*o+r[12]*a,e[1]=r[1]*n+r[5]*i+r[9]*o+r[13]*a,e[2]=r[2]*n+r[6]*i+r[10]*o+r[14]*a,e[3]=r[3]*n+r[7]*i+r[11]*o+r[15]*a,e}function cn(e,t,r){let n=t[0],i=t[1],o=t[2],a=r[0],s=r[1],u=r[2],c=r[3],f=c*n+s*o-u*i,l=c*i+u*n-a*o,h=c*o+a*i-s*n,p=-a*n-s*i-u*o;return e[0]=f*c+p*-a+l*-u-h*-s,e[1]=l*c+p*-s+h*-a-f*-u,e[2]=h*c+p*-u+f*-s-l*-a,e[3]=t[3],e}function fn(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function ln(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function hn(e,t){let r=e[0],n=e[1],i=e[2],o=e[3],a=t[0],s=t[1],u=t[2],c=t[3];return Math.abs(r-a)<=p*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-s)<=p*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-u)<=p*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-c)<=p*Math.max(1,Math.abs(o),Math.abs(c))}const pn=Dr,_n=kr,dn=Xr,bn=$r,mn=Jr,vn=Qr,gn=en,yn=function(){let e=Br();return function(t,r,n,i,o,a){let s,u;for(r||(r=4),n||(n=0),u=i?Math.min(i*r+n,t.length):t.length,s=n;s<u;s+=r)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],e[3]=t[s+3],o(e,e,a),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2],t[s+3]=e[3];return t}}();function En(){let e=new _(4);return _!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function xn(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function Tn(e,t,r){r*=.5;let n=Math.sin(r);return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=Math.cos(r),e}function Mn(e,t){let r=2*Math.acos(t[3]),n=Math.sin(r/2);return n>p?(e[0]=t[0]/n,e[1]=t[1]/n,e[2]=t[2]/n):(e[0]=1,e[1]=0,e[2]=0),r}function On(e,t,r){let n=t[0],i=t[1],o=t[2],a=t[3],s=r[0],u=r[1],c=r[2],f=r[3];return e[0]=n*f+a*s+i*c-o*u,e[1]=i*f+a*u+o*s-n*c,e[2]=o*f+a*c+n*u-i*s,e[3]=a*f-n*s-i*u-o*c,e}function An(e,t,r){r*=.5;let n=t[0],i=t[1],o=t[2],a=t[3],s=Math.sin(r),u=Math.cos(r);return e[0]=n*u+a*s,e[1]=i*u+o*s,e[2]=o*u-i*s,e[3]=a*u-n*s,e}function Pn(e,t,r){r*=.5;let n=t[0],i=t[1],o=t[2],a=t[3],s=Math.sin(r),u=Math.cos(r);return e[0]=n*u-o*s,e[1]=i*u+a*s,e[2]=o*u+n*s,e[3]=a*u-i*s,e}function Rn(e,t,r){r*=.5;let n=t[0],i=t[1],o=t[2],a=t[3],s=Math.sin(r),u=Math.cos(r);return e[0]=n*u+i*s,e[1]=i*u-n*s,e[2]=o*u+a*s,e[3]=a*u-o*s,e}function wn(e,t){let r=t[0],n=t[1],i=t[2];return e[0]=r,e[1]=n,e[2]=i,e[3]=Math.sqrt(Math.abs(1-r*r-n*n-i*i)),e}function Sn(e,t,r,n){let i,o,a,s,u,c=t[0],f=t[1],l=t[2],h=t[3],_=r[0],d=r[1],b=r[2],m=r[3];return(o=c*_+f*d+l*b+h*m)<0&&(o=-o,_=-_,d=-d,b=-b,m=-m),1-o>p?(i=Math.acos(o),a=Math.sin(i),s=Math.sin((1-n)*i)/a,u=Math.sin(n*i)/a):(s=1-n,u=n),e[0]=s*c+u*_,e[1]=s*f+u*d,e[2]=s*l+u*b,e[3]=s*h+u*m,e}function jn(e){let t=d(),r=d(),n=d(),i=Math.sqrt(1-t),o=Math.sqrt(t);return e[0]=i*Math.sin(2*Math.PI*r),e[1]=i*Math.cos(2*Math.PI*r),e[2]=o*Math.sin(2*Math.PI*n),e[3]=o*Math.cos(2*Math.PI*n),e}function Ln(e,t){let r=t[0],n=t[1],i=t[2],o=t[3],a=r*r+n*n+i*i+o*o,s=a?1/a:0;return e[0]=-r*s,e[1]=-n*s,e[2]=-i*s,e[3]=o*s,e}function Fn(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function In(e,t){let r,n=t[0]+t[4]+t[8];if(n>0)r=Math.sqrt(n+1),e[3]=.5*r,r=.5/r,e[0]=(t[5]-t[7])*r,e[1]=(t[6]-t[2])*r,e[2]=(t[1]-t[3])*r;else{let n=0;t[4]>t[0]&&(n=1),t[8]>t[3*n+n]&&(n=2);let i=(n+1)%3,o=(n+2)%3;r=Math.sqrt(t[3*n+n]-t[3*i+i]-t[3*o+o]+1),e[n]=.5*r,r=.5/r,e[3]=(t[3*i+o]-t[3*o+i])*r,e[i]=(t[3*i+n]+t[3*n+i])*r,e[o]=(t[3*o+n]+t[3*n+o])*r}return e}function Bn(e,t,r,n){let i=.5*Math.PI/180;t*=i,r*=i,n*=i;let o=Math.sin(t),a=Math.cos(t),s=Math.sin(r),u=Math.cos(r),c=Math.sin(n),f=Math.cos(n);return e[0]=o*u*f-a*s*c,e[1]=a*s*f+o*u*c,e[2]=a*u*c-o*s*f,e[3]=a*u*f+o*s*c,e}function Nn(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}const zn=Nr,Cn=zr,Gn=Cr,Un=Gr,Dn=Ur,kn=On,Xn=Kr,Wn=on,qn=an,Vn=Qr,Hn=Vn,Yn=en,Kn=Yn,Zn=nn,$n=ln,Jn=hn,Qn=function(){let e=kt(),t=qt(1,0,0),r=qt(0,1,0);return function(n,i,o){let a=lr(i,o);return a<-.999999?(hr(e,t,i),Lr(e)<1e-6&&hr(e,r,i),fr(e,e),Tn(n,e,Math.PI),n):a>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(hr(e,i,o),n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=1+a,Zn(n,n))}}(),ei=function(){let e=En(),t=En();return function(r,n,i,o,a,s){return Sn(e,n,a,s),Sn(t,i,o,s),Sn(r,e,t,2*s*(1-s)),r}}(),ti=function(){let e=me();return function(t,r,n,i){return e[0]=n[0],e[3]=n[1],e[6]=n[2],e[1]=i[0],e[4]=i[1],e[7]=i[2],e[2]=-r[0],e[5]=-r[1],e[8]=-r[2],Zn(t,In(t,e))}}();function ri(){let e=new _(8);return _!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0),e[3]=1,e}function ni(e){let t=new _(8);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}function ii(e,t,r,n,i,o,a,s){let u=new _(8);return u[0]=e,u[1]=t,u[2]=r,u[3]=n,u[4]=i,u[5]=o,u[6]=a,u[7]=s,u}function oi(e,t,r,n,i,o,a){let s=new _(8);s[0]=e,s[1]=t,s[2]=r,s[3]=n;let u=.5*i,c=.5*o,f=.5*a;return s[4]=u*n+c*r-f*t,s[5]=c*n+f*e-u*r,s[6]=f*n+u*t-c*e,s[7]=-u*e-c*t-f*r,s}function ai(e,t,r){let n=.5*r[0],i=.5*r[1],o=.5*r[2],a=t[0],s=t[1],u=t[2],c=t[3];return e[0]=a,e[1]=s,e[2]=u,e[3]=c,e[4]=n*c+i*u-o*s,e[5]=i*c+o*a-n*u,e[6]=o*c+n*s-i*a,e[7]=-n*a-i*s-o*u,e}function si(e,t){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=.5*t[0],e[5]=.5*t[1],e[6]=.5*t[2],e[7]=0,e}function ui(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=0,e[5]=0,e[6]=0,e[7]=0,e}function ci(e,t){let r=En();xt(r,t);let n=new _(3);return yt(n,t),ai(e,r,n),e}function fi(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e}function li(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e}function hi(e,t,r,n,i,o,a,s,u){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=o,e[5]=a,e[6]=s,e[7]=u,e}const pi=Gn;function _i(e,t){return e[0]=t[4],e[1]=t[5],e[2]=t[6],e[3]=t[7],e}const di=Gn;function bi(e,t){return e[4]=t[0],e[5]=t[1],e[6]=t[2],e[7]=t[3],e}function mi(e,t){let r=t[4],n=t[5],i=t[6],o=t[7],a=-t[0],s=-t[1],u=-t[2],c=t[3];return e[0]=2*(r*c+o*a+n*u-i*s),e[1]=2*(n*c+o*s+i*a-r*u),e[2]=2*(i*c+o*u+r*s-n*a),e}function vi(e,t,r){let n=t[0],i=t[1],o=t[2],a=t[3],s=.5*r[0],u=.5*r[1],c=.5*r[2],f=t[4],l=t[5],h=t[6],p=t[7];return e[0]=n,e[1]=i,e[2]=o,e[3]=a,e[4]=a*s+i*c-o*u+f,e[5]=a*u+o*s-n*c+l,e[6]=a*c+n*u-i*s+h,e[7]=-n*s-i*u-o*c+p,e}function gi(e,t,r){let n=-t[0],i=-t[1],o=-t[2],a=t[3],s=t[4],u=t[5],c=t[6],f=t[7],l=s*a+f*n+u*o-c*i,h=u*a+f*i+c*n-s*o,p=c*a+f*o+s*i-u*n,_=f*a-s*n-u*i-c*o;return An(e,t,r),n=e[0],i=e[1],o=e[2],a=e[3],e[4]=l*a+_*n+h*o-p*i,e[5]=h*a+_*i+p*n-l*o,e[6]=p*a+_*o+l*i-h*n,e[7]=_*a-l*n-h*i-p*o,e}function yi(e,t,r){let n=-t[0],i=-t[1],o=-t[2],a=t[3],s=t[4],u=t[5],c=t[6],f=t[7],l=s*a+f*n+u*o-c*i,h=u*a+f*i+c*n-s*o,p=c*a+f*o+s*i-u*n,_=f*a-s*n-u*i-c*o;return Pn(e,t,r),n=e[0],i=e[1],o=e[2],a=e[3],e[4]=l*a+_*n+h*o-p*i,e[5]=h*a+_*i+p*n-l*o,e[6]=p*a+_*o+l*i-h*n,e[7]=_*a-l*n-h*i-p*o,e}function Ei(e,t,r){let n=-t[0],i=-t[1],o=-t[2],a=t[3],s=t[4],u=t[5],c=t[6],f=t[7],l=s*a+f*n+u*o-c*i,h=u*a+f*i+c*n-s*o,p=c*a+f*o+s*i-u*n,_=f*a-s*n-u*i-c*o;return Rn(e,t,r),n=e[0],i=e[1],o=e[2],a=e[3],e[4]=l*a+_*n+h*o-p*i,e[5]=h*a+_*i+p*n-l*o,e[6]=p*a+_*o+l*i-h*n,e[7]=_*a-l*n-h*i-p*o,e}function xi(e,t,r){let n=r[0],i=r[1],o=r[2],a=r[3],s=t[0],u=t[1],c=t[2],f=t[3];return e[0]=s*a+f*n+u*o-c*i,e[1]=u*a+f*i+c*n-s*o,e[2]=c*a+f*o+s*i-u*n,e[3]=f*a-s*n-u*i-c*o,s=t[4],u=t[5],c=t[6],f=t[7],e[4]=s*a+f*n+u*o-c*i,e[5]=u*a+f*i+c*n-s*o,e[6]=c*a+f*o+s*i-u*n,e[7]=f*a-s*n-u*i-c*o,e}function Ti(e,t,r){let n=t[0],i=t[1],o=t[2],a=t[3],s=r[0],u=r[1],c=r[2],f=r[3];return e[0]=n*f+a*s+i*c-o*u,e[1]=i*f+a*u+o*s-n*c,e[2]=o*f+a*c+n*u-i*s,e[3]=a*f-n*s-i*u-o*c,s=r[4],u=r[5],c=r[6],f=r[7],e[4]=n*f+a*s+i*c-o*u,e[5]=i*f+a*u+o*s-n*c,e[6]=o*f+a*c+n*u-i*s,e[7]=a*f-n*s-i*u-o*c,e}function Mi(e,t,r,n){if(Math.abs(n)<p)return fi(e,t);let i=Math.sqrt(r[0]*r[0]+r[1]*r[1]+r[2]*r[2]);n*=.5;let o=Math.sin(n),a=o*r[0]/i,s=o*r[1]/i,u=o*r[2]/i,c=Math.cos(n),f=t[0],l=t[1],h=t[2],_=t[3];e[0]=f*c+_*a+l*u-h*s,e[1]=l*c+_*s+h*a-f*u,e[2]=h*c+_*u+f*s-l*a,e[3]=_*c-f*a-l*s-h*u;let d=t[4],b=t[5],m=t[6],v=t[7];return e[4]=d*c+v*a+b*u-m*s,e[5]=b*c+v*s+m*a-d*u,e[6]=m*c+v*u+d*s-b*a,e[7]=v*c-d*a-b*s-m*u,e}function Oi(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e}function Ai(e,t,r){let n=t[0],i=t[1],o=t[2],a=t[3],s=r[4],u=r[5],c=r[6],f=r[7],l=t[4],h=t[5],p=t[6],_=t[7],d=r[0],b=r[1],m=r[2],v=r[3];return e[0]=n*v+a*d+i*m-o*b,e[1]=i*v+a*b+o*d-n*m,e[2]=o*v+a*m+n*b-i*d,e[3]=a*v-n*d-i*b-o*m,e[4]=n*f+a*s+i*c-o*u+l*v+_*d+h*m-p*b,e[5]=i*f+a*u+o*s-n*c+h*v+_*b+p*d-l*m,e[6]=o*f+a*c+n*u-i*s+p*v+_*m+l*b-h*d,e[7]=a*f-n*s-i*u-o*c+_*v-l*d-h*b-p*m,e}const Pi=Ai;function Ri(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e}const wi=Wn;function Si(e,t,r,n){let i=1-n;return wi(t,r)<0&&(n=-n),e[0]=t[0]*i+r[0]*n,e[1]=t[1]*i+r[1]*n,e[2]=t[2]*i+r[2]*n,e[3]=t[3]*i+r[3]*n,e[4]=t[4]*i+r[4]*n,e[5]=t[5]*i+r[5]*n,e[6]=t[6]*i+r[6]*n,e[7]=t[7]*i+r[7]*n,e}function ji(e,t){let r=Bi(t);return e[0]=-t[0]/r,e[1]=-t[1]/r,e[2]=-t[2]/r,e[3]=t[3]/r,e[4]=-t[4]/r,e[5]=-t[5]/r,e[6]=-t[6]/r,e[7]=t[7]/r,e}function Li(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e[4]=-t[4],e[5]=-t[5],e[6]=-t[6],e[7]=t[7],e}const Fi=Vn,Ii=Fi,Bi=Yn,Ni=Bi;function zi(e,t){let r=Bi(t);if(r>0){r=Math.sqrt(r);let n=t[0]/r,i=t[1]/r,o=t[2]/r,a=t[3]/r,s=t[4],u=t[5],c=t[6],f=t[7],l=n*s+i*u+o*c+a*f;e[0]=n,e[1]=i,e[2]=o,e[3]=a,e[4]=(s-n*l)/r,e[5]=(u-i*l)/r,e[6]=(c-o*l)/r,e[7]=(f-a*l)/r}return e}function Ci(e){return"quat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+")"}function Gi(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]}function Ui(e,t){let r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],f=t[0],l=t[1],h=t[2],_=t[3],d=t[4],b=t[5],m=t[6],v=t[7];return Math.abs(r-f)<=p*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(n-l)<=p*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(i-h)<=p*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(o-_)<=p*Math.max(1,Math.abs(o),Math.abs(_))&&Math.abs(a-d)<=p*Math.max(1,Math.abs(a),Math.abs(d))&&Math.abs(s-b)<=p*Math.max(1,Math.abs(s),Math.abs(b))&&Math.abs(u-m)<=p*Math.max(1,Math.abs(u),Math.abs(m))&&Math.abs(c-v)<=p*Math.max(1,Math.abs(c),Math.abs(v))}function Di(){let e=new _(2);return _!=Float32Array&&(e[0]=0,e[1]=0),e}function ki(e){let t=new _(2);return t[0]=e[0],t[1]=e[1],t}function Xi(e,t){let r=new _(2);return r[0]=e,r[1]=t,r}function Wi(e,t){return e[0]=t[0],e[1]=t[1],e}function qi(e,t,r){return e[0]=t,e[1]=r,e}function Vi(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e}function Hi(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e}function Yi(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e}function Ki(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e}function Zi(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e}function $i(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e}function Ji(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e}function Qi(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e}function eo(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e}function to(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e}function ro(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e}function no(e,t){var r=t[0]-e[0],n=t[1]-e[1];return Math.sqrt(r*r+n*n)}function io(e,t){var r=t[0]-e[0],n=t[1]-e[1];return r*r+n*n}function oo(e){var t=e[0],r=e[1];return Math.sqrt(t*t+r*r)}function ao(e){var t=e[0],r=e[1];return t*t+r*r}function so(e,t){return e[0]=-t[0],e[1]=-t[1],e}function uo(e,t){return e[0]=1/t[0],e[1]=1/t[1],e}function co(e,t){var r=t[0],n=t[1],i=r*r+n*n;return i>0&&(i=1/Math.sqrt(i),e[0]=t[0]*i,e[1]=t[1]*i),e}function fo(e,t){return e[0]*t[0]+e[1]*t[1]}function lo(e,t,r){var n=t[0]*r[1]-t[1]*r[0];return e[0]=e[1]=0,e[2]=n,e}function ho(e,t,r,n){var i=t[0],o=t[1];return e[0]=i+n*(r[0]-i),e[1]=o+n*(r[1]-o),e}function po(e,t){t=t||1;var r=2*d()*Math.PI;return e[0]=Math.cos(r)*t,e[1]=Math.sin(r)*t,e}function _o(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i,e[1]=r[1]*n+r[3]*i,e}function bo(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i+r[4],e[1]=r[1]*n+r[3]*i+r[5],e}function mo(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[3]*i+r[6],e[1]=r[1]*n+r[4]*i+r[7],e}function vo(e,t,r){let n=t[0],i=t[1];return e[0]=r[0]*n+r[4]*i+r[12],e[1]=r[1]*n+r[5]*i+r[13],e}function go(e,t,r,n){let i=t[0]-r[0],o=t[1]-r[1],a=Math.sin(n),s=Math.cos(n);return e[0]=i*s-o*a+r[0],e[1]=i*a+o*s+r[1],e}function yo(e,t){let r=e[0],n=e[1],i=t[0],o=t[1],a=r*r+n*n;a>0&&(a=1/Math.sqrt(a));let s=i*i+o*o;s>0&&(s=1/Math.sqrt(s));let u=(r*i+n*o)*a*s;return u>1?0:u<-1?Math.PI:Math.acos(u)}function Eo(e){return"vec2("+e[0]+", "+e[1]+")"}function xo(e,t){return e[0]===t[0]&&e[1]===t[1]}function To(e,t){let r=e[0],n=e[1],i=t[0],o=t[1];return Math.abs(r-i)<=p*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(n-o)<=p*Math.max(1,Math.abs(n),Math.abs(o))}const Mo=oo,Oo=Hi,Ao=Yi,Po=Ki,Ro=no,wo=io,So=ao,jo=function(){let e=Di();return function(t,r,n,i,o,a){let s,u;for(r||(r=2),n||(n=0),u=i?Math.min(i*r+n,t.length):t.length,s=n;s<u;s+=r)e[0]=t[s],e[1]=t[s+1],o(e,e,a),t[s]=e[0],t[s+1]=e[1];return t}}();r.d(t,"glMatrix",function(){return n}),r.d(t,"mat2",function(){return i}),r.d(t,"mat2d",function(){return o}),r.d(t,"mat3",function(){return a}),r.d(t,"mat4",function(){return s}),r.d(t,"quat",function(){return f}),r.d(t,"quat2",function(){return l}),r.d(t,"vec2",function(){return h}),r.d(t,"vec3",function(){return u}),r.d(t,"vec4",function(){return c})},function(e,t,r){"use strict";var n,i=r(2);!function(e){function t(e){return e>0?e-Math.floor(e):e-Math.ceil(e)}e.sign=function(e){return e>0?1:e<0?-1:0},e.clamp=function(e,t,r){return Math.max(t,Math.min(r,e))},e.fract=t,e.v2=function(){return i.vec2.create()},e.clamp2=function(e,t,r,n){return e[0]=Math.max(r[0],Math.min(n[0],t[0])),e[1]=Math.max(r[1],Math.min(n[1],t[1])),e},e.abs2=function(e,t){return e[0]=Math.abs(t[0]),e[1]=Math.abs(t[1]),e},e.v3=function(){return i.vec3.create()},e.clamp3=function(e,t,r,n){return e[0]=Math.max(r[0],Math.min(n[0],t[0])),e[1]=Math.max(r[1],Math.min(n[1],t[1])),e[2]=Math.max(r[2],Math.min(n[2],t[2])),e},e.abs3=function(e,t){return e[0]=Math.abs(t[0]),e[1]=Math.abs(t[1]),e[2]=Math.abs(t[2]),e};var r=1/256;e.encode_float24x1_to_uint8x3=function(e,r){return e[0]=Math.floor(256*r),e[1]=Math.floor(256*t(256*r)),e[2]=Math.floor(256*t(65536*r)),e},e.decode_float24x1_from_uint8x3=function(e){return(e[0]+(e[1]+e[2]*r)*r)*r},e.encode_uint24_to_rgb8=function(e,t){return e[0]=t>>0&255,e[1]=t>>8&255,e[2]=t>>16&255,e},e.encode_uint32_to_rgba8=function(e,t){return e[0]=t>>0&255,e[1]=t>>8&255,e[2]=t>>16&255,e[3]=t>>24&255,e},e.decode_uint24_from_rgb8=function(e){return e[0]+(e[1]<<8)+(e[2]<<16)},e.decode_uint32_from_rgba8=function(e){return e[0]+(e[1]<<8)+(e[2]<<16)+(e[3]<<24)},e.fromVec4=function(e){return i.vec3.fromValues(e[0]/e[3],e[1]/e[3],e[2]/e[3])},e.v4=function(){return i.vec4.create()},e.clamp4=function(e,t,r,n){return e[0]=Math.max(r[0],Math.min(n[0],t[0])),e[1]=Math.max(r[1],Math.min(n[1],t[1])),e[2]=Math.max(r[2],Math.min(n[2],t[2])),e[3]=Math.max(r[3],Math.min(n[3],t[3])),e},e.abs4=function(e,t){return e[0]=Math.abs(t[0]),e[1]=Math.abs(t[1]),e[2]=Math.abs(t[2]),e[3]=Math.abs(t[3]),e},e.fromVec3=function(e){return i.vec4.fromValues(e[0],e[1],e[2],1)},e.parseVec2=function(e){if(void 0!==e&&""!==e){var t=[];try{t=JSON.parse("["+e+"]")}catch(e){return}return 2!==t.length||isNaN(t[0])||isNaN(t[1])?void 0:i.vec2.clone(t)}},e.parseVec3=function(e){if(void 0!==e&&""!==e){var t=[];try{t=JSON.parse("["+e+"]")}catch(e){return}return 3!==t.length||isNaN(t[0])||isNaN(t[1])||isNaN(t[2])?void 0:i.vec3.clone(t)}},e.parseVec4=function(e){if(void 0!==e&&""!==e){var t=[];try{t=JSON.parse("["+e+"]")}catch(e){return}return 4!==t.length||isNaN(t[0])||isNaN(t[1])||isNaN(t[2])||isNaN(t[3])?void 0:i.vec4.clone(t)}},e.mix=function(e,t,r){return e*(1-r)+t*r},e.m2=function(){return i.mat2.create()},e.m3=function(){return i.mat3.create()},e.m4=function(){return i.mat4.create()}}(n||(n={})),e.exports=n},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),a=r(1),s=function(e){function t(t,r){var n=e.call(this)||this;return n._valid=!1,n._referenceCount=0,n._context=t,n._identifier=void 0!==r&&""!==r?r:"Object",n}return n(t,e),t.prototype.initialize=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._identifier=this._context.allocationRegister.createUniqueIdentifier(this._identifier),this.create.apply(this,e),this._valid||(this._context.allocationRegister.deleteUniqueIdentifier(this._identifier),o.log(o.LogLevel.Error,"initialization of '"+this._identifier+"' failed")),this._valid},t.prototype.uninitialize=function(){this._context.allocationRegister.reallocate(this._identifier,0),this._context.allocationRegister.deleteUniqueIdentifier(this._identifier),this.delete(),o.assert(void 0===this._object,"expected object '"+this._identifier+"' to be undefined after delete"),o.assert(!1===this._valid,"expected object '"+this._identifier+"' to be invalid after delete")},Object.defineProperty(t.prototype,"context",{get:function(){return this._context},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"identifier",{get:function(){return this._identifier},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"object",{get:function(){return o.assert(void 0!==this._object,"access to undefined object"),this._object},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"valid",{get:function(){return this._valid},enumerable:!0,configurable:!0}),t.prototype.ref=function(){o.assert(this.initialized,"expected object to be initialized in order to be referenced"),++this._referenceCount},t.prototype.unref=function(){o.assert(this._referenceCount>0,"expected object to be referenced in order to decrease its reference count"),--this._referenceCount},i([a.Initializable.initialize()],t.prototype,"initialize",null),i([a.Initializable.uninitialize()],t.prototype,"uninitialize",null),t}(a.Initializable);t.AbstractObject=s},function(t,r){t.exports=e},function(e,t,r){"use strict";var n=r(23),i=t.ValidationError=function(e,t,r,n,i,o){n&&(this.property=n),e&&(this.message=e),r&&(r.id?this.schema=r.id:this.schema=r),t&&(this.instance=t),this.name=i,this.argument=o,this.stack=this.toString()};i.prototype.toString=function(){return this.property+" "+this.message};var o=t.ValidatorResult=function(e,t,r,n){this.instance=e,this.schema=t,this.propertyPath=n.propertyPath,this.errors=[],this.throwError=r&&r.throwError,this.disableFormat=r&&!0===r.disableFormat};function a(e,t){return t+": "+e.toString()+"\n"}o.prototype.addError=function(e){var t;if("string"==typeof e)t=new i(e,this.instance,this.schema,this.propertyPath);else{if(!e)throw new Error("Missing error detail");if(!e.message)throw new Error("Missing error message");if(!e.name)throw new Error("Missing validator type");t=new i(e.message,this.instance,this.schema,this.propertyPath,e.name,e.argument)}if(this.throwError)throw t;return this.errors.push(t),t},o.prototype.importErrors=function(e){"string"==typeof e||e&&e.validatorType?this.addError(e):e&&e.errors&&Array.prototype.push.apply(this.errors,e.errors)},o.prototype.toString=function(e){return this.errors.map(a).join("")},Object.defineProperty(o.prototype,"valid",{get:function(){return!this.errors.length}});var s=t.SchemaError=function e(t,r){this.message=t,this.schema=r,Error.call(this,t),Error.captureStackTrace(this,e)};s.prototype=Object.create(Error.prototype,{constructor:{value:s,enumerable:!1},name:{value:"SchemaError",enumerable:!1}});var u=t.SchemaContext=function(e,t,r,n,i){this.schema=e,this.options=t,this.propertyPath=r,this.base=n,this.schemas=i};u.prototype.resolve=function(e){return n.resolve(this.base,e)},u.prototype.makeChild=function(e,t){var r=void 0===t?this.propertyPath:this.propertyPath+f(t),i=n.resolve(this.base,e.id||""),o=new u(e,this.options,r,i,Object.create(this.schemas));return e.id&&!o.schemas[i]&&(o.schemas[i]=e),o};var c=t.FORMAT_REGEXPS={"date-time":/^\d{4}-(?:0[0-9]{1}|1[0-2]{1})-(3[01]|0[1-9]|[12][0-9])[tT ](2[0-4]|[01][0-9]):([0-5][0-9]):(60|[0-5][0-9])(\.\d+)?([zZ]|[+-]([0-5][0-9]):(60|[0-5][0-9]))$/,date:/^\d{4}-(?:0[0-9]{1}|1[0-2]{1})-(3[01]|0[1-9]|[12][0-9])$/,time:/^(2[0-4]|[01][0-9]):([0-5][0-9]):(60|[0-5][0-9])$/,email:/^(?:[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+\.)*[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+@(?:(?:(?:[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!\.)){0,61}[a-zA-Z0-9]?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9\-](?!$)){0,61}[a-zA-Z0-9]?)|(?:\[(?:(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\.){3}(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\]))$/,"ip-address":/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,ipv6:/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,uri:/^[a-zA-Z][a-zA-Z0-9+-.]*:[^\s]*$/,color:/^(#?([0-9A-Fa-f]{3}){1,2}\b|aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|yellow|(rgb\(\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*\))|(rgb\(\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*\)))$/,hostname:/^(?=.{1,255}$)[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?(?:\.[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?)*\.?$/,"host-name":/^(?=.{1,255}$)[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?(?:\.[0-9A-Za-z](?:(?:[0-9A-Za-z]|-){0,61}[0-9A-Za-z])?)*\.?$/,alpha:/^[a-zA-Z]+$/,alphanumeric:/^[a-zA-Z0-9]+$/,"utc-millisec":function(e){return"string"==typeof e&&parseFloat(e)===parseInt(e,10)&&!isNaN(e)},regex:function(e){var t=!0;try{new RegExp(e)}catch(e){t=!1}return t},style:/\s*(.+?):\s*([^;]+);?/g,phone:/^\+(?:[0-9] ?){6,14}[0-9]$/};c.regexp=c.regex,c.pattern=c.regex,c.ipv4=c["ip-address"],t.isFormat=function(e,t,r){if("string"==typeof e&&void 0!==c[t]){if(c[t]instanceof RegExp)return c[t].test(e);if("function"==typeof c[t])return c[t](e)}else if(r&&r.customFormats&&"function"==typeof r.customFormats[t])return r.customFormats[t](e);return!0};var f=t.makeSuffix=function(e){return(e=e.toString()).match(/[.\s\[\]]/)||e.match(/^[\d]/)?e.match(/^\d+$/)?"["+e+"]":"["+JSON.stringify(e)+"]":"."+e};function l(e,t){var r=Array.isArray(t),n=r&&[]||{};return r?(e=e||[],n=n.concat(e),t.forEach(function(e,t,r,n){"object"==typeof r?t[n]=l(e[n],r):-1===e.indexOf(r)&&t.push(r)}.bind(null,e,n))):(e&&"object"==typeof e&&Object.keys(e).forEach(function(e,t,r){t[r]=e[r]}.bind(null,e,n)),Object.keys(t).forEach(function(e,t,r,n){"object"==typeof t[n]&&t[n]&&e[n]?r[n]=l(e[n],t[n]):r[n]=t[n]}.bind(null,e,t,n))),n}function h(e){return"/"+encodeURIComponent(e).replace(/~/g,"%7E")}t.deepCompareStrict=function e(t,r){if(typeof t!=typeof r)return!1;if(t instanceof Array)return r instanceof Array&&(t.length===r.length&&t.every(function(n,i){return e(t[i],r[i])}));if("object"==typeof t){if(!t||!r)return t===r;var n=Object.keys(t),i=Object.keys(r);return n.length===i.length&&n.every(function(n){return e(t[n],r[n])})}return t===r},e.exports.deepMerge=l,t.objectGetPath=function(e,t){for(var r,n=t.split("/").slice(1);"string"==typeof(r=n.shift());){var i=decodeURIComponent(r.replace(/~0/,"~").replace(/~1/g,"/"));if(!(i in e))return;e=e[i]}return e},t.encodePath=function(e){return e.map(h).join("")},t.getDecimalPlaces=function(e){var t=0;if(isNaN(e))return t;"number"!=typeof e&&(e=Number(e));var r=e.toString().split("e");if(2===r.length){if("-"!==r[1][0])return t;t=Number(r[1].slice(1))}var n=r[0].split(".");return 2===n.length&&(t+=n[1].length),t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(37),i=function(){function e(){this._camera=void 0,this._reference=new n.Camera}return Object.defineProperty(e.prototype,"camera",{set:function(e){this._camera!==e&&(this._camera=e,void 0!==e&&(Object.assign(this._reference,e),this.update()))},enumerable:!0,configurable:!0}),e}();t.CameraModifier=i},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),a=r(1),s=r(4),u=r(30),c=r(9),f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._buffersByAttachment=new Map,t._texturesByAttachment=new Map,t._colorClearQueue=new Array,t._drawBuffers=new Array,t._drawBuffersChanged=!1,t}return n(t,e),t.statusString=function(e,t){var r=e.gl;switch(t){case r.FRAMEBUFFER_COMPLETE:return"the framebuffer is ready to display (COMPLETE)";case r.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"the attachment types are mismatched or not all framebuffer attachment points are framebuffer attachment complete (INCOMPLETE_ATTACHMENT)";case r.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"there is no attachment (INCOMPLETE_MISSING_ATTACHMENT)";case r.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"height and width of the attachment are not the same (INCOMPLETE_DIMENSIONS)";case r.FRAMEBUFFER_UNSUPPORTED:return"the format of the attachment is not supported or if depth and stencil attachments are not the same renderbuffer (UNSUPPORTED)";case r.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:return"the values of gl.RENDERBUFFER_SAMPLES are different among attached renderbuffers, or are non-zero if the attached images are a mix of renderbuffers and textures (INCOMPLETE_MULTISAMPLE)";default:return o.assert(!1,"expected known framebuffer status, given "+t),""}},t.prototype.create=function(e){var r=this._context.gl,n=this.context.gl2facade;this._object=r.createFramebuffer(),this._clearColors=new Array(n.COLOR_ATTACHMENT_MAX-n.COLOR_ATTACHMENT0),this._clearDepth=1,this._clearStencil=0,this.clear=this.context.isWebGL1?this.es2Clear:this.es3Clear;for(var i=0,a=e;i<a.length;i++){var s=a[i],f=s[0],l=s[1];if(l instanceof u.Renderbuffer?this._buffersByAttachment.set(f,l):l instanceof c.Texture2&&this._texturesByAttachment.set(f,l),!(f<n.COLOR_ATTACHMENT_MIN||f>n.COLOR_ATTACHMENT_MAX)){this._drawBuffers.push(f);var h=f-r.COLOR_ATTACHMENT0;this._colorClearQueue.push(h),this._clearColors[h]=[0,0,0,0]}}this._drawBuffersChanged=!0,r.bindFramebuffer(r.FRAMEBUFFER,this._object),this._buffersByAttachment.forEach(function(e,t){r.framebufferRenderbuffer(r.FRAMEBUFFER,t,r.RENDERBUFFER,e.object)}),this._texturesByAttachment.forEach(function(e,t){r.framebufferTexture2D(r.FRAMEBUFFER,t,r.TEXTURE_2D,e.object,0)}),n.drawBuffers&&n.drawBuffers(this._drawBuffers);var p=r.checkFramebufferStatus(r.FRAMEBUFFER);return this._valid=r.isFramebuffer(this._object)&&p===r.FRAMEBUFFER_COMPLETE,o.logIf(!this._valid,o.LogLevel.Warning,t.statusString(this.context,p)),r.bindFramebuffer(r.FRAMEBUFFER,t.DEFAULT_FRAMEBUFFER),this._object},t.prototype.delete=function(){o.assert(this._object instanceof WebGLFramebuffer,"expected WebGLFramebuffer object"),this.context.gl.deleteFramebuffer(this._object),this._object=void 0,this._valid=!1},t.prototype.es2Clear=function(e,t,r){void 0===t&&(t=!0),void 0===r&&(r=!0);var n=this.context.gl,i=o.bitInBitfield(e,n.DEPTH_BUFFER_BIT),a=o.bitInBitfield(e,n.STENCIL_BUFFER_BIT),s=o.bitInBitfield(e,n.COLOR_BUFFER_BIT);if(s||i||a){if(t&&this.bind(),s&&void 0!==this._clearColors[0]){var u=this._clearColors[0];n.clearColor(u[0],u[1],u[2],u[3])}i&&void 0!==this._clearDepth&&n.clearDepth(this._clearDepth),a&&void 0!==this._clearStencil&&n.clearStencil(this._clearStencil),n.clear(e),r&&this.unbind()}},t.prototype.es3Clear=function(e,t,r,n){void 0===t&&(t=!0),void 0===r&&(r=!0);var i=this.context.gl,a=o.bitInBitfield(e,i.DEPTH_BUFFER_BIT),s=o.bitInBitfield(e,i.STENCIL_BUFFER_BIT),u=o.bitInBitfield(e,i.COLOR_BUFFER_BIT);if(u||a||s){if(t&&this.bind(),u)for(var c=0,f=n||this._colorClearQueue;c<f.length;c++){var l=f[c];i.clearBufferfv(i.COLOR,l,this._clearColors[l])}a&&s?(i.clearStencil(this._clearStencil),i.clearDepth(this._clearDepth),i.clear(i.STENCIL_BUFFER_BIT|i.DEPTH_BUFFER_BIT)):a?i.clearBufferfv(i.DEPTH,0,[this._clearDepth]):s&&(i.clearStencil(this._clearStencil),i.clear(i.STENCIL_BUFFER_BIT)),r&&this.unbind()}},t.prototype.hasAttachment=function(e){return this._texturesByAttachment.has(e)||this._buffersByAttachment.has(e)},t.prototype.bind=function(e){void 0===e&&(e=this.context.gl.FRAMEBUFFER),this.context.gl.bindFramebuffer(e,this._object),this._drawBuffersChanged&&this.context.gl2facade.drawBuffers&&(this.context.gl2facade.drawBuffers(this._drawBuffers),this._drawBuffersChanged=!1)},t.prototype.unbind=function(e){void 0===e&&(e=this.context.gl.FRAMEBUFFER),this.context.gl.bindFramebuffer(e,t.DEFAULT_FRAMEBUFFER)},t.prototype.clearColor=function(e,t){o.assert(void 0===t||0===t||this.context.isWebGL2||this.context.supportsDrawBuffers,"WebGL2 context expected for clearing multiple color attachments.");var r=e[3]<1&&!this.context.alpha;o.logIf(r,o.LogLevel.Warning,"context has alpha disabled, clear color alpha is ignored");var n=[e[0],e[1],e[2],r?1:e[3]];if(this.context.premultipliedAlpha&&!r&&(n[0]*=n[3],n[1]*=n[3],n[2]*=n[3]),void 0!==t)this._clearColors[t]=n;else for(var i=0;i<this._clearColors.length;++i)this._clearColors[i]=n},t.prototype.clearDepth=function(e){this._clearDepth=e},t.prototype.clearStencil=function(e){this._clearStencil=e},t.prototype.texture=function(e){return this._texturesByAttachment.get(e)},t.prototype.resize=function(e,t,r,n){void 0===r&&(r=!0),void 0===n&&(n=!0),this._buffersByAttachment.forEach(function(i){i.resize(e,t,r,n)}),this._texturesByAttachment.forEach(function(i){i.resize(e,t,r,n)})},Object.defineProperty(t.prototype,"width",{get:function(){this.assertInitialized();var e=NaN;return this._buffersByAttachment.forEach(function(t){(isNaN(e)||t.width<e)&&(e=t.width)}),this._texturesByAttachment.forEach(function(t){(isNaN(e)||t.width<e)&&(e=t.width)}),e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){this.assertInitialized();var e=NaN;return this._buffersByAttachment.forEach(function(t){(isNaN(e)||t.height<e)&&(e=t.height)}),this._texturesByAttachment.forEach(function(t){(isNaN(e)||t.height<e)&&(e=t.height)}),e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return[this.width,this.height]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"drawBuffers",{get:function(){return this.assertInitialized(),this._drawBuffers},set:function(e){this.assertInitialized();for(var t=this.context.gl2facade,r=0,n=e;r<n.length;r++){var i=n[r];o.assert(this.hasAttachment(i),"valid attachment expected for draw buffer, given "+i),o.assert(i>=t.COLOR_ATTACHMENT_MIN&&i<=t.COLOR_ATTACHMENT_MAX,"color attachment expected for draw buffer, given "+i),this._drawBuffersChanged=this._drawBuffersChanged||-1===this._drawBuffers.indexOf(i)}this._drawBuffersChanged=this._drawBuffersChanged||e.length!==this._drawBuffers.length,this._drawBuffersChanged&&(this._drawBuffers=e)},enumerable:!0,configurable:!0}),t.DEFAULT_FRAMEBUFFER=void 0,i([a.Initializable.assert_initialized()],t.prototype,"es2Clear",null),i([a.Initializable.assert_initialized()],t.prototype,"es3Clear",null),i([a.Initializable.assert_initialized()],t.prototype,"bind",null),i([a.Initializable.assert_initialized()],t.prototype,"unbind",null),i([a.Initializable.assert_initialized()],t.prototype,"clearColor",null),i([a.Initializable.assert_initialized()],t.prototype,"clearDepth",null),i([a.Initializable.assert_initialized()],t.prototype,"clearStencil",null),i([a.Initializable.assert_initialized()],t.prototype,"texture",null),i([a.Initializable.assert_initialized()],t.prototype,"resize",null),t}(s.AbstractObject);t.Framebuffer=f},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),a=r(25),s=r(1),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._width=0,t._height=0,t._internalFormat=0,t._format=0,t._type=0,t}return n(t,e),t.prototype.create=function(e,r,n,i,a){o.assert(e>0&&r>0,"texture requires valid width and height of greater than zero");var s=this._context.gl,u=this._context.gl2facade;return this._object=s.createTexture(),this._width=e,this._height=r,this._internalFormat=n,this._format=i,this._type=a,s.bindTexture(s.TEXTURE_2D,this._object),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.NEAREST),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.NEAREST),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE),u.texImage2D(s.TEXTURE_2D,0,this._internalFormat,this._width,this._height,0,this._format,this._type),s.bindTexture(s.TEXTURE_2D,t.DEFAULT_TEXTURE),this._valid=s.isTexture(this._object),this.reallocate(),this._object},t.prototype.delete=function(){o.assert(this._object instanceof WebGLTexture,"expected WebGLTexture object"),this._context.gl.deleteTexture(this._object),this._object=void 0,this._valid=!1,this._internalFormat=0,this._format=0,this._type=0,this._width=0,this._height=0},t.prototype.reallocate=function(){var e=this.context.gl,t=this._context.gl2facade,r=this._width*this._height*a.byteSizeOfFormat(this.context,this._internalFormat);this._type===t.HALF_FLOAT&&this._internalFormat!==e.RGBA16F?r*=2:this._type===e.FLOAT&&this._internalFormat!==e.RGBA16F&&(r*=4),this.context.allocationRegister.reallocate(this._identifier,r)},t.prototype.bind=function(e){var t=this.context.gl;e&&t.activeTexture(e),t.bindTexture(t.TEXTURE_2D,this._object)},t.prototype.unbind=function(e){var r=this.context.gl;e&&r.activeTexture(e),r.bindTexture(r.TEXTURE_2D,t.DEFAULT_TEXTURE)},t.prototype.load=function(e,t){var r=this;return void 0===t&&(t=!1),new Promise(function(n,i){var o=new Image;o.onerror=function(){return i()},o.onload=function(){r.resize(o.width,o.height),r.data(o),n()},t&&(o.crossOrigin="anonymous"),o.src=e})},t.prototype.data=function(e,t,r){void 0===t&&(t=!0),void 0===r&&(r=!0);var n=this.context.gl,i=this._context.gl2facade;t&&this.bind(),i.texImage2D(n.TEXTURE_2D,0,this._internalFormat,this._width,this._height,0,this._format,this._type,e),r&&this.unbind(),this.reallocate()},t.prototype.filter=function(e,t,r,n){void 0===r&&(r=!0),void 0===n&&(n=!0);var i=this.context.gl;r&&this.bind(),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,e),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,t),n&&this.unbind()},t.prototype.wrap=function(e,t,r,n){void 0===r&&(r=!0),void 0===n&&(n=!0);var i=this.context.gl;r&&this.bind(),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,e),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,t),n&&this.unbind()},t.prototype.reformat=function(e,t,r,n,i){void 0===n&&(n=!0),void 0===i&&(i=!0),(e!==this._internalFormat||void 0!==t&&t!==this._format||void 0!==r&&r!==this._type)&&(o.assert(void 0!==e,"valid internal format expected"),this._internalFormat=e,t&&(this._format=t),r&&(this._type=r),this.data(void 0,n,i))},t.prototype.resize=function(e,t,r,n){void 0===r&&(r=!0),void 0===n&&(n=!0),e===this._width&&t===this._height||(this._width=e,this._height=t,this.data(void 0,r,n))},Object.defineProperty(t.prototype,"bytes",{get:function(){return this.assertInitialized(),this.context.allocationRegister.allocated(this._identifier)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"internalFormat",{get:function(){return this.assertInitialized(),this._internalFormat},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"format",{get:function(){return this.assertInitialized(),this._format},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this.assertInitialized(),this._type},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.assertInitialized(),this._width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.assertInitialized(),this._height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return[this.width,this.height]},enumerable:!0,configurable:!0}),t.DEFAULT_TEXTURE=void 0,i([s.Initializable.assert_initialized()],t.prototype,"bind",null),i([s.Initializable.assert_initialized()],t.prototype,"unbind",null),i([s.Initializable.assert_initialized()],t.prototype,"load",null),i([s.Initializable.assert_initialized()],t.prototype,"data",null),i([s.Initializable.assert_initialized()],t.prototype,"filter",null),i([s.Initializable.assert_initialized()],t.prototype,"wrap",null),i([s.Initializable.assert_initialized()],t.prototype,"reformat",null),i([s.Initializable.assert_initialized()],t.prototype,"resize",null),t}(r(4).AbstractObject);t.Texture2=u},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),a=r(1),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.attach=function(e){o.assert(void 0!==this._object,"expected a WebGLProgram object");for(var t=this._context.gl,r=0,n=e;r<n.length;r++){var i=n[r];i.initialized?(t.attachShader(this._object,i.object),i.ref()):o.log(o.LogLevel.Error,"shader '"+i.identifier+"' not initialized.")}return!0},t.prototype.link=function(){o.assert(void 0!==this._object,"expected WebGLProgram object");var e=this._context.gl;if(e.linkProgram(this._object),!e.getProgramParameter(this._object,e.LINK_STATUS)){var t=e.getProgramInfoLog(this._object);return o.log(o.LogLevel.Error,"linking of program '"+this._identifier+"' failed: '"+t+"'"),!1}return!0},t.prototype.detach=function(e){o.assert(void 0!==this._object,"expected WebGLProgram object");for(var t=this._context.gl,r=0,n=e;r<n.length;r++){var i=n[r];o.assert(i.initialized,"expected shader '"+i.identifier+"' to be initialized"),t.detachShader(this._object,i.object),i.unref()}},t.prototype.create=function(e){for(var t=this._context.gl,r=0,n=0,i=0,a=e;i<a.length;i++){switch(a[i].type){case t.VERTEX_SHADER:++r;break;case t.FRAGMENT_SHADER:++n;break;default:o.assert(!1,"Unknown shader type detected.")}}if(o.logIf(r<1,o.LogLevel.Error,"at least one vertex shader is expected"),o.logIf(n<1,o.LogLevel.Error,"at least one fragment shader is expected"),!(r<1||n<1)){if(this._object=t.createProgram(),o.assert(this._object instanceof WebGLProgram,"expected WebGLProgram object to be created"),this.attach(e)&&this.link())return this.detach(e),this._valid=t.isProgram(this._object),this._object;this.delete()}},t.prototype.delete=function(){o.assert(void 0!==this._object,"expected WebGLProgram object"),this._context.gl.deleteProgram(this._object),this._object=void 0,this._valid=!1},t.prototype.bind=function(){this._context.gl.useProgram(this._object)},t.prototype.unbind=function(){this._context.gl.useProgram(t.DEFAULT_PROGRAM)},t.prototype.uniform=function(e){return this._context.gl.getUniformLocation(this._object,e)},t.prototype.attribute=function(e,t){return this._context.isWebGL2&&void 0!==t?(this._context.gl.bindAttribLocation(this._object,t,e),t):this._context.gl.getAttribLocation(this._object,e)},t.DEFAULT_PROGRAM=void 0,i([a.Initializable.assert_initialized()],t.prototype,"bind",null),i([a.Initializable.assert_initialized()],t.prototype,"unbind",null),i([a.Initializable.assert_initialized()],t.prototype,"uniform",null),i([a.Initializable.assert_initialized()],t.prototype,"attribute",null),t}(r(4).AbstractObject);t.Program=s},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),o=function(e){function t(t,r,n){var o=this,a=t.gl;if(void 0===n)switch(r){case t.gl.FRAGMENT_SHADER:n="FragmentShader";break;case t.gl.VERTEX_SHADER:n="VertexShader";break;default:i.assert(!1,"expected either a FRAGMENT_SHADER ("+a.FRAGMENT_SHADER+") or a VERTEX_SHADER ("+a.VERTEX_SHADER+"), given "+r)}return(o=e.call(this,t,n)||this)._type=r,o}return n(t,e),t.prototype.create=function(e){var t=this._context.gl;if(this._object=t.createShader(this._type),i.assert(this._object instanceof WebGLShader,"expected WebGLShader object to be created"),this._context.isWebGL2&&(e="#version 300 es\n"+e),t.shaderSource(this._object,e),t.compileShader(this._object),!t.getShaderParameter(this._object,t.COMPILE_STATUS)){var r=t.getShaderInfoLog(this._object);return i.log(i.LogLevel.Error,"compilation of shader '"+this._identifier+"' failed: "+r),void this.delete()}return this._valid=t.isShader(this._object),this._object},t.prototype.delete=function(){i.assert(void 0!==this._object,"expected WebGLShader object"),this._context.gl.deleteShader(this._object),this._object=void 0,this._valid=!1},Object.defineProperty(t.prototype,"type",{get:function(){return this.assertInitialized(),this._type},enumerable:!0,configurable:!0}),t}(r(4).AbstractObject);t.Shader=o},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),a=r(22),s=r(26),u=r(1),c=function(e){function t(t,r){var n=e.call(this,t,r)||this;r=void 0!==r&&""!==r?r:n.constructor.name;var i=new a.Buffer(t,r+"VBO");return n._buffers.push(i),n}return n(t,e),t.prototype.bindBuffers=function(e){this._buffers[0].attribEnable(e[0],2,this.context.gl.FLOAT,!1,0,0,!0,!1),this._aVertex=e[0]},t.prototype.unbindBuffers=function(e){this._buffers[0].attribDisable(e[0],!0,!0)},t.prototype.initialize=function(r){var n=this.context.gl,i=e.prototype.initialize.call(this,[n.ARRAY_BUFFER],[r]);return o.assert(void 0!==this._buffers[0]&&this._buffers[0].object instanceof WebGLBuffer,"expected valid WebGLBuffer"),this._buffers[0].data(t.VERTICES,n.STATIC_DRAW),i},t.prototype.draw=function(){var e=this.context.gl;e.drawArrays(e.TRIANGLES,0,3)},Object.defineProperty(t.prototype,"aVertex",{get:function(){return this._aVertex},enumerable:!0,configurable:!0}),t.VERTICES=new Float32Array([-1,-3,3,1,-1,1]),i([u.Initializable.assert_initialized()],t.prototype,"draw",null),t}(s.Geometry);t.NdcFillingTriangle=c},function(e,t,r){"use strict";var n,i=r(2),o=r(3),a=r(0);!function(e){function t(e){return a.assert(2===e.length,"expected length of buffer to be 2, given "+e.length),[e[0],e[1]]}function r(e){return a.assert(3===e.length,"expected length of buffer to be 3, given "+e.length),[e[0],e[1],e[2]]}function n(e){return a.assert(4===e.length,"expected length of buffer to be 4, given "+e.length),[e[0],e[1],e[2],e[3]]}e.tuple2=t,e.tuple3=r,e.tuple4=n,e.clampf=function(e,t){var r=o.clamp(e,0,1);return a.logIf(void 0!==t&&e<0||e>1,a.LogLevel.Info,t+" clamped to ["+r+"], given ["+e+"]"),r},e.clampf2=function(e,r){var n=i.vec2.fromValues(e[0],e[1]);return(e[0]<0||e[0]>1||e[1]<0||e[1]>1)&&(o.clamp2(n,n,i.vec2.fromValues(0,0),i.vec2.fromValues(1,1)),a.logIf(void 0!==r,a.LogLevel.Info,r+" clamped to ["+n+"], given ["+e+"]")),t(n)},e.clampf3=function(e,t){var n=i.vec3.fromValues(e[0],e[1],e[2]);return(e[0]<0||e[0]>1||e[1]<0||e[1]>1||e[2]<0||e[2]>1)&&(o.clamp3(n,n,i.vec3.fromValues(0,0,0),i.vec3.fromValues(1,1,1)),a.logIf(void 0!==t,a.LogLevel.Info,t+" clamped to ["+n+"], given ["+e+"]")),r(n)},e.clampf4=function(e,t){var r=i.vec4.fromValues(e[0],e[1],e[2],e[3]);return(e[0]<0||e[0]>1||e[1]<0||e[1]>1||e[2]<0||e[2]>1||e[3]<0||e[3]>1)&&(o.clamp4(r,r,i.vec4.fromValues(0,0,0,0),i.vec4.fromValues(1,1,1,1)),a.logIf(void 0!==t,a.LogLevel.Info,t+" clamped to ["+r+"], given ["+e+"]")),n(r)},e.duplicate2=function(e){return[e[0],e[1]]},e.duplicate3=function(e){return[e[0],e[1],e[2]]},e.duplicate4=function(e){return[e[0],e[1],e[2],e[3]]},e.equals2=function(e,t){return e[0]===t[0]&&e[1]===t[1]},e.equals3=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},e.equals4=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}}(n||(n={})),e.exports=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=function(){function e(){}return e.queryInternalTextureFormat=function(t,r,i){var o=t.gl,a=t.gl2facade,s=t.isWebGL1&&t.supportsTextureFloat||t.isWebGL2&&t.supportsColorBufferFloat,u=t.isWebGL1&&t.supportsTextureHalfFloat||t.isWebGL2&&t.supportsColorBufferFloat;void 0===i&&(i=e.Precision.auto);var c,f,l=void 0===i?e.Precision.auto:i;if(i in e.Precision||(n.log(n.LogLevel.Warning,"unknown precision '"+l+"' changed to '"+e.Precision.auto+"'"),i=e.Precision.auto),i===e.Precision.auto&&(l=s?e.Precision.float:u?e.Precision.half:e.Precision.byte),l===e.Precision.half&&u?(t.isWebGL2?t.colorBufferFloat:t.textureHalfFloat,c=a.HALF_FLOAT,f=1):l!==e.Precision.float&&l!==e.Precision.half||!s?(c=o.UNSIGNED_BYTE,f=2):(t.isWebGL2?t.colorBufferFloat:t.textureFloat,c=o.FLOAT,f=0),t.isWebGL1)return[r,c,l];switch(r){case o.RGBA:return[[o.RGBA32F,o.RGBA16F,o.RGBA8][f],c,l];case o.RGB:return[[o.RGB32F,o.RGB16F,o.RGB8][f],c,l];default:n.assert(!1,"internal format querying is not yet supported for formats other than RGBA, RGB")}return[o.NONE,o.NONE,l]},e}();t.Wizard=i,function(e){!function(e){e.float="float",e.half="half",e.byte="byte",e.auto="auto"}(e.Precision||(e.Precision={}))}(i=t.Wizard||(t.Wizard={})),t.Wizard=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(55),o=r(32),a=r(33),s=r(16),u=r(57),c=function(){function e(t,r){this._extensions=new Array,this._allocationRegister=new i.AllocationRegister,this._context=t,this._mask=r;var o=t.toString(),a=/WebGLRenderingContext/.test(o)||/CaptureContext/.test(o),s=/WebGL2RenderingContext/.test(o);if(this._backend=a?e.BackendType.WebGL1:s?e.BackendType.WebGL2:void 0,n.assert(void 0!==this._backend&&this._backend.valueOf()!==e.BackendType.Invalid.valueOf(),"context is neither webgl nor webgl2, given "+o),this.queryExtensionSupport(),this._mask&&this._mask.functionsUndefine)for(var c in this._mask.functionsUndefine)this._context[c]=void 0;this._gl2=new u.GL2Facade(this)}return e.createMasqueradeFromGETorDataAttribute=function(e){var t=o.ContextMasquerade.fromGET();return t||(e.msqrdH?o.ContextMasquerade.fromHash(e.msqrdH):e.msqrdP?o.ContextMasquerade.fromPreset(e.msqrdP):void 0)},e.request=function(t,r){void 0===r&&(r=e.DEFAULT_ATTRIBUTES);var i,o=t.dataset,a=e.createMasqueradeFromGETorDataAttribute(o),s=a?a.backend:o.backend?o.backend.toLowerCase():"auto";switch(s in e.BackendRequestType||(n.log(n.LogLevel.Warning,"unknown backend '"+o.backend+"' changed to '"+e.BackendRequestType.auto+"'"),s="auto"),s){case e.BackendRequestType.webgl:break;case e.BackendRequestType.experimental:case e.BackendRequestType.webgl1:case e.BackendRequestType.experimental1:s=e.BackendRequestType.webgl;break;case e.BackendRequestType.webgl2:case e.BackendRequestType.experimental2:s=e.BackendRequestType.webgl2;break;default:s=e.BackendRequestType.auto}return s!==e.BackendRequestType.webgl&&(i=this.requestWebGL2(t,r)),i||(i=this.requestWebGL1(t,r),n.logIf(void 0!==i&&s===e.BackendRequestType.webgl2,n.LogLevel.Info,"backend changed to '"+e.BackendRequestType.webgl+"', given '"+s+"'")),n.assert(!!i,"creating a context failed"),new e(i,a)},e.requestWebGL1=function(t,r){void 0===r&&(r=e.DEFAULT_ATTRIBUTES);var n=t.getContext(e.BackendRequestType.webgl,r);return n||(null===(n=t.getContext(e.BackendRequestType.experimental,r))?void 0:n)},e.requestWebGL2=function(t,r){void 0===r&&(r=e.DEFAULT_ATTRIBUTES);var n=t.getContext(e.BackendRequestType.webgl2,r);return n||(null===(n=t.getContext(e.BackendRequestType.experimental2,r))?void 0:n)},Object.defineProperty(e.prototype,"alpha",{get:function(){return this._context.getContextAttributes().alpha},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"antialias",{get:function(){return this._context.getContextAttributes().antialias},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"depth",{get:function(){return this._context.getContextAttributes().depth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"failIfMajorPerformanceCaveat",{get:function(){return this._context.getContextAttributes().failIfMajorPerformanceCaveat},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"premultipliedAlpha",{get:function(){return this._context.getContextAttributes().premultipliedAlpha},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preserveDrawingBuffer",{get:function(){return this._context.getContextAttributes().preserveDrawingBuffer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stencil",{get:function(){return this._context.getContextAttributes().stencil},enumerable:!0,configurable:!0}),e.prototype.supports=function(t){if(this._mask&&this._mask.extensionsConceal.indexOf(t)>-1)return!1;switch(this._backend){case e.BackendType.WebGL1:n.assert(a.WEBGL1_EXTENSIONS.indexOf(t)>-1,"extension "+t+" not available to WebGL1");break;case e.BackendType.WebGL2:n.assert(-1===a.WEBGL2_DEFAULT_EXTENSIONS.indexOf(t),"extension "+t+" supported by default in WebGL2"),n.assert(a.WEBGL2_EXTENSIONS.indexOf(t)>-1,"extension "+t+" not available to WebGL2")}return this._extensions.indexOf(t)>-1},e.prototype.queryExtensionSupport=function(){this._extensions=this._context.getSupportedExtensions(),this._backend===e.BackendType.WebGL1&&(this.ANGLE_instanced_arrays_supported=this.supports("ANGLE_instanced_arrays"),this.EXT_blend_minmax_supported=this.supports("EXT_blend_minmax"),this.EXT_color_buffer_half_float_supported=this.supports("EXT_color_buffer_half_float"),this.EXT_disjoint_timer_query_supported=this.supports("EXT_disjoint_timer_query"),this.EXT_frag_depth_supported=this.supports("EXT_frag_depth"),this.EXT_sRGB_supported=this.supports("EXT_sRGB"),this.EXT_shader_texture_lod_supported=this.supports("EXT_shader_texture_lod"),this.OES_element_index_uint_supported=this.supports("OES_element_index_uint"),this.OES_standard_derivatives_supported=this.supports("OES_standard_derivatives"),this.OES_texture_float_supported=this.supports("OES_texture_float"),this.OES_texture_half_float_supported=this.supports("OES_texture_half_float"),this.OES_vertex_array_object_supported=this.supports("OES_vertex_array_object"),this.WEBGL_color_buffer_float_supported=this.supports("WEBGL_color_buffer_float"),this.WEBGL_depth_texture_supported=this.supports("WEBGL_depth_texture"),this.WEBGL_draw_buffers_supported=this.supports("WEBGL_draw_buffers")),this._backend===e.BackendType.WebGL2&&(this.EXT_color_buffer_float_supported=this.supports("EXT_color_buffer_float"),this.EXT_disjoint_timer_query_webgl2_supported=this.supports("EXT_disjoint_timer_query_webgl2")),this.EXT_texture_filter_anisotropic_supported=this.supports("EXT_texture_filter_anisotropic"),this.OES_texture_float_linear_supported=this.supports("OES_texture_float_linear"),this.OES_texture_half_float_linear_supported=this.supports("OES_texture_half_float_linear"),this.WEBGL_compressed_texture_astc_supported=this.supports("WEBGL_compressed_texture_astc"),this.WEBGL_compressed_texture_atc_supported=this.supports("WEBGL_compressed_texture_atc"),this.WEBGL_compressed_texture_etc_supported=this.supports("WEBGL_compressed_texture_etc"),this.WEBGL_compressed_texture_etc1_supported=this.supports("WEBGL_compressed_texture_etc1"),this.WEBGL_compressed_texture_pvrtc_supported=this.supports("WEBGL_compressed_texture_pvrtc"),this.WEBGL_compressed_texture_s3tc_supported=this.supports("WEBGL_compressed_texture_s3tc"),this.WEBGL_compressed_texture_s3tc_srgb_supported=this.supports("WEBGL_compressed_texture_s3tc_srgb"),this.WEBGL_debug_renderer_info_supported=this.supports("WEBGL_debug_renderer_info"),this.WEBGL_debug_shaders_supported=this.supports("WEBGL_debug_shaders"),this.WEBGL_lose_context_supported=this.supports("WEBGL_lose_context")},e.prototype.extension=function(e,t){return void 0===e&&(n.assert(this.supports(t),"extension "+t+" expected to be supported"),e=this._context.getExtension(t)),e},Object.defineProperty(e.prototype,"allocationRegister",{get:function(){return this._allocationRegister},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"backend",{get:function(){return this._backend},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"backendString",{get:function(){switch(this._backend){case e.BackendType.WebGL1:return"WebGL";case e.BackendType.WebGL2:return"WebGL2";default:return}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"extensions",{get:function(){return this._extensions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mask",{get:function(){return this._mask},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gl",{get:function(){return this._context},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gl2facade",{get:function(){return this._gl2},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isWebGL1",{get:function(){return this._backend===e.BackendType.WebGL1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isWebGL2",{get:function(){return this._backend===e.BackendType.WebGL2},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsInstancedArrays",{get:function(){return this.ANGLE_instanced_arrays_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"instancedArrays",{get:function(){return this.extension(this.ANGLE_instanced_arrays,"ANGLE_instanced_arrays")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsBlendMinmax",{get:function(){return this.EXT_blend_minmax_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blendMinmax",{get:function(){return this.extension(this.EXT_blend_minmax,"EXT_blend_minmax")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsColorBufferHalfFloat",{get:function(){return this.EXT_color_buffer_half_float_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"colorBufferHalfFloat",{get:function(){return this.extension(this.EXT_color_buffer_half_float,"EXT_color_buffer_half_float")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsDisjointTimerQuery",{get:function(){return this.EXT_disjoint_timer_query_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"disjointTimerQuery",{get:function(){return this.extension(this.EXT_disjoint_timer_query,"EXT_disjoint_timer_query")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsDisjointTimerQueryWebGL2",{get:function(){return this.EXT_disjoint_timer_query_webgl2_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"disjointTimerQueryWebGL2",{get:function(){return this.extension(this.EXT_disjoint_timer_query_webgl2,"EXT_disjoint_timer_query_webgl2")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsFragDepth",{get:function(){return this.EXT_frag_depth_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fragDepth",{get:function(){return this.extension(this.EXT_frag_depth,"EXT_frag_depth")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsSRGB",{get:function(){return this.EXT_sRGB_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sRGB",{get:function(){return this.extension(this.EXT_sRGB,"EXT_sRGB")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsShaderTextureLOD",{get:function(){return this.EXT_shader_texture_lod_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shaderTextureLOD",{get:function(){return this.extension(this.EXT_shader_texture_lod,"EXT_shader_texture_lod")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsTextureFilterAnisotropic",{get:function(){return this.EXT_texture_filter_anisotropic_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textureFilterAnisotropic",{get:function(){return this.extension(this.EXT_texture_filter_anisotropic,"EXT_texture_filter_anisotropic")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsElementIndexUint",{get:function(){return this.OES_element_index_uint_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"elementIndexUint",{get:function(){return this.extension(this.OES_element_index_uint,"OES_element_index_uint")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsStandardDerivatives",{get:function(){return this.OES_standard_derivatives_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"standardDerivatives",{get:function(){return this.extension(this.OES_standard_derivatives,"OES_standard_derivatives")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsTextureFloat",{get:function(){return this.OES_texture_float_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textureFloat",{get:function(){return this.extension(this.OES_texture_float,"OES_texture_float")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsTextureFloatLinear",{get:function(){return this.OES_texture_float_linear_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textureFloatLinear",{get:function(){return this.extension(this.OES_texture_float_linear,"OES_texture_float_linear")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsTextureHalfFloat",{get:function(){return this.OES_texture_half_float_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textureHalfFloat",{get:function(){return this.extension(this.OES_texture_half_float,"OES_texture_half_float")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsTextureHalfFloatLinear",{get:function(){return this.OES_texture_half_float_linear_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textureHalfFloatLinear",{get:function(){return this.extension(this.OES_texture_half_float_linear,"OES_texture_half_float_linear")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsVertexArrayObject",{get:function(){return this.OES_vertex_array_object_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vertexArrayObject",{get:function(){return this.extension(this.OES_vertex_array_object,"OES_vertex_array_object")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsColorBufferFloat",{get:function(){switch(this._backend){case e.BackendType.WebGL1:return this.WEBGL_color_buffer_float_supported;case e.BackendType.WebGL2:return this.EXT_color_buffer_float_supported;default:return}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"colorBufferFloat",{get:function(){switch(this._backend){case e.BackendType.WebGL1:return this.extension(this.WEBGL_color_buffer_float,"WEBGL_color_buffer_float");case e.BackendType.WebGL2:return this.extension(this.EXT_color_buffer_float,"EXT_color_buffer_float");default:return}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsCompressedTextureASTC",{get:function(){return this.WEBGL_compressed_texture_astc_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"compressedTextureASTC",{get:function(){return this.extension(this.WEBGL_compressed_texture_astc,"WEBGL_compressed_texture_astc")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsCompressedTextureATC",{get:function(){return this.WEBGL_compressed_texture_atc_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"compressedTextureATC",{get:function(){return this.extension(this.WEBGL_compressed_texture_atc,"WEBGL_compressed_texture_atc")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsCompressedTextureETC",{get:function(){return this.WEBGL_compressed_texture_etc_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"compressedTextureETC",{get:function(){return this.extension(this.WEBGL_compressed_texture_etc,"WEBGL_compressed_texture_etc")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsCompressedTextureETC1",{get:function(){return this.WEBGL_compressed_texture_etc1_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"compressedTextureETC1",{get:function(){return this.extension(this.WEBGL_compressed_texture_etc1,"WEBGL_compressed_texture_etc1")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsCompressedTexturePVRTC",{get:function(){return this.WEBGL_compressed_texture_pvrtc_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"compressedTexturePVRTC",{get:function(){return this.extension(this.WEBGL_compressed_texture_pvrtc,"WEBGL_compressed_texture_pvrtc")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsCompressedTextureS3TC",{get:function(){return this.WEBGL_compressed_texture_s3tc_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"compressedTextureS3TC",{get:function(){return this.extension(this.WEBGL_compressed_texture_s3tc,"WEBGL_compressed_texture_s3tc")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsCompressedTextureS3TCSRGB",{get:function(){return this.WEBGL_compressed_texture_s3tc_srgb_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"compressedTextureS3TCSRGB",{get:function(){return this.extension(this.WEBGL_compressed_texture_s3tc_srgb,"WEBGL_compressed_texture_s3tc_srgb")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsDebugRendererInfo",{get:function(){return this.WEBGL_debug_renderer_info_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"debugRendererInfo",{get:function(){return this.extension(this.WEBGL_debug_renderer_info,"WEBGL_debug_renderer_info")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsDebugShaders",{get:function(){return this.WEBGL_debug_shaders_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"debugShaders",{get:function(){return this.extension(this.WEBGL_debug_shaders,"WEBGL_debug_shaders")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsDepthTexture",{get:function(){return this.WEBGL_depth_texture_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"depthTexture",{get:function(){return this.extension(this.WEBGL_depth_texture,"WEBGL_depth_texture")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsDrawBuffers",{get:function(){return this.WEBGL_draw_buffers_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"drawBuffers",{get:function(){return this.extension(this.WEBGL_draw_buffers,"WEBGL_draw_buffers")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsLoseContext",{get:function(){return this.WEBGL_lose_context_supported},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"loseContext",{get:function(){return this.extension(this.WEBGL_lose_context,"WEBGL_lose_context")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsBlitFramebuffer",{get:function(){return void 0!==this._context.blitFramebuffer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"supportsReadBuffer",{get:function(){return void 0!==this._context.readBuffer},enumerable:!0,configurable:!0}),e.prototype.hash=function(){return s.ExtensionsHash.encode(this._backend,this._extensions)},e.prototype.about=function(){if(this._backend===e.BackendType.Invalid)return new Array;var t=new Array;t.push(["BACKEND (GLOPERATE)",this.backend]),t.push(["CONTEXT_HASH (GLOPERATE)",this.hash()]),t.push(["RENDERER",this._context.getParameter(this._context.RENDERER)]),t.push(["VENDOR",this._context.getParameter(this._context.VENDOR)]),t.push(["VERSION",this._context.getParameter(this._context.VERSION)]),t.push(["SHADING_LANGUAGE_VERSION",this._context.getParameter(this._context.SHADING_LANGUAGE_VERSION)]),t.push(["UNMASKED_VENDOR_WEBGL",this.supportsDebugRendererInfo?this._context.getParameter(this.debugRendererInfo.UNMASKED_VENDOR_WEBGL):"na"]),t.push(["UNMASKED_RENDERER_WEBGL",this.supportsDebugRendererInfo?this._context.getParameter(this.debugRendererInfo.UNMASKED_RENDERER_WEBGL):"na"]),t.push(["ALPHA (ATTRIBUTE)",String(this.alpha)]),t.push(["ANTIALIAS (ATTRIBUTE)",String(this.antialias)]),t.push(["DEPTH (ATTRIBUTE)",String(this.depth)]),t.push(["FAIL_IF_MAJOR_PERFORMANCE_CAVEAT (ATTRIBUTE)",String(this.failIfMajorPerformanceCaveat)]),t.push(["PREMULTIPLIED_ALPHA (ATTRIBUTE)",String(this.premultipliedAlpha)]),t.push(["PRESERVE_DRAWING_BUFFER (ATTRIBUTE)",String(this.preserveDrawingBuffer)]),t.push(["STENCIL (ATTRIBUTE)",String(this.stencil)]),t.push(["DEVICE_PIXEL_RATIO (WINDOW)",window.devicePixelRatio]),t.push(["APP_CODE_NAME (NAVIGATOR)",window.navigator.appCodeName]),t.push(["APP_NAME (NAVIGATOR)",window.navigator.appName]),t.push(["APP_VERSION (NAVIGATOR)",window.navigator.appVersion]),t.push(["PLATFORM (NAVIGATOR)",window.navigator.platform]),t.push(["HARDWARE_CONCURRENCY (NAVIGATOR)",window.navigator.appCodeName]),t.push(["VENDOR (NAVIGATOR)",window.navigator.vendor]),t.push(["VENDOR_SUB (NAVIGATOR)",window.navigator.vendorSub]),t.push(["MAX_COMBINED_TEXTURE_IMAGE_UNITS",this._context.getParameter(this._context.MAX_COMBINED_TEXTURE_IMAGE_UNITS)]),t.push(["MAX_CUBE_MAP_TEXTURE_SIZE",this._context.getParameter(this._context.MAX_CUBE_MAP_TEXTURE_SIZE)]),t.push(["MAX_FRAGMENT_UNIFORM_VECTORS",this._context.getParameter(this._context.MAX_FRAGMENT_UNIFORM_VECTORS)]),t.push(["MAX_RENDERBUFFER_SIZE",this._context.getParameter(this._context.MAX_RENDERBUFFER_SIZE)]),t.push(["MAX_TEXTURE_IMAGE_UNITS",this._context.getParameter(this._context.MAX_TEXTURE_IMAGE_UNITS)]),t.push(["MAX_TEXTURE_SIZE",this._context.getParameter(this._context.MAX_TEXTURE_SIZE)]),t.push(["MAX_VARYING_VECTORS",this._context.getParameter(this._context.MAX_VARYING_VECTORS)]),t.push(["MAX_VERTEX_ATTRIBS",this._context.getParameter(this._context.MAX_VERTEX_ATTRIBS)]),t.push(["MAX_VERTEX_TEXTURE_IMAGE_UNITS",this._context.getParameter(this._context.MAX_VERTEX_TEXTURE_IMAGE_UNITS)]),t.push(["MAX_VERTEX_UNIFORM_VECTORS",this._context.getParameter(this._context.MAX_VERTEX_UNIFORM_VECTORS)]);var r=this._context.getParameter(this._context.MAX_VIEWPORT_DIMS);if(t.push(["MAX_VIEWPORT_DIMS (WIDTH)",r[0]]),t.push(["MAX_VIEWPORT_DIMS (HEIGHT)",r[1]]),this.isWebGL2&&(t.push(["MAX_3D_TEXTURE_SIZE",this._context.getParameter(this._context.MAX_3D_TEXTURE_SIZE)]),t.push(["MAX_ARRAY_TEXTURE_LAYERS",this._context.getParameter(this._context.MAX_ARRAY_TEXTURE_LAYERS)]),t.push(["MAX_CLIENT_WAIT_TIMEOUT_WEBGL",this._context.getParameter(this._context.MAX_CLIENT_WAIT_TIMEOUT_WEBGL)]),t.push(["MAX_COLOR_ATTACHMENTS",this._context.getParameter(this._context.MAX_COLOR_ATTACHMENTS)]),t.push(["MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",this._context.getParameter(this._context.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS)]),t.push(["MAX_COMBINED_UNIFORM_BLOCKS",this._context.getParameter(this._context.MAX_COMBINED_UNIFORM_BLOCKS)]),t.push(["MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",this._context.getParameter(this._context.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS)]),t.push(["MAX_DRAW_BUFFERS",this._context.getParameter(this._context.MAX_DRAW_BUFFERS)]),t.push(["MAX_ELEMENT_INDEX",this._context.getParameter(this._context.MAX_ELEMENT_INDEX)]),t.push(["MAX_ELEMENTS_INDICES",this._context.getParameter(this._context.MAX_ELEMENTS_INDICES)]),t.push(["MAX_ELEMENTS_VERTICES",this._context.getParameter(this._context.MAX_ELEMENTS_VERTICES)]),t.push(["MAX_FRAGMENT_INPUT_COMPONENTS",this._context.getParameter(this._context.MAX_FRAGMENT_INPUT_COMPONENTS)]),t.push(["MAX_FRAGMENT_UNIFORM_BLOCKS",this._context.getParameter(this._context.MAX_FRAGMENT_UNIFORM_BLOCKS)]),t.push(["MAX_FRAGMENT_UNIFORM_COMPONENTS",this._context.getParameter(this._context.MAX_FRAGMENT_UNIFORM_COMPONENTS)]),t.push(["MAX_PROGRAM_TEXEL_OFFSET",this._context.getParameter(this._context.MAX_PROGRAM_TEXEL_OFFSET)]),t.push(["MAX_SAMPLES",this._context.getParameter(this._context.MAX_SAMPLES)]),t.push(["MAX_SERVER_WAIT_TIMEOUT",this._context.getParameter(this._context.MAX_SERVER_WAIT_TIMEOUT)]),t.push(["MAX_TEXTURE_LOD_BIAS",this._context.getParameter(this._context.MAX_TEXTURE_LOD_BIAS)]),t.push(["MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",this._context.getParameter(this._context.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS)]),t.push(["MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",this._context.getParameter(this._context.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS)]),t.push(["MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",this._context.getParameter(this._context.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS)]),t.push(["MAX_UNIFORM_BLOCK_SIZE",this._context.getParameter(this._context.MAX_UNIFORM_BLOCK_SIZE)]),t.push(["MAX_UNIFORM_BUFFER_BINDINGS",this._context.getParameter(this._context.MAX_UNIFORM_BUFFER_BINDINGS)]),t.push(["MAX_VARYING_COMPONENTS",this._context.getParameter(this._context.MAX_VARYING_COMPONENTS)]),t.push(["MAX_VERTEX_OUTPUT_COMPONENTS",this._context.getParameter(this._context.MAX_VERTEX_OUTPUT_COMPONENTS)]),t.push(["MAX_VERTEX_UNIFORM_BLOCKS",this._context.getParameter(this._context.MAX_VERTEX_UNIFORM_BLOCKS)]),t.push(["MAX_VERTEX_UNIFORM_COMPONENTS",this._context.getParameter(this._context.MAX_VERTEX_UNIFORM_COMPONENTS)]),t.push(["MIN_PROGRAM_TEXEL_OFFSET",this._context.getParameter(this._context.MIN_PROGRAM_TEXEL_OFFSET)])),this.isWebGL1)for(var n=0,i=a.WEBGL1_EXTENSIONS;n<i.length;n++){var o=i[n];t.push([o,this.supports(o)?"ok":"na"])}else if(this.isWebGL2){for(var s=0,u=a.WEBGL2_DEFAULT_EXTENSIONS;s<u.length;s++){o=u[s];t.push([o+" (default)","ok"])}for(var c=0,f=a.WEBGL2_EXTENSIONS;c<f.length;c++){o=f[c];t.push([o,this.supports(o)?"ok":"na"])}}return t},e.prototype.aboutString=function(){for(var e=this.about(),t=0,r=0,n=e;r<n.length;r++){var i=n[r];t=Math.max(i[0].length,t)}for(var o=0,s="",u=this.isWebGL2?63+a.WEBGL2_DEFAULT_EXTENSIONS.length:-1,c=0,f=e;c<f.length;c++){i=f[c];switch(o){case 2:case 6:case 8:case 15:case 16:case 23:case 35:case 63:case u:s+="\n"}s+="  "+i[0]+" "+"-".repeat(t-i[0].length)+"-- "+i[1]+"\n",++o}return s+="\n"},e.prototype.logAbout=function(e){void 0===e&&(e=n.LogLevel.Info),n.log(e,"context.about\n\n"+this.aboutString())},e.prototype.logAboutIf=function(e,t){void 0===t&&(t=n.LogLevel.Info),n.logIf(e,t,"context.about\n\n"+this.aboutString())},e.DEFAULT_ATTRIBUTES={alpha:!0,antialias:!1,depth:!0,failIfMajorPerformanceCaveat:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,stencil:!1},e}();t.Context=c,function(e){!function(e){e.Invalid="invalid",e.WebGL1="webgl1",e.WebGL2="webgl2"}(e.BackendType||(e.BackendType={})),function(e){e.auto="auto",e.webgl="webgl",e.experimental="experimental-webgl",e.webgl1="webgl1",e.experimental1="experimental-webgl1",e.webgl2="webgl2",e.experimental2="experimental-webgl2"}(e.BackendRequestType||(e.BackendRequestType={}))}(c=t.Context||(t.Context={})),t.Context=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(33),o=function(){function e(){}return e.encode64=function(t){return n.assert(t>=0&&t<=63,"expected bitfield in range [ 0b000000, 0b111111 ], given "+t),e.BASE64_ALPHABET[t]},e.decode64=function(t){n.assert(1===t.length,"expected single base64 character, given '"+t+"'");var r=e.BASE64_ALPHABET.indexOf(t);return n.assert(r>-1,"unknown base64 character, given '"+t+"'"),r},e.encode=function(t,r){var i=e.LATEST_VERSION,o=e.EXTENSIONS_BY_VERSION.get(i),a=e.WEBGL_BACKENDS.indexOf(t);n.assert(a>-1,"expected valid backend "+e.WEBGL_BACKENDS+", given "+t+" ");var s=e.encode64(i<<3|a+1);if(0===r.length)return s;for(var u=0,c=0;c<o.length;++c)u|=r.indexOf(o[c])>-1?32>>c%6:0,c%6<5&&c<o.length-1||(s+=e.encode64(u),u=0);return s},e.decode=function(t){var r=e.decode64(t[0]),i=r>>3,o=(7&r)-1;n.assert(o<e.WEBGL_BACKENDS.length,"expected valid backend index, given "+o);var a=e.WEBGL_BACKENDS[o];n.assert(e.EXTENSIONS_BY_VERSION.has(i),"expected valid hash version, given "+i);var s=e.EXTENSIONS_BY_VERSION.get(i),u=Math.ceil(s.length/6)+1;n.assert(t.length===u,"expected hash of version "+i+" to have a length of "+u+", given "+t);for(var c=new Array,f=1;f<t.length;++f){var l=e.decode64(t[f]),h=6*(f-1);32&l&&c.push(s[h+0]),16&l&&c.push(s[h+1]),8&l&&c.push(s[h+2]),4&l&&c.push(s[h+3]),2&l&&c.push(s[h+4]),1&l&&c.push(s[h+5])}return[a,c]},e.complement=function(t,r){var i=e.WEBGL_BACKENDS.indexOf(t);return n.assert(i>-1,"expected valid backend "+e.WEBGL_BACKENDS+", given "+t+" "),e.WEBGL_EXTENSIONS_BY_BACKEND.get(i).filter(function(e){return r.indexOf(e)<0})},e.WEBGL_BACKENDS=["webgl1","webgl2"],e.WEBGL_EXTENSIONS_BY_BACKEND=new Map([[0,i.WEBGL1_EXTENSIONS],[1,i.WEBGL2_EXTENSIONS]]),e.EXTENSIONS_BY_VERSION=new Map([[0,["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_color_buffer_float","EXT_color_buffer_half_float","EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2","EXT_frag_depth","EXT_shader_texture_lod","EXT_sRGB","EXT_texture_filter_anisotropic","OES_element_index_uint","OES_standard_derivatives","OES_texture_float","OES_texture_float_linear","OES_texture_half_float","OES_texture_half_float_linear","OES_vertex_array_object","WEBGL_color_buffer_float","WEBGL_compressed_texture_astc","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_debug_renderer_info","WEBGL_debug_shaders","WEBGL_depth_texture","WEBGL_draw_buffers","WEBGL_lose_context"]]]),e.LATEST_VERSION=0,e.BASE64_ALPHABET="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ-+",e}();t.ExtensionsHash=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=r(3),o=r(0),a=r(13),s=function(){function e(t,r){this._rgba=[0,0,0,e.DEFAULT_ALPHA],this._altered=!1,void 0!==t&&(3===t.length&&void 0!==r?this.fromF32(t[0],t[1],t[2],r):4===t.length?(this.fromF32(t[0],t[1],t[2],t[3]),o.assert(void 0===r,"expected alpha to be undefined when given an 4-tuple in RGBA")):this.fromF32(t[0],t[1],t[2]))}return e.hue2rgb=function(e,t,r){return o.assert(r>=-1&&r<=2,"t is expected to be between -1 and 2"),r<0?r+=1:r>1&&(r-=1),6*r<1?e+6*(t-e)*r:2*r<1?t:3*r<2?e+6*(t-e)*(2/3-r):e},e.to2CharHexCode=function(e){return(e<15.5/255?"0":"")+Math.round(255*e).toString(16)},e.hsl2rgb=function(t){var r=a.clampf3(t,"HSL input");if(0===r[1])return[r[2],r[2],r[2]];var n=r[2]<.5?r[2]*(1+r[1]):r[2]+r[1]-r[1]*r[2],i=2*r[2]-n;return[e.hue2rgb(i,n,r[0]+1/3),e.hue2rgb(i,n,r[0]),e.hue2rgb(i,n,r[0]-1/3)]},e.rgb2hsl=function(e){var t=a.clampf3(e,"RGB input"),r=[0,0,0],n=Math.min(t[0],t[1],t[2]),i=Math.max(t[0],t[1],t[2]),o=i-n;if(r[2]=.5*(i+n),0===o)return r;r[1]=r[2]<.5?o/(i+n):o/(2-i-n);var s=((i-t[0])/6+o/2)/o,u=((i-t[1])/6+o/2)/o,c=((i-t[2])/6+o/2)/o;return t[0]===i?r[0]=c-u:t[1]===i?r[0]=s-c+1/3:r[0]=u-s+2/3,r},e.lab2xyz=function(e){var t=a.clampf3(e,"LAB input"),r=(100*t[0]+16)/116,n=100*t[1]/500+r,i=r-100*t[2]/200,o=r*r*r,s=n*n*n,u=i*i*i;return[.95047*(s>.008856?s:(n-16/116)/7.787),1*(o>.008856?o:(r-16/116)/7.787),1.08883*(u>.008856?u:(i-16/116)/7.787)]},e.xyz2lab=function(e){var t=[e[0]/.95047,1*e[1],e[2]/1.08883],r=t[0]>.008856?Math.pow(t[0],1/3):7.787*t[0]+16/116,n=t[1]>.008856?Math.pow(t[1],1/3):7.787*t[1]+16/116,i=t[2]>.008856?Math.pow(t[2],1/3):7.787*t[2]+16/116;return a.clampf3([.01*(116*n-16),500*(r-n)*.01,200*(n-i)*.01])},e.xyz2rgb=function(e){var t=2.04159*e[0]+-.56501*e[1]+-.34473*e[2],r=-.96924*e[0]+1.87597*e[1]+.04156*e[2],n=.01344*e[0]+-.11836*e[1]+1.01517*e[2];return a.clampf3([Math.pow(t,1/2.19921875),Math.pow(r,1/2.19921875),Math.pow(n,1/2.19921875)])},e.rgb2xyz=function(e){var t=a.clampf3(e,"RGB input"),r=Math.pow(t[0],2.19921875),n=Math.pow(t[1],2.19921875),i=Math.pow(t[2],2.19921875);return[.57667*r+.18556*n+.18823*i,.29734*r+.62736*n+.07529*i,.02703*r+.07069*n+.99134*i]},e.lab2rgb=function(t){return e.xyz2rgb(e.lab2xyz(t))},e.rgb2lab=function(t){return e.xyz2lab(e.rgb2xyz(t))},e.cmyk2rgb=function(e){var t=a.clampf4(e,"CMYK input"),r=1-t[3];return[(1-t[0])*r,(1-t[1])*r,(1-t[2])*r]},e.rgb2cmyk=function(e){var t=a.clampf3(e,"RGB input"),r=1-Math.max(t[0],t[1],t[2]),n=1-r,i=0===n?0:1/n;return[(n-t[0])*i,(n-t[1])*i,(n-t[2])*i,r]},e.hex2rgba=function(t){var r=[0,0,0,e.DEFAULT_ALPHA];if(!e.HEX_FORMAT_REGEX.test(t))return o.log(o.LogLevel.Warning,"hexadecimal RGBA color string must conform to either '0x0000', '#0000', '0000', '0x00000000', '#00000000', or '00000000', given '"+t+"'"),r;var n=t.startsWith("0x")?2:t.startsWith("#")?1:0,i=Math.floor((t.length-n)/3),a=i-1;return r[0]=parseInt(t[n+0*i]+t[n+0*i+a],16)/255,r[1]=parseInt(t[n+1*i]+t[n+1*i+a],16)/255,r[2]=parseInt(t[n+2*i]+t[n+2*i+a],16)/255,t.length-n!=4&&t.length-n!=8||(r[3]=parseInt(t[n+3*i]+t[n+3*i+a],16)/255),o.assert(!(isNaN(r[0])||isNaN(r[1])||isNaN(r[2])||isNaN(r[3])),"expected well formated hexadecimal RGBA string, given '"+t+"'"),r},e.rgb2hex=function(t){var r=a.clampf3(t,"RGB input");return"#"+e.to2CharHexCode(r[0])+e.to2CharHexCode(r[1])+e.to2CharHexCode(r[2])},e.rgba2hex=function(t){var r=a.clampf4(t,"RGBA input");return"#"+e.to2CharHexCode(r[0])+e.to2CharHexCode(r[1])+e.to2CharHexCode(r[2])+e.to2CharHexCode(r[3])},e.mix=function(t,r,o,a){if(void 0===a&&(a=e.Space.LAB),0===o)return new e(t.rgba);if(1===o)return new e(r.rgba);var s=n.vec4.create();switch(a){case e.Space.CMYK:n.vec4.lerp(s,t.cmyk,r.cmyka,o);var u=i.mix(t.a,r.a,o);return(new e).fromCMYK(s[0],s[1],s[2],s[3],u);case e.Space.LAB:return n.vec4.lerp(s,t.laba,r.laba,o),(new e).fromLAB(s[0],s[1],s[2],s[3]);case e.Space.HSL:return n.vec4.lerp(s,t.hsla,r.hsla,o),(new e).fromHSL(s[0],s[1],s[2],s[3]);case e.Space.RGB:return n.vec4.lerp(s,t.rgba,r.rgba,o),(new e).fromRGB(s[0],s[1],s[2],s[3])}},e.prototype.equals=function(e){return a.equals4(this._rgba,e._rgba)},e.prototype.fromF32=function(t,r,n,i){void 0===i&&(i=e.DEFAULT_ALPHA);var o=a.duplicate4(this._rgba);return this._rgba[0]=a.clampf(t,"red value"),this._rgba[1]=a.clampf(r,"green value"),this._rgba[2]=a.clampf(n,"blue value"),this._rgba[3]=a.clampf(i,"alpha value"),this._altered=!a.equals4(this._rgba,o),this},e.prototype.fromUI8=function(t,r,n,o){void 0===o&&(o=Math.floor(255*e.DEFAULT_ALPHA));var s=a.duplicate4(this._rgba);return this._rgba[0]=i.clamp(t,0,255)/255,this._rgba[1]=i.clamp(r,0,255)/255,this._rgba[2]=i.clamp(n,0,255)/255,this._rgba[3]=i.clamp(o,0,255)/255,this._altered=!a.equals4(this._rgba,s),this},e.prototype.fromRGB=function(t,r,n,i){void 0===i&&(i=e.DEFAULT_ALPHA);var o=a.duplicate4(this._rgba);return this._rgba=a.clampf4([t,r,n,i],"RGBA input"),this._altered=!a.equals4(this._rgba,o),this},e.prototype.fromHSL=function(t,r,n,i){void 0===i&&(i=e.DEFAULT_ALPHA);var o=a.duplicate4(this._rgba),s=e.hsl2rgb([t,r,n]),u=a.clampf(i,"ALPHA input");return this._rgba=[s[0],s[1],s[2],u],this._altered=!a.equals4(this._rgba,o),this},e.prototype.fromLAB=function(t,r,n,i){void 0===i&&(i=e.DEFAULT_ALPHA);var o=a.duplicate4(this._rgba),s=e.lab2rgb([t,r,n]),u=a.clampf(i,"ALPHA input");return this._rgba=[s[0],s[1],s[2],u],this._altered=!a.equals4(this._rgba,o),this},e.prototype.fromCMYK=function(t,r,n,i,o){void 0===o&&(o=e.DEFAULT_ALPHA);var s=a.duplicate4(this._rgba),u=e.cmyk2rgb([t,r,n,i]),c=a.clampf(o,"ALPHA input");return this._rgba=[u[0],u[1],u[2],c],this._altered=!a.equals4(this._rgba,s),this},e.prototype.fromHex=function(t){var r=a.duplicate4(this._rgba);return this._rgba=e.hex2rgba(t),this._altered=!a.equals4(this._rgba,r),this},e.prototype.gray=function(t){switch(void 0===t&&(t=e.GrayscaleAlgorithm.LinearLuminance),t){case e.GrayscaleAlgorithm.Average:return(this._rgba[0]+this._rgba[1]+this._rgba[2])/3;case e.GrayscaleAlgorithm.LeastSaturatedVariant:return.5*(Math.max(this._rgba[0],this._rgba[1],this._rgba[2])-Math.min(this._rgba[0],this._rgba[1],this._rgba[2]));case e.GrayscaleAlgorithm.MinimumDecomposition:return Math.min(this._rgba[0],this._rgba[1],this._rgba[2]);case e.GrayscaleAlgorithm.MaximumDecomposition:return Math.max(this._rgba[0],this._rgba[1],this._rgba[2]);case e.GrayscaleAlgorithm.LinearLuminance:return.2126*this._rgba[0]+.7152*this._rgba[1]+.0722*this._rgba[2]}},e.prototype.tuple=function(t,r){switch(void 0===r&&(r=!0),t){case e.Space.RGB:return r?this.rgba:this.rgb;case e.Space.LAB:return r?this.laba:this.lab;case e.Space.CMYK:return r?this.cmyka:this.cmyk;case e.Space.HSL:return r?this.hsla:this.hsl}},Object.defineProperty(e.prototype,"rgb",{get:function(){return[this._rgba[0],this._rgba[1],this._rgba[2]]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rgbUI8",{get:function(){var e=new Uint8Array(3);return e[0]=Math.round(255*this._rgba[0]),e[1]=Math.round(255*this._rgba[1]),e[2]=Math.round(255*this._rgba[2]),e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rgbF32",{get:function(){var e=new Float32Array(3);return e[0]=this._rgba[0],e[1]=this._rgba[1],e[2]=this._rgba[2],e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rgba",{get:function(){return this._rgba},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rgbaUI8",{get:function(){var e=new Uint8Array(4);return e[0]=Math.round(255*this._rgba[0]),e[1]=Math.round(255*this._rgba[1]),e[2]=Math.round(255*this._rgba[2]),e[3]=Math.round(255*this._rgba[3]),e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rgbaF32",{get:function(){return new Float32Array(this._rgba)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"r",{get:function(){return this._rgba[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"g",{get:function(){return this._rgba[1]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"b",{get:function(){return this._rgba[2]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"a",{get:function(){return this._rgba[3]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hexRGB",{get:function(){return e.rgb2hex(this.rgb)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hexRGBA",{get:function(){return e.rgba2hex(this._rgba)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hsl",{get:function(){return e.rgb2hsl(this.rgb)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hsla",{get:function(){var t=e.rgb2hsl(this.rgb);return[t[0],t[1],t[2],this._rgba[3]]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lab",{get:function(){return e.rgb2lab(this.rgb)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"laba",{get:function(){var t=e.rgb2lab(this.rgb);return[t[0],t[1],t[2],this._rgba[3]]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cmyk",{get:function(){return e.rgb2cmyk(this.rgb)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cmyka",{get:function(){var t=e.rgb2cmyk(this.rgb);return[t[0],t[1],t[2],t[3],this._rgba[3]]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"altered",{get:function(){return this._altered},set:function(e){this._altered=e},enumerable:!0,configurable:!0}),e.DEFAULT_ALPHA=1,e.HEX_FORMAT_REGEX=new RegExp(/^(#|0x)?(([0-9a-f]{3}){1,2}|([0-9a-f]{4}){1,2})$/i),e}();t.Color=s,function(e){!function(e){e.Average="average",e.LinearLuminance="linear-luminance",e.LeastSaturatedVariant="least-saturated-variant",e.MinimumDecomposition="minimum-decomposition",e.MaximumDecomposition="maximum-decomposition"}(e.GrayscaleAlgorithm||(e.GrayscaleAlgorithm={})),function(e){e.RGB="rgb",e.HSL="hsl",e.LAB="lab",e.CMYK="cmyk"}(e.Space||(e.Space={}))}(s=t.Color||(t.Color={})),t.Color=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5),i=r(0),o=r(19),a=function(){function e(e,t){var r=this;this._pointerLockRequestPending=!1,i.assert(void 0!==e,"expected valid canvas element on initialization, given "+e),this._element=e,this._timeframe=t,this._element.addEventListener("click",function(){return r.processPointerLockRequests()})}return e.prototype.processPointerLockRequests=function(){this._pointerLockRequestPending&&o.PointerLock.request(this._element)},e.prototype.preventDefaultOnEvent=function(e,t){i.bitInBitfield(this._preventDefaultMask,e)&&t.preventDefault()},e.prototype.preventDefault=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=0,n=e;r<n.length;r++){var o=n[r];i.bitInBitfield(this._preventDefaultMask,o)||(this._preventDefaultMask|=o)}},e.prototype.allowDefault=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=0,n=e;r<n.length;r++){var o=n[r];i.bitInBitfield(this._preventDefaultMask,o)&&(this._preventDefaultMask&=~o)}},e.prototype.observable=function(t){switch(t){case e.Type.Click:return this.click$;case e.Type.Enter:return this.enter$;case e.Type.Leave:return this.leave$;case e.Type.Down:return this.down$;case e.Type.Up:return this.up$;case e.Type.Move:return this.move$;case e.Type.Wheel:return this.wheel$;default:return}},Object.defineProperty(e.prototype,"pointerLock",{get:function(){return o.PointerLock.active(this._element)},set:function(e){this._pointerLockRequestPending=e,!1===e&&(this._pointerLockRequestPending=!1,o.PointerLock.exit())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"click$",{get:function(){var t=this;return void 0===this._clickSubject&&(this._clickSubject=new n.ReplaySubject(void 0,this._timeframe),this._clickListener=function(r){t.preventDefaultOnEvent(e.Type.Click,r),t._clickSubject.next(r)},this._element.addEventListener("click",this._clickListener)),this._clickSubject.asObservable()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enter$",{get:function(){var t=this;return void 0===this._enterSubject&&(this._enterSubject=new n.ReplaySubject(void 0,this._timeframe),this._enterListener=function(r){t.preventDefaultOnEvent(e.Type.Enter,r),t._enterSubject.next(r)},this._element.addEventListener("mouseenter",this._enterListener)),this._enterSubject.asObservable()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leave$",{get:function(){var t=this;return void 0===this._leaveSubject&&(this._leaveSubject=new n.ReplaySubject(void 0,this._timeframe),this._leaveListener=function(r){t.preventDefaultOnEvent(e.Type.Leave,r),t._leaveSubject.next(r)},this._element.addEventListener("mouseleave",this._leaveListener)),this._leaveSubject.asObservable()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"down$",{get:function(){var t=this;return void 0===this._downSubject&&(this._downSubject=new n.ReplaySubject(void 0,this._timeframe),this._downListener=function(r){t.preventDefaultOnEvent(e.Type.Down,r),t._downSubject.next(r)},this._element.addEventListener("mousedown",this._downListener)),this._downSubject.asObservable()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"up$",{get:function(){var t=this;return void 0===this._upSubject&&(this._upSubject=new n.ReplaySubject(void 0,this._timeframe),this._upListener=function(r){t.preventDefaultOnEvent(e.Type.Up,r),t._upSubject.next(r)},this._element.addEventListener("mouseup",this._upListener)),this._upSubject.asObservable()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"move$",{get:function(){var t=this;return void 0===this._moveSubject&&(this._moveSubject=new n.ReplaySubject(void 0,this._timeframe),this._moveListener=function(r){t.preventDefaultOnEvent(e.Type.Move,r),t._moveSubject.next(r)},this._element.addEventListener("mousemove",this._moveListener)),this._moveSubject.asObservable()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"wheel$",{get:function(){var t=this;return void 0===this._wheelSubject&&(this._wheelSubject=new n.ReplaySubject(void 0,this._timeframe),this._wheelListener=function(r){t.preventDefaultOnEvent(e.Type.Wheel,r),t._wheelSubject.next(r)},this._element.addEventListener("wheel",this._wheelListener)),this._wheelSubject.asObservable()},enumerable:!0,configurable:!0}),e}();t.MouseEventProvider=a,function(e){!function(e){e[e.Click=1]="Click",e[e.Wheel=2]="Wheel",e[e.Enter=4]="Enter",e[e.Leave=8]="Leave",e[e.Move=16]="Move",e[e.Down=32]="Down",e[e.Up=64]="Up"}(e.Type||(e.Type={}))}(a=t.MouseEventProvider||(t.MouseEventProvider={})),t.MouseEventProvider=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=function(){function e(){}return e.queryAndCacheAPI=function(){if(void 0===e._exit){for(var t=window.document,r=[t.exitPointerLock,t.mozExitPointerLock,t.webkitExitPointerLock,void 0],i=0;i<r.length&&void 0===r[i];++i);switch(i){case 0:e._exit=function(){return t.exitPointerLock()},e._request=function(e){return e.requestPointerLock()},e._element=function(){return t.pointerLockElement};break;case 1:e._exit=function(){return t.mozCancelPointerLock()},e._request=function(e){return e.mozRequestPointerLock()},e._element=function(){return t.mozPointerLockElement};break;case 2:e._exit=function(){return t.webkitExitPointerLock()},e._request=function(e){return e.webkitRequestPointerLock()},e._element=function(){return t.webkitPointerLockElement};break;default:n.assert(!1,"none of the following pointer lock apis was found: native, moz, or webkit")}}},e.active=function(t){return void 0!==this._element&&(void 0!==t&&e._element()===t||void 0===t&&void 0!==e._element()&&null!==e._element())},e.request=function(t,r){void 0!==t&&(e.queryAndCacheAPI(),e.active()&&e._element()!==t&&e._exit(),e.active()||e._request(t))},e.exit=function(){e._exit&&e._exit()},e}();t.PointerLock=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5),i=r(0),o=function(){function e(e,t){i.assert(void 0!==e,"expected valid canvas element on initialization, given "+e),this._element=e,this._timeframe=t}return e.prototype.preventDefaultOnEvent=function(e,t){i.bitInBitfield(this._preventDefaultMask,e)&&t.preventDefault()},e.prototype.preventDefault=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=0,n=e;r<n.length;r++){var o=n[r];i.bitInBitfield(this._preventDefaultMask,o)||(this._preventDefaultMask|=o)}},e.prototype.allowDefault=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=0,n=e;r<n.length;r++){var o=n[r];i.bitInBitfield(this._preventDefaultMask,o)&&(this._preventDefaultMask&=~o)}},e.prototype.observable=function(t){switch(t){case e.Type.Start:return this.start$;case e.Type.End:return this.end$;case e.Type.Move:return this.move$;case e.Type.Cancel:return this.cancel$}return i.assert(!1,"Encountered unknown touch event."),new n.Observable},Object.defineProperty(e.prototype,"start$",{get:function(){var t=this;return void 0===this._startSubject&&(this._startSubject=new n.ReplaySubject(void 0,this._timeframe),this._startListener=function(r){t.preventDefaultOnEvent(e.Type.Start,r),t._startSubject.next(r)},this._element.addEventListener("touchstart",this._startListener)),this._startSubject.asObservable()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"end$",{get:function(){var t=this;return void 0===this._endSubject&&(this._endSubject=new n.ReplaySubject(void 0,this._timeframe),this._endListener=function(r){t.preventDefaultOnEvent(e.Type.End,r),t._endSubject.next(r)},this._element.addEventListener("touchend",this._endListener)),this._endSubject.asObservable()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"move$",{get:function(){var t=this;return void 0===this._moveSubject&&(this._moveSubject=new n.ReplaySubject(void 0,this._timeframe),this._moveListener=function(r){t.preventDefaultOnEvent(e.Type.Move,r),t._moveSubject.next(r)},this._element.addEventListener("touchmove",this._moveListener)),this._moveSubject.asObservable()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cancel$",{get:function(){var t=this;return void 0===this._cancelSubject&&(this._cancelSubject=new n.ReplaySubject(void 0,this._timeframe),this._cancelListener=function(r){t.preventDefaultOnEvent(e.Type.Cancel,r),t._cancelSubject.next(r)},this._element.addEventListener("touchcancel",this._cancelListener)),this._cancelSubject.asObservable()},enumerable:!0,configurable:!0}),e}();t.TouchEventProvider=o,function(e){!function(e){e[e.Start=1]="Start",e[e.End=2]="End",e[e.Move=4]="Move",e[e.Cancel=8]="Cancel"}(e.Type||(e.Type={}))}(o=t.TouchEventProvider||(t.TouchEventProvider={})),t.TouchEventProvider=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=function(){function e(){}return e.alter=function(t,r){n.assert(r.hasOwnProperty("any"),"expected alterable object to provide 'any' key"),r.any=!0;var i=t.split("."),o=i.shift();if(n.assert(""===o||r.hasOwnProperty(o),"expected object to have key '"+o+"' in order to capture alterations"),""===o||"object"==typeof r[o])if(""!==o&&i.length>0)e.alter(i.join("."),r[o]);else for(var a=""!==o?r[o]:r,s=0,u=Object.getOwnPropertyNames(a);s<u.length;s++){var c=u[s];"any"!==c&&e.alter(c,a)}else r[o]=!0},e.reset=function(t){for(var r=0,n=Object.getOwnPropertyNames(t);r<n.length;r++){var i=n[r];"object"!=typeof t[i]?t[i]=!1:e.reset(t[i])}},e.prototype.alter=function(t){return e.alter(t,this)},e.prototype.reset=function(){return e.reset(this)},e}();t.ChangeLookup=i},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),a=r(1),s=function(e){function t(){var r=null!==e&&e.apply(this,arguments)||this;return r._target=t.DEFAULT_BUFFER,r}return n(t,e),t.prototype.create=function(e){var t=this._context.gl;return this._object=t.createBuffer(),this._valid=this._object instanceof WebGLBuffer,this._valid&&(o.assert(e===t.ARRAY_BUFFER||e===t.ELEMENT_ARRAY_BUFFER,"either ARRAY_BUFFER or ELEMENT_ARRAY_BUFFER expected as buffer target"),this._target=e),this._object},t.prototype.delete=function(){o.assert(this._object instanceof WebGLBuffer,"expected WebGLBuffer object"),this._context.gl.deleteBuffer(this._object),this._object=void 0,this._valid=!1,this._target=t.DEFAULT_BUFFER},t.prototype.bind=function(){o.assert(this._target===this._context.gl.ARRAY_BUFFER||this._target===this._context.gl.ELEMENT_ARRAY_BUFFER,"expected either ARRAY_BUFFER or ELEMENT_ARRAY_BUFFER as buffer target"),this._context.gl.bindBuffer(this._target,this._object)},t.prototype.unbind=function(){this.context.gl.bindBuffer(this._target,t.DEFAULT_BUFFER)},t.prototype.data=function(e,t,r,n){void 0===r&&(r=!0),void 0===n&&(n=!0);var i=this.context.gl;r&&this.bind(),i.bufferData(this._target,e,t),n&&this.unbind(),this._valid=i.isBuffer(this._object)&&i.getError()===i.NO_ERROR;var o=this._valid?e.byteLength:0;this.context.allocationRegister.reallocate(this._identifier,o)},t.prototype.attribEnable=function(e,t,r,n,i,o,a,s){void 0===n&&(n=!1),void 0===i&&(i=0),void 0===o&&(o=0),void 0===a&&(a=!0),void 0===s&&(s=!0);var u=this.context.gl;a&&this.bind(),u.vertexAttribPointer(e,t,r,n,i,o),u.enableVertexAttribArray(e),s&&this.unbind()},t.prototype.attribDisable=function(e,t,r){void 0===t&&(t=!0),void 0===r&&(r=!0);var n=this.context.gl;t&&this.bind(),n.disableVertexAttribArray(e),r&&this.unbind()},Object.defineProperty(t.prototype,"bytes",{get:function(){return this.assertInitialized(),this.context.allocationRegister.allocated(this._identifier)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"target",{get:function(){return this.assertInitialized(),this._target},enumerable:!0,configurable:!0}),t.DEFAULT_BUFFER=void 0,i([a.Initializable.assert_initialized()],t.prototype,"bind",null),i([a.Initializable.assert_initialized()],t.prototype,"unbind",null),i([a.Initializable.assert_initialized()],t.prototype,"data",null),i([a.Initializable.assert_initialized()],t.prototype,"attribEnable",null),i([a.Initializable.assert_initialized()],t.prototype,"attribDisable",null),t}(r(4).AbstractObject);t.Buffer=s},function(e,t,r){"use strict";var n=r(62),i=r(65);function o(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}t.parse=g,t.resolve=function(e,t){return g(e,!1,!0).resolve(t)},t.resolveObject=function(e,t){return e?g(e,!1,!0).resolveObject(t):t},t.format=function(e){i.isString(e)&&(e=g(e));return e instanceof o?e.format():o.prototype.format.call(e)},t.Url=o;var a=/^([a-z0-9.+-]+:)/i,s=/:[0-9]*$/,u=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,c=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),f=["'"].concat(c),l=["%","/","?",";","#"].concat(f),h=["/","?","#"],p=/^[+a-z0-9A-Z_-]{0,63}$/,_=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,d={javascript:!0,"javascript:":!0},b={javascript:!0,"javascript:":!0},m={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},v=r(66);function g(e,t,r){if(e&&i.isObject(e)&&e instanceof o)return e;var n=new o;return n.parse(e,t,r),n}o.prototype.parse=function(e,t,r){if(!i.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var o=e.indexOf("?"),s=-1!==o&&o<e.indexOf("#")?"?":"#",c=e.split(s);c[0]=c[0].replace(/\\/g,"/");var g=e=c.join(s);if(g=g.trim(),!r&&1===e.split("#").length){var y=u.exec(g);if(y)return this.path=g,this.href=g,this.pathname=y[1],y[2]?(this.search=y[2],this.query=t?v.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var E=a.exec(g);if(E){var x=(E=E[0]).toLowerCase();this.protocol=x,g=g.substr(E.length)}if(r||E||g.match(/^\/\/[^@\/]+@[^@\/]+/)){var T="//"===g.substr(0,2);!T||E&&b[E]||(g=g.substr(2),this.slashes=!0)}if(!b[E]&&(T||E&&!m[E])){for(var M,O,A=-1,P=0;P<h.length;P++){-1!==(R=g.indexOf(h[P]))&&(-1===A||R<A)&&(A=R)}-1!==(O=-1===A?g.lastIndexOf("@"):g.lastIndexOf("@",A))&&(M=g.slice(0,O),g=g.slice(O+1),this.auth=decodeURIComponent(M)),A=-1;for(P=0;P<l.length;P++){var R;-1!==(R=g.indexOf(l[P]))&&(-1===A||R<A)&&(A=R)}-1===A&&(A=g.length),this.host=g.slice(0,A),g=g.slice(A),this.parseHost(),this.hostname=this.hostname||"";var w="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!w)for(var S=this.hostname.split(/\./),j=(P=0,S.length);P<j;P++){var L=S[P];if(L&&!L.match(p)){for(var F="",I=0,B=L.length;I<B;I++)L.charCodeAt(I)>127?F+="x":F+=L[I];if(!F.match(p)){var N=S.slice(0,P),z=S.slice(P+1),C=L.match(_);C&&(N.push(C[1]),z.unshift(C[2])),z.length&&(g="/"+z.join(".")+g),this.hostname=N.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),w||(this.hostname=n.toASCII(this.hostname));var G=this.port?":"+this.port:"",U=this.hostname||"";this.host=U+G,this.href+=this.host,w&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==g[0]&&(g="/"+g))}if(!d[x])for(P=0,j=f.length;P<j;P++){var D=f[P];if(-1!==g.indexOf(D)){var k=encodeURIComponent(D);k===D&&(k=escape(D)),g=g.split(D).join(k)}}var X=g.indexOf("#");-1!==X&&(this.hash=g.substr(X),g=g.slice(0,X));var W=g.indexOf("?");if(-1!==W?(this.search=g.substr(W),this.query=g.substr(W+1),t&&(this.query=v.parse(this.query)),g=g.slice(0,W)):t&&(this.search="",this.query={}),g&&(this.pathname=g),m[x]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){G=this.pathname||"";var q=this.search||"";this.path=G+q}return this.href=this.format(),this},o.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",r=this.pathname||"",n=this.hash||"",o=!1,a="";this.host?o=e+this.host:this.hostname&&(o=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&i.isObject(this.query)&&Object.keys(this.query).length&&(a=v.stringify(this.query));var s=this.search||a&&"?"+a||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||m[t])&&!1!==o?(o="//"+(o||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):o||(o=""),n&&"#"!==n.charAt(0)&&(n="#"+n),s&&"?"!==s.charAt(0)&&(s="?"+s),t+o+(r=r.replace(/[?#]/g,function(e){return encodeURIComponent(e)}))+(s=s.replace("#","%23"))+n},o.prototype.resolve=function(e){return this.resolveObject(g(e,!1,!0)).format()},o.prototype.resolveObject=function(e){if(i.isString(e)){var t=new o;t.parse(e,!1,!0),e=t}for(var r=new o,n=Object.keys(this),a=0;a<n.length;a++){var s=n[a];r[s]=this[s]}if(r.hash=e.hash,""===e.href)return r.href=r.format(),r;if(e.slashes&&!e.protocol){for(var u=Object.keys(e),c=0;c<u.length;c++){var f=u[c];"protocol"!==f&&(r[f]=e[f])}return m[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}if(e.protocol&&e.protocol!==r.protocol){if(!m[e.protocol]){for(var l=Object.keys(e),h=0;h<l.length;h++){var p=l[h];r[p]=e[p]}return r.href=r.format(),r}if(r.protocol=e.protocol,e.host||b[e.protocol])r.pathname=e.pathname;else{for(var _=(e.pathname||"").split("/");_.length&&!(e.host=_.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==_[0]&&_.unshift(""),_.length<2&&_.unshift(""),r.pathname=_.join("/")}if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var d=r.pathname||"",v=r.search||"";r.path=d+v}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var g=r.pathname&&"/"===r.pathname.charAt(0),y=e.host||e.pathname&&"/"===e.pathname.charAt(0),E=y||g||r.host&&e.pathname,x=E,T=r.pathname&&r.pathname.split("/")||[],M=(_=e.pathname&&e.pathname.split("/")||[],r.protocol&&!m[r.protocol]);if(M&&(r.hostname="",r.port=null,r.host&&(""===T[0]?T[0]=r.host:T.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===_[0]?_[0]=e.host:_.unshift(e.host)),e.host=null),E=E&&(""===_[0]||""===T[0])),y)r.host=e.host||""===e.host?e.host:r.host,r.hostname=e.hostname||""===e.hostname?e.hostname:r.hostname,r.search=e.search,r.query=e.query,T=_;else if(_.length)T||(T=[]),T.pop(),T=T.concat(_),r.search=e.search,r.query=e.query;else if(!i.isNullOrUndefined(e.search)){if(M)r.hostname=r.host=T.shift(),(w=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=w.shift(),r.host=r.hostname=w.shift());return r.search=e.search,r.query=e.query,i.isNull(r.pathname)&&i.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!T.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var O=T.slice(-1)[0],A=(r.host||e.host||T.length>1)&&("."===O||".."===O)||""===O,P=0,R=T.length;R>=0;R--)"."===(O=T[R])?T.splice(R,1):".."===O?(T.splice(R,1),P++):P&&(T.splice(R,1),P--);if(!E&&!x)for(;P--;P)T.unshift("..");!E||""===T[0]||T[0]&&"/"===T[0].charAt(0)||T.unshift(""),A&&"/"!==T.join("/").substr(-1)&&T.push("");var w,S=""===T[0]||T[0]&&"/"===T[0].charAt(0);M&&(r.hostname=r.host=S?"":T.length?T.shift():"",(w=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=w.shift(),r.host=r.hostname=w.shift()));return(E=E||r.host&&T.length)&&!S&&T.unshift(""),T.length?r.pathname=T.join("/"):(r.pathname=null,r.path=null),i.isNull(r.pathname)&&i.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},o.prototype.parseHost=function(){var e=this.host,t=s.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},function(e,t,r){var n=r(23),i=r(6);function o(e,t){this.id=e,this.ref=t}e.exports.SchemaScanResult=o,e.exports.scan=function(e,t){function r(e,t){if(t&&"object"==typeof t)if(t.$ref){var o=n.resolve(e,t.$ref);c[o]=c[o]?c[o]+1:0}else{var f=t.id?n.resolve(e,t.id):e;if(f){if(f.indexOf("#")<0&&(f+="#"),u[f]){if(!i.deepCompareStrict(u[f],t))throw new Error("Schema <"+t+"> already exists with different definition");return u[f]}u[f]=t,"#"==f[f.length-1]&&(u[f.substring(0,f.length-1)]=t)}a(f+"/items",t.items instanceof Array?t.items:[t.items]),a(f+"/extends",t.extends instanceof Array?t.extends:[t.extends]),r(f+"/additionalItems",t.additionalItems),s(f+"/properties",t.properties),r(f+"/additionalProperties",t.additionalProperties),s(f+"/definitions",t.definitions),s(f+"/patternProperties",t.patternProperties),s(f+"/dependencies",t.dependencies),a(f+"/disallow",t.disallow),a(f+"/allOf",t.allOf),a(f+"/anyOf",t.anyOf),a(f+"/oneOf",t.oneOf),r(f+"/not",t.not)}}function a(e,t){if(t instanceof Array)for(var n=0;n<t.length;n++)r(e+"/"+n,t[n])}function s(e,t){if(t&&"object"==typeof t)for(var n in t)r(e+"/"+n,t[n])}var u={},c={};return r(e,t),new o(u,c)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);t.byteSizeOfFormat=function(e,t){var r=e.gl,i=e.gl2facade,o=e.supportsDepthTexture?e.depthTexture.UNSIGNED_INT_24_8_WEBGL:void 0;switch(t){case void 0:default:break;case r.UNSIGNED_BYTE:case r.UNSIGNED_SHORT_5_6_5:case r.UNSIGNED_SHORT_4_4_4_4:case r.UNSIGNED_SHORT_5_5_5_1:case r.UNSIGNED_SHORT:case r.UNSIGNED_INT:case o:case r.FLOAT:case i.HALF_FLOAT:case r.BYTE:case r.UNSIGNED_SHORT:case r.SHORT:case r.UNSIGNED_INT:case r.INT:case r.HALF_FLOAT:case r.FLOAT:case r.UNSIGNED_INT_2_10_10_10_REV:case r.UNSIGNED_INT_10F_11F_11F_REV:case r.UNSIGNED_INT_5_9_9_9_REV:case r.UNSIGNED_INT_24_8:case r.FLOAT_32_UNSIGNED_INT_24_8_REV:return n.assert(!1,"expected format instead of type "+t),0}var a=e.supportsSRGB?e.sRGB.SRGB8_ALPHA8_EXT:void 0,s=e.supportsSRGB?e.sRGB.SRGB_EXT:void 0,u=e.supportsSRGB?e.sRGB.SRGB_ALPHA_EXT:void 0,c=e.supportsColorBufferFloat?e.colorBufferFloat.RGB32F_EXT:void 0,f=e.supportsColorBufferFloat?e.colorBufferFloat.RGBA32F_EXT:void 0;switch(t){case void 0:default:return n.assert(!1,"size of format "+t+" is unknown"),0;case r.ALPHA:case r.LUMINANCE:case r.R8:case r.R8I:case r.R8UI:case r.STENCIL_INDEX8:return 1;case r.DEPTH_COMPONENT16:case r.LUMINANCE_ALPHA:case r.R16F:case r.R16I:case r.R16UI:case r.RG8:case r.RG8I:case r.RG8UI:case r.RGB565:case r.RGB5_A1:case r.RGBA4:return 2;case r.DEPTH_COMPONENT24:case r.RGB:case r.RGB8:case r.RGB8UI:case r.SRGB:case s:case r.SRGB8:return 3;case r.DEPTH_STENCIL:case r.DEPTH24_STENCIL8:case r.DEPTH_COMPONENT32F:case r.R11F_G11F_B10F:case r.R32F:case r.R32I:case r.R32UI:case r.RG16F:case r.RG16I:case r.RG16UI:case r.RGB10_A2:case r.RGB10_A2UI:case r.RGB9_E5:case r.RGBA:case r.RGBA8:case r.RGBA8I:case r.RGBA8UI:case r.SRGB8_ALPHA8:case a:case r.SRGB_ALPHA:case u:case r.SRGB_ALPHA8:case r.SRGB_APLHA8:return 4;case r.DEPTH32F_STENCIL8:return 5;case r.RGB16F:return 6;case r.RG32F:case r.RG32I:case r.RG32UI:case r.RGBA16F:case r.RGBA16I:case r.RGBA16UI:return 8;case r.RGB32F:case r.RGB32F:case c:return 12;case r.RGBA32F:case f:case r.RGBA32I:case r.RGBA32UI:return 16;case r.DEPTH_COMPONENT:case r.DEPTH_STENCIL:return n.assert(!1,"byte size of DEPTH_COMPONENT or DEPTH_STENCIL formats depends on active render buffer"),0}}},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),a=r(36),s=function(e){function t(t,r){var n=e.call(this)||this;return n._buffers=new Array,r=void 0!==r&&""!==r?r:n.constructor.name,n._vertexArray=new a.VertexArray(t,r+"VAO"),n}return n(t,e),t.prototype.initialize=function(){for(var e=this,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(var n=t[0],i=t[1],o=!0,a=0;a<this._buffers.length;++a)o=this._buffers[a].initialize(n[a])&&o;return this._vertexArray.initialize(function(){return e.bindBuffers(i)},function(){return e.unbindBuffers(i)}),this._vertexArray.valid&&o},t.prototype.uninitialize=function(){this._vertexArray.uninitialize(),this._buffers.forEach(function(e){return e.uninitialize()});for(var e=0,t=this._buffers;e<t.length;e++){t[e].uninitialize()}},t.prototype.bind=function(){this._vertexArray.bind()},t.prototype.unbind=function(){this._vertexArray.unbind()},Object.defineProperty(t.prototype,"buffers",{get:function(){return this._buffers},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"context",{get:function(){return this._vertexArray.context},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"vertexArray",{get:function(){return this._vertexArray},enumerable:!0,configurable:!0}),i([o.Initializable.initialize()],t.prototype,"initialize",null),i([o.Initializable.uninitialize()],t.prototype,"uninitialize",null),i([o.Initializable.assert_initialized()],t.prototype,"bind",null),i([o.Initializable.assert_initialized()],t.prototype,"unbind",null),t}(o.Initializable);t.Geometry=s},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),o=function(){function e(e,t,r,n){void 0===r&&(r=1),void 0===n&&(n=1),this._components=e,this._width=isNaN(t)?1:Math.max(1,t),this._height=Math.max(1,r),this._depth=Math.max(1,n),this.resize()}return e.prototype.get=function(e,t,r){var n;switch(n=void 0===t&&void 0===r?this._components*e:this.index(e,t,r||0),i.assert(n<this.length,"index expected to be in range [0, "+(this.length-1)+"], given "+n),this._components){case 1:return[this._samples[n]];case 2:return[this._samples[n],this._samples[n+1]];case 3:return[this._samples[n],this._samples[n+1],this._samples[n+2]];case 4:return[this._samples[n],this._samples[n+1],this._samples[n+2],this._samples[n+3]]}},e.prototype.set=function(e,t,r,n){var o;switch(i.assert(e.length===this._components,"number of components expected to be "+this._components+", given "+e.length),o=void 0===r&&void 0===n?this._components*Math.min(this.elements,Math.max(0,t)):this._components*this.index(t,r,n||0),i.assert(o<this.length,"index expected to be in range [0, "+(this.length-1)+"], given "+o),this._components){case 4:this._samples[o+3]=e[3];case 3:this._samples[o+2]=e[2];case 2:this._samples[o+1]=e[1];case 1:this._samples[o+0]=e[0]}},e.prototype.fromJSON=function(e){i.assert(e.size&&void 0!==e.size.width&&void 0!==e.size.height&&void 0!==e.size.depth,"expected kernel width, height, and depth to be set, given '"+e.size+"'");var t=function(e){return e.reduce(function(e,r){return e.concat(Array.isArray(r)?t(r):r)},[])};this._width=Math.max(1,e.size.width),this._height=Math.max(1,e.size.height),this._depth=Math.max(1,e.size.depth);var r=t(e.kernel);this._components=Math.floor(r.length/this.elements),this.resize(),this.fromArray(r)},e.prototype.index=function(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=0),this._width*(this._height*Math.min(this._depth,Math.max(0,r))+Math.min(this._height,Math.max(0,t)))+Math.min(this._width,Math.max(0,e))},e.prototype.position=function(e){var t=Math.min(this.elements,Math.max(0,e)),r=Math.floor(t/(this._width*this._height));t-=r*this._width*this._height;var n=Math.floor(t/this._width);return[t-=n*this._width,n,r]},e.prototype.sort=function(t){if(!(this.elements<2)){for(var r=Array(this.elements),n=0;n<this.elements;++n){var i=0;switch(t){default:case e.SortApproach.BySquaredLength:for(var o=0;o<this._components;++o){var a=this._samples[n*this._components+o];i+=a*a}}r[n]=[n,i]}switch(t){default:case e.SortApproach.BySquaredLength:r.sort(function(e,t){return e[1]-t[1]})}var s=this._samples.slice();for(n=0;n<r.length;++n)for(o=0;o<this._components;++o){var u=r[n][0]*this._components+o,c=n*this._components+o;this._samples[c]=s[u]}}},Object.defineProperty(e.prototype,"samples",{get:function(){return this._samples},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._width*this._height*this._depth*this._components},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"elements",{get:function(){var e=this._width*this._height*this._depth;return isNaN(e)?0:e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"components",{get:function(){return this._components},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"depth",{get:function(){return this._depth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"xStride",{get:function(){return this.bytesPerComponent*this._components},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"yStride",{get:function(){return this.bytesPerComponent*this._components*this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"zStride",{get:function(){return this.bytesPerComponent*this._components*this._width*this._depth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bytesLength",{get:function(){return this.bytesPerComponent*this._components*this._width*this._height*this._depth},enumerable:!0,configurable:!0}),e}();t.AbstractKernel=o,function(e){!function(e){e[e.BySquaredLength=0]="BySquaredLength"}(e.SortApproach||(e.SortApproach={}))}(o=t.AbstractKernel||(t.AbstractKernel={})),t.AbstractKernel=o;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.resize=function(){this._samples=new Float32Array(this.length)},t.prototype.fromArray=function(e){i.assert(e.length===this.length,"expected samples length to match this kernel's length"),this._samples.set(new Float32Array(e))},Object.defineProperty(t.prototype,"bytesPerComponent",{get:function(){return 4},enumerable:!0,configurable:!0}),t}(o);t.KernelF32=a;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.resize=function(){this._samples=new Uint32Array(this.length)},t.prototype.fromArray=function(e){i.assert(e.length===this.length,"expected samples length to match this kernel's length"),this._samples.set(new Uint32Array(e))},Object.defineProperty(t.prototype,"bytesPerComponent",{get:function(){return 4},enumerable:!0,configurable:!0}),t}(o);t.KernelUI32=s;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.resize=function(){this._samples=new Int32Array(this.length)},t.prototype.fromArray=function(e){i.assert(e.length===this.length,"expected samples length to match this kernel's length"),this._samples.set(new Int32Array(e))},Object.defineProperty(t.prototype,"bytesPerComponent",{get:function(){return 4},enumerable:!0,configurable:!0}),t}(o);t.KernelI32=u;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.resize=function(){this._samples=new Uint8Array(this.length)},t.prototype.fromArray=function(e){i.assert(e.length===this.length,"expected samples length to match this kernel's length"),this._samples.set(new Uint8Array(e))},Object.defineProperty(t.prototype,"bytesPerComponent",{get:function(){return 4},enumerable:!0,configurable:!0}),t}(o);t.KernelUI8=c;var f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.resize=function(){this._samples=new Int8Array(this.length)},t.prototype.fromArray=function(e){i.assert(e.length===this.length,"expected samples length to match this kernel's length"),this._samples.set(new Int8Array(e))},Object.defineProperty(t.prototype,"bytesPerComponent",{get:function(){return 4},enumerable:!0,configurable:!0}),t}(o);t.KernelI8=f},function(e,t){e.exports="\r\nprecision lowp float;\r\n\r\n\r\n#if __VERSION__ == 100\r\n#else \r\n    #define varying out\r\n#endif\r\n\r\n\r\n\r\n#if __VERSION__ == 100\r\n    attribute vec2 a_vertex;\r\n#else \r\n    in vec2 a_vertex;\r\n#endif\r\n\r\n\r\nvarying vec2 v_uv;\r\n\r\n\r\nvoid main(void)\r\n{\r\n    v_uv = a_vertex * 0.5 + 0.5;\r\n    gl_Position = vec4(a_vertex, 0.0, 1.0);\r\n}\r\n"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=r(0),o=r(18),a=r(20),s=function(){function e(e,t,r){this._subscriptions=new Array,this._latestMouseEventsByType=new Map,this._previousMouseEventsByType=new Map,this._mouseEventHandlerByType=new Map,this._latestTouchEventsByType=new Map,this._previousTouchEventsByType=new Map,this._touchEventHandlerByType=new Map,this._invalidate=e,this._mouseEventProvider=t,this._touchEventProvider=r}return e.prototype.invalidate=function(e){void 0===e&&(e=!1),this._invalidate&&this._invalidate(e)},e.prototype.pushMouseEventHandler=function(e,t){var r=this;if(this._mouseEventHandlerByType.has(e))this._mouseEventHandlerByType.get(e).push(t);else{this._mouseEventHandlerByType.set(e,new Array),this._previousMouseEventsByType.set(e,new Array);var n=new Array;this._latestMouseEventsByType.set(e,n),i.assert(void 0!==this._mouseEventProvider,"expected valid mouse event provider");var a=this._mouseEventProvider.observable(e);switch(e){case o.MouseEventProvider.Type.Wheel:default:this._subscriptions.push(a.subscribe(function(e){n.push(e),r.invalidate()}))}this._mouseEventHandlerByType.get(e).push(t)}},e.prototype.invokeMouseEventHandler=function(e){var t=this._mouseEventHandlerByType.get(e);if(void 0!==t&&0!==t.length){var r=this._latestMouseEventsByType.get(e);if(0!==r.length){var n=this._previousMouseEventsByType.get(e);t.forEach(function(e){return e(r,n)}),Object.assign(n,r),r.length=0}}},e.prototype.pushTouchEventHandler=function(e,t){var r=this;if(this._touchEventHandlerByType.has(e))this._touchEventHandlerByType.get(e).push(t);else{this._touchEventHandlerByType.set(e,new Array),this._previousTouchEventsByType.set(e,new Array);var n=new Array;this._latestTouchEventsByType.set(e,n),i.assert(void 0!==this._touchEventProvider,"expected valid touch event provider");var o=this._touchEventProvider.observable(e);this._subscriptions.push(o.subscribe(function(e){n.push(e),r.invalidate()})),this._touchEventHandlerByType.get(e).push(t)}},e.prototype.invokeTouchEventHandler=function(e){var t=this._touchEventHandlerByType.get(e);if(void 0!==t&&0!==t.length){var r=this._latestTouchEventsByType.get(e);if(0!==r.length){var n=this._previousTouchEventsByType.get(e);t.forEach(function(e){return e(r,n)}),Object.assign(n,r),r.length=0}}},e.prototype.dispose=function(){this._latestMouseEventsByType.forEach(function(e){return e.length=0}),this._previousMouseEventsByType.forEach(function(e){return e.length=0}),this._latestTouchEventsByType.forEach(function(e){return e.length=0}),this._previousTouchEventsByType.forEach(function(e){return e.length=0});for(var e=0,t=this._subscriptions;e<t.length;e++){t[e].unsubscribe()}},e.prototype.update=function(){this.invokeMouseEventHandler(o.MouseEventProvider.Type.Click),this.invokeMouseEventHandler(o.MouseEventProvider.Type.Enter),this.invokeMouseEventHandler(o.MouseEventProvider.Type.Leave),this.invokeMouseEventHandler(o.MouseEventProvider.Type.Down),this.invokeMouseEventHandler(o.MouseEventProvider.Type.Up),this.invokeMouseEventHandler(o.MouseEventProvider.Type.Move),this.invokeMouseEventHandler(o.MouseEventProvider.Type.Wheel),this.invokeTouchEventHandler(a.TouchEventProvider.Type.Start),this.invokeTouchEventHandler(a.TouchEventProvider.Type.End),this.invokeTouchEventHandler(a.TouchEventProvider.Type.Move),this.invokeTouchEventHandler(a.TouchEventProvider.Type.Cancel)},e.prototype.offsets=function(e,t){void 0===t&&(t=!0);var r=new Array,i=!1;if(e instanceof MouseEvent)i=0!==(o=e).offsetX&&0!==o.offsetY,r.push(i?n.vec2.fromValues(o.offsetX,o.offsetY):n.vec2.fromValues(o.clientX,o.clientY));else if(e instanceof WheelEvent){i=0!==(o=e).offsetX&&0!==o.offsetY,r.push(i?n.vec2.fromValues(o.offsetX,o.offsetY):n.vec2.fromValues(o.clientX,o.clientY))}else if(e instanceof TouchEvent)for(var o=e,a=0;a<o.touches.length;++a){var s=o.touches.item(a);r.push(n.vec2.fromValues(s.clientX,s.clientY))}if(i){if(t)for(var u=0,c=r;u<c.length;u++){var f=c[u];n.vec2.scale(f,f,window.devicePixelRatio)}return r}for(var l=(e.target||e.currentTarget||e.srcElement).getBoundingClientRect(),h=0,p=r;h<p.length;h++){(f=p[h])[0]=Math.floor(f[0]-l.left),f[1]=Math.floor(f[1]-l.top),t&&n.vec2.scale(f,f,window.devicePixelRatio)}return r},e.prototype.pushClickHandler=function(e){this.pushMouseEventHandler(o.MouseEventProvider.Type.Click,e)},e.prototype.pushMouseEnterHandler=function(e){this.pushMouseEventHandler(o.MouseEventProvider.Type.Enter,e)},e.prototype.pushMouseLeaveHandler=function(e){this.pushMouseEventHandler(o.MouseEventProvider.Type.Leave,e)},e.prototype.pushMouseDownHandler=function(e){this.pushMouseEventHandler(o.MouseEventProvider.Type.Down,e)},e.prototype.pushMouseUpHandler=function(e){this.pushMouseEventHandler(o.MouseEventProvider.Type.Up,e)},e.prototype.pushMouseMoveHandler=function(e){this.pushMouseEventHandler(o.MouseEventProvider.Type.Move,e)},e.prototype.pushMouseWheelHandler=function(e){this.pushMouseEventHandler(o.MouseEventProvider.Type.Wheel,e)},e.prototype.pushTouchStartHandler=function(e){this.pushTouchEventHandler(a.TouchEventProvider.Type.Start,e)},e.prototype.pushTouchEndHandler=function(e){this.pushTouchEventHandler(a.TouchEventProvider.Type.End,e)},e.prototype.pushTouchMoveHandler=function(e){this.pushTouchEventHandler(a.TouchEventProvider.Type.Move,e)},e.prototype.pushTouchCancelHandler=function(e){this.pushTouchEventHandler(a.TouchEventProvider.Type.Cancel,e)},e.prototype.requestPointerLock=function(){this._mouseEventProvider&&(this._mouseEventProvider.pointerLock=!0)},e.prototype.exitPointerLock=function(){this._mouseEventProvider&&(this._mouseEventProvider.pointerLock=!1)},e}();t.EventHandler=s},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),a=r(25),s=r(1),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._internalFormat=void 0,t}return n(t,e),t.prototype.create=function(e,r,n){o.assert(e>0&&r>0,"renderbuffer object requires valid width and height greater than zero");var i=this.context.gl;this._object=i.createRenderbuffer(),this._width=e,this._height=r,this._internalFormat=n,i.bindRenderbuffer(i.RENDERBUFFER,this._object),i.renderbufferStorage(i.RENDERBUFFER,n,e,r),this._valid=i.isRenderbuffer(this._object),i.bindRenderbuffer(i.RENDERBUFFER,t.DEFAULT_RENDER_BUFFER);var s=e*r*a.byteSizeOfFormat(this.context,n);return this.context.allocationRegister.reallocate(this._identifier,s),this._object},t.prototype.delete=function(){o.assert(this._object instanceof WebGLRenderbuffer,"expected WebGLRenderbuffer object"),this.context.gl.deleteRenderbuffer(this._object),this._object=void 0,this._valid=!1,this._internalFormat=void 0,this._width=0,this._height=0},t.prototype.bind=function(){this.context.gl.bindRenderbuffer(this.context.gl.RENDERBUFFER,this._object)},t.prototype.unbind=function(){this.context.gl.bindRenderbuffer(this.context.gl.RENDERBUFFER,t.DEFAULT_RENDER_BUFFER)},t.prototype.resize=function(e,t,r,n){if(void 0===r&&(r=!1),void 0===n&&(n=!1),e!==this._width||t!==this._height){this._width=e,this._height=t;var i=this.context.gl;r&&this.bind(),i.renderbufferStorage(i.RENDERBUFFER,this._internalFormat,e,t),n&&this.unbind();var o=e*t*a.byteSizeOfFormat(this.context,this._internalFormat);this.context.allocationRegister.reallocate(this._identifier,o)}},Object.defineProperty(t.prototype,"bytes",{get:function(){return this.assertInitialized(),this.context.allocationRegister.allocated(this._identifier)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"internalFormat",{get:function(){return this.assertInitialized(),this._internalFormat},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.assertInitialized(),this._width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.assertInitialized(),this._height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return[this.width,this.height]},enumerable:!0,configurable:!0}),t.DEFAULT_RENDER_BUFFER=void 0,i([s.Initializable.assert_initialized()],t.prototype,"bind",null),i([s.Initializable.assert_initialized()],t.prototype,"unbind",null),i([s.Initializable.assert_initialized()],t.prototype,"resize",null),t}(r(4).AbstractObject);t.Renderbuffer=u},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0});var o=r(5),a=r(2),s=r(0),u=r(3),c=r(21),f=r(1),l=r(13),h=r(14),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._altered=Object.assign(new c.ChangeLookup,{any:!1,multiFrameNumber:!1,frameSize:!1,canvasSize:!1,framePrecision:!1,clearColor:!1,debugTexture:!1}),t._frameSize=[0,0],t._canvasSize=[0,0],t._framePrecision=h.Wizard.Precision.half,t._clearColor=[0,0,0,1],t._debugTextures=new Array,t._debugTextureSubject=new o.ReplaySubject(1),t}return n(t,e),t.prototype.invalidate=function(e){void 0===e&&(e=!1),this._invalidate(e)},t.prototype.debugTextureNext=function(){this._debugTextureSubject.next(this._debugTexture)},Object.defineProperty(t.prototype,"context",{get:function(){return this.assertInitialized(),this._context},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canvasSize",{get:function(){return this.assertInitialized(),this._canvasSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"altered",{get:function(){return this._altered.any},enumerable:!0,configurable:!0}),t.prototype.initialize=function(e,t,r,n){return s.assert(void 0!==e,"valid webgl context required"),this._context=e,s.assert(void 0!==t,"valid multi-frame update callback required"),this._invalidate=t,this.onInitialize(e,t,r,n)},t.prototype.uninitialize=function(){this.onUninitialize()},t.prototype.update=function(e){return this._canvasSize[0]===this._context.gl.canvas.width&&this._canvasSize[1]===this._context.gl.canvas.height||(this._canvasSize[0]=this._context.gl.canvas.width,this._canvasSize[1]=this._context.gl.canvas.height,this._altered.alter("canvasSize")),this._multiFrameNumber!==e&&(this._multiFrameNumber=e,this._altered.alter("multiFrameNumber")),this.onUpdate()||this._altered.any},t.prototype.prepare=function(){this.onPrepare()},t.prototype.frame=function(e){this.onFrame(e)},t.prototype.swap=function(){this.onSwap()},t.prototype.frameCoords=function(e,t){var r=a.vec2.divide(u.v2(),this._frameSize,this.canvasSize);return a.vec2.floor(r,a.vec2.multiply(r,[e+.5,t+.5],r)),a.vec2.add(r,r,[.5,.5]),l.tuple2(r)},Object.defineProperty(t.prototype,"frameSize",{set:function(e){this.assertInitialized(),a.vec2.equals(this._frameSize,e)||(Object.assign(this._frameSize,e),this._altered.alter("frameSize"),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"framePrecision",{set:function(e){this.assertInitialized(),this._framePrecision!==e&&(this._framePrecision=e,this._altered.alter("framePrecision"),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"clearColor",{set:function(e){this.assertInitialized(),a.vec4.equals(this._clearColor,e)||(Object.assign(this._clearColor,e),this._altered.alter("clearColor"),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"debugTextures",{get:function(){return this.assertInitialized(),this._debugTextures},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"debugTexture",{get:function(){return this.assertInitialized(),this._debugTexture},set:function(e){this.assertInitialized(),this._debugTexture!==e&&(s.logIf(e>=this._debugTextures.length,s.LogLevel.Error,"invalid texture index, debug texture disabled (index set to -1) | "+e+" not in [-1,+"+(this._debugTextures.length-1)+"]"),this._debugTexture=e<this._debugTextures.length?u.clamp(e,-1,this._debugTextures.length-1):-1,this._altered.alter("debugTexture"),this.invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"debugTexture$",{get:function(){return this._debugTextureSubject.asObservable()},enumerable:!0,configurable:!0}),i([f.Initializable.assert_initialized()],t.prototype,"invalidate",null),i([f.Initializable.initialize()],t.prototype,"initialize",null),i([f.Initializable.uninitialize()],t.prototype,"uninitialize",null),i([f.Initializable.assert_initialized()],t.prototype,"update",null),i([f.Initializable.assert_initialized()],t.prototype,"prepare",null),i([f.Initializable.assert_initialized()],t.prototype,"frame",null),i([f.Initializable.assert_initialized()],t.prototype,"swap",null),t}(f.Initializable);t.Renderer=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(16),o=function(){function e(){this._extensionsStrive=new Array,this._extensionsConceal=new Array,this._functionsUndefine=new Array}return e.fromHash=function(t){var r=new e,n=i.ExtensionsHash.decode(t);return r._backend=n[0],r._extensionsStrive=n[1],r._extensionsConceal=i.ExtensionsHash.complement(r._backend,r._extensionsStrive),r},e.fromPreset=function(t){for(var r,o=new e,a=new Array,s=0,u=e.presets();s<u.length;s++){var c=u[s];if(a.push(c.identifier),c.identifier===t){r=c;break}}if(void 0===r)return n.assert(!1,"expected valid identifier, available ['"+a.join("', '")+"'], given '"+t+"'"),o;if(void 0!==(r=r).extensions_hash){var f=i.ExtensionsHash.decode(r.extensions_hash);o._backend=f[0],o._extensionsStrive=f[1]}else o._backend=r.backend,o._extensionsConceal=r.extensions_conceal,o._extensionsStrive=r.extensions_strive;return o._functionsUndefine=r.functions_undefine,n.assert(void 0!==o._backend,"expected backend to be included in preset"),void 0===o._extensionsStrive?o._extensionsStrive=[]:o._extensionsConceal=i.ExtensionsHash.complement(o._backend,o._extensionsStrive),void 0===o._extensionsConceal&&(o._extensionsConceal=[]),void 0===o._functionsUndefine&&(o._functionsUndefine=[]),o},e.fromGET=function(){var t=n.GETparameter("msqrd_h");if(void 0!==t)return e.fromHash(t);var r=n.GETparameter("msqrd_p");return void 0!==r?e.fromPreset(r):void 0},e.presets=function(){return this.MASQUERADE_JSON},Object.defineProperty(e.prototype,"backend",{get:function(){return this._backend},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"extensionsStrive",{get:function(){return this._extensionsStrive},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"extensionsConceal",{get:function(){return this._extensionsConceal},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"functionsUndefine",{get:function(){return this._functionsUndefine},enumerable:!0,configurable:!0}),e.MASQUERADE_JSON=r(56),e}();t.ContextMasquerade=o},function(e,t,r){"use strict";var n;!function(e){e.WEBGL1_EXTENSIONS=["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_color_buffer_half_float","EXT_disjoint_timer_query","EXT_frag_depth","EXT_sRGB","EXT_shader_texture_lod","EXT_texture_filter_anisotropic","OES_element_index_uint","OES_standard_derivatives","OES_texture_float","OES_texture_float_linear","OES_texture_half_float","OES_texture_half_float_linear","OES_vertex_array_object","WEBGL_color_buffer_float","WEBGL_compressed_texture_astc","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_debug_renderer_info","WEBGL_debug_shaders","WEBGL_depth_texture","WEBGL_draw_buffers","WEBGL_lose_context"],e.WEBGL2_EXTENSIONS=["EXT_color_buffer_float","EXT_disjoint_timer_query_webgl2","EXT_texture_filter_anisotropic","OES_texture_float_linear","OES_texture_half_float_linear","WEBGL_compressed_texture_astc","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_debug_renderer_info","WEBGL_debug_shaders","WEBGL_lose_context"],e.WEBGL2_DEFAULT_EXTENSIONS=["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_frag_depth","EXT_sRGB","EXT_shader_texture_lod","OES_element_index_uint","OES_standard_derivatives","OES_texture_float","OES_texture_half_float","OES_vertex_array_object","WEBGL_depth_texture","WEBGL_draw_buffers"]}(n||(n={})),e.exports=n},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=r(5),o=r(2),a=r(3),s=r(0),u=r(13),c=r(17),f=r(15),l=r(35),h=r(18),p=r(58),_=r(20),d=r(14),b=function(e){function t(r,n,o){var l=e.call(this)||this;l._framePrecisionSubject=new i.ReplaySubject(1),l._size=[1,1],l._sizeSubject=new i.ReplaySubject(1),l._frameScaleSubject=new i.ReplaySubject(1),l._frameSizeSubject=new i.ReplaySubject(1),l._element=r instanceof HTMLCanvasElement?r:document.getElementById(r),l._mouseEventProvider=new h.MouseEventProvider(l._element,200),l._touchEventProvider=new _.TouchEventProvider(l._element,200);var p,b=l._element.dataset;l._context=f.Context.request(l._element,n),o?(l._controller=o,l._controller.block()):l.configureController(b),l.configureSizeAndScale(b),b.clearColor&&(p=a.parseVec4(b.clearColor),s.logIf(void 0===p,s.LogLevel.Warning,"data-clear-color could not be parsed, given '"+b.clearColor+"'")),l._clearColor=p?new c.Color(u.tuple4(p)):t.DEFAULT_CLEAR_COLOR;var m=b.accumulationFormat?b.accumulationFormat:t.DEFAULT_FRAME_PRECISION;return m in d.Wizard.Precision||(m=t.DEFAULT_FRAME_PRECISION,s.log(s.LogLevel.Warning,"unknown frame precision '"+b.accumulationFormat+"' changed to '"+m+"'")),l._framePrecision=m,l.framePrecisionNext(),l}return n(t,e),t.prototype.configureController=function(e){var r,n;this._controller=new l.Controller,this._controller.block(),e.multiFrameNumber&&(r=parseInt(e.multiFrameNumber,10),s.logIf(isNaN(r),s.LogLevel.Warning,"data-multi-frame-number could not be parsed, given '"+e.multiFrameNumber+"'")),e.debugFrameNumber&&(n=parseInt(e.debugFrameNumber,10),s.logIf(isNaN(n),s.LogLevel.Warning,"data-debug-frame-number could not be parsed, given '"+e.debugFrameNumber+"'")),this._controller.multiFrameNumber=r||t.DEFAULT_MULTI_FRAME_NUMBER,this._controller.debugFrameNumber=n||0;var i=!!r&&r!==this._controller.multiFrameNumber;s.logIf(i,s.LogLevel.Warning,"data-multi-frame-number changed to "+this._controller.multiFrameNumber+", given '"+e.multiFrameNumber+"'");var o=!!n&&n!==this._controller.debugFrameNumber;s.logIf(o,s.LogLevel.Warning,"data-debug-frame-number changed to "+this._controller.debugFrameNumber+", given '"+e.debugFrameNumber+"'")},t.prototype.configureSizeAndScale=function(e){var t,r;e.frameScale&&(t=a.parseVec2(e.frameScale),s.logIf(void 0!==e.frameScale&&void 0===t,s.LogLevel.Warning,"data-frame-scale could not be parsed, given '"+e.frameScale+"'")),this._frameScale=t?u.tuple2(t):[1,1],e.frameSize&&(r=a.parseVec2(e.frameSize),s.logIf(void 0!==e.frameSize&&void 0===r,s.LogLevel.Warning,"data-frame-size could not be parsed, given '"+e.frameSize+"'")),this._favorSizeOverScale=void 0!==r,this._frameSize=r?u.tuple2(r):[this._size[0],this._size[1]],this.onResize()},t.prototype.retrieveSize=function(){var e=p.Resizable.elementSize(this._element);this._size=[e[0],e[1]],this.sizeNext()},t.prototype.onResize=function(){this.retrieveSize(),0!==this._size[0]&&0!==this._size[1]?(this._element.width=this._size[0],this._element.height=this._size[1],this._renderer&&this._controller.block(),this._favorSizeOverScale?this.frameSize=this._frameSize:this.frameScale=this._frameScale,this._renderer&&(this._controller.unblock(),this._renderer.swap())):s.log(s.LogLevel.Warning,"canvas width or height is 0, thus, not visible, resize discarded")},t.prototype.framePrecisionNext=function(){this._framePrecisionSubject.next(this._framePrecision)},t.prototype.sizeNext=function(){this._sizeSubject.next(this._size)},t.prototype.frameScaleNext=function(){this._frameScaleSubject.next(this._frameScale)},t.prototype.frameSizeNext=function(){this._frameSizeSubject.next(this._frameSize)},t.prototype.bind=function(e){var t=this;this._renderer!==e&&(this.unbind(),void 0!==e&&(s.assert(this._controller.blocked,"expected controller to be blocked"),this._renderer=e,this._renderer.initialize(this.context,function(e){return t._controller.update(e)},this._mouseEventProvider,this._touchEventProvider),this._renderer.frameSize=this._frameSize,this._renderer.clearColor=this._clearColor.rgba,this._renderer.framePrecision=this._framePrecision,this._renderer.debugTexture=-1,this._controller.controllable=this._renderer,this._controller.unblock()))},t.prototype.unbind=function(){void 0!==this._renderer&&(this._controller.block(),this._controller.controllable=void 0,this._renderer=void 0)},t.prototype.dispose=function(){e.prototype.dispose.call(this),this._renderer&&(this._renderer.uninitialize(),this.unbind())},t.prototype.resize=function(){this.onResize()},Object.defineProperty(t.prototype,"controller",{get:function(){return this._controller},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderer",{get:function(){return this._renderer},set:function(e){this.bind(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"frameScale",{get:function(){return this._frameScale},set:function(e){if(isFinite(e[0])&&isFinite(e[1])){s.logIf(e[0]<0||e[0]>2,s.LogLevel.Info,"frame width scale clamped to [0.0,2.0], given "+e[0]),s.logIf(e[1]<0||e[1]>2,s.LogLevel.Info,"frame height scale clamped to [0.0,2.0], given "+e[0]);var t=o.vec2.create();a.clamp2(t,e,[0,0],[2,2]);var r=o.vec2.create();o.vec2.mul(r,this._size,t),o.vec2.max(r,[1,1],r),o.vec2.round(r,r),o.vec2.div(t,r,this._size),s.logIf(!o.vec2.exactEquals(t,e),2,"frame scale was adjusted to "+t.toString()+", given "+e.toString()),this._frameScale=u.tuple2(t),this._frameSize=u.tuple2(r),this._favorSizeOverScale=!1,this.frameScaleNext(),this.frameSizeNext(),this._renderer&&(this._renderer.frameSize=this._frameSize)}else s.log(s.LogLevel.Warning,"expected finite frame size, non-finite values ignored, given ["+e+"]")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"frameScale$",{get:function(){return this._frameScaleSubject.asObservable()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"frameSize",{get:function(){return this._frameSize},set:function(e){if(isFinite(e[0])&&isFinite(e[1])){s.logIf(e[0]<1||e[0]>this._size[0],s.LogLevel.Info,"frame width scale clamped to [1,"+this._size[0]+"], given "+e[0]),s.logIf(e[1]<1||e[1]>this._size[1],s.LogLevel.Info,"frame height scale clamped to [1, "+this._size[1]+"], given "+e[1]);var t=o.vec2.create();a.clamp2(t,e,[1,1],this._size),o.vec2.round(t,t),s.logIf(!o.vec2.exactEquals(t,e),s.LogLevel.Warning,"frame size was adjusted to "+t.toString()+", given "+e.toString());var r=o.vec2.create();o.vec2.div(r,t,this._size),this._frameScale=u.tuple2(r),this._frameSize=u.tuple2(t),this._favorSizeOverScale=!o.vec2.exactEquals(this._frameSize,this._size),this.frameScaleNext(),this.frameSizeNext(),this._renderer&&(this._renderer.frameSize=this._frameSize)}else s.log(s.LogLevel.Warning,"expected finite frame size, non-finite values ignored, given ["+e+"]")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"frameSize$",{get:function(){return this._frameSizeSubject.asObservable()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"clearColor",{get:function(){return this._clearColor},set:function(e){this._clearColor=e,this._renderer&&(this._renderer.clearColor=this._clearColor.rgba)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"framePrecision",{get:function(){return this._framePrecision},set:function(e){this._framePrecision=e,this._renderer&&(this._renderer.framePrecision=this._framePrecision,this._framePrecision=this._renderer.framePrecision),this.framePrecisionNext()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"framePrecision$",{get:function(){return this._framePrecisionSubject.asObservable()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"context",{get:function(){return this._context},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"backend",{get:function(){return this._context.backendString},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size$",{get:function(){return this._sizeSubject.asObservable()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._size[0]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._size[1]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"element",{get:function(){return this._element},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mouseEventProvider",{get:function(){return this._mouseEventProvider},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"touchEventProvider",{get:function(){return this._touchEventProvider},enumerable:!0,configurable:!0}),t.DEFAULT_CLEAR_COLOR=new c.Color([.203,.227,.25,1]),t.DEFAULT_FRAME_PRECISION=d.Wizard.Precision.auto,t.DEFAULT_MULTI_FRAME_NUMBER=0,t}(p.Resizable);t.Canvas=b},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5),i=r(0),o=r(3),a=function(){function e(){this._batchSize=1,this._multiFrameNumber=1,this._multiFrameNumberSubject=new n.ReplaySubject(1),this._debugFrameNumber=0,this._debugFrameNumberSubject=new n.ReplaySubject(1),this._frameNumber=0,this._frameNumberSubject=new n.ReplaySubject(1),this._pendingRequest=0,this._pause=!1,this._block=!1,this._blockedUpdates=0,this._intermediateFrameCount=0,this._multiFrameCount=0,this._intermediateFrameTimes=new Array(2),this._multiTime=[0,0]}return Object.defineProperty(e.prototype,"debug",{set:function(t){t&&i.logVerbosity()<i.LogLevel.Debug&&(i.logVerbosity(i.LogLevel.Debug),i.log(i.LogLevel.Debug,"changed log verbosity to "+i.LogLevel.Debug+" (debug)")),e._debug=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"batch",{set:function(e){i.log(i.LogLevel.Warning,"(adaptive) batch multi-frame rendering is experimental for now"),this._batchSize=Math.max(1,e)},enumerable:!0,configurable:!0}),e.prototype.request=function(t){var r=this;if(0===this._pendingRequest)if(!this._pause&&this._controllable){i.logIf(e._debug,i.LogLevel.Debug,"c request           | intermediates: #"+this._frameNumber);var n=this._debugFrameNumber,o=this._multiFrameNumber;i.assert(n<=o,"debug-frame number exceeds multi-frame number"),i.assert(0===this._pendingRequest,"another request is pending, cannot invoke multiple requests"),n>0&&this._frameNumber>=n&&this.pause();var a=Math.max((n>0?n:o)-this._frameNumber,0);void 0!==t?this._pendingRequest=window.requestAnimationFrame(function(){return r.invoke(t)}):a>0?this._pendingRequest=window.requestAnimationFrame(function(){return r.invoke(e.RequestType.Frame)}):n!==o&&0!==n||++this._multiFrameCount}else i.logIf(e._debug,i.LogLevel.Debug,"c request (ignored) | pending: '"+this._pendingRequest+"'");else i.logIf(e._debug,i.LogLevel.Debug,"c request (ignored) | pending: '"+this._pendingRequest+"'")},e.prototype.reset=function(){var t=this._block||0===this._frameNumber&&this._pendingRequest;return i.logIf(e._debug,i.LogLevel.Debug,"c update  "+(t?"(blocked) ":"          ")+"| pending: '"+this._pendingRequest+"', intermediates: #"+this._frameNumber),t?(++this._blockedUpdates,!0):(this.cancel(),!1)},e.prototype.cancel=function(){0!==this._pendingRequest?(i.logIf(e._debug,i.LogLevel.Debug,"c cancel            | pending: '"+this._pendingRequest+"'"),window.cancelAnimationFrame(this._pendingRequest),this._pendingRequest=0):i.logIf(e._debug,i.LogLevel.Debug,"c cancel  (ignored) |")},e.prototype.invoke=function(t){switch(i.assert(0!==this._pendingRequest,"manual/explicit invocation not anticipated"),i.assert(void 0!==this._controllable,"expected valid controllable for invocation"),this._pendingRequest=0,t){case e.RequestType.Update:this.invokeUpdate(!1);break;case e.RequestType.NonOptionalUpdate:this.invokeUpdate(!0);break;case e.RequestType.Prepare:this.invokePrepare();break;case e.RequestType.Frame:this.invokeFrame()}},e.prototype.invokeUpdate=function(t){void 0===t&&(t=!1),i.logIf(e._debug,i.LogLevel.Debug,"c invoke update     | pending: '"+this._pendingRequest+"', mfnum: "+this._multiFrameNumber),this.unblock(),i.assert(!this._pause,"updates should not be invoked when paused");var r=this._controllable.update(this._multiFrameNumber);t||r?this.invokePrepare():this.invokeFrame()},e.prototype.invokePrepare=function(){i.logIf(e._debug,i.LogLevel.Debug,"c invoke prepare    |"),this._frameNumber=0,this._pause=!1,this._pauseTime=void 0,this._multiFrameTime=0,this._intermediateFrameTimes[0]=Number.MAX_VALUE,this._intermediateFrameTimes[1]=Number.MIN_VALUE,this._multiTime[0]=performance.now(),this._controllable.prepare(),this._multiTime[1]=performance.now();var t=this._multiTime[1]-this._multiTime[0];this._multiFrameTime=t,this._updateFrameTime=t,this.invokeFrame()},e.prototype.invokeFrame=function(){i.assert(!this._pause,"frames should not be invoked when paused"),i.logIf(e._debug,i.LogLevel.Debug,"c invoke frame      | pending: '"+this._pendingRequest+"'");var t=this._debugFrameNumber,r=this._multiFrameNumber;if(this._frameNumber!==r){var n=t>0;i.assert(!n||this._frameNumber<t,"frame number about to exceed debug-frame number"),i.assert(void 0!==this._controllable,"update invoked without controllable set");var o=performance.now(),a=Math.min(this._multiFrameNumber,this._frameNumber+this._batchSize);for(this._debugFrameNumber>0&&(a=Math.min(a,this._debugFrameNumber));this._frameNumber<a;++this._frameNumber)i.logIf(e._debug,i.LogLevel.Debug,"c -> frame          | frame: "+this._frameNumber),this._controllable.frame(this._frameNumber),++this._intermediateFrameCount;i.logIf(e._debug,i.LogLevel.Debug,"c -> swap           |"),this._controllable.swap(),this._multiTime[1]=performance.now();var s=this._multiTime[1]-o;this._multiFrameTime+=s,this._intermediateFrameTimes[0]=Math.min(this._intermediateFrameTimes[0],s),this._intermediateFrameTimes[1]=Math.max(this._intermediateFrameTimes[1],s),this.frameNumberNext(),this.request()}},e.prototype.multiFrameNumberNext=function(){this._multiFrameNumberSubject.next(this._multiFrameNumber)},e.prototype.debugFrameNumberNext=function(){this._debugFrameNumberSubject.next(this._debugFrameNumber)},e.prototype.frameNumberNext=function(){this._frameNumberSubject.next(this._frameNumber)},e.prototype.pause=function(){var t=this._pause;i.logIf(e._debug,i.LogLevel.Debug,"c pause   "+(t?"(ignored)":"")),this._pause||(this._pause=!0,this._pauseTime=performance.now(),this.cancel())},e.prototype.unpause=function(){var t=!this._pause;if(i.logIf(e._debug,i.LogLevel.Debug,"c unpause "+(t?"(ignored)":"")),!t){if(this._pause=!1,void 0!==this._pauseTime&&!isNaN(this._pauseTime)){var r=performance.now()-this._pauseTime;this._multiTime[0]+=r,this._multiTime[1]+=r}this.request()}},e.prototype.update=function(t){void 0===t&&(t=!1),this.reset()||this.request(t?e.RequestType.NonOptionalUpdate:e.RequestType.Update)},e.prototype.prepare=function(){this.reset()||this.request(e.RequestType.Prepare)},e.prototype.block=function(){i.logIf(e._debug,i.LogLevel.Debug,"c block   "+(this._block?"(ignored) ":"          ")+"|"),this._block||(this._block=!0)},e.prototype.unblock=function(){i.logIf(e._debug,i.LogLevel.Debug,"c unblock "+(this._block?"          ":"(ignored) ")+"| blocked: #"+this._blockedUpdates),this._block&&(this._block=!1,this._blockedUpdates>0&&(this._blockedUpdates=0,this.update()))},Object.defineProperty(e.prototype,"paused",{get:function(){return this._pause},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blocked",{get:function(){return this._block},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"controllable",{set:function(e){e!==this._controllable&&(this._controllable=e,this.update())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"multiFrameNumber",{get:function(){return this._multiFrameNumber},set:function(e){var t=Math.max(1,isNaN(e)?1:e);t!==this._multiFrameNumber&&(this._multiFrameNumber=t,this.multiFrameNumberNext(),i.logIf(t!==e,i.LogLevel.Debug,"multi-frame number adjusted to "+t+", given "+e),this.debugFrameNumber>this.multiFrameNumber?this.debugFrameNumber=this.multiFrameNumber:this.update())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"multiFrameNumber$",{get:function(){return this._multiFrameNumberSubject.asObservable()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"debugFrameNumber",{get:function(){return this._debugFrameNumber},set:function(e){var t=o.clamp(isNaN(e)?0:e,0,this.multiFrameNumber);t!==this._debugFrameNumber&&(this._debugFrameNumber=t,this.debugFrameNumberNext(),i.logIf(t!==e,i.LogLevel.Debug,"debug-frame number adjusted to "+t+", given "+e),this._block||(this.debugFrameNumber<this._frameNumber?this.prepare():this._pendingRequest||(this.unpause(),this.request())))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"debugFrameNumber$",{get:function(){return this._debugFrameNumberSubject.asObservable()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"frameNumber",{get:function(){return this._frameNumber},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"frameNumber$",{get:function(){return this._frameNumberSubject.asObservable()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"intermediateFrameCount",{get:function(){return this._intermediateFrameCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"multiFrameCount",{get:function(){return this._multiFrameCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"averageFrameTime",{get:function(){return 0===this._frameNumber?0:this._multiFrameTime/this._frameNumber},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"updateFrameTime",{get:function(){return this._updateFrameTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minimumFrameTime",{get:function(){return this._intermediateFrameTimes[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maximumFrameTime",{get:function(){return this._intermediateFrameTimes[1]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"multiFrameTime",{get:function(){return 0===this._frameNumber?0:this._multiTime[1]-this._multiTime[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"framesPerSecond",{get:function(){return 0===this._frameNumber?0:1e3/(this.multiFrameTime/this._frameNumber)},enumerable:!0,configurable:!0}),e._debug=!1,e}();t.Controller=a,function(e){!function(e){e[e.Update=0]="Update",e[e.NonOptionalUpdate=1]="NonOptionalUpdate",e[e.Prepare=2]="Prepare",e[e.Frame=3]="Frame"}(e.RequestType||(e.RequestType={}))}(a=t.Controller||(t.Controller={})),t.Controller=a},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),a=r(1),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._buffersBound=!1,t}return n(t,e),t.prototype.create=function(e,r){var n=this;if(this.context.isWebGL2||this.context.supportsVertexArrayObject){var i=this.context.gl2facade;this._object=i.createVertexArray(),this._valid=void 0!==this._object,this._bind=function(){i.bindVertexArray(n.object),n._buffersBound||(e(),n._buffersBound=!0)},this._unbind=function(){return i.bindVertexArray(t.DEFAULT_VERTEX_ARRAY)}}else this._bind=function(){return e()},this._unbind=function(){return r()},this._valid=!0;return this._object},t.prototype.delete=function(){this.context.isWebGL2||this.context.supportsVertexArrayObject?(o.assert(void 0!==this._object,"expected WebGLVertexArrayObject object"),this._context.gl2facade.deleteVertexArray(this._object),this._object=void 0,this._valid=!1,this._buffersBound=!1):this._valid=!1},t.prototype.bind=function(){this._bind()},t.prototype.unbind=function(){this._unbind()},t.prototype.invalidate=function(){this._buffersBound=!1},t.DEFAULT_VERTEX_ARRAY=void 0,i([a.Initializable.assert_initialized()],t.prototype,"bind",null),i([a.Initializable.assert_initialized()],t.prototype,"unbind",null),t}(r(4).AbstractObject);t.VertexArray=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=r(3),o=r(0),a=function(){function e(t,r,i){this._fovy=e.DEFAULT_FOVY,this._near=e.DEFAULT_NEAR,this._far=e.DEFAULT_FAR,this._viewport=[1,1],this._aspect=1,this._altered=!1,this._eye=t?n.vec3.clone(t):n.vec3.clone(e.DEFAULT_EYE),this._center=r?n.vec3.clone(r):n.vec3.clone(e.DEFAULT_CENTER),this._up=i?n.vec3.clone(i):n.vec3.clone(e.DEFAULT_UP)}return e.calculateFovY=function(e,t){return 2*Math.atan(.5*e/t)},e.prototype.invalidate=function(e,t){e&&(this._view=void 0,this._viewInverse=void 0),t&&(this._projection=void 0,this._projectionInverse=void 0),(e||t)&&(this._viewProjection=void 0,this._viewProjectionInverse=void 0),this._altered=!0},Object.defineProperty(e.prototype,"eye",{get:function(){return this._eye},set:function(e){n.vec3.equals(this._eye,e)||(this._eye=n.vec3.clone(e),this.invalidate(!0,!1))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"center",{get:function(){return this._center},set:function(e){n.vec3.equals(this._center,e)||(this._center=n.vec3.clone(e),this.invalidate(!0,!1))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"up",{get:function(){return this._up},set:function(e){n.vec3.equals(this._up,e)||(this._up=n.vec3.clone(e),this.invalidate(!0,!1))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fovy",{get:function(){return this._fovy},set:function(e){this._fovy!==e&&(this._fovy=e,this.invalidate(!1,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"near",{get:function(){return this._near},set:function(e){this._near!==e&&(this._near>=this._far?o.log(o.LogLevel.Warning,"near expected to be smaller than far ("+this._far+"), given "+e):(this._near=e,this.invalidate(!1,!0)))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"far",{get:function(){return this._far},set:function(e){this._far!==e&&(this._near>=this._far?o.log(o.LogLevel.Warning,"far expected to be greater than near ("+this._near+"), given "+e):(this._far=e,this.invalidate(!1,!0)))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewport",{get:function(){return this._viewport},set:function(e){this._viewport[0]===e[0]&&this._viewport[1]===e[1]||(this._viewport=e,this.invalidate(!1,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._viewport[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._viewport[1]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"aspect",{get:function(){return this._aspect},set:function(e){this._aspect!==e&&(this._aspect=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"view",{get:function(){return this._view?this._view:(this._view=n.mat4.lookAt(i.m4(),this._eye,this._center,this._up),this._view)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewInverse",{get:function(){return void 0!==this._viewInverse?this._viewInverse:(this._viewInverse=n.mat4.invert(i.m4(),this.view),this._viewInverse)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"projection",{get:function(){return this._projection?this._projection:(this._projection=n.mat4.perspective(i.m4(),this.fovy*o.DEG2RAD,this.aspect,this.near,this.far),this._projection)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"projectionInverse",{get:function(){return void 0!==this._projectionInverse?this._projectionInverse:(this._projectionInverse=n.mat4.invert(i.m4(),this.projection),this._projectionInverse)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewProjection",{get:function(){return this._viewProjection?this._viewProjection:(this._viewProjection=n.mat4.multiply(i.m4(),this.projection,this.view),this._viewProjection)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewProjectionInverse",{get:function(){return void 0!==this._viewProjectionInverse?this._viewProjectionInverse:(this._viewProjectionInverse=n.mat4.invert(i.m4(),this.viewProjection),this._viewProjectionInverse)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"altered",{get:function(){return this._altered},set:function(e){this._altered=e},enumerable:!0,configurable:!0}),e.DEFAULT_EYE=n.vec3.fromValues(0,0,1),e.DEFAULT_CENTER=n.vec3.fromValues(0,0,0),e.DEFAULT_UP=n.vec3.fromValues(0,1,0),e.DEFAULT_FOVY=45,e.DEFAULT_NEAR=2,e.DEFAULT_FAR=8,e}();t.Camera=a},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=r(2),o=r(3),a=function(e){function t(){var r=null!==e&&e.apply(this,arguments)||this;return r._rotation=i.mat4.create(),r._sensitivity=t.DEFAULT_SENSITIVITY,r}return n(t,e),t.prototype.initiate=function(e){Object.assign(this._reference,this._camera),this._initialPoint=e},t.prototype.process=function(e,t){this._currentPoint=e;var r=i.vec2.create();void 0===t?i.vec2.subtract(r,this._initialPoint,this._currentPoint):i.vec2.copy(r,t),i.vec2.scale(r,r,window.devicePixelRatio*this._sensitivity),i.vec2.copy(this._initialPoint,this._currentPoint);var n=i.vec3.sub(o.v3(),this._reference.eye,this._reference.center);i.vec3.normalize(n,n);var a=i.vec3.cross(o.v3(),n,this._reference.up),s=i.mat4.fromRotation(o.m4(),-r[0],this._reference.up),u=i.mat4.fromRotation(o.m4(),r[1],a);i.mat4.mul(this._rotation,u,s),this.update()},t.prototype.update=function(){if(void 0!==this._camera){var e=i.mat4.fromTranslation(o.m4(),this._reference.eye);i.mat4.multiply(e,e,this._rotation),i.mat4.translate(e,e,i.vec3.negate(o.v3(),this._reference.eye));var t=i.vec3.transformMat4(o.v3(),this._reference.center,e);this._camera.center=t,Object.assign(this._reference,this._camera)}},Object.defineProperty(t.prototype,"sensitivity",{get:function(){return this._sensitivity},set:function(e){this._sensitivity=e},enumerable:!0,configurable:!0}),t.DEFAULT_SENSITIVITY=8e-4,t}(r(7).CameraModifier);t.FirstPersonModifier=a},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=r(2),o=r(3),a=function(e){function t(){var r=null!==e&&e.apply(this,arguments)||this;return r._rotation=i.mat4.create(),r._sensitivity=t.DEFAULT_SENSITIVITY,r}return n(t,e),t.prototype.initiate=function(e){this._initialPoint=e},t.prototype.process=function(e){this._currentPoint=e;var t=i.vec2.subtract(o.v2(),this._initialPoint,this._currentPoint);i.vec2.scale(t,t,window.devicePixelRatio*this._sensitivity),i.vec2.copy(this._initialPoint,this._currentPoint);var r=i.vec3.sub(o.v3(),this._reference.eye,this._reference.center);i.vec3.normalize(r,r);var n=i.vec3.normalize(o.v3(),this._reference.up),a=i.vec3.cross(o.v3(),r,n);i.vec3.scale(n,n,t[1]),i.vec3.scale(a,a,t[0]);var s=i.vec3.cross(o.v3(),i.vec3.add(o.v3(),n,a),r);i.vec3.normalize(s,s);var u=i.quat.setAxisAngle(i.quat.create(),s,i.vec2.len(t));i.mat4.multiply(this._rotation,this._rotation,i.mat4.fromQuat(o.m4(),u)),this.update()},t.prototype.update=function(){if(void 0!==this._camera){var e=i.mat4.fromTranslation(o.m4(),this._reference.center);i.mat4.multiply(e,e,this._rotation),i.mat4.translate(e,e,i.vec3.negate(o.v3(),this._reference.center));var t=i.vec3.transformMat4(o.v3(),[0,1,0],this._rotation),r=i.vec3.transformMat4(o.v3(),this._reference.eye,e);this._camera.up=t,this._camera.eye=r}},Object.defineProperty(t.prototype,"sensitivity",{get:function(){return this._sensitivity},set:function(e){this._sensitivity=e},enumerable:!0,configurable:!0}),t.DEFAULT_SENSITIVITY=.002,t}(r(7).CameraModifier);t.TrackballModifier=a},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=r(2),o=r(3),a=function(e){function t(){var r=null!==e&&e.apply(this,arguments)||this;return r._rotation=o.m4(),r._maxAzimuth=.5*+Math.PI-1e-4,r._minAzimuth=.5*-Math.PI+1e-4,r._xAxisScreenSpace=o.v3(),r._sensitivity=t.DEFAULT_SENSITIVITY,r}return n(t,e),t.prototype.initiate=function(e){Object.assign(this._reference,this._camera),this._initialPoint=e;var t=i.vec3.sub(o.v3(),this._reference.eye,this._reference.center);i.vec3.normalize(t,t),this._xAxisScreenSpace=i.vec3.cross(o.v3(),[0,1,0],t),this._azimuth=Math.acos(i.vec3.dot(t,[0,1,0])),this._azimuth=.5*Math.PI-this._azimuth},t.prototype.process=function(e){this._currentPoint=e;var t=i.vec2.subtract(o.v2(),this._initialPoint,this._currentPoint);i.vec2.scale(t,t,window.devicePixelRatio*this._sensitivity),this._minAzimuth&&(t[1]=Math.min(this._azimuth-this._minAzimuth,t[1])),this._maxAzimuth&&(t[1]=Math.max(this._azimuth-this._maxAzimuth,t[1])),i.mat4.rotateY(this._rotation,o.m4(),t[0]),i.mat4.rotate(this._rotation,this._rotation,t[1],this._xAxisScreenSpace),this.update()},t.prototype.update=function(){if(void 0!==this._camera){var e=i.mat4.fromTranslation(o.m4(),this._reference.center);i.mat4.multiply(e,e,this._rotation),i.mat4.translate(e,e,i.vec3.negate(o.v3(),this._reference.center));var t=i.vec3.transformMat4(o.v3(),[0,1,0],this._rotation),r=i.vec3.transformMat4(o.v3(),this._reference.eye,e);this._camera.up=t,this._camera.eye=r}},Object.defineProperty(t.prototype,"sensitivity",{get:function(){return this._sensitivity},set:function(e){this._sensitivity=e},enumerable:!0,configurable:!0}),t.DEFAULT_SENSITIVITY=.002,t}(r(7).CameraModifier);t.TurntableModifier=a},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),o=function(e){function t(t){var r=e.call(this,2,t)||this;return r.generate(),r}return n(t,e),t.prototype.generate=function(){i.assert(this.width>0,"expected every kernel to comprise at least one element"),this.set([0,0],0);for(var e=1;e<this.width;++e)this.set([i.rand(-.5,.5),i.rand(-.5,.5)],e)},Object.defineProperty(t.prototype,"width",{get:function(){return this._width},set:function(e){this._width!==e&&(this._width=e,this.resize(),this.generate())},enumerable:!0,configurable:!0}),t}(r(27).KernelF32);t.RandomSquareKernel=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(43),i=function(){function e(){this._renderViews=[],this._renderViewsValid=!1,this._inputData=[],this._inputDataValid=!1}return Object.defineProperty(e.prototype,"time",{get:function(){return this._time},set:function(e){this._time=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"frame",{get:function(){return this._frame},set:function(e){this._frame=e,this._renderViewsValid=!1,this._inputDataValid=!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"frameOfReference",{get:function(){return this._frameOfReference},set:function(e){this._frameOfReference=e,this._inputDataValid=!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"renderViews",{get:function(){if(this._renderViewsValid)return this._renderViews;var e=this.frame.getDevicePose(this.frameOfReference);if(e){var t=this._frame.views;t.length!==this._renderViews.length&&(this._renderViews.length=t.length);for(var r=0;r<t.length;++r){var i=t[r];this._renderViews[r]||(this._renderViews[r]=new n.RenderView),this._renderViews[r].set(i.projectionMatrix,e.getViewMatrix(i),this.frame.session.baseLayer.getViewport(i))}}return this._renderViewsValid=!0,this._renderViews},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputData",{get:function(){if(this._inputDataValid)return this._inputData;var e=this._frame.session.getInputSources();e.length!==this.inputData.length&&(this.inputData.length=e.length);for(var t=0;t<e.length;++t){var r=e[t],n=this._frame.getInputPose(e[t],this.frameOfReference);this.inputData[t]||(this.inputData[t]={}),this.inputData[t].source=r,this.inputData[t].pose=n}return this._inputDataValid=!0,this._inputData},enumerable:!0,configurable:!0}),e}();t.FrameData=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=function(){function e(){this._cameraPosition=n.vec3.create(),this._cameraPositionValid=!1,this._viewProjectionMatrixValid=!1}return Object.defineProperty(e.prototype,"projectionMatrix",{get:function(){return this._projectionMatrix},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewMatrix",{get:function(){return this._viewMatrix},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewport",{get:function(){return this._viewport},enumerable:!0,configurable:!0}),e.prototype.set=function(e,t,r){this._projectionMatrix=e,this._viewMatrix=t,this._viewport=r,this._cameraPositionValid=!1,this._viewProjectionMatrixValid=!1},Object.defineProperty(e.prototype,"cameraPosition",{get:function(){return this._cameraPositionValid?this._cameraPosition:(this._inverseViewMatrix||(this._inverseViewMatrix=n.mat4.create()),this._cameraPosition[0]=0,this._cameraPosition[1]=0,this._cameraPosition[2]=0,n.mat4.invert(this._inverseViewMatrix,this.viewMatrix),n.vec3.transformMat4(this._cameraPosition,this._cameraPosition,this._inverseViewMatrix),this._cameraPositionValid=!0,this._cameraPosition)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewProjectionMatrix",{get:function(){return this._viewProjectionMatrixValid?this._viewProjectionMatrix:(this._viewProjectionMatrix||(this._viewProjectionMatrix=n.mat4.create()),n.mat4.multiply(this._viewProjectionMatrix,this.projectionMatrix,this.viewMatrix),this._viewProjectionMatrixValid=!0,this._viewProjectionMatrix)},enumerable:!0,configurable:!0}),e}();t.RenderView=i},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.onUpdate=function(){return!1},t.prototype.onPrepare=function(){},t.prototype.onFrame=function(e){},t.prototype.onSwap=function(){},t.prototype.xrframe=function(e){this.onXRFrame(e)},t}(r(31).Renderer);t.XRRenderer=i},function(e,t,r){"use strict";var n,i=r(46);!function(e){var t=function(e,t){return"fetching '"+e+"' failed ("+t.status+"): "+t.statusText};e.fetchAsync=function(e,r){return new Promise(function(n,i){var o=new XMLHttpRequest;o.open("GET",e,!0),o.onload=function(){if(o.status<200||o.status>=300)i(t(e,o));else{var a=o.responseText,s=r(a);n(s)}},o.onerror=function(){return i(t(e,o))},o.ontimeout=function(){return i(t(e,o))},o.send()})},e.fetchJsonAsync=function(e,r,n){return new Promise(function(o,a){var s=new XMLHttpRequest;s.open("GET",e,!0),s.onload=function(){if(s.status<200||s.status>=300)a(t(e,s));else{var u=s.responseText;if(void 0===n||i.validate(u,n)){var c;try{c=JSON.parse(u)}catch(t){return void a("fetching '"+e+"' failed ("+t.name+"): "+t.message)}var f=r(c);void 0!==f?o(f):a("fetching '"+e+"' failed (TransformError): transforming the object failed.")}}},s.onerror=function(){return a(t(e,s))},s.ontimeout=function(){return a(t(e,s))},s.send()})}}(n||(n={})),e.exports=n},function(e,t,r){"use strict";var n,i=r(60),o=r(0);!function(e){e.validate=function(e,t,r){var n=new i.Validator;if(void 0!==r)for(var a=0,s=r;a<s.length;a++){var u=s[a];n.addSchema(u[0],u[1])}var c=n.validate(e,t);return o.logIf(!c.valid,o.LogLevel.Warning,"schema expected to be valid:\n"+c.toString()),c.valid},e.complement=function e(t,r){if(void 0!==t)switch(o.assert(r.hasOwnProperty("properties")&&"object"===r.type||r.hasOwnProperty("items")&&"array"===r.type,"expected schema to have 'properties' or 'items', given "+r),r.type){case"object":for(var n=r.properties,i=0,a=Object.getOwnPropertyNames(n);i<a.length;i++){var s=a[i],u=n[s],c="object"===u.type,f=t.hasOwnProperty(s),l=u.hasOwnProperty("properties"),h=u.hasOwnProperty("default");o.assert(l&&c||!l&&!c,"expected property '"+s+"' to be of type 'object', given '"+u.type+"'"),f&&l?e(t[s],u):!f&&h&&Object.defineProperty(t,s,{value:u.default,writable:!0})}break;case"array":var p=r.items;if("object"!==p.type)break;for(var _=0,d=Object.getOwnPropertyNames(t);_<d.length;_++){var b=d[_];"length"!==b&&e(t[b],p)}}},e.compare=function e(t,r,n,i){void 0===i&&(i="");var a=void 0!==n;if(o.assert(!a||n.hasOwnProperty("any"),"expected allocation lookup object to have 'any' key"),void 0===t&&void 0!==r||void 0!==t&&void 0===r)return a&&n.alter(i),!0;var s=!0,u=[typeof t,typeof r],c=[t instanceof Array,r instanceof Array];if(!(c[0]&&c[1]||"object"===u[0]&&"object"===u[1]))return!(s=t===r)&&a&&n.alter(""+i),!s;for(var f=0,l=Array.from(new Set(Array().concat(Object.getOwnPropertyNames(t),Object.getOwnPropertyNames(r))).values());f<l.length;f++){var h=l[f];if("length"!==h){var p=[t[h],r[h]];u=[typeof p[0],typeof p[1]];var _=i+(i.length>0&&!c[0]?".":"")+(c[0]?"":h);if(p[0]instanceof Array&&p[1]instanceof Array||"object"===u[0]&&"object"===u[1])s=s&&!e(p[0],p[1],n,_);else{if(u[0]===u[1]&&p[0]===p[1])continue;s=!1,a&&n.alter(_)}}}return!s}}(n||(n={})),e.exports=n},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),a=r(8),s=r(1),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.create=function(){return this._object=a.Framebuffer.DEFAULT_FRAMEBUFFER,this._valid=!0,this._clearColors=new Array(1),this._clearDepth=1,this._clearStencil=0,this.clear=this.es2Clear,this._object},t.prototype.delete=function(){this._object=void 0,this._valid=!1},t.prototype.hasAttachment=function(e){return!1},t.prototype.bind=function(e){void 0===e&&(e=this.context.gl.FRAMEBUFFER),this.context.gl.bindFramebuffer(e,this._object)},t.prototype.clearColor=function(t){e.prototype.clearColor.call(this,t)},t.prototype.resize=function(){o.assert(!1,"the default framebuffer cannot be resized directly")},Object.defineProperty(t.prototype,"width",{get:function(){return this.context.gl.canvas.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.context.gl.canvas.height},enumerable:!0,configurable:!0}),i([s.Initializable.assert_initialized()],t.prototype,"bind",null),t}(a.Framebuffer);t.DefaultFramebuffer=u},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(t){return e.call(this,t)||this}return n(t,e),t.prototype.generate=function(){switch(this._width){case 8:this.fromJSON(r(76));break;case 64:this.fromJSON(r(77));break;default:e.prototype.generate.call(this)}},t}(r(41).RandomSquareKernel);t.AntiAliasingKernel=i},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),a=r(21),s=r(8),u=r(1),c=r(12),f=r(10),l=r(11),h=r(9),p=r(14),_=function(e){function t(t){var r=e.call(this)||this;return r._altered=Object.assign(new a.ChangeLookup,{any:!1,texture:!1,precision:!1,passThrough:!1}),r._precision=p.Wizard.Precision.half,r._write=0,r._ndcTriangleShared=!1,r._context=t,r}return n(t,e),t.prototype.initialize=function(e){var t=this._context.gl;this._accumulationFBOs=[new s.Framebuffer(this._context,"AccumPingFBO"),new s.Framebuffer(this._context,"AccumPongFBO")],this._accumulationTextures=[new h.Texture2(this._context,"AccumPingTexture"),new h.Texture2(this._context,"AccumPongTexture")];var n=new l.Shader(this._context,t.VERTEX_SHADER,"ndcvertices.vert (accumulate)");n.initialize(r(28));var i=new l.Shader(this._context,t.FRAGMENT_SHADER,"accumulate.frag");if(i.initialize(r(78)),this._program=new f.Program(this._context,"AccumulateProgram"),this._program.initialize([n,i]),this._uWeight=this._program.uniform("u_weight"),this._program.bind(),t.uniform1f(this._uWeight,0),t.uniform1i(this._program.uniform("u_accumulationTexture"),0),t.uniform1i(this._program.uniform("u_currentFrameTexture"),1),this._program.unbind(),void 0===e?this._ndcTriangle=new c.NdcFillingTriangle(this._context,"NdcFillingTriangle-Accumulate"):(this._ndcTriangle=e,this._ndcTriangleShared=!0),this._ndcTriangle.initialized)this._program.attribute("a_vertex",this._ndcTriangle.aVertex);else{var o=this._program.attribute("a_vertex",0);this._ndcTriangle.initialize(o)}return!0},t.prototype.uninitialize=function(){!this._ndcTriangleShared&&this._ndcTriangle.initialized&&this._ndcTriangle.uninitialize(),this._program.uninitialize(),this._accumulationFBOs[0].uninitialize(),this._accumulationFBOs[1].uninitialize(),this._accumulationTextures[0].uninitialize(),this._accumulationTextures[1].uninitialize(),this._write=0},t.prototype.update=function(){if(this._texture&&this._texture.valid){if(!this._passThrough){var e=this._altered.texture||this._accumulationTextures[0].width!==this._texture.width||this._accumulationTextures[0].height!==this._texture.height;if(this._altered.any||e){var t=this._context.gl,r=this._context.gl2facade,n=this._texture.size;if(this._accumulationTextures[0].initialized){if((this._altered.texture||e)&&(this._accumulationTextures[0].resize(this._texture.width,this._texture.height),this._accumulationTextures[1].resize(this._texture.width,this._texture.height)),this._altered.precision){i=p.Wizard.queryInternalTextureFormat(this._context,t.RGBA,this._precision);this._accumulationTextures[0].reformat(i[0],t.RGBA,i[1]),this._accumulationTextures[1].reformat(i[0],t.RGBA,i[1])}}else{var i=p.Wizard.queryInternalTextureFormat(this._context,t.RGBA,this._precision);this._accumulationTextures[0].initialize(n[0],n[1],i[0],t.RGBA,i[1]),this._accumulationTextures[1].initialize(n[0],n[1],i[0],t.RGBA,i[1])}this._accumulationFBOs[0].initialized||(this._accumulationFBOs[0].initialize([[r.COLOR_ATTACHMENT0,this._accumulationTextures[0]]]),this._accumulationFBOs[1].initialize([[r.COLOR_ATTACHMENT0,this._accumulationTextures[1]]])),o.assert(this._accumulationFBOs[0].valid&&this._accumulationFBOs[1].valid,"valid accumulation framebuffers expected"),this._altered.reset()}else o.assert(this._accumulationFBOs[0].valid&&this._accumulationFBOs[1].valid,"valid accumulation framebuffers expected")}}else o.log(o.LogLevel.Warning,"valid texture for accumulation update expected, given "+this._texture)},t.prototype.frame=function(e,t){if(o.assert(this._accumulationFBOs[0].valid&&this._accumulationFBOs[1].valid,"valid framebuffer objects for accumulation expected (initialize or update was probably not be called"),!this._passThrough&&void 0!==this._texture){o.logIf(!this._texture||!this._texture.valid,o.LogLevel.Warning,"valid texture for accumulation frame expected, given "+this._texture);var r=this._context.gl;void 0!==t&&r.viewport(0,0,t[0],t[1]);var n=e%2,i=this._write=1-n,a=this._accumulationTextures[n],s=this._texture;a.bind(r.TEXTURE0),s.bind(r.TEXTURE1),this._program.bind(),r.uniform1f(this._uWeight,1/(e+1)),this._accumulationFBOs[i].bind(r.DRAW_FRAMEBUFFER),this._ndcTriangle.bind(),this._ndcTriangle.draw(),this._ndcTriangle.unbind(),this._accumulationFBOs[i].unbind(r.DRAW_FRAMEBUFFER),a.unbind(r.TEXTURE0),s.unbind(r.TEXTURE1)}},Object.defineProperty(t.prototype,"texture",{set:function(e){this.assertInitialized(),this._texture!==e&&(this._texture=e,this._altered.alter("texture"))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"precision",{set:function(e){this.assertInitialized(),this._precision!==e&&(this._precision=e,this._altered.alter("precision"))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"passThrough",{set:function(e){this.assertInitialized(),this._passThrough!==e&&(this._passThrough&&this._accumulationTextures[0].initialized&&(this._accumulationTextures[0].uninitialize(),this._accumulationTextures[1].uninitialize()),this._passThrough&&this._accumulationFBOs[0].initialized&&(this._accumulationFBOs[0].uninitialize(),this._accumulationFBOs[1].uninitialize()),this._passThrough=e,this._altered.alter("passThrough"))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"framebuffer",{get:function(){return this._passThrough?void 0:this._accumulationFBOs[this._write]},enumerable:!0,configurable:!0}),i([u.Initializable.initialize()],t.prototype,"initialize",null),i([u.Initializable.uninitialize()],t.prototype,"uninitialize",null),i([u.Initializable.assert_initialized()],t.prototype,"update",null),i([u.Initializable.assert_initialized()],t.prototype,"frame",null),t}(u.Initializable);t.AccumulatePass=_},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),a=r(1),s=r(12),u=r(10),c=r(11),f=function(e){function t(t){var r=e.call(this)||this;return r._ndcTriangleShared=!1,r._context=t,r}return n(t,e),t.prototype.functionBlit=function(){var e=this._context.gl;this._target.bind(e.DRAW_FRAMEBUFFER),this._framebuffer.bind(e.READ_FRAMEBUFFER),e.readBuffer(this._readBuffer),e.drawBuffers([this._drawBuffer]),e.enable(e.SCISSOR_TEST),e.scissor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),e.disable(e.SCISSOR_TEST),e.blitFramebuffer(0,0,this._framebuffer.width,this._framebuffer.height,0,0,this._target.width,this._target.height,e.COLOR_BUFFER_BIT,e.NEAREST),this._framebuffer.unbind(e.READ_FRAMEBUFFER),this._target.unbind(e.DRAW_FRAMEBUFFER)},t.prototype.programBlit=function(){o.assert(this._ndcTriangle&&this._ndcTriangle.initialized,"expected an initialized ndc triangle");var e=this._context.gl;e.viewport(0,0,this._target.width,this._target.height),this._program.bind();var t=this._framebuffer.texture(this._readBuffer);t.bind(e.TEXTURE0);var r=this._context.isWebGL2?e.DRAW_FRAMEBUFFER:e.FRAMEBUFFER;this._target.bind(r),this._ndcTriangle.bind(),this._ndcTriangle.draw(),this._ndcTriangle.unbind(),this._target.unbind(r),t.unbind()},t.prototype.initialize=function(e){var t=this._context.gl,n=new c.Shader(this._context,t.VERTEX_SHADER,"ndcvertices.vert (blit)");n.initialize(r(28));var i=new c.Shader(this._context,t.FRAGMENT_SHADER,"blit.frag");if(i.initialize(r(79)),this._program=new u.Program(this._context,"BlitProgram"),this._program.initialize([n,i]),this._program.bind(),t.uniform1i(this._program.uniform("u_texture"),0),this._program.unbind(),void 0===e?this._ndcTriangle=new s.NdcFillingTriangle(this._context,"NdcFillingTriangle-Blit"):(this._ndcTriangle=e,this._ndcTriangleShared=!0),this._ndcTriangle.initialized)this._program.attribute("a_vertex",this._ndcTriangle.aVertex);else{var o=this._program.attribute("a_vertex",0);this._ndcTriangle.initialize(o)}return!0},t.prototype.uninitialize=function(){!this._ndcTriangleShared&&this._ndcTriangle.initialized&&this._ndcTriangle.uninitialize(),this._program.uninitialize()},t.prototype.frame=function(){o.logIf(!this._target||!this._target.valid,o.LogLevel.Warning,"valid target expected, given "+this._target),o.logIf(!this._framebuffer||!this._framebuffer.valid,o.LogLevel.Warning,"valid framebuffer for blitting from expected, given "+this._framebuffer);var e=this._context.gl;switch(this._readBuffer){case e.DEPTH_ATTACHMENT:case e.STENCIL_ATTACHMENT:case e.DEPTH_STENCIL_ATTACHMENT:return this.programBlit()}if(this._context.supportsBlitFramebuffer)return this.functionBlit();this.programBlit()},Object.defineProperty(t.prototype,"framebuffer",{set:function(e){this.assertInitialized(),this._framebuffer=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"readBuffer",{set:function(e){this.assertInitialized(),this._readBuffer=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"drawBuffer",{set:function(e){this.assertInitialized(),this._drawBuffer=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"target",{set:function(e){this.assertInitialized(),this._target=e},enumerable:!0,configurable:!0}),i([a.Initializable.initialize()],t.prototype,"initialize",null),i([a.Initializable.uninitialize()],t.prototype,"uninitialize",null),i([a.Initializable.assert_initialized()],t.prototype,"frame",null),t}(a.Initializable);t.BlitPass=f},function(e,t,r){"use strict"},function(e,t,r){"use strict";var n=this;void 0===String.prototype.repeat&&(String.prototype.repeat=function(e){if(null===this)throw new TypeError("can't convert "+this+" to object");var t=""+this;if((e=+e)!=e&&(e=0),e<0)throw new RangeError("repeat count must be non-negative");if(e===1/0)throw new RangeError("repeat count must be less than infinity");if(e=Math.floor(e),0===t.length||0===e)return"";if(t.length*e>=1<<28)throw new RangeError("repeat count must not overflow maximum string size");for(var r="",n=0;n<e;n++)r+=t;return r}),void 0===String.prototype.startsWith&&(String.prototype.startsWith=function(e,t){return t=t||0,this.indexOf(e,t)===t}),void 0===Array.prototype.forEach&&(Array.prototype.forEach=function(e,t){for(var r=n.length,i=0;i<r;i++)i in n&&e.call(t,n[i],i,n)}),void 0===Math.log10&&(Math.log10=function(e){return Math.log(e)*Math.LOG10E}),void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),[Float32Array,Float64Array,Uint8Array,Int8Array,Uint16Array,Int16Array,Uint32Array,Int32Array].forEach(function(e){void 0===e.prototype.slice&&(e.prototype.slice=Array.prototype.slice)})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(54);t.branch=n.branch,t.commit=n.commit,t.version=n.version;var i=r(15);t.Context=i.Context;var o=r(34);t.Canvas=o.Canvas;var a=r(35);t.Controller=a.Controller;var s=r(1);t.Initializable=s.Initializable;var u=r(32);t.ContextMasquerade=u.ContextMasquerade;var c=r(16);t.ExtensionsHash=c.ExtensionsHash;var f=r(21);t.ChangeLookup=f.ChangeLookup;var l=r(18);t.MouseEventProvider=l.MouseEventProvider;var h=r(20);t.TouchEventProvider=h.TouchEventProvider;var p=r(29);t.EventHandler=p.EventHandler;var _=r(22);t.Buffer=_.Buffer;var d=r(17);t.Color=d.Color;var b=r(59);t.ColorScale=b.ColorScale;var m=r(47);t.DefaultFramebuffer=m.DefaultFramebuffer;var v=r(8);t.Framebuffer=v.Framebuffer;var g=r(26);t.Geometry=g.Geometry;var y=r(10);t.Program=y.Program;var E=r(30);t.Renderbuffer=E.Renderbuffer;var x=r(31);t.Renderer=x.Renderer;var T=r(11);t.Shader=T.Shader;var M=r(9);t.Texture2=M.Texture2;var O=r(71);t.TextureCube=O.TextureCube;var A=r(36);t.VertexArray=A.VertexArray;var P=r(14);t.Wizard=P.Wizard;var R=r(37);t.Camera=R.Camera;var w=r(7);t.CameraModifier=w.CameraModifier;var S=r(72);t.Navigation=S.Navigation;var j=r(38);t.FirstPersonModifier=j.FirstPersonModifier;var L=r(73);t.PanModifier=L.PanModifier;var F=r(19);t.PointerLock=F.PointerLock;var I=r(39);t.TrackballModifier=I.TrackballModifier;var B=r(40);t.TurntableModifier=B.TurntableModifier;var N=r(74);t.ZoomModifier=N.ZoomModifier;var z=r(75);t.NdcFillingRectangle=z.NdcFillingRectangle;var C=r(12);t.NdcFillingTriangle=C.NdcFillingTriangle;var G=r(27);t.AbstractKernel=G.AbstractKernel;var U=r(48);t.AntiAliasingKernel=U.AntiAliasingKernel;var D=r(41);t.RandomSquareKernel=D.RandomSquareKernel;var k=r(27);t.KernelF32=k.KernelF32,t.KernelI32=k.KernelI32,t.KernelI8=k.KernelI8,t.KernelUI32=k.KernelUI32,t.KernelUI8=k.KernelUI8;var X=r(49);t.AccumulatePass=X.AccumulatePass;var W=r(50);t.BlitPass=W.BlitPass;var q=r(80);t.ReadbackPass=q.ReadbackPass;var V=r(0);t.auxiliaries=V;var H=r(2);t.vec2=H.vec2,t.vec3=H.vec3,t.vec4=H.vec4;var Y=r(2);t.mat2=Y.mat2,t.mat3=Y.mat3,t.mat4=Y.mat4;var K=r(3);t.gl_matrix_extensions=K;var Z=r(13);t.tuples=Z;var $=r(82);t.XRController=$.XRController;var J=r(44);t.XRRenderer=J.XRRenderer;var Q=r(42);t.FrameData=Q.FrameData;var ee=r(43);t.RenderView=ee.RenderView},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.branch="webxr",t.commit="8e23251e53b17d45c3955595deecabd33403c418",t.version="8e23251"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5),i=r(0),o=function(){function e(){this._bytesByIdentifier=new Map,this._bytes=0,this._bytesSubject=new n.ReplaySubject(1)}return e.prototype.bytesNext=function(){this._bytesSubject.next([this._bytes,this.bytesToString()])},e.prototype.assertIdentifier=function(e){i.assert(this._bytesByIdentifier.has(e),"allocation identifier unknown")},e.prototype.createUniqueIdentifier=function(e){for(var t=e,r=2;this._bytesByIdentifier.has(t);)t=e+"-"+r,++r;return this._bytesByIdentifier.set(t,0),t},e.prototype.deleteUniqueIdentifier=function(e){i.assert(this._bytesByIdentifier.has(e),"identifier expected to be known for allocation registration"),this._bytesByIdentifier.delete(e)},e.prototype.allocate=function(e,t){if(this.assertIdentifier(e),i.assert(t>=0,"positive number of bytes expected for allocation, given "+t),0!==t){var r=this._bytesByIdentifier.get(e)+t;this._bytesByIdentifier.set(e,r),this._bytes=this._bytes+t,this.bytesNext()}},e.prototype.deallocate=function(e,t){this.assertIdentifier(e);var r=this._bytesByIdentifier.get(e);i.assert(t>=0,"positive number of bytes expected for deallocation, given "+t),i.assert(t<=r,"deallocation cannot exceed previous allocations of "+r+", given "+t),0!==t&&(this._bytesByIdentifier.set(e,r-t),this._bytes=this._bytes-t,this.bytesNext())},e.prototype.reallocate=function(e,t){this.assertIdentifier(e),i.assert(t>=0,"positive number of bytes expected for reallocation, given "+t);var r=this._bytesByIdentifier.get(e);r!==t&&(this._bytes=this._bytes-r,this._bytesByIdentifier.set(e,t),this._bytes=this._bytes+t,this.bytesNext())},e.prototype.allocated=function(e){return void 0===e?this._bytes:(this.assertIdentifier(e),this._bytesByIdentifier.get(e))},e.prototype.toString=function(){var e=new Array;return this._bytesByIdentifier.forEach(function(t,r){e.push(r+": "+i.prettyPrintBytes(t))}),e.join(", ")},e.prototype.bytesToString=function(e){return i.prettyPrintBytes(this.allocated(e))},Object.defineProperty(e.prototype,"bytes",{get:function(){return this._bytes},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bytes$",{get:function(){return this._bytesSubject.asObservable()},enumerable:!0,configurable:!0}),e}();t.AllocationRegister=o},function(e){e.exports=[{identifier:"chrome-63",backend:"webgl2",extensions_strive:["EXT_color_buffer_float","EXT_disjoint_timer_query_webgl2","EXT_texture_filter_anisotropic","OES_texture_float_linear","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_debug_renderer_info","WEBGL_debug_shaders","WEBGL_lose_context"]},{identifier:"edge-41",backend:"webgl1",extensions_strive:["ANGLE_instanced_arrays","EXT_frag_depth","EXT_texture_filter_anisotropic","OES_texture_float","OES_texture_float_linear","OES_standard_derivatives","OES_element_index_uint","OES_texture_half_float","OES_texture_half_float_linear","WEBGL_compressed_texture_s3tc","WEBGL_debug_renderer_info","WEBGL_depth_texture"]},{identifier:"ie-11",backend:"webgl1",extensions_strive:["ANGLE_instanced_arrays","EXT_texture_filter_anisotropic","OES_texture_float","OES_texture_float_linear","OES_standard_derivatives","OES_element_index_uint","WEBGL_compressed_texture_s3tc","WEBGL_debug_renderer_info"]},{identifier:"firefox-57",backend:"webgl2",extensions_strive:["EXT_color_buffer_float","EXT_texture_filter_anisotropic","EXT_disjoint_timer_query","OES_texture_float_linear","WEBGL_compressed_texture_s3tc","WEBGL_debug_renderer_info","WEBGL_debug_shaders","WEBGL_lose_context","MOZ_WEBGL_lose_context","MOZ_WEBGL_compressed_texture_s3tc"]},{identifier:"safari-10.1",backend:"webgl1",extensions_strive:["compressed_texture_pvrtc","compressed_texture_s3tc","debug_renderer_info","disjoint_timer_query","draw_buffers","element_index_uint","frag_depth","instanced_arrays","lose_context","sRGB","shader_texture_lod","standard_derivatives","texture_filter_anisotropic","texture_float","texture_float_linear","texture_half_float","texture_half_float_linear","vertex_array_object"],functions_undefine:["readBuffer"]},{identifier:"no-WEBGL_draw_buffers",backend:"webgl1",extensions_conceal:["WEBGL_draw_buffers"]},{identifier:"no-readBuffer",extensions_hash:"100000",functions_undefine:["readBuffer"]},{identifier:"webgl1",extensions_hash:"1+++++"},{identifier:"webgl2",extensions_hash:"2+++++"}]},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(15),o=function(){function e(e){this.drawBuffers=void 0,n.assert(void 0!==e,"gl2 facade expects a valid WebGL context"),this.queryHalfFloatSupport(e),this.queryColorAttachments(e),this.queryInstancedArraySupport(e),this.queryDrawBuffersSupport(e),this.queryVertexArrayObjectSupport(e),this.queryMaxUniformVec3Components(e),this.queryTexImageInterface(e)}return Object.defineProperty(e.prototype,"HALF_FLOAT",{get:function(){return this._halfFloat},enumerable:!0,configurable:!0}),e.prototype.queryHalfFloatSupport=function(e){switch(e.backend){case i.Context.BackendType.WebGL1:this._halfFloat=e.supportsTextureHalfFloat&&e.textureHalfFloat?e.textureHalfFloat.HALF_FLOAT_OES:void 0;break;case i.Context.BackendType.WebGL2:default:this._halfFloat=e.gl.HALF_FLOAT}},Object.defineProperty(e.prototype,"COLOR_ATTACHMENT_MIN",{get:function(){return this._colorAttachmentMin},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"COLOR_ATTACHMENT_MAX",{get:function(){return this._colorAttachmentMax},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"COLOR_ATTACHMENT0",{get:function(){return this._colorAttachments[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"COLOR_ATTACHMENT1",{get:function(){return this._colorAttachments[1]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"COLOR_ATTACHMENT2",{get:function(){return this._colorAttachments[2]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"COLOR_ATTACHMENT3",{get:function(){return this._colorAttachments[3]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"COLOR_ATTACHMENT4",{get:function(){return this._colorAttachments[4]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"COLOR_ATTACHMENT5",{get:function(){return this._colorAttachments[5]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"COLOR_ATTACHMENT6",{get:function(){return this._colorAttachments[6]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"COLOR_ATTACHMENT7",{get:function(){return this._colorAttachments[7]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"COLOR_ATTACHMENT8",{get:function(){return this._colorAttachments[8]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"COLOR_ATTACHMENT9",{get:function(){return this._colorAttachments[9]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"COLOR_ATTACHMENT10",{get:function(){return this._colorAttachments[10]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"COLOR_ATTACHMENT11",{get:function(){return this._colorAttachments[11]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"COLOR_ATTACHMENT12",{get:function(){return this._colorAttachments[12]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"COLOR_ATTACHMENT13",{get:function(){return this._colorAttachments[13]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"COLOR_ATTACHMENT14",{get:function(){return this._colorAttachments[14]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"COLOR_ATTACHMENT15",{get:function(){return this._colorAttachments[15]},enumerable:!0,configurable:!0}),e.prototype.queryColorAttachments=function(e){var t=e.gl;switch(this._colorAttachments=new Array(16),this._colorAttachments[0]=t.COLOR_ATTACHMENT0,e.backend){case i.Context.BackendType.WebGL1:var r=e.supportsDrawBuffers?e.drawBuffers:void 0;if(this._colorAttachmentMin=this._colorAttachments[0],this._colorAttachmentMax=this._colorAttachmentMin+(r?t.getParameter(r.MAX_COLOR_ATTACHMENTS_WEBGL):0),this._colorAttachments[0]=r?r.COLOR_ATTACHMENT0_WEBGL:t.COLOR_ATTACHMENT0,!r)break;for(var n=1;n<16;++n)this._colorAttachments[n]=r.COLOR_ATTACHMENT0_WEBGL+n;break;case i.Context.BackendType.WebGL2:default:this._colorAttachmentMin=e.gl.COLOR_ATTACHMENT0,this._colorAttachmentMax=e.gl.COLOR_ATTACHMENT0+t.getParameter(t.MAX_COLOR_ATTACHMENTS);for(n=0;n<16;++n)this._colorAttachments[n]=t.COLOR_ATTACHMENT0+n}},e.prototype.queryInstancedArraySupport=function(e){(e.isWebGL2||e.supportsInstancedArrays)&&(this.drawArraysInstanced=e.isWebGL2?function(t,r,n,i){return e.gl.drawArraysInstanced(t,r,n,i)}:function(t,r,n,i){return e.instancedArrays.drawArraysInstancedANGLE(t,r,n,i)},this.drawElementsInstanced=e.isWebGL2?function(t,r,n,i,o){return e.gl.drawElementsInstanced(t,r,n,i,o)}:function(t,r,n,i,o){return e.instancedArrays.drawElementsInstancedANGLE(t,r,n,i,o)},this.vertexAttribDivisor=e.isWebGL2?function(t,r){return e.gl.vertexAttribDivisor(t,r)}:function(t,r){return e.instancedArrays.vertexAttribDivisorANGLE(t,r)})},e.prototype.queryDrawBuffersSupport=function(e){(e.isWebGL2||e.supportsDrawBuffers)&&(this.drawBuffers=e.isWebGL2?function(t){return e.gl.drawBuffers(t)}:function(t){return e.drawBuffers.drawBuffersWEBGL(t)})},e.prototype.queryVertexArrayObjectSupport=function(e){(e.isWebGL2||e.supportsVertexArrayObject)&&(this.createVertexArray=e.isWebGL2?function(){return e.gl.createVertexArray()}:function(){return e.vertexArrayObject.createVertexArrayOES()},this.deleteVertexArray=e.isWebGL2?function(t){return e.gl.deleteVertexArray(t)}:function(t){return e.vertexArrayObject.deleteVertexArrayOES(t)},this.isVertexArray=e.isWebGL2?function(t){return e.gl.isVertexArray(t)}:function(t){return e.vertexArrayObject.isVertexArrayOES(t)},this.bindVertexArray=e.isWebGL2?function(t){return e.gl.bindVertexArray(t)}:function(t){return e.vertexArrayObject.bindVertexArrayOES(t)})},Object.defineProperty(e.prototype,"maxUniformVec3Components",{get:function(){return this._maxUniformVec3Components},enumerable:!0,configurable:!0}),e.prototype.queryMaxUniformVec3Components=function(e){var t=e.gl;this._maxUniformVec3Components=e.isWebGL2?t.getParameter(t.MAX_VERTEX_UNIFORM_COMPONENTS):3*t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS)},e.prototype.queryTexImageInterface=function(e){var t=e.gl;e.isWebGL2?this.texImage2D=function(e,r,i,o,a,s,u,c,f,l){return f instanceof ArrayBuffer?t.texImage2D(e,r,i,o,a,s,u,c,void 0===f?null:f,l):(n.assert(void 0===l,"offset expected to be undefined for non ArrayBuffer source"),t.texImage2D(e,r,i,o,a,s,u,c,void 0===f?null:f))}:this.texImage2D=function(e,r,n,i,o,a,s,u,c,f){return void 0===c?t.texImage2D(e,r,n,i,o,a,s,u,null):c instanceof Int8Array||c instanceof Uint8Array||c instanceof Uint8ClampedArray||c instanceof Int16Array||c instanceof Uint16Array||c instanceof Int32Array||c instanceof Uint32Array||c instanceof Float32Array||c instanceof Float64Array||c instanceof DataView?t.texImage2D(e,r,n,i,o,a,s,u,c):t.texImage2D(e,r,n,s,u,c)}},e}();t.GL2Facade=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=function(){function e(){if(this._resizeEventListener=function(){return e.resize()},0===e.instances.length){var t="on"+e.EVENT_IDENTIFIER;e.eventSupported=document&&(t in document.documentElement||t in document.body),n.logIf(!e.eventSupported,n.LogLevel.Warning,"resize event not supported")}0===e.instances.length&&e.eventSupported&&window.addEventListener(e.EVENT_IDENTIFIER,this._resizeEventListener),e.instances.push(this)}return e.resize=function(){n.assert(e.instances.length>0,"resize event received without a single resizable registered"),e.instances.forEach(function(e){return e.onResize()})},e.elementSize=function(e){if(void 0===e||void 0===window||"number"!=typeof window.devicePixelRatio)return[0,0];var t=window.devicePixelRatio,r=getComputedStyle(e),n=[parseInt(r.width,10),parseInt(r.height,10)];return n[0]=Math.round(n[0]*t),n[1]=Math.round(n[1]*t),n},e.prototype.dispose=function(){var t=e.instances.indexOf(this);n.assert(-1!==t,"invalid reference counting of resizable instances"),e.instances.splice(t,1),0===e.instances.length&&e.eventSupported&&window.removeEventListener(e.EVENT_IDENTIFIER,this._resizeEventListener)},e.EVENT_IDENTIFIER="resize",e.instances=[],e.eventSupported=!1,e}();t.Resizable=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),i=r(0),o=r(17),a=r(45),s=function(){function e(){this._colors=new Array}return e.stride=function(t){switch(t){default:case e.ArrayType.RGB:case e.ArrayType.RGBf:return 3;case e.ArrayType.RGBA:case e.ArrayType.RGBAf:return 4}},e.fromPreset=function(t,r,n){return a.fetchJsonAsync(t,function(t){for(var i,o=0,a=t;o<a.length;o++){var s=a[o];if(s.identifier===r){i=s;break}}if(void 0!==i){for(var u=i.format,c=e.stride(u),f=i.colors,l=f.length-1,h=0;h<f.length;++h)if(f[h].length===n*c){l=h;break}var p,_=f[l],d=i.positions;if(void 0===d)return e.fromArray(_,u,n,void 0);for(h=0;h<d.length;++h)d[h].length===_.length&&(p=d[h]);return e.fromArray(_,u,n,p)}},e.SCHEMA.properties)},e.fromArray=function(t,r,n,a){if(0===n||0===t.length)return new e;for(var s=t,u=e.stride(r),c=s.length/u,f=new Array(c),l=0;l<s.length;l+=u){var h=new o.Color;switch(r){case e.ArrayType.RGB:h.fromUI8(s[l+0],s[l+1],s[l+2]);break;case e.ArrayType.RGBA:h.fromUI8(s[l+0],s[l+1],s[l+2],s[l+3]);break;case e.ArrayType.RGBf:h.fromF32(s[l+0],s[l+1],s[l+2]);break;case e.ArrayType.RGBAf:h.fromF32(s[l+0],s[l+1],s[l+2],s[l+3])}f[l/u]=h}var p=new e;if(void 0===a&&n===c)return p._colors=f,p;if(1===n&&p._colors.push(f[0]),void 0===a){(a=new Array(c))[0]=0;for(l=1;l<c;++l)a[l]=l/(c-1)}i.assert(a.length===f.length,"expected number of positions to match number of colors");var _=0,d=_+1,b=c-1;for(l=0;l<n;++l){var m=0===l?0:l/(n-1);if(m<=a[_])p._colors.push(f[_]);else if(a[b]<=m)p._colors.push(f[b]);else{for(var v=_+1;v<c;++v)if(!(a[v]<m)){d=v,_=v-1;break}var g=(m-a[_])/(a[d]-a[_]);p._colors.push(o.Color.mix(f[_],f[d],g,o.Color.Space.LAB))}}return p},e.prototype.lerp=function(t,r){if(void 0===r&&(r=o.Color.Space.LAB),0!==this._colors.length){if(1===this._colors.length)return this._colors[0];var a=n.clamp(t,0,1);if(a<=0)return this._colors[0];if(a>=1)return this._colors[this._colors.length-1];var s=t*this._colors.length,u=Math.floor(s),c=u+1;return i.assert(c<this._colors.length,"expected upper not exceed maximum color index"),this._hint===e.InterpolationHint.Nearest?this._colors[s-u>c-s?u:c]:o.Color.mix(this._colors[u],this._colors[c],s-u,r)}},e.prototype.color=function(e){if(!(e<0||e>=this._colors.length))return this._colors[e]},Object.defineProperty(e.prototype,"colors",{get:function(){return this._colors},set:function(e){this._colors=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hint",{get:function(){return this._hint},set:function(e){this._hint=e},enumerable:!0,configurable:!0}),e.prototype.bitsUI8=function(e,t){void 0===e&&(e=o.Color.Space.RGB),void 0===t&&(t=!0);for(var r=this._colors.length,n=t?4:3,i=new Uint8Array(r*n),a=0;a<r;++a){var s=this._colors[a].tuple(e,t);i[a*n+0]=255*s[0],i[a*n+1]=255*s[1],i[a*n+2]=255*s[2],t&&(i[a*n+3]=255*s[3])}return i},e.prototype.bitsF32=function(e,t){void 0===e&&(e=o.Color.Space.RGB),void 0===t&&(t=!0);for(var r=this._colors.length,n=t?4:3,i=new Float32Array(r*n),a=0;a<r;++a){var s=this._colors[a].tuple(e,t);i[a*n+0]=s[0],i[a*n+1]=s[1],i[a*n+2]=s[2],t&&(i[a*n+3]=s[3])}return i},Object.defineProperty(e.prototype,"length",{get:function(){return this._colors.length},enumerable:!0,configurable:!0}),e.SCHEMA=r(70),e}();t.ColorScale=s,function(e){!function(e){e.Linear="linear",e.Nearest="nearest"}(e.InterpolationHint||(e.InterpolationHint={})),function(e){e.sequential="sequential",e.diverging="diverging",e.qualitative="qualitative"}(e.ScaleType||(e.ScaleType={})),function(e){e.RGB="rgb",e.RGBf="rgbf",e.RGBA="rgba",e.RGBAf="rgbaf"}(e.ArrayType||(e.ArrayType={}))}(s=t.ColorScale||(t.ColorScale={})),t.ColorScale=s},function(e,t,r){"use strict";var n=e.exports.Validator=r(61);e.exports.ValidatorResult=r(6).ValidatorResult,e.exports.ValidationError=r(6).ValidationError,e.exports.SchemaError=r(6).SchemaError,e.exports.SchemaScanResult=r(24).SchemaScanResult,e.exports.scan=r(24).scan,e.exports.validate=function(e,t,r){return(new n).validate(e,t,r)}},function(e,t,r){"use strict";var n=r(23),i=r(69),o=r(6),a=r(24).scan,s=o.ValidatorResult,u=o.SchemaError,c=o.SchemaContext,f=function e(){this.customFormats=Object.create(e.prototype.customFormats),this.schemas={},this.unresolvedRefs=[],this.types=Object.create(h),this.attributes=Object.create(i.validators)};function l(e){var t="string"==typeof e?e:e.$ref;return"string"==typeof t&&t}f.prototype.customFormats={},f.prototype.schemas=null,f.prototype.types=null,f.prototype.attributes=null,f.prototype.unresolvedRefs=null,f.prototype.addSchema=function(e,t){var r=this;if(!e)return null;var n=a(t||"/",e),i=t||e.id;for(var o in n.id)this.schemas[o]=n.id[o];for(var o in n.ref)this.unresolvedRefs.push(o);return this.unresolvedRefs=this.unresolvedRefs.filter(function(e){return void 0===r.schemas[e]}),this.schemas[i]},f.prototype.addSubSchemaArray=function(e,t){if(t instanceof Array)for(var r=0;r<t.length;r++)this.addSubSchema(e,t[r])},f.prototype.addSubSchemaObject=function(e,t){if(t&&"object"==typeof t)for(var r in t)this.addSubSchema(e,t[r])},f.prototype.setSchemas=function(e){this.schemas=e},f.prototype.getSchema=function(e){return this.schemas[e]},f.prototype.validate=function(e,t,r,i){r||(r={});var o=r.propertyName||"instance",s=n.resolve(r.base||"/",t.id||"");if(!i){(i=new c(t,r,o,s,Object.create(this.schemas))).schemas[s]||(i.schemas[s]=t);var f=a(s,t);for(var l in f.id){var h=f.id[l];i.schemas[l]=h}}if(t){var p=this.validateSchema(e,t,r,i);if(!p)throw new Error("Result undefined");return p}throw new u("no schema specified",t)},f.prototype.validateSchema=function(e,t,r,n){var a,f=new s(e,t,r,n);if("boolean"==typeof t)!0===t?t={}:!1===t&&(t={type:[]});else if(!t)throw new Error("schema is undefined");if(t.extends)if(t.extends instanceof Array){var h={schema:t,ctx:n};t.extends.forEach(this.schemaTraverser.bind(this,h)),t=h.schema,h.schema=null,h.ctx=null,h=null}else t=o.deepMerge(t,this.superResolve(t.extends,n));if(a=l(t)){var p=this.resolve(t,a,n),_=new c(p.subschema,r,n.propertyPath,p.switchSchema,n.schemas);return this.validateSchema(e,p.subschema,r,_)}var d=r&&r.skipAttributes||[];for(var b in t)if(!i.ignoreProperties[b]&&d.indexOf(b)<0){var m=null,v=this.attributes[b];if(v)m=v.call(this,e,t,r,n);else if(!1===r.allowUnknownAttributes)throw new u("Unsupported attribute: "+b,t);m&&f.importErrors(m)}if("function"==typeof r.rewrite){var g=r.rewrite.call(this,e,t,r,n);f.instance=g}return f},f.prototype.schemaTraverser=function(e,t){e.schema=o.deepMerge(e.schema,this.superResolve(t,e.ctx))},f.prototype.superResolve=function(e,t){var r;return(r=l(e))?this.resolve(e,r,t).subschema:e},f.prototype.resolve=function(e,t,r){if(t=r.resolve(t),r.schemas[t])return{subschema:r.schemas[t],switchSchema:t};var i=n.parse(t),a=i&&i.hash,s=a&&a.length&&t.substr(0,t.length-a.length);if(!s||!r.schemas[s])throw new u("no such schema <"+t+">",e);var c=o.objectGetPath(r.schemas[s],a.substr(1));if(void 0===c)throw new u("no such schema "+a+" located in <"+s+">",e);return{subschema:c,switchSchema:t}},f.prototype.testType=function(e,t,r,n,i){if("function"==typeof this.types[i])return this.types[i].call(this,e);if(i&&"object"==typeof i){var o=this.validateSchema(e,i,r,n);return void 0===o||!(o&&o.errors.length)}return!0};var h=f.prototype.types={};h.string=function(e){return"string"==typeof e},h.number=function(e){return"number"==typeof e&&isFinite(e)},h.integer=function(e){return"number"==typeof e&&e%1==0},h.boolean=function(e){return"boolean"==typeof e},h.array=function(e){return Array.isArray(e)},h.null=function(e){return null===e},h.date=function(e){return e instanceof Date},h.any=function(e){return!0},h.object=function(e){return e&&"object"==typeof e&&!(e instanceof Array)&&!(e instanceof Date)},e.exports=f},function(e,t,r){(function(e,n){var i;/*! https://mths.be/punycode v1.4.1 by @mathias */!function(o){"object"==typeof t&&t&&t.nodeType,"object"==typeof e&&e&&e.nodeType;var a="object"==typeof n&&n;a.global!==a&&a.window!==a&&a.self;var s,u=2147483647,c=36,f=1,l=26,h=38,p=700,_=72,d=128,b="-",m=/^xn--/,v=/[^\x20-\x7E]/,g=/[\x2E\u3002\uFF0E\uFF61]/g,y={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},E=c-f,x=Math.floor,T=String.fromCharCode;function M(e){throw new RangeError(y[e])}function O(e,t){for(var r=e.length,n=[];r--;)n[r]=t(e[r]);return n}function A(e,t){var r=e.split("@"),n="";return r.length>1&&(n=r[0]+"@",e=r[1]),n+O((e=e.replace(g,".")).split("."),t).join(".")}function P(e){for(var t,r,n=[],i=0,o=e.length;i<o;)(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<o?56320==(64512&(r=e.charCodeAt(i++)))?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),i--):n.push(t);return n}function R(e){return O(e,function(e){var t="";return e>65535&&(t+=T((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=T(e)}).join("")}function w(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:c}function S(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function j(e,t,r){var n=0;for(e=r?x(e/p):e>>1,e+=x(e/t);e>E*l>>1;n+=c)e=x(e/E);return x(n+(E+1)*e/(e+h))}function L(e){var t,r,n,i,o,a,s,h,p,m,v=[],g=e.length,y=0,E=d,T=_;for((r=e.lastIndexOf(b))<0&&(r=0),n=0;n<r;++n)e.charCodeAt(n)>=128&&M("not-basic"),v.push(e.charCodeAt(n));for(i=r>0?r+1:0;i<g;){for(o=y,a=1,s=c;i>=g&&M("invalid-input"),((h=w(e.charCodeAt(i++)))>=c||h>x((u-y)/a))&&M("overflow"),y+=h*a,!(h<(p=s<=T?f:s>=T+l?l:s-T));s+=c)a>x(u/(m=c-p))&&M("overflow"),a*=m;T=j(y-o,t=v.length+1,0==o),x(y/t)>u-E&&M("overflow"),E+=x(y/t),y%=t,v.splice(y++,0,E)}return R(v)}function F(e){var t,r,n,i,o,a,s,h,p,m,v,g,y,E,O,A=[];for(g=(e=P(e)).length,t=d,r=0,o=_,a=0;a<g;++a)(v=e[a])<128&&A.push(T(v));for(n=i=A.length,i&&A.push(b);n<g;){for(s=u,a=0;a<g;++a)(v=e[a])>=t&&v<s&&(s=v);for(s-t>x((u-r)/(y=n+1))&&M("overflow"),r+=(s-t)*y,t=s,a=0;a<g;++a)if((v=e[a])<t&&++r>u&&M("overflow"),v==t){for(h=r,p=c;!(h<(m=p<=o?f:p>=o+l?l:p-o));p+=c)O=h-m,E=c-m,A.push(T(S(m+O%E,0))),h=x(O/E);A.push(T(S(h,0))),o=j(r,y,n==i),r=0,++n}++r,++t}return A.join("")}s={version:"1.4.1",ucs2:{decode:P,encode:R},decode:L,encode:F,toASCII:function(e){return A(e,function(e){return v.test(e)?"xn--"+F(e):e})},toUnicode:function(e){return A(e,function(e){return m.test(e)?L(e.slice(4).toLowerCase()):e})}},void 0===(i=function(){return s}.call(t,r,t,e))||(e.exports=i)}()}).call(this,r(63)(e),r(64))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){"use strict";e.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},function(e,t,r){"use strict";t.decode=t.parse=r(67),t.encode=t.stringify=r(68)},function(e,t,r){"use strict";function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,r,o){t=t||"&",r=r||"=";var a={};if("string"!=typeof e||0===e.length)return a;var s=/\+/g;e=e.split(t);var u=1e3;o&&"number"==typeof o.maxKeys&&(u=o.maxKeys);var c=e.length;u>0&&c>u&&(c=u);for(var f=0;f<c;++f){var l,h,p,_,d=e[f].replace(s,"%20"),b=d.indexOf(r);b>=0?(l=d.substr(0,b),h=d.substr(b+1)):(l=d,h=""),p=decodeURIComponent(l),_=decodeURIComponent(h),n(a,p)?i(a[p])?a[p].push(_):a[p]=[a[p],_]:a[p]=_}return a};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,r){"use strict";var n=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,r,s){return t=t||"&",r=r||"=",null===e&&(e=void 0),"object"==typeof e?o(a(e),function(a){var s=encodeURIComponent(n(a))+r;return i(e[a])?o(e[a],function(e){return s+encodeURIComponent(n(e))}).join(t):s+encodeURIComponent(n(e[a]))}).join(t):s?encodeURIComponent(n(s))+r+encodeURIComponent(n(e)):""};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function o(e,t){if(e.map)return e.map(t);for(var r=[],n=0;n<e.length;n++)r.push(t(e[n],n));return r}var a=Object.keys||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t}},function(e,t,r){"use strict";var n=r(6),i=n.ValidatorResult,o=n.SchemaError,a={ignoreProperties:{id:!0,default:!0,description:!0,title:!0,exclusiveMinimum:!0,exclusiveMaximum:!0,additionalItems:!0,$schema:!0,$ref:!0,extends:!0}},s=a.validators={};function u(e,t,r,n,i){var o=t.throwError;t.throwError=!1;var a=this.validateSchema(e,i,t,r);return t.throwError=o,!a.valid&&n instanceof Function&&n(a),a.valid}function c(e,t,r,n,i,o){if(this.types.object(e)&&(!t.properties||void 0===t.properties[i]))if(!1===t.additionalProperties)o.addError({name:"additionalProperties",argument:i,message:"additionalProperty "+JSON.stringify(i)+" exists in instance when not allowed"});else{var a=t.additionalProperties||{};"function"==typeof r.preValidateProperty&&r.preValidateProperty(e,i,a,r,n);var s=this.validateSchema(e[i],a,r,n.makeChild(a,i));s.instance!==o.instance[i]&&(o.instance[i]=s.instance),o.importErrors(s)}}s.type=function(e,t,r,n){if(void 0===e)return null;var o=new i(e,t,r,n),a=Array.isArray(t.type)?t.type:[t.type];if(!a.some(this.testType.bind(this,e,t,r,n))){var s=a.map(function(e){return e.id&&"<"+e.id+">"||e+""});o.addError({name:"type",argument:s,message:"is not of a type(s) "+s})}return o},s.anyOf=function(e,t,r,n){if(void 0===e)return null;var a=new i(e,t,r,n),s=new i(e,t,r,n);if(!Array.isArray(t.anyOf))throw new o("anyOf must be an array");if(!t.anyOf.some(u.bind(this,e,r,n,function(e){s.importErrors(e)}))){var c=t.anyOf.map(function(e,t){return e.id&&"<"+e.id+">"||e.title&&JSON.stringify(e.title)||e.$ref&&"<"+e.$ref+">"||"[subschema "+t+"]"});r.nestedErrors&&a.importErrors(s),a.addError({name:"anyOf",argument:c,message:"is not any of "+c.join(",")})}return a},s.allOf=function(e,t,r,n){if(void 0===e)return null;if(!Array.isArray(t.allOf))throw new o("allOf must be an array");var a=new i(e,t,r,n),s=this;return t.allOf.forEach(function(t,i){var o=s.validateSchema(e,t,r,n);if(!o.valid){var u=t.id&&"<"+t.id+">"||t.title&&JSON.stringify(t.title)||t.$ref&&"<"+t.$ref+">"||"[subschema "+i+"]";a.addError({name:"allOf",argument:{id:u,length:o.errors.length,valid:o},message:"does not match allOf schema "+u+" with "+o.errors.length+" error[s]:"}),a.importErrors(o)}}),a},s.oneOf=function(e,t,r,n){if(void 0===e)return null;if(!Array.isArray(t.oneOf))throw new o("oneOf must be an array");var a=new i(e,t,r,n),s=new i(e,t,r,n),c=t.oneOf.filter(u.bind(this,e,r,n,function(e){s.importErrors(e)})).length,f=t.oneOf.map(function(e,t){return e.id&&"<"+e.id+">"||e.title&&JSON.stringify(e.title)||e.$ref&&"<"+e.$ref+">"||"[subschema "+t+"]"});return 1!==c&&(r.nestedErrors&&a.importErrors(s),a.addError({name:"oneOf",argument:f,message:"is not exactly one from "+f.join(",")})),a},s.properties=function(e,t,r,n){if(this.types.object(e)){var o=new i(e,t,r,n),a=t.properties||{};for(var s in a){"function"==typeof r.preValidateProperty&&r.preValidateProperty(e,s,a[s],r,n);var u=Object.hasOwnProperty.call(e,s)?e[s]:void 0,c=this.validateSchema(u,a[s],r,n.makeChild(a[s],s));c.instance!==o.instance[s]&&(o.instance[s]=c.instance),o.importErrors(c)}return o}},s.patternProperties=function(e,t,r,n){if(this.types.object(e)){var o=new i(e,t,r,n),a=t.patternProperties||{};for(var s in e){var u=!0;for(var f in a){if(new RegExp(f).test(s)){u=!1,"function"==typeof r.preValidateProperty&&r.preValidateProperty(e,s,a[f],r,n);var l=this.validateSchema(e[s],a[f],r,n.makeChild(a[f],s));l.instance!==o.instance[s]&&(o.instance[s]=l.instance),o.importErrors(l)}}u&&c.call(this,e,t,r,n,s,o)}return o}},s.additionalProperties=function(e,t,r,n){if(this.types.object(e)){if(t.patternProperties)return null;var o=new i(e,t,r,n);for(var a in e)c.call(this,e,t,r,n,a,o);return o}},s.minProperties=function(e,t,r,n){if(this.types.object(e)){var o=new i(e,t,r,n);return Object.keys(e).length>=t.minProperties||o.addError({name:"minProperties",argument:t.minProperties,message:"does not meet minimum property length of "+t.minProperties}),o}},s.maxProperties=function(e,t,r,n){if(this.types.object(e)){var o=new i(e,t,r,n);return Object.keys(e).length<=t.maxProperties||o.addError({name:"maxProperties",argument:t.maxProperties,message:"does not meet maximum property length of "+t.maxProperties}),o}},s.items=function(e,t,r,n){var o=this;if(this.types.array(e)&&t.items){var a=new i(e,t,r,n);return e.every(function(e,i){var s=Array.isArray(t.items)?t.items[i]||t.additionalItems:t.items;if(void 0===s)return!0;if(!1===s)return a.addError({name:"items",message:"additionalItems not permitted"}),!1;var u=o.validateSchema(e,s,r,n.makeChild(s,i));return u.instance!==a.instance[i]&&(a.instance[i]=u.instance),a.importErrors(u),!0}),a}},s.minimum=function(e,t,r,n){if(this.types.number(e)){var o=new i(e,t,r,n);return(t.exclusiveMinimum&&!0===t.exclusiveMinimum?e>t.minimum:e>=t.minimum)||o.addError({name:"minimum",argument:t.minimum,message:"must have a minimum value of "+t.minimum}),o}},s.maximum=function(e,t,r,n){if(this.types.number(e)){var o=new i(e,t,r,n);return(t.exclusiveMaximum&&!0===t.exclusiveMaximum?e<t.maximum:e<=t.maximum)||o.addError({name:"maximum",argument:t.maximum,message:"must have a maximum value of "+t.maximum}),o}};var f=function(e,t,r,a,s,u){if(this.types.number(e)){var c=t[s];if(0==c)throw new o(s+" cannot be zero");var f=new i(e,t,r,a),l=n.getDecimalPlaces(e),h=n.getDecimalPlaces(c),p=Math.max(l,h),_=Math.pow(10,p);return Math.round(e*_)%Math.round(c*_)!=0&&f.addError({name:s,argument:c,message:u+JSON.stringify(c)}),f}};function l(e,t,r){var i,o=r.length;for(i=t+1;i<o;i++)if(n.deepCompareStrict(e,r[i]))return!1;return!0}s.multipleOf=function(e,t,r,n){return f.call(this,e,t,r,n,"multipleOf","is not a multiple of (divisible by) ")},s.divisibleBy=function(e,t,r,n){return f.call(this,e,t,r,n,"divisibleBy","is not divisible by (multiple of) ")},s.required=function(e,t,r,n){var o=new i(e,t,r,n);return void 0===e&&!0===t.required?o.addError({name:"required",message:"is required"}):this.types.object(e)&&Array.isArray(t.required)&&t.required.forEach(function(t){void 0===e[t]&&o.addError({name:"required",argument:t,message:"requires property "+JSON.stringify(t)})}),o},s.pattern=function(e,t,r,n){if(this.types.string(e)){var o=new i(e,t,r,n);return e.match(t.pattern)||o.addError({name:"pattern",argument:t.pattern,message:"does not match pattern "+JSON.stringify(t.pattern)}),o}},s.format=function(e,t,r,o){if(void 0!==e){var a=new i(e,t,r,o);return a.disableFormat||n.isFormat(e,t.format,this)||a.addError({name:"format",argument:t.format,message:"does not conform to the "+JSON.stringify(t.format)+" format"}),a}},s.minLength=function(e,t,r,n){if(this.types.string(e)){var o=new i(e,t,r,n),a=e.match(/[\uDC00-\uDFFF]/g);return e.length-(a?a.length:0)>=t.minLength||o.addError({name:"minLength",argument:t.minLength,message:"does not meet minimum length of "+t.minLength}),o}},s.maxLength=function(e,t,r,n){if(this.types.string(e)){var o=new i(e,t,r,n),a=e.match(/[\uDC00-\uDFFF]/g);return e.length-(a?a.length:0)<=t.maxLength||o.addError({name:"maxLength",argument:t.maxLength,message:"does not meet maximum length of "+t.maxLength}),o}},s.minItems=function(e,t,r,n){if(this.types.array(e)){var o=new i(e,t,r,n);return e.length>=t.minItems||o.addError({name:"minItems",argument:t.minItems,message:"does not meet minimum length of "+t.minItems}),o}},s.maxItems=function(e,t,r,n){if(this.types.array(e)){var o=new i(e,t,r,n);return e.length<=t.maxItems||o.addError({name:"maxItems",argument:t.maxItems,message:"does not meet maximum length of "+t.maxItems}),o}},s.uniqueItems=function(e,t,r,o){if(this.types.array(e)){var a=new i(e,t,r,o);return e.every(function(e,t,r){for(var i=t+1;i<r.length;i++)if(n.deepCompareStrict(e,r[i]))return!1;return!0})||a.addError({name:"uniqueItems",message:"contains duplicate item"}),a}},s.uniqueItems=function(e,t,r,n){if(this.types.array(e)){var o=new i(e,t,r,n);return e.every(l)||o.addError({name:"uniqueItems",message:"contains duplicate item"}),o}},s.dependencies=function(e,t,r,n){if(this.types.object(e)){var o=new i(e,t,r,n);for(var a in t.dependencies)if(void 0!==e[a]){var s=t.dependencies[a],u=n.makeChild(s,a);if("string"==typeof s&&(s=[s]),Array.isArray(s))s.forEach(function(t){void 0===e[t]&&o.addError({name:"dependencies",argument:u.propertyPath,message:"property "+t+" not found, required by "+u.propertyPath})});else{var c=this.validateSchema(e,s,r,u);o.instance!==c.instance&&(o.instance=c.instance),c&&c.errors.length&&(o.addError({name:"dependencies",argument:u.propertyPath,message:"does not meet dependency required by "+u.propertyPath}),o.importErrors(c))}}return o}},s.enum=function(e,t,r,a){if(void 0===e)return null;if(!Array.isArray(t.enum))throw new o("enum expects an array",t);var s=new i(e,t,r,a);return t.enum.some(n.deepCompareStrict.bind(null,e))||s.addError({name:"enum",argument:t.enum,message:"is not one of enum values: "+t.enum.map(String).join(",")}),s},s.const=function(e,t,r,o){if(void 0===e)return null;var a=new i(e,t,r,o);return n.deepCompareStrict(t.const,e)||a.addError({name:"const",argument:t.const,message:"does not exactly match expected constant: "+t.const}),a},s.not=s.disallow=function(e,t,r,n){var o=this;if(void 0===e)return null;var a=new i(e,t,r,n),s=t.not||t.disallow;return s?(Array.isArray(s)||(s=[s]),s.forEach(function(i){if(o.testType(e,t,r,n,i)){var s=i&&i.id&&"<"+i.id+">"||i;a.addError({name:"not",argument:s,message:"is of prohibited type "+s})}}),a):null},e.exports=a},function(e){e.exports={id:"/ColorScalePresets",title:"Color Scale Presets Schema",description:"JSON schema for a color scale presets data, used in the webgl-operate module for validation.",type:"array",items:{type:"object",properties:{identifier:{type:"string"},type:{type:"string",enum:["sequential","diverging","qualitative"]},format:{type:"string",enum:["rgb","rgbf"]},colors:{type:"array",items:{type:"array",items:{type:["integer","number"]}}},positions:{type:"array",items:{type:"array",items:{type:["integer","number"]}}}},required:["identifier","format","colors"],additionalProperties:!1}}},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),a=r(25),s=r(1),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._size=0,t._internalFormat=0,t._format=0,t._type=0,t._bytes=[0,0,0,0,0,0],t}return n(t,e),t.prototype.faceID=function(e){var t=this._context.gl;switch(e){case t.TEXTURE_CUBE_MAP_POSITIVE_X:return 0;case t.TEXTURE_CUBE_MAP_NEGATIVE_X:return 1;case t.TEXTURE_CUBE_MAP_POSITIVE_Y:return 2;case t.TEXTURE_CUBE_MAP_NEGATIVE_Y:return 3;case t.TEXTURE_CUBE_MAP_POSITIVE_Z:return 4;case t.TEXTURE_CUBE_MAP_NEGATIVE_Z:return 5;default:return o.assert(!1,"expected texture cube map identifier ("+t.TEXTURE_CUBE_MAP_POSITIVE_X+", "+t.TEXTURE_CUBE_MAP_NEGATIVE_X+", "+t.TEXTURE_CUBE_MAP_POSITIVE_Y+", "+t.TEXTURE_CUBE_MAP_NEGATIVE_Y+", "+t.TEXTURE_CUBE_MAP_POSITIVE_Z+", or"+t.TEXTURE_CUBE_MAP_NEGATIVE_Z+"), given "+e),-1}},t.prototype.create=function(e,r,n,i){o.assert(e>0,"texture cube requires valid size (width/height) of greater than zero");var a=this._context.gl,s=this._context.gl2facade;return this._object=a.createTexture(),this._size=e,this._internalFormat=r,this._format=n,this._type=i,a.bindTexture(a.TEXTURE_CUBE_MAP,this._object),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),s.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X,0,this._internalFormat,this._size,this._size,0,this._format,this._type),s.texImage2D(a.TEXTURE_CUBE_MAP_NEGATIVE_X,0,this._internalFormat,this._size,this._size,0,this._format,this._type),s.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_Y,0,this._internalFormat,this._size,this._size,0,this._format,this._type),s.texImage2D(a.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,this._internalFormat,this._size,this._size,0,this._format,this._type),s.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_Z,0,this._internalFormat,this._size,this._size,0,this._format,this._type),s.texImage2D(a.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,this._internalFormat,this._size,this._size,0,this._format,this._type),a.bindTexture(a.TEXTURE_CUBE_MAP,t.DEFAULT_TEXTURE),this._valid=a.isTexture(this._object),this.context.allocationRegister.reallocate(this._identifier,0),this._object},t.prototype.delete=function(){o.assert(this._object instanceof WebGLTexture,"expected WebGLTexture object"),this._context.gl.deleteTexture(this._object),this._object=void 0,this._valid=!1,this._internalFormat=0,this._format=0,this._type=0,this._size=0},t.prototype.bind=function(e){var t=this.context.gl;e&&t.activeTexture(e),t.bindTexture(t.TEXTURE_CUBE_MAP,this._object)},t.prototype.unbind=function(e){var r=this.context.gl;e&&r.activeTexture(e),r.bindTexture(r.TEXTURE_CUBE_MAP,t.DEFAULT_TEXTURE)},t.prototype.load=function(e,t){var r=this;void 0===t&&(t=!1);var n=this.context.gl;return new Promise(function(i,a){var s=new Array;e.positiveX&&s.push([n.TEXTURE_CUBE_MAP_POSITIVE_X,e.positiveX]),e.negativeX&&s.push([n.TEXTURE_CUBE_MAP_NEGATIVE_X,e.negativeX]),e.positiveY&&s.push([n.TEXTURE_CUBE_MAP_POSITIVE_Y,e.positiveY]),e.negativeY&&s.push([n.TEXTURE_CUBE_MAP_NEGATIVE_Y,e.negativeY]),e.positiveZ&&s.push([n.TEXTURE_CUBE_MAP_POSITIVE_Z,e.positiveZ]),e.negativeZ&&s.push([n.TEXTURE_CUBE_MAP_NEGATIVE_Z,e.negativeZ]);for(var u=s.length,c=function(e){var n=new Image;n.onerror=function(){return a()},n.onload=function(){n.width===n.height?n.width===r._size?(r.data([e[0],n]),0===(u-=1)&&i()):o.log(o.LogLevel.Warning,"image ignored, width and height expected to match this texture's size "+r._size+", given "+n.width):o.log(o.LogLevel.Warning,"image ignored, width and height expected to be equal (square image)")},t&&(n.crossOrigin="anonymous"),n.src=e[1]},f=0,l=s;f<l.length;f++){c(l[f])}})},t.prototype.data=function(e,t,r){void 0===t&&(t=!0),void 0===r&&(r=!0);var n=this.context.gl,i=this.context.gl2facade,o=this._size*this._size*a.byteSizeOfFormat(this.context,this._internalFormat);if(this._type===this.context.gl2facade.HALF_FLOAT&&this._internalFormat!==this.context.gl.RGBA16F?o*=2:this._type===this.context.gl.FLOAT&&this._internalFormat!==this.context.gl.RGBA16F&&(o*=4),t&&this.bind(),e instanceof Array&&2===e.length){i.texImage2D(e[0],0,this._internalFormat,this._size,this._size,0,this._format,this._type,e[1]);var s=this.faceID(e[0]);this.context.allocationRegister.deallocate(this._identifier,this._bytes[s]),this.context.allocationRegister.allocate(this._identifier,o),this._bytes[s]=o}else{var u=e;void 0!==u.positiveX&&(i.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X,0,this._internalFormat,this._size,this._size,0,this._format,this._type,u.positiveX),this.context.allocationRegister.deallocate(this._identifier,this._bytes[0]),this.context.allocationRegister.allocate(this._identifier,o),this._bytes[0]=o),void 0!==u.negativeX&&(i.texImage2D(n.TEXTURE_CUBE_MAP_NEGATIVE_X,0,this._internalFormat,this._size,this._size,0,this._format,this._type,u.negativeX),this.context.allocationRegister.deallocate(this._identifier,this._bytes[1]),this.context.allocationRegister.allocate(this._identifier,o),this._bytes[1]=o),void 0!==u.positiveY&&(i.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_Y,0,this._internalFormat,this._size,this._size,0,this._format,this._type,u.positiveY),this.context.allocationRegister.deallocate(this._identifier,this._bytes[2]),this.context.allocationRegister.allocate(this._identifier,o),this._bytes[2]=o),void 0!==u.negativeY&&(i.texImage2D(n.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,this._internalFormat,this._size,this._size,0,this._format,this._type,u.negativeY),this.context.allocationRegister.deallocate(this._identifier,this._bytes[3]),this.context.allocationRegister.allocate(this._identifier,o),this._bytes[3]=o),void 0!==u.positiveZ&&(i.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_Z,0,this._internalFormat,this._size,this._size,0,this._format,this._type,u.positiveZ),this.context.allocationRegister.deallocate(this._identifier,this._bytes[4]),this.context.allocationRegister.allocate(this._identifier,o),this._bytes[4]=o),void 0!==u.negativeZ&&(i.texImage2D(n.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,this._internalFormat,this._size,this._size,0,this._format,this._type,u.negativeZ),this.context.allocationRegister.deallocate(this._identifier,this._bytes[5]),this.context.allocationRegister.allocate(this._identifier,o),this._bytes[5]=o)}r&&this.unbind()},t.prototype.filter=function(e,t,r,n){void 0===r&&(r=!0),void 0===n&&(n=!0);var i=this.context.gl;r&&this.bind(),i.texParameteri(i.TEXTURE_CUBE_MAP,i.TEXTURE_MAG_FILTER,e),i.texParameteri(i.TEXTURE_CUBE_MAP,i.TEXTURE_MIN_FILTER,t),n&&this.unbind()},t.prototype.wrap=function(e,t,r,n){void 0===r&&(r=!0),void 0===n&&(n=!0);var i=this.context.gl;r&&this.bind(),i.texParameteri(i.TEXTURE_CUBE_MAP,i.TEXTURE_WRAP_S,e),i.texParameteri(i.TEXTURE_CUBE_MAP,i.TEXTURE_WRAP_T,t),n&&this.unbind()},t.prototype.reformat=function(e,t,r,n,i){void 0===n&&(n=!0),void 0===i&&(i=!0),(e!==this._internalFormat||void 0!==t&&t!==this._format||void 0!==r&&r!==this._type)&&(o.assert(void 0!==e,"valid internal format expected"),this._internalFormat=e,t&&(this._format=t),r&&(this._type=r),this.data({clearOnUndefined:!0},n,i))},t.prototype.resize=function(e,t,r){void 0===t&&(t=!0),void 0===r&&(r=!0),e!==this._size&&(this._size=e,this.data({clearOnUndefined:!0},t,r))},Object.defineProperty(t.prototype,"bytes",{get:function(){return this.assertInitialized(),this.context.allocationRegister.allocated(this._identifier)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"internalFormat",{get:function(){return this.assertInitialized(),this._internalFormat},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"format",{get:function(){return this.assertInitialized(),this._format},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this.assertInitialized(),this._type},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.assertInitialized(),this._size},enumerable:!0,configurable:!0}),t.DEFAULT_TEXTURE=void 0,i([s.Initializable.assert_initialized()],t.prototype,"bind",null),i([s.Initializable.assert_initialized()],t.prototype,"unbind",null),i([s.Initializable.assert_initialized()],t.prototype,"load",null),i([s.Initializable.assert_initialized()],t.prototype,"data",null),i([s.Initializable.assert_initialized()],t.prototype,"filter",null),i([s.Initializable.assert_initialized()],t.prototype,"wrap",null),i([s.Initializable.assert_initialized()],t.prototype,"reformat",null),i([s.Initializable.assert_initialized()],t.prototype,"resize",null),t}(r(4).AbstractObject);t.TextureCube=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),i=r(29),o=r(19),a=r(38),s=r(39),u=r(40),c=function(){function e(t,r){var n=this;this._alwaysRotateOnMove=!1,this._invalidate=t,this._eventHandler=new i.EventHandler(t,r,void 0),this._eventHandler.pushMouseDownHandler(function(e,t){return n.onMouseDown(e,t)}),this._eventHandler.pushMouseUpHandler(function(e,t){return n.onMouseUp(e,t)}),this._eventHandler.pushMouseMoveHandler(function(e,t){return n.onMouseMove(e,t)}),this._eventHandler.pushClickHandler(function(e,t){return n.onClick(e,t)}),this.metaphor=e.Metaphor.Turntable}return e.prototype.mode=function(t){var r=1&t.buttons,n="mousedown"===t.type,i="mousemove"===t.type;if(o.PointerLock.active()&&this._alwaysRotateOnMove||(n||i)&&r)return e.Modes.Rotate},e.prototype.rotate=function(t,r){var i=this._eventHandler.offsets(t)[0];switch(this._metaphor){case e.Metaphor.FirstPerson:var a=this._firstPerson,s=void 0;o.PointerLock.active()&&t instanceof MouseEvent&&(s=n.vec2.fromValues(t.movementX,t.movementY)),r?a.initiate(i):a.process(i,s),t.preventDefault();break;case e.Metaphor.Trackball:var u=this._trackball;r?u.initiate(i):u.process(i),t.preventDefault();break;case e.Metaphor.Turntable:var c=this._turntable;r?c.initiate(i):c.process(i),t.preventDefault()}},e.prototype.onMouseDown=function(t,r){var n=t[t.length-1];switch(this._mode=this.mode(n),this._mode){case e.Modes.Zoom:break;case e.Modes.Rotate:this.rotate(n,!0)}},e.prototype.onMouseUp=function(e,t){var r=e[e.length-1];void 0!==this._mode&&r.preventDefault()},e.prototype.onMouseMove=function(t,r){var n=t[t.length-1],i=void 0===this._mode;switch(this._mode=this.mode(n),this._mode){case e.Modes.Rotate:this.rotate(n,i)}},e.prototype.onClick=function(e,t){},e.prototype.update=function(){this._eventHandler.update()},Object.defineProperty(e.prototype,"camera",{set:function(e){this._camera=e,this._firstPerson&&(this._firstPerson.camera=e),this._trackball&&(this._trackball.camera=e),this._turntable&&(this._turntable.camera=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"metaphor",{get:function(){return this._metaphor},set:function(t){if(this._metaphor!==t){switch(this._firstPerson=void 0,this._trackball=void 0,this._turntable=void 0,this._eventHandler.exitPointerLock(),this._alwaysRotateOnMove=!1,this._metaphor=t,this._metaphor){case e.Metaphor.FirstPerson:this._eventHandler.requestPointerLock(),this._alwaysRotateOnMove=!0,this._firstPerson=new a.FirstPersonModifier,this._firstPerson.camera=this._camera;break;case e.Metaphor.Trackball:this._trackball=new s.TrackballModifier,this._trackball.camera=this._camera;break;case e.Metaphor.Turntable:this._turntable=new u.TurntableModifier,this._turntable.camera=this._camera}this._invalidate(!0)}},enumerable:!0,configurable:!0}),e}();t.Navigation=c,function(e){!function(e){e[e.Move=0]="Move",e[e.Pan=1]="Pan",e[e.Rotate=2]="Rotate",e[e.Zoom=3]="Zoom",e[e.ZoomStep=4]="ZoomStep"}(e.Modes||(e.Modes={})),function(e){e.FirstPerson="firstperson",e.Flight="flight",e.Trackball="trackball",e.Turntable="turntable"}(e.Metaphor||(e.Metaphor={}))}(c=t.Navigation||(t.Navigation={})),t.Navigation=c},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.update=function(){},t}(r(7).CameraModifier);t.PanModifier=i},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.update=function(){},t}(r(7).CameraModifier);t.ZoomModifier=i},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),a=r(22),s=r(26),u=r(1),c=function(e){function t(t,r){var n=e.call(this,t,r)||this;r=void 0!==r&&""!==r?r:n.constructor.name;var i=new a.Buffer(t,r+"VBO");return n._buffers.push(i),n}return n(t,e),t.prototype.bindBuffers=function(e){this._buffers[0].attribEnable(e[0],2,this.context.gl.FLOAT,!1,0,0,!0,!1)},t.prototype.unbindBuffers=function(e){this._buffers[0].attribDisable(e[0],!0,!0)},t.prototype.initialize=function(r){var n=this.context.gl,i=e.prototype.initialize.call(this,[n.ARRAY_BUFFER],[r]);return o.assert(void 0!==this._buffers[0]&&this._buffers[0].object instanceof WebGLBuffer,"expected valid WebGLBuffer"),this._buffers[0].data(t.VERTICES,n.STATIC_DRAW),i},t.prototype.draw=function(){var e=this.context.gl;e.drawArrays(e.TRIANGLE_STRIP,0,4)},t.VERTICES=new Float32Array([-1,-1,1,-1,-1,1,1,1]),i([u.Initializable.assert_initialized()],t.prototype,"draw",null),t}(s.Geometry);t.NdcFillingRectangle=c},function(e){e.exports={kernel:[[[[-.41692,-.0735727],[.201114,.0165974],[-.0906823,-.219471],[.437182,.252665],[-.180852,.162495],[.291284,-.365369],[.0552157,.398563],[-.32675,-.455539]]]],size:{depth:1,height:1,width:8}}},function(e){e.exports={kernel:[[[[-.49667,.0980561],[-.0589763,.0210422],[.370588,-.29204],[.259132,.381722],[.447602,-.20187],[-.449072,-.0478419],[.0656358,-.0346857],[-.31633,-.485536],[.13452,.43745],[.301704,.235824],[.190248,-.0904137],[.245976,-.236312],[-.247446,-.0133998],[.100078,.201382],[-.350772,.278396],[-.0245342,.25711],[.357432,.0899264],[.31486,-.146142],[.168962,-.326482],[-.358902,-.339638],[-.4065,-.19374],[.482044,.0341984],[.121364,-.180584],[.22469,.145654],[-.427786,.188226],[-.22616,-.395366],[.336146,.471892],[-.157276,-.305196],[.0311937,-.270754],[-.191718,.458736],[.155806,.0554843],[.211534,-.47238],[-.011378,-.124856],[.078792,-.416652],[-.260602,.368566],[-.337616,-.10357],[-.0458201,-.360924],[-.213004,.222668],[-.0802622,-.215026],[-.204874,-.159298],[-.101548,.16694],[-.393344,.424294],[.426316,.180096],[-.170432,.0767702],[-.372058,.0423281],[-.483514,-.28391],[-.114704,-.451094],[-.122834,-.0691278],[-.067106,.403008],[-.13599,.312838],[-.303174,.132498],[.177092,.291552],[-.462228,.334124],[.460758,.416164],[-.281888,-.249468],[.267262,-243664e-9],[.00990784,.493178],[.0443499,.34728],[.41316,-.437938],[.40503,-.0559716],[.391874,.325994],[-.440942,-.429808],[.023064,.111212],[.280418,-.38221]]]],size:{depth:1,height:1,width:64}}},function(e,t){e.exports="\r\nprecision lowp float;\r\n\r\n\r\n#if __VERSION__ == 100\r\n    #define texture(sampler, coord) texture2D(sampler, coord)\r\n#else \r\n    #define varying in\r\n#endif\r\n\r\n\r\n\r\n#if __VERSION__ == 100\r\n    #define fragColor gl_FragColor\r\n#else\r\n    layout(location = 0) out vec4 fragColor;\r\n#endif\r\n\r\n\r\nuniform float u_weight;\r\nuniform sampler2D u_accumulationTexture;\r\nuniform sampler2D u_currentFrameTexture;\r\n\r\nvarying vec2 v_uv;\r\n\r\n\r\nvoid main(void)\r\n{\r\n    vec4 accumulationColor = texture(u_accumulationTexture, v_uv);\r\n    vec4 currentFrameColor = texture(u_currentFrameTexture, v_uv);\r\n    fragColor = mix(accumulationColor, currentFrameColor, u_weight);\r\n}\r\n"},function(e,t){e.exports="\r\nprecision lowp float;\r\n\r\n\r\n#if __VERSION__ == 100\r\n    #define texture(sampler, coord) texture2D(sampler, coord)\r\n#else \r\n    #define varying in\r\n#endif\r\n\r\n\r\n\r\n#if __VERSION__ == 100\r\n    #define fragColor gl_FragColor\r\n#else \r\n    layout(location = 0) out vec4 fragColor;\r\n#endif\r\n\r\n\r\nuniform sampler2D u_texture;\r\n\r\nvarying vec2 v_uv;\r\n\r\n\r\nvoid main(void)\r\n{\r\n    fragColor = texture(u_texture, v_uv);\r\n}\r\n"},function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),i=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a};Object.defineProperty(t,"__esModule",{value:!0});var o=r(2),a=r(0),s=r(3),u=r(8),c=r(1),f=r(12),l=r(10),h=r(11),p=r(9),_=function(e){function t(t){var r=e.call(this)||this;return r._cache=!1,r._depthAttachment=0,r._cachedDepths=new Map,r._cachedIDs=new Map,r._buffer=new Uint8Array(4),r._ndcTriangleShared=!1,r._context=t,r}return n(t,e),t.prototype.onFrame=function(){this._cachedDepths.clear(),this._cachedIDs.clear()},t.prototype.hash=function(e,t){return 65535*t+e},t.prototype.directReadDepthAt=function(e,t){var r=this.hash(e,t);if(this._cache&&this._cachedDepths.has(r))return this._cachedDepths.get(r);a.assert(void 0!==this._depthFBO&&this._depthFBO.valid,"valid depth FBO expected for reading back depth");var n=this._depthFBO.texture(this._depthAttachment),i=this._context.gl,u=n.size;this._depthFBO.bind();var c=void 0===this._referenceSize?[1,1]:[u[0]/this._referenceSize[0],u[1]/this._referenceSize[1]];(this._context.isWebGL2||this._context.supportsDrawBuffers)&&i.readBuffer(this._depthAttachment),i.readPixels(e*c[0],u[1]-t*c[1],1,1,i.RGBA,i.UNSIGNED_BYTE,this._buffer);var f=s.decode_float24x1_from_uint8x3(o.vec3.fromValues(this._buffer[0],this._buffer[1],this._buffer[2]));return f=f>=1?void 0:f,this._cache&&this._cachedDepths.set(r,f),f},t.prototype.renderThenReadDepthAt=function(e,t){var r=this.hash(e,t);if(this._cache&&this._cachedDepths.has(r))return this._cachedDepths.get(r);a.assert(void 0!==this._depthFBO&&this._depthFBO.valid,"valid depth FBO expected for reading back depth");var n=this._depthFBO.texture(this._depthAttachment),i=this._context.gl,u=n.size,c=void 0===this._referenceSize?[1,1]:[u[0]/this._referenceSize[0],u[1]/this._referenceSize[1]];i.viewport(0,0,1,1),this._program.bind(),i.uniform2f(this._uOffset,e*c[0]/u[0],(u[1]-t*c[1])/u[1]),i.uniform2f(this._uScale,1/u[0],1/u[1]),n.bind(i.TEXTURE0),this._framebuffer.bind(),this._ndcTriangle.bind(),this._ndcTriangle.draw(),this._ndcTriangle.unbind(),n.unbind(),(this._context.isWebGL2||this._context.supportsDrawBuffers)&&i.readBuffer&&i.readBuffer(i.COLOR_ATTACHMENT0),i.readPixels(0,0,1,1,i.RGBA,i.UNSIGNED_BYTE,this._buffer),this._framebuffer.unbind();var f=s.decode_float24x1_from_uint8x3(o.vec3.fromValues(this._buffer[0],this._buffer[1],this._buffer[2]));return f=f>=1?void 0:f,this._cache&&this._cachedDepths.set(r,f),f},t.prototype.initialize=function(e){var t=this._context.gl,n=this._context.gl2facade;if(this._context.isWebGL1&&!this._context.supportsDepthTexture)return this.depthAt=this.directReadDepthAt,!0;this.depthAt=this.renderThenReadDepthAt;var i=new h.Shader(this._context,t.VERTEX_SHADER,"ndcvertices.vert (readback)");i.initialize(r(28));var o=new h.Shader(this._context,t.FRAGMENT_SHADER,"readbackdepth.frag");if(o.initialize(r(81)),this._program=new l.Program(this._context,"ReadbackDepthProgram"),this._program.initialize([i,o]),this._uOffset=this._program.uniform("u_offset"),this._program.bind(),t.uniform1i(this._program.uniform("u_texture"),0),this._program.unbind(),this._texture=new p.Texture2(this._context,"ReadbackRenderTexture"),this._texture.initialize(1,1,t.RGBA,t.RGBA,t.UNSIGNED_BYTE),this._framebuffer=new u.Framebuffer(this._context,"ReadbackFBO"),this._framebuffer.initialize([[n.COLOR_ATTACHMENT0,this._texture]]),void 0===e?this._ndcTriangle=new f.NdcFillingTriangle(this._context):(this._ndcTriangle=e,this._ndcTriangleShared=!0),this._ndcTriangle.initialized)this._program.attribute("a_vertex",this._ndcTriangle.aVertex);else{var a=this._program.attribute("a_vertex",0);this._ndcTriangle.initialize(a)}return!0},t.prototype.uninitialize=function(){this._context.isWebGL1&&!this._context.supportsDepthTexture||(!this._ndcTriangleShared&&this._ndcTriangle.initialized&&this._ndcTriangle.uninitialize(),this._program.uninitialize(),this._texture.uninitialize(),this._framebuffer.uninitialize())},t.prototype.coordsAt=function(e,t,r,n){var i=this._depthFBO.texture(this._depthAttachment).size,a=void 0===r?this.depthAt(e,t):r;if(void 0!==a){var s=void 0===this._referenceSize?[1,1]:[i[0]/this._referenceSize[0],i[1]/this._referenceSize[1]],u=o.vec3.fromValues(e*s[0]*2/i[0]-1,1-t*s[1]*2/i[1],2*a-1);return o.vec3.transformMat4(o.vec3.create(),u,n)}},t.prototype.idAt=function(e,t){var r=this.hash(e,t);if(this._cache&&this._cachedIDs.has(r))return this._cachedIDs.get(r);var n=this._context.gl,i=this._idFBO.texture(this._idAttachment).size,a=void 0===this._referenceSize?[1,1]:[i[0]/this._referenceSize[0],i[1]/this._referenceSize[1]];this._idFBO.bind(),(this._context.isWebGL2||this._context.supportsDrawBuffers)&&n.readBuffer&&n.readBuffer(this._idAttachment),n.readPixels(e*a[0],i[1]-t*a[1],1,1,n.RGBA,n.UNSIGNED_BYTE,this._buffer);var u=s.decode_uint32_from_rgba8(o.vec4.fromValues(this._buffer[0],this._buffer[1],this._buffer[2],this._buffer[3]));return this._cache&&this._cachedIDs.set(r,u),u},t.prototype.frame=function(){this.onFrame()},Object.defineProperty(t.prototype,"cache",{set:function(e){this._cache=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"depthFBO",{set:function(e){this._depthFBO=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"depthAttachment",{set:function(e){this._depthAttachment=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"idFBO",{set:function(e){this._idFBO=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"idAttachment",{set:function(e){this._idAttachment=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"coordinateReferenceSize",{set:function(e){this._referenceSize=e},enumerable:!0,configurable:!0}),i([c.Initializable.assert_initialized()],t.prototype,"directReadDepthAt",null),i([c.Initializable.assert_initialized()],t.prototype,"renderThenReadDepthAt",null),i([c.Initializable.initialize()],t.prototype,"initialize",null),i([c.Initializable.uninitialize()],t.prototype,"uninitialize",null),i([c.Initializable.assert_initialized()],t.prototype,"coordsAt",null),i([c.Initializable.assert_initialized()],t.prototype,"idAt",null),t}(c.Initializable);t.ReadbackPass=_},function(e,t){e.exports="\r\nprecision highp float;\r\n\r\n\r\n#if __VERSION__ == 100\r\n    #define texture(sampler, coord) texture2D(sampler, coord)\r\n#else \r\n    #define varying in\r\n#endif\r\n\r\n\r\nconst float one255ths = 1.0 / 255.0;\r\n\r\nvec3 float24x1_to_uint8x3(const in float f) {\r\n    vec3 uint8x3 = vec3(f, fract(f * 256.0), fract(f * 65536.0));\r\n    return floor(uint8x3 * 256.0) * one255ths;\r\n}\r\n\r\nvec4 float24x1_to_uint8x4(const in float f) {\r\n    vec4 uint8x4 = vec4(f, fract(f * 256.0), fract(f * 65536.0), fract(f * 16777216.0));\r\n    return floor(uint8x4 * 256.0) * one255ths;\r\n}\r\n\r\nconst vec3 premultUint8x3 = vec3(255.0 / 256.0, 255.0 / 65536.0, 255.0 / 16777216.0);\r\nfloat uint8x3_to_float24x1(const in vec3 v) {\r\n    return dot(v, premultUint8x3); // a1 * b1 + a2 * b2 + a3 * b3  ;)\r\n}\r\n\r\nconst vec4 premultUint8x4 = vec4(255.0 / 256.0, 255.0 / 65536.0, 255.0 / 16777216.0, 255.0 / 4294967296.0);\r\nfloat uint8x4_to_float24x1(const in vec4 v) {\r\n    return dot(v, premultUint8x4); // a1 * b1 + a2 * b2 + a3 * b3 + a4 * b4  ;)\r\n}\r\n\r\n\r\n\r\n#if __VERSION__ == 100\r\n    #define fragDepth gl_FragColor\r\n#else \r\n    layout(location = 0) out vec4 fragDepth;\r\n#endif\r\n\r\n\r\nuniform sampler2D u_texture;\r\nuniform vec2 u_offset;\r\nuniform vec2 u_scale;\r\n\r\nvarying vec2 v_uv;\r\n\r\n\r\n\r\nvoid main(void)\r\n{\r\n    vec2 uv = vec2(v_uv.x, 1.0 - v_uv.y) * u_scale + u_offset;\r\n    float depth = texture(u_texture, uv).r;\r\n\r\n    fragDepth = vec4(float24x1_to_uint8x3(depth), 1.0);\r\n}\r\n"},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(i,o){function a(e){try{u(n.next(e))}catch(e){o(e)}}function s(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(a,s)}u((n=n.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(0),a=r(34),s=r(42),u=r(44),c=function(){function e(e){this.onXRFrameCallback=this.onXRFrame.bind(this),this.frameData=new s.FrameData,this.contextAttributes={},this.frameOfRefType="eye-level",this.inputPoses=[],this._block=!1,this.sessionCreationOptions=e||{}}return e.supportsXR=function(){return void 0!==navigator.xr},e.prototype.requestDevice=function(){return n(this,void 0,void 0,function(){var t;return i(this,function(r){switch(r.label){case 0:return o.assert(e.supportsXR(),"WebXR not supported by browser"),t=this,[4,navigator.xr.requestDevice()];case 1:return t.device=r.sent(),this.contextAttributes.compatibleXRDevice=this.device,[2]}})})},e.prototype.supportsSession=function(){return n(this,void 0,void 0,function(){return i(this,function(e){switch(e.label){case 0:o.assert(void 0!==this.device,"this.device not initialized"),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.device.supportsSession(this.sessionCreationOptions)];case 2:return e.sent(),[2,!0];case 3:return e.sent(),[2,!1];case 4:return[2]}})})},e.prototype.requestSession=function(){return n(this,void 0,void 0,function(){var e,t,r,n=this;return i(this,function(i){switch(i.label){case 0:return e=this,[4,this.device.requestSession(this.sessionCreationOptions)];case 1:return e.session=i.sent(),t=document.createElement("canvas"),this.canvas=new a.Canvas(t,this.contextAttributes,this),this.gl=this.canvas.context.gl,this.session.baseLayer=new XRWebGLLayer(this.session,this.gl,this.webGLLayerInit),r=this,[4,this.session.requestFrameOfReference(this.frameOfRefType,this.frameOfRefOptions)];case 2:return r.frameOfRef=i.sent(),this.frameData.frameOfReference=this.frameOfRef,this.session.requestAnimationFrame(this.onXRFrameCallback),this.session.addEventListener("end",function(){return n.onEndSession()}),[2]}})})},e.prototype.endSession=function(){return n(this,void 0,void 0,function(){return i(this,function(e){switch(e.label){case 0:return[4,this.session.end()];case 1:return e.sent(),[2]}})})},e.prototype.onEndSession=function(){this.session=void 0,this.canvas=void 0,this.gl=void 0,this.frameOfRef=void 0,this.frameData=new s.FrameData},e.prototype.onXRFrame=function(e,t){if(this.session){var r=t.session;r.requestAnimationFrame(this.onXRFrameCallback);var n=this.gl;this.frameData.time=e,this.frameData.frame=t,n.bindFramebuffer(n.FRAMEBUFFER,r.baseLayer.framebuffer),this.renderer.xrframe(this.frameData)}},Object.defineProperty(e.prototype,"controllable",{set:function(e){o.assert(e instanceof u.XRRenderer,"Controllable must be an `XRRenderer`"),this.renderer=e},enumerable:!0,configurable:!0}),e.prototype.block=function(){this._block=!0},Object.defineProperty(e.prototype,"blocked",{get:function(){return this._block},enumerable:!0,configurable:!0}),e.prototype.unblock=function(){this._block=!1},e.prototype.update=function(e){void 0===e&&(e=!1)},Object.defineProperty(e.prototype,"multiFrameNumber",{get:function(){return 0},set:function(e){},enumerable:!0,configurable:!0}),e}();t.XRController=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(29),i=function(){function e(e,t){var r=this;this._altered=!1,this._eventHandler=new n.EventHandler(e,t,void 0),this._eventHandler.pushMouseEnterHandler(function(e,t){return r.onMouseEnter(e,t)}),this._eventHandler.pushMouseLeaveHandler(function(e,t){return r.onMouseLeave(e,t)})}return e.prototype.onMouseEnter=function(e,t){this._altered=!1},e.prototype.onMouseLeave=function(e,t){this._altered=!0},e.prototype.update=function(){this._eventHandler.update()},e.prototype.reset=function(){this._altered=!1},Object.defineProperty(e.prototype,"altered",{get:function(){return this._altered},enumerable:!0,configurable:!0}),e}();t.TestNavigation=i},function(e,t,r){r(51),r(52),e.exports=r(85)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(r(53));var n=r(46);t.properties=n;var i=r(45);t.fetch=i;var o=r(86);t.ray_math=o;var a=r(83),s=r(87);!function(e){e.TestRenderer=s.TestRenderer,e.TestNavigation=a.TestNavigation}(t.debug||(t.debug={}));var u=r(90),c=r(91);!function(e){e.EventBlocker=u.EventBlocker,e.Fullscreen=c.Fullscreen}(t.viewer||(t.viewer={}))},function(e,t,r){"use strict";var n,i=r(2),o=r(3),a=r(0);!function(e){function t(e,t,r){void 0===r&&(r=1);var n=i.vec2.subtract(o.v2(),t,e);if(!i.vec2.equals(n,i.vec2.fromValues(0,0))){var a=i.vec2.squaredLength(n),s=2*i.vec2.dot(n,e),u=s*s-4*a*(i.vec2.squaredLength(e)-r*r);if(!(u<0)){var c=Math.sqrt(u),f=Math.min((-s+c)/(2*a),(-s-c)/(2*a)),l=i.vec2.scale(o.v2(),n,f);return i.vec2.add(l,l,e)}}}function r(e,t,r,n){var a=e,s=i.vec2.sub(o.v2(),t,e),u=r,c=i.vec2.sub(o.v2(),n,r),f=i.vec2.cross(o.v3(),s,c)[2];if(0!==f){var l=i.vec2.sub(o.v2(),u,a),h=i.vec2.cross(o.v3(),l,i.vec2.scale(o.v2(),s,1/f))[2],p=i.vec2.cross(o.v3(),l,i.vec2.scale(o.v2(),c,1/f))[2];if(!(h<0||h>1||p<0))return[i.vec2.add(o.v2(),u,i.vec2.scale(o.v2(),c,h)),p]}}function n(e,t,r,n){void 0===r&&(r=[0,0,0]),void 0===n&&(n=[0,1,0]);var a=i.vec3.normalize(o.v3(),i.vec3.subtract(o.v3(),t,e)),s=i.vec3.dot(a,n);if(!(i.vec3.equals(a,[0,0,0])||s>=0)){var u=i.vec3.dot(i.vec3.subtract(o.v3(),r,e),n)/s;return i.vec3.add(o.v3(),i.vec3.scale(o.v3(),a,u),e)}}function s(e,t,r){var n=i.vec3.subtract(o.v3(),t,e),a=i.vec3.squaredLength(n);if(0===a)return 0;var s=i.vec3.subtract(o.v3(),r,e);return i.vec3.dot(s,n)/a}e.rayCircleIntersection=t,e.pointSquareIntersection=function(e,t){void 0===t&&(t=1);var r=o.abs2(o.v2(),e);return r[0]>=r[1]?i.vec2.fromValues(o.sign(e[0])*t,e[1]/r[0]*t):i.vec2.fromValues(e[0]/r[1]*t,o.sign(e[1])*t)},e.raySquareIntersection=function(e,t,n){void 0===n&&(n=1);for(var o=[i.vec2.fromValues(-n,+n),i.vec2.fromValues(-n,-n),i.vec2.fromValues(+n,-n),i.vec2.fromValues(+n,+n)],a=new Array,s=0;s<4;++s){var u=r(e,t,o[s],o[(s+1)%4]);u&&a.push(u[1])}return a},e.rayLineIntersection=r,e.rayPlaneIntersection=n,e.raySphereIntersection=function(e,t,r,n){void 0===r&&(r=i.vec3.fromValues(0,0,0)),void 0===n&&(n=1);var a=i.vec3.subtract(o.v3(),e,r),s=i.vec3.normalize(o.v3(),i.vec3.subtract(o.v3(),t,e)),u=i.vec3.dot(s,a),c=u*u-i.vec3.squaredLength(a)+n*n;if(!(c<=0))return i.vec3.add(o.v3(),e,i.vec3.scale(o.v3(),s,-u-Math.sqrt(c)))},e.rayPlaneIntersection_tube=function(e,r,o){void 0===o&&(o=1);var a=n(e,r);if(void 0!==a&&i.vec3.length(a)<o)return a;var s=t(i.vec2.fromValues(e[0],e[2]),i.vec2.fromValues(r[0],r[2]),o);return s?i.vec3.fromValues(s[0],0,s[1]):void 0},e.isPointWithinSquare=function(e,t){void 0===t&&(t=1);var r=o.abs2(o.v2(),e);return r[0]<=t&&r[1]<=t},e.isPointWithinNDC=function(e,t){var r=i.vec3.transformMat4(o.v3(),t,e),n=o.abs3(o.v3(),r);return n[0]<=1&&n[1]<=1&&r[2]>=0&&r[2]<=1},e.distancePointToRay=s,e.eyeWithPointInView=function(e,t){var r=i.vec3.subtract(o.v3(),e.center,e.eye),n=i.vec3.normalize(o.v3(),r),u=i.vec3.normalize(o.v3(),i.vec3.cross(o.v3(),n,e.up)),c=i.vec3.normalize(o.v3(),i.vec3.cross(o.v3(),u,n)),f=s(e.eye,e.center,t),l=i.vec3.add(o.v3(),e.eye,i.vec3.scale(o.v3(),r,f)),h=i.vec3.subtract(o.v3(),t,l),p=Math.abs(i.vec3.dot(h,u))/e.aspect,_=Math.abs(i.vec3.dot(h,c)),d=Math.max(p,_)/Math.tan(e.fovy*a.DEG2RAD*.5);return i.vec3.subtract(o.v3(),l,i.vec3.scale(o.v3(),n,d))}}(n||(n={})),e.exports=n},function(e,t,r){"use strict";var n,i=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),o=r(0),a=r(49),s=r(48),u=r(50),c=r(47),f=r(8),l=r(12),h=r(10),p=r(30),_=r(31),d=r(11),b=r(9),m=r(83);!function(e){var t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._extensions=!1,t}return i(t,e),t.prototype.onInitialize=function(e,t,n){var i=this,_=this._context.gl,v=this._context.gl2facade;!1===this._extensions&&this._context.isWebGL1&&(o.assert(this._context.supportsStandardDerivatives,"expected OES_standard_derivatives support"),this._context.standardDerivatives,this._extensions=!0);var g=new d.Shader(this._context,_.VERTEX_SHADER,"testrenderer.vert");g.initialize(r(88));var y=new d.Shader(this._context,_.FRAGMENT_SHADER,"testrenderer.frag");y.initialize(r(89)),this._program=new h.Program(this._context),this._program.initialize([g,y]),this._uNdcOffset=this._program.uniform("u_ndcOffset"),this._uFrameNumber=this._program.uniform("u_frameNumber"),this._ndcTriangle=new l.NdcFillingTriangle(this._context);var E=this._program.attribute("a_vertex",0);return this._ndcTriangle.initialize(E),this._ndcOffsetKernel=new s.AntiAliasingKernel(this._multiFrameNumber),this._defaultFBO=new c.DefaultFramebuffer(this._context,"DefaultFBO"),this._defaultFBO.initialize(),this._colorRenderTexture=new b.Texture2(this._context,"ColorRenderTexture"),this._depthRenderbuffer=new p.Renderbuffer(this._context,"DepthRenderbuffer"),this._intermediateFBO=new f.Framebuffer(this._context,"IntermediateFBO"),this._accumulate=new a.AccumulatePass(this._context),this._accumulate.initialize(this._ndcTriangle),this._accumulate.precision=this._framePrecision,this._accumulate.texture=this._colorRenderTexture,this._blit=new u.BlitPass(this._context),this._blit.initialize(this._ndcTriangle),this._blit.readBuffer=v.COLOR_ATTACHMENT0,this._blit.drawBuffer=_.BACK,this._blit.target=this._defaultFBO,this._testNavigation=new m.TestNavigation(function(){return i.invalidate()},n),!0},t.prototype.onUninitialize=function(){e.prototype.uninitialize.call(this),this._uNdcOffset=-1,this._uFrameNumber=-1,this._program.uninitialize(),this._ndcTriangle.uninitialize(),this._intermediateFBO.uninitialize(),this._defaultFBO.uninitialize(),this._colorRenderTexture.uninitialize(),this._depthRenderbuffer.uninitialize(),this._blit.uninitialize()},t.prototype.onUpdate=function(){this._testNavigation.update();var e=this._testNavigation.altered;return this._testNavigation.reset(),!(!e&&!this._altered.any)&&e},t.prototype.onPrepare=function(){var e=this._context.gl,t=this._context.gl2facade;this._intermediateFBO.initialized?this._altered.frameSize&&this._intermediateFBO.resize(this._frameSize[0],this._frameSize[1]):(this._colorRenderTexture.initialize(this._frameSize[0],this._frameSize[1],this._context.isWebGL2?e.RGBA8:e.RGBA,e.RGBA,e.UNSIGNED_BYTE),this._depthRenderbuffer.initialize(this._frameSize[0],this._frameSize[1],e.DEPTH_COMPONENT16),this._intermediateFBO.initialize([[t.COLOR_ATTACHMENT0,this._colorRenderTexture],[e.DEPTH_ATTACHMENT,this._depthRenderbuffer]])),this._altered.multiFrameNumber&&(this._ndcOffsetKernel.width=this._multiFrameNumber),this._altered.framePrecision&&(this._accumulate.precision=this._framePrecision),this._altered.clearColor&&this._intermediateFBO.clearColor(this._clearColor),this._accumulate.update(),this._altered.reset()},t.prototype.onFrame=function(e){var t=this._context.gl;t.viewport(0,0,this._frameSize[0],this._frameSize[1]),this._program.bind();var r=this._ndcOffsetKernel.get(e);r[0]=2*r[0]/this._frameSize[0],r[1]=2*r[1]/this._frameSize[1],t.uniform2fv(this._uNdcOffset,r),t.uniform1i(this._uFrameNumber,e),this._intermediateFBO.clear(t.COLOR_BUFFER_BIT,!0,!1),this._ndcTriangle.bind(),this._ndcTriangle.draw(),this._intermediateFBO.unbind(),this._accumulate.frame(e)},t.prototype.onSwap=function(){this._blit.framebuffer=this._accumulate.framebuffer?this._accumulate.framebuffer:this._blit.framebuffer=this._intermediateFBO,this._blit.frame()},t}(_.Renderer);e.TestRenderer=t}(n||(n={})),e.exports=n},function(e,t){e.exports="\r\nprecision lowp float;\r\n\r\n\r\n#if __VERSION__ == 100\r\n#else \r\n    #define varying out\r\n#endif\r\n\r\n\r\nvoid ndcOffset(inout vec4 vertex, in vec2 offset) {\r\n    vertex.xy = offset * vec2(vertex.w) + vertex.xy;\r\n}\r\n\r\n\r\n\r\n#if __VERSION__ == 100\r\n    attribute vec2 a_vertex;\r\n#else \r\n    layout(location = 0) in vec2 a_vertex;\r\n#endif\r\n\r\nuniform vec2 u_ndcOffset;\r\n\r\nvarying vec2 v_uv;\r\n\r\n\r\nvoid main(void)\r\n{\r\n    v_uv = a_vertex.xy * 0.5 + 0.5;\r\n\r\n    vec4 vertex = vec4(a_vertex, 0.0, 1.0);\r\n    ndcOffset(vertex, u_ndcOffset);\r\n\r\n    gl_Position = vertex;\r\n}\r\n"},function(e,t){e.exports="\r\nprecision lowp float;\r\n\r\n\r\n#if __VERSION__ == 100\r\n    #define texture(sampler, coord) texture2D(sampler, coord)\r\n#else \r\n    #define varying in\r\n#endif\r\n\r\n\r\n\r\n#if __VERSION__ == 100\r\n    #define fragColor gl_FragColor\r\n    #extension GL_OES_standard_derivatives : enable\r\n#else \r\n    layout(location = 0) out vec4 fragColor;\r\n#endif\r\n\r\nuniform int u_frameNumber;\r\n\r\nvarying vec2 v_uv;\r\n\r\n\r\nvoid main(void)\r\n{\r\n    vec3 color = vec3(28.0 / 255.0, 117.0 / 255.0, 188.0 / 255.0);\r\n    color += (vec3(0.0, v_uv) - 0.5) * 0.125;\r\n\r\n    vec2 awidth = fwidth(v_uv) * (sin(float(u_frameNumber) * 0.1) * 7.0 + 8.0);\r\n    vec2 cstep = abs(step(awidth, v_uv) - step(awidth, 1.0 - v_uv));\r\n    if(!any(bvec2(cstep))) {\r\n        discard;\r\n    }\r\n    fragColor = vec4(color, 1.0); \r\n}\r\n"},function(e,t,r){"use strict";var n;!function(e){var t=function(){function e(e,t){if(this._blockListenerByEvent=new Map,this._element=e,void 0!==t)for(var r=0,n=t;r<n.length;r++){var i=n[r];this.block(i)}}return e.prototype.block=function(e){this._blockListenerByEvent.has(e)||(this._blockListenerByEvent.set(e,function(e){return e.preventDefault(),e.stopPropagation(),!1}),this._element.addEventListener(e,this._blockListenerByEvent.get(e)))},e.prototype.unblock=function(e){this._blockListenerByEvent.has(e)&&(this._element.removeEventListener(e,this._blockListenerByEvent.get(e)),this._blockListenerByEvent.delete(e))},e}();e.EventBlocker=t}(n||(n={})),e.exports=n},function(e,t,r){"use strict";var n,i=r(0);!function(e){var t=function(){function e(){}return e.queryAndCacheAPI=function(){if(void 0===e._exit){for(var t=window.document,r=[t.exitFullScreen,t.msExitFullscreen,t.mozCancelFullScreen,t.webkitExitFullscreen,void 0],n=0;n<r.length&&void 0===r[n];++n);switch(n){case 0:e._exit=function(){return t.exitFullScreen()},e._request=function(e){return e.requestFullscreen()},e._element=function(){return t.fullscreenElement},e._event="fullscreenchange";break;case 1:e._exit=function(){return t.msExitFullscreen()},e._request=function(e){return e.msRequestFullscreen()},e._element=function(){return t.msFullscreenElement},e._event="msfullscreenchange";break;case 2:e._exit=function(){return t.mozCancelFullScreen()},e._request=function(e){return e.mozRequestFullScreen()},e._element=function(){return t.mozFullScreenElement},e._event="mozfullscreenchange";break;case 3:e._exit=function(){return t.webkitExitFullscreen()},e._request=function(e){return e.webkitRequestFullscreen()},e._element=function(){return t.webkitFullscreenElement},e._event="webkitfullscreenchange";break;default:i.assert(!1,"none of the following fullscreen apis was found: native, ms, moz, or webkit")}}},e.active=function(){return void 0!==e._element()&&null!==e._element()},e.toggle=function(t,r){if(void 0!==t){e.queryAndCacheAPI();var n=e.active();if(!n){var i=getComputedStyle(t);e._size[0]=i.width,e._size[1]=i.height}r&&r(),n?(e._callback=void 0,window.removeEventListener(e._event,e.removeEventListener),t.style.width=e._size[0],t.style.height=e._size[1]):(e._callback=r,window.addEventListener(e._event,e.addEventListener)),n?e._exit():e._request(t)}},e._size=["0","0"],e.addEventListener=function(){window.removeEventListener(e._event,e.addEventListener),window.addEventListener(e._event,e.removeEventListener)},e.removeEventListener=function(){e._callback&&(e._callback(),e._callback=void 0),window.removeEventListener(e._event,e.removeEventListener)},e}();e.Fullscreen=t}(n||(n={})),e.exports=n}])});
//# sourceMappingURL=webgl-operate.js.map