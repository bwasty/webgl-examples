!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("gloperate"));else if("function"==typeof define&&define.amd)define(["gloperate"],t);else{var i="object"==typeof exports?t(require("gloperate")):t(e.gloperate);for(var n in i)("object"==typeof exports?exports:e)[n]=i[n]}}(window,function(e){return function(e){var t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},i.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=46)}({0:function(t,i){t.exports=e},1:function(e,t,i){"use strict"},42:function(e,t){e.exports="\nprecision lowp float;\n\n\n#if __VERSION__ == 100\n    #define texture(sampler, coord) texture2D(sampler, coord)\n#else \n    #define varying in\n#endif\n\n\n\n#if __VERSION__ == 100\n    #define fragColor gl_FragColor\n    #extension GL_OES_standard_derivatives : enable\n#else \n    layout(location = 0) out vec4 fragColor;\n#endif\n\nuniform int u_frameNumber;\n\nvarying vec2 v_uv;\n\n\nvoid main(void)\n{\n    vec3 color = vec3(28.0 / 255.0, 117.0 / 255.0, 188.0 / 255.0);\n    color += (vec3(0.0, v_uv) - 0.5) * 0.125;\n\n    vec2 awidth = fwidth(v_uv) * (sin(float(u_frameNumber) * 0.1) * 7.0 + 8.0);\n    vec2 cstep = abs(step(awidth, v_uv) - step(awidth, 1.0 - v_uv));\n    if(!any(bvec2(cstep))) {\n        discard;\n    }\n    fragColor = vec4(color, 1.0); \n}\n"},43:function(e,t){e.exports="\nprecision lowp float;\n\n\n#if __VERSION__ == 100\n#else \n    #define varying out\n#endif\n\n\n\n#if __VERSION__ == 100\n    attribute vec2 a_vertex;\n#else \n    layout(location = 0) in vec2 a_vertex;\n#endif\n\nuniform vec2 u_ndcOffset;\n\nvarying vec2 v_uv;\n\n\nvoid main(void)\n{\n    v_uv = a_vertex.xy * 0.5 + 0.5;\n\n    vec4 vertex = vec4(a_vertex, 0.0, 1.0);\n    vertex.xy = u_ndcOffset * vec2(vertex.w) + vertex.xy;\n\n    gl_Position = vertex;\n}\n"},44:function(e,t,i){"use strict";var n,r=this&&this.__extends||(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});Object.defineProperty(t,"__esModule",{value:!0});var a=i(0),o=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._extensions=!1,t}return r(t,e),t.prototype.onUpdate=function(){this._testNavigation.update();var e=this._testNavigation.altered;return this._testNavigation.reset(),this._altered.any||e},t.prototype.onPrepare=function(){var e=this._context.gl,t=this._context.gl2facade;this._altered.multiFrameNumber&&(this._ndcOffsetKernel.width=this._multiFrameNumber),this._intermediateFBO.initialized?this._altered.frameSize&&this._intermediateFBO.resize(this._frameSize[0],this._frameSize[1]):(this._colorRenderTexture.initialize(this._frameSize[0],this._frameSize[1],this._context.isWebGL2?e.RGBA8:e.RGBA,e.RGBA,e.UNSIGNED_BYTE),this._depthRenderbuffer.initialize(this._frameSize[0],this._frameSize[1],e.DEPTH_COMPONENT16),this._intermediateFBO.initialize([[t.COLOR_ATTACHMENT0,this._colorRenderTexture],[e.DEPTH_ATTACHMENT,this._depthRenderbuffer]])),this._altered.clearColor&&this._intermediateFBO.clearColor(this._clearColor),this._accumulate.update(),this._altered.reset()},t.prototype.onFrame=function(e){var t=this._context.gl;t.viewport(0,0,this._frameSize[0],this._frameSize[1]),this._program.bind();var i=this._ndcOffsetKernel.get(e);i[0]=2*i[0]/this._frameSize[0],i[1]=2*i[1]/this._frameSize[1],t.uniform2fv(this._uNdcOffset,i),t.uniform1i(this._uFrameNumber,e),this._intermediateFBO.clear(t.COLOR_BUFFER_BIT,!0,!1),this._ndcTriangle.bind(),this._ndcTriangle.draw(),this._intermediateFBO.unbind(),this._accumulate.frame(e)},t.prototype.onSwap=function(){this._blit.framebuffer=this._accumulate.framebuffer?this._accumulate.framebuffer:this._blit.framebuffer=this._intermediateFBO,this._blit.frame()},t.prototype.onInitialize=function(e,t,n){var r=this,o=this._context.gl,s=this._context.gl2facade;!1===this._extensions&&this._context.isWebGL1&&(a.auxiliaries.assert(this._context.supportsStandardDerivatives,"expected OES_standard_derivatives support"),this._context.standardDerivatives,this._extensions=!0);var u=new a.Shader(this._context,o.VERTEX_SHADER,"testrenderer.vert");u.initialize(i(43));var _=new a.Shader(this._context,o.FRAGMENT_SHADER,"testrenderer.frag");_.initialize(i(42)),this._program=new a.Program(this._context),this._program.initialize([u,_]),this._uNdcOffset=this._program.uniform("u_ndcOffset"),this._uFrameNumber=this._program.uniform("u_frameNumber"),this._ndcTriangle=new a.NdcFillingTriangle(this._context);var c=this._program.attribute("a_vertex",0);return this._ndcTriangle.initialize(c),this._ndcOffsetKernel=new a.AntiAliasingKernel(this._multiFrameNumber),this._defaultFBO=new a.DefaultFramebuffer(this._context,"DefaultFBO"),this._defaultFBO.initialize(),this._colorRenderTexture=new a.Texture2(this._context,"ColorRenderTexture"),this._depthRenderbuffer=new a.Renderbuffer(this._context,"DepthRenderbuffer"),this._intermediateFBO=new a.Framebuffer(this._context,"IntermediateFBO"),this._accumulate=new a.AccumulatePass(this._context),this._accumulate.initialize(this._ndcTriangle),this._accumulate.precision=this._framePrecision,this._accumulate.texture=this._colorRenderTexture,this._blit=new a.BlitPass(this._context),this._blit.initialize(this._ndcTriangle),this._blit.readBuffer=s.COLOR_ATTACHMENT0,this._blit.drawBuffer=o.BACK,this._blit.target=this._defaultFBO,this._testNavigation=new a.debug.TestNavigation(function(){return r.invalidate()},n),!0},t.prototype.onUninitialize=function(){this._uNdcOffset=-1,this._uFrameNumber=-1,this._program.uninitialize(),this._ndcTriangle.uninitialize(),this._intermediateFBO.uninitialize(),this._defaultFBO.uninitialize(),this._colorRenderTexture.uninitialize(),this._depthRenderbuffer.uninitialize(),this._blit.uninitialize()},t}(a.Renderer);t.TestRenderer=o},45:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(0),r=i(44);function a(){var e=new n.Canvas("example-canvas"),t=e.context,i=new r.TestRenderer;e.renderer=i,e.element.addEventListener("click",function(){n.viewer.Fullscreen.toggle(e.element)}),e.element.addEventListener("touchstart",function(){n.viewer.Fullscreen.toggle(e.element)}),window.canvas=e,window.context=t,window.renderer=i}"complete"===window.document.readyState?a():window.onload=a},46:function(e,t,i){i(1),e.exports=i(45)}})});
//# sourceMappingURL=test-renderer.js.map